/**  
 * Copyright (c) 2020 by ALK Technologies Inc.  
 * Updated: 07-13-2020  
 * Rev: node  
 */ 
'use strict';var ALKMaps=function(){var a=function(){for(var a=/(^|(.*?\/))(ALKMaps.js)(\?|$)/i,b=document.getElementsByTagName("script"),e,f="",g="",h="",i=0,j=b.length;i<j;i++)if(e=b[i].getAttribute("src")){var k=e.match(a);if(k){f=k[1];h=k[0];g=e;break}}return{l:f,src:g,p:h}},b=a(),b=function(a){var b={};if(!a)return b;for(var a=a.split(/[;&]/),e=0;e<a.length;e++){var f=a[e].split("=");if(f&&2==f.length){var g=unescape(f[0]),f=unescape(f[1]),f=f.replace(/\+/g," ");b[g]=f}}return b}(b.src.substring(b.p.length));
return{VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){var b=a();return function(){return b.l}}(),ImgPath:"",APIKey:b.key}}();(function(a){var b=document.location.protocol.toUpperCase();"HTTP:"!==b&&"HTTPS:"!==b&&(b="http:");a.RestServiceURL=b+"//pcmiler.alk.com/APIs/REST/v1.0/service.svc/";a.MapTileServiceURLForLeaflet=b+"//pcmiler-{s}.alk.com/APIs/REST/v1.0/service.svc/";a.SatImgContentServiceURLForLeaflet=b+"//contentsvc-sat-{s}.alk.com/ContentService.svc/xml/";var c=[b+"//pcmiler-a.alk.com/APIs/REST/v1.0/service.svc/",b+"//pcmiler-b.alk.com/APIs/REST/v1.0/service.svc/",b+"//pcmiler-c.alk.com/APIs/REST/v1.0/service.svc/",
b+"//pcmiler-d.alk.com/APIs/REST/v1.0/service.svc/"];a.VehicleRestrServiceURL=c;a.MapServiceURL=[c[0]+"map",c[1]+"map",c[2]+"map",c[3]+"map"];a.TrafficServiceURL=[c[0]+"traffic",c[1]+"traffic",c[2]+"traffic",c[3]+"traffic"];a.TrafficTileServiceURL=[a.TrafficServiceURL[0]+"Tile",a.TrafficServiceURL[1]+"Tile",a.TrafficServiceURL[2]+"Tile",a.TrafficServiceURL[3]+"Tile"];a.RailServiceURL=b+"//pcmrail.alk.com/REST/v23.1/Service.svc/";a.ContentServiceURL=b+"//contentsvc.alk.com/ContentService.svc/xml/";
a.ContentServiceURL_POC=b+"//contentsvc.alk.com/ContentService.svc/poc/";a.ContentServiceURL_JSON=b+"//contentsvc.alk.com/ContentService.svc/json/";a.TrafficIncContentServiceURL=[b+"//contentsvc.alk.com/ContentService.svc/json/",b+"//contentsvc-a.alk.com/ContentService.svc/json/",b+"//contentsvc-b.alk.com/ContentService.svc/json/",b+"//contentsvc-c.alk.com/ContentService.svc/json/",b+"//contentsvc-d.alk.com/ContentService.svc/json/"];a.SatImgContentServiceURL=[b+"//contentsvc-sat.alk.com/ContentService.svc/xml/",
b+"//contentsvc-sat-a.alk.com/ContentService.svc/xml/",b+"//contentsvc-sat-b.alk.com/ContentService.svc/xml/",b+"//contentsvc-sat-c.alk.com/ContentService.svc/xml/",b+"//contentsvc-sat-d.alk.com/ContentService.svc/xml/"];a.TrafficImgContentServiceURL=[b+"//contentsvc-trafficimg.alk.com/ContentService.svc/xml/",b+"//contentsvc-trafficimg-a.alk.com/ContentService.svc/xml/",b+"//contentsvc-trafficimg-b.alk.com/ContentService.svc/xml/",b+"//contentsvc-trafficimg-c.alk.com/ContentService.svc/xml/",b+"//contentsvc-trafficimg-d.alk.com/ContentService.svc/xml/"];
a.WeatherImgContentServiceURL=[b+"//contentsvc-weather.alk.com/ContentService.svc/xml/",b+"//contentsvc-weather-a.alk.com/ContentService.svc/xml/",b+"//contentsvc-weather-b.alk.com/ContentService.svc/xml/",b+"//contentsvc-weather-c.alk.com/ContentService.svc/xml/",b+"//contentsvc-weather-d.alk.com/ContentService.svc/xml/"];a.SingleSearchURL=b+"//singlesearch.alk.com/";a.DataAnywhereServiceURL=b+"//dataanywhere.alk.com/api/"})(ALKMaps);(function(a){a.isTouch="ontouchstart"in window?!0:!1;a.preventWindowPanning=function(){a.isTouch&&document.body.addEventListener("touchmove",function(a){a.preventDefault()},!1)};a.RouteServiceURL=a.RestServiceURL;a.GeocodeServiceURL=a.RestServiceURL;a.ReportServiceURL=a.RestServiceURL;a.STYLE=a.STYLE||{TRANSPORTATION:"transportation",DATADARK:"datadark",DATALIGHT:"datalight",BASIC:"basic",DEFAULT:"transportation",CLASSIC:"transportation",MONOCHROME:"datalight",ROADATLAS:"transportation",CONTEMPORARY:"datadark",
NIGHT:"datadark",SATELLITE:"satellite",LIGHTNESS:"datalight",SMOOTH:"datalight",TERRAIN:"terrain",validate:function(b){var c=null;if(null!=b&&"string"===typeof b){var b=b.toLowerCase(),d;for(d in a.STYLE)if("string"===typeof a.STYLE[d]&&a.STYLE[d]===b){c=a.STYLE[d];break}}return c},compare:function(b,c){var d=a.STYLE.validate(b),e=a.STYLE.validate(c),f=!1;null!=d&&null!=e&&d===e&&(f=!0);return f},legacyCheck:function(b){var c=a.STYLE.validate(b);if(null===c)if("string"===typeof b)switch(b.toLowerCase()){case "default":case "classic":case "roadatlas":console.warn("The style '"+
b+"' is deprecated. Please use the style ALKMaps.STYLE.TRANSPORTATION.");c=a.STYLE.TRANSPORTATION;break;case "monochrome":case "lightness":case "smooth":console.warn("The style '"+b+"' is deprecated. Please use the style ALKMaps.STYLE.DATALIGHT.");c=a.STYLE.DATALIGHT;break;case "contemporary":case "night":console.warn("The style '"+b+"' is deprecated. Please use the style ALKMaps.STYLE.DATADARK.");c=a.STYLE.DATADARK;break;default:b&&console.warn("The style '"+b+"' is unknown. ALKMaps.STYLE.TRANSPORTATION will be used."),
c=a.STYLE.TRANSPORTATION}else console.warn("The style '"+b+"' is unknown. ALKMaps.STYLE.TRANSPORTATION will be used."),c=a.STYLE.TRANSPORTATION;return c}};a.CONTENT=a.CONTENT||{CITIES:"cities",LABELS:"labels",ROADS:"roads",COMMERCIAL:"commercial",BORDERS:"borders",AREAS:"areas",DEFAULT:"cities,labels,roads,borders,areas"};a.Loading=!1;a.IsInitMap=!0;a.InitDate=new Date(2013,0,24,1,2,3,4)})(ALKMaps);
(function(a){var d;if(a){a.ALKMaps=a.ALKMaps||{VERSION:"1.0.0",LVERSION:"0.7.3",RestServiceURL:"",MapTileServiceURL:"",ContentServiceURL:"",ContentServiceURL_POC:"",ContentServiceURL_JSON:"",APIKey:null,Util:{},Services:{},Layer:{},Control:{},ATTRIBUTION:{},setApiKey:function(a){ALKMaps.APIKey=a}};d=a.alk=a.ALKMaps,a=d;a.RestServiceURL=ALKMaps.RestServiceURL;a.MapTileServiceURL=ALKMaps.MapTileServiceURLForLeaflet;a.ContentServiceURL=ALKMaps.ContentServiceURL;a.ContentServiceURL_POC=ALKMaps.ContentServiceURL_POC;
a.ContentServiceURL_JSON=ALKMaps.ContentServiceURL_JSON;a.ContentServiceURL_SatImg=ALKMaps.SatImgContentServiceURLForLeaflet;for(var a="",b=document.getElementsByTagName("script"),c=0;c<b.length;c++)if(-1<b[c].src.indexOf("alkmaps")){a=b[c].src.split("alkmaps");break}a=a[0]+"theme/default/alkmaps-leaflet.css";b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b)}})("undefined"===
typeof L?null:L);ALKMaps.Class=function(){var a=arguments.length,b=arguments[0],c=arguments[a-1],d="function"==typeof c.initialize?c.initialize:function(){b.prototype.initialize.apply(this,arguments)};1<a?(a=[d,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),c),ALKMaps.inherit.apply(null,a)):d.prototype=c;return d};
ALKMaps.inherit=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;var d,e;for(c=2,d=arguments.length;c<d;c++){e=arguments[c];if("function"===typeof e)e=e.prototype;ALKMaps.Util.extend(a.prototype,e)}};ALKMaps.Util=ALKMaps.Util||{};
ALKMaps.Util.extend=function(a,b){a=a||{};if(b){for(var c in b)if(!("webkitMovementX"==c||"webkitMovementY"==c)){var d=b[c];void 0!==d&&(a[c]=d)}if(!("function"==typeof window.Event&&b instanceof window.Event)&&b.hasOwnProperty&&b.hasOwnProperty("toString"))a.toString=b.toString}return a};ALKMaps.Address=ALKMaps.Class({streetAddress:null,city:null,state:null,zip:null,country:null,initialize:function(a){a=a||{};this.streetAddress=a.streetAddress;this.city=a.city;this.state=a.state;this.zip=a.zip;this.country=a.country},CLASS_NAME:"ALKMaps.Address"});ALKMaps.LonLat=ALKMaps.Class({lon:0,lat:0,initialize:function(a,b){ALKMaps.Util.isArray(a)&&(b=a[1],a=a[0]);this.lon=ALKMaps.Util.toFloat(a);this.lat=ALKMaps.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new ALKMaps.LonLat(this.lon,this.lat)},add:function(a,b){if(null==a||null==b)throw new TypeError("LonLat.add cannot receive null values");return new ALKMaps.LonLat(this.lon+ALKMaps.Util.toFloat(a),
this.lat+ALKMaps.Util.toFloat(b))},equals:function(a){var b=!1;null!=a&&(b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat));return b},transform:function(a,b){var c=ALKMaps.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=c.x;this.lat=c.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){for(;b.lon<a.left;)b.lon+=a.getWidth();for(;b.lon>a.right;)b.lon-=a.getWidth()}return b},CLASS_NAME:"ALKMaps.LonLat"});
ALKMaps.LonLat.fromString=function(a){a=a.split(",");return new ALKMaps.LonLat(a[0],a[1])};ALKMaps.LonLat.fromArray=function(a){var b=ALKMaps.Util.isArray(a);return new ALKMaps.LonLat(b&&a[0],b&&a[1])};ALKMaps.LonLat.transformArray=function(a,b,c){var d=[];if(null!=a&&a instanceof Array&&0<a.length)for(var e=0;e<a.length;e++)if(a[e]instanceof ALKMaps.LonLat)d.push(a[e].clone().transform(b,c));else return[];return d};ALKMaps.Location=ALKMaps.Class({address:null,lonLat:null,label:null,initialize:function(a){a=a||{};this.address=a.address;this.lonLat=a.lonLat;this.label=a.label},CLASS_NAME:"ALKMaps.Location"});ALKMaps.Location.fromLonLat=function(a){a=a||{};return new ALKMaps.Location({lonLat:a})};ALKMaps.Location.fromLonLats=function(a,b){var c=[];if(ALKMaps.Util.isArray(a)&&0<a.length)for(var d=0;d<a.length;d++){var e=ALKMaps.Location.fromLonLat(a[d],b);c.push(e)}return c};ALKMaps.Renderer=ALKMaps.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(a,b){this.container=ALKMaps.Util.getElement(a);ALKMaps.Util.extend(this,b)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return!1},setExtent:function(a,b){this.extent=a.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var c=a.getWidth()/this.map.getExtent().getWidth(),a=a.scale(1/
c);this.extent=a.wrapDateLine(this.map.getMaxExtent()).scale(c)}if(b)this.resolution=null;return!0},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(a,b){if(null==b)b=a.style;if(a.geometry){var c=a.geometry.getBounds();if(c){var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());c.intersectsBounds(this.extent,{worldBounds:d})?this.calculateFeatureDx(c,
d):b={display:"none"};c=this.drawGeometry(a.geometry,b,a.id);if("none"!==b.display&&b.label&&!1!==c){d=a.geometry.getCentroid();if(b.labelXOffset||b.labelYOffset){var e=isNaN(b.labelXOffset)?0:b.labelXOffset,f=isNaN(b.labelYOffset)?0:b.labelYOffset,g=this.getResolution();d.move(e*g,f*g)}this.drawText(a.id,b,d)}else this.removeText(a.id);return c}}},calculateFeatureDx:function(a,b){this.featureDx=0;if(b){var c=b.getWidth();this.featureDx=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/
2)/c)*c}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(a){ALKMaps.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<c;++b){var d=a[b];this.eraseGeometry(d.geometry,d.id);this.removeText(d.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(a){var b=ALKMaps.Util.extend({},ALKMaps.Renderer.defaultSymbolizer);
!1===a.stroke&&(delete b.strokeWidth,delete b.strokeColor);!1===a.fill&&delete b.fillColor;ALKMaps.Util.extend(b,a);return b},CLASS_NAME:"ALKMaps.Renderer"});ALKMaps.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};
ALKMaps.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10],truck:[0,-2,0,-3,1,-3,1,-7,5,-8,5,-9,6,-11,12,-11,12,-3,13,-3,13,-15,32,-15,32,-3,30,-2,30,-1,29,-0.0,27,-0.0,26,-1,26,-2,25,-2,25,-1,24,0,22,0,21,-1,21,-2,7,-2,7,-1,6,-0.0,4,-0.0,
3,-1,3,-2],chevron:[6,0,12,15,6,12,0,15],vehicle:[0,2,2,0,4,2,4,10,0,10,0,2],pin:[15,59,30,23,30,21,31,20,31,11,30,10,30,9,29,8,29,7,28,6,27,5,26,4,25,3,24,2,22,1,20,0,11,0,9,1,7,2,6,3,5,4,4,5,3,6,2,7,2,8,1,9,1,10,0,11,0,20,1,21,1,23,14,59,15,59]};ALKMaps.ElementsIndexer=ALKMaps.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?ALKMaps.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:ALKMaps.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(a){this.exists(a)&&this.remove(a);var b=a.id;this.determineZIndex(a);for(var c=-1,d=this.order.length,e;1<d-c;)e=parseInt((c+d)/2),0<this.compare(this,a,ALKMaps.Util.getElement(this.order[e]))?c=e:d=e;this.order.splice(d,0,b);
this.indices[b]=this.getZIndex(a);return this.getNextElement(d)},remove:function(a){var a=a.id,b=ALKMaps.Util.indexOf(this.order,a);if(0<=b)this.order.splice(b,1),delete this.indices[a],this.maxZIndex=0<this.order.length?this.indices[this.order[this.order.length-1]]:0},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return null!=this.indices[a.id]},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex;if(null==
b)b=this.maxZIndex,a._style.graphicZIndex=b;else if(b>this.maxZIndex)this.maxZIndex=b},getNextElement:function(a){a+=1;if(a<this.order.length){var b=ALKMaps.Util.getElement(this.order[a]);void 0==b&&(b=this.getNextElement(a));return b}return null},CLASS_NAME:"ALKMaps.ElementsIndexer"});
ALKMaps.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,b,c){var b=a.getZIndex(b),d=0;c&&(a=a.getZIndex(c),d=b-a);return d},Z_ORDER_DRAWING_ORDER:function(a,b,c){a=ALKMaps.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0==a&&(a=1);return a},Z_ORDER_Y_ORDER:function(a,b,c){a=ALKMaps.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0===a&&(b=c._boundsBottom-b._boundsBottom,a=0===b?1:b);return a}};
ALKMaps.Renderer.Elements=ALKMaps.Class(ALKMaps.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(a,b){ALKMaps.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);
this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(b&&(b.zIndexing||b.yOrdering))this.indexer=new ALKMaps.ElementsIndexer(b.yOrdering)},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;ALKMaps.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var a,b=this.vectorRoot;if(b)for(;a=b.firstChild;)b.removeChild(a);if(b=this.textRoot)for(;a=b.firstChild;)b.removeChild(a);this.indexer&&
this.indexer.clear()},setExtent:function(a,b){var c=ALKMaps.Renderer.prototype.setExtent.apply(this,arguments),d=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var e,f=a.getWidth()/this.map.getExtent().getWidth(),a=a.scale(1/f),f=this.map.getMaxExtent();f.right>a.left&&f.right<a.right&&f.left>a.left&&f.left<a.right?e=!1:f.right>a.left&&f.right<a.right?e=!0:f.left>a.left&&f.left<a.right&&(e=!1);if(e!==this.rightOfDateLine||b)c=!1,this.xOffset=!0===e?f.getWidth()/d:0;this.rightOfDateLine=
e}return c},getNodeType:function(){},drawGeometry:function(a,b,c){var d=a.CLASS_NAME,e=!0;if("ALKMaps.Geometry.Collection"==d||"ALKMaps.Geometry.MultiPoint"==d||"ALKMaps.Geometry.MultiLineString"==d||"ALKMaps.Geometry.MultiPolygon"==d){for(var d=0,f=a.components.length;d<f;d++)e=this.drawGeometry(a.components[d],b,c)&&e;return e}d=e=!1;"none"!=b.display&&(b.backgroundGraphic?this.redrawBackgroundNode(a.id,a,b,c):d=!0,e=this.redrawNode(a.id,a,b,c));if(!1==e&&(b=document.getElementById(a.id)))b._style.backgroundGraphic&&
(d=!0),b.parentNode.removeChild(b);d&&(b=document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX))&&b.parentNode.removeChild(b);return e},redrawNode:function(a,b,c,d){c=this.applyDefaultSymbolizer(c);a=this.nodeFactory(a,this.getNodeType(b,c));a._featureId=d;a._boundsBottom=b.getBounds().bottom;a._geometryClass=b.CLASS_NAME;a._style=c;b=this.drawGeometryNode(a,b,c);if(!1===b)return!1;a=b.node;this.indexer?(c=this.indexer.insert(a))?this.vectorRoot.insertBefore(a,c):this.vectorRoot.appendChild(a):a.parentNode!==
this.vectorRoot&&this.vectorRoot.appendChild(a);this.postDraw(a);return b.complete},redrawBackgroundNode:function(a,b,c){c=ALKMaps.Util.extend({},c);c.externalGraphic=c.backgroundGraphic;c.graphicXOffset=c.backgroundXOffset;c.graphicYOffset=c.backgroundYOffset;c.graphicZIndex=c.backgroundGraphicZIndex;c.graphicWidth=c.backgroundWidth||c.graphicWidth;c.graphicHeight=c.backgroundHeight||c.graphicHeight;c.backgroundGraphic=null;c.backgroundXOffset=null;c.backgroundYOffset=null;c.backgroundGraphicZIndex=
null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX,b,c,null)},drawGeometryNode:function(a,b,c){var c=c||a._style,d={isFilled:void 0===c.fill?!0:c.fill,isStroked:void 0===c.stroke?!!c.strokeWidth:c.stroke},e;switch(b.CLASS_NAME){case "ALKMaps.Geometry.Point":if(!1===c.graphic)d.isFilled=!1,d.isStroked=!1;e=this.drawPoint(a,b);break;case "ALKMaps.Geometry.LineString":d.isFilled=!1;e=this.drawLineString(a,b);break;case "ALKMaps.Geometry.LinearRing":e=this.drawLinearRing(a,b);break;case "ALKMaps.Geometry.Polygon":e=
this.drawPolygon(a,b);break;case "ALKMaps.Geometry.Rectangle":e=this.drawRectangle(a,b)}a._options=d;return!1!=e?{node:this.setStyle(a,c,d,b),complete:e}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(a){var b=document.getElementById(a+this.LABEL_ID_SUFFIX);b&&this.textRoot.removeChild(b);(a=document.getElementById(a+this.LABEL_OUTLINE_SUFFIX))&&
this.textRoot.removeChild(a)},getFeatureIdFromEvent:function(a){var b=a.target,c=b&&b.correspondingUseElement;return(c?c:b||a.srcElement)._featureId},eraseGeometry:function(a,b){if("ALKMaps.Geometry.MultiPoint"==a.CLASS_NAME||"ALKMaps.Geometry.MultiLineString"==a.CLASS_NAME||"ALKMaps.Geometry.MultiPolygon"==a.CLASS_NAME||"ALKMaps.Geometry.Collection"==a.CLASS_NAME)for(var c=0,d=a.components.length;c<d;c++)this.eraseGeometry(a.components[c],b);else if((c=ALKMaps.Util.getElement(a.id))&&c.parentNode){if(c.geometry)c.geometry.destroy(),
c.geometry=null;c.parentNode.removeChild(c);this.indexer&&this.indexer.remove(c);c._style.backgroundGraphic&&(c=ALKMaps.Util.getElement(a.id+this.BACKGROUND_ID_SUFFIX))&&c.parentNode&&c.parentNode.removeChild(c)}},nodeFactory:function(a,b){var c=ALKMaps.Util.getElement(a);c?this.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=this.nodeFactory(a,b)):c=this.createNode(b,a);return c},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(a){var b=this.root;if(a.root.parentNode==
this.rendererRoot)b=a.root;b.parentNode.removeChild(b);a.rendererRoot.appendChild(b)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return"circle"!=a&&!!a},CLASS_NAME:"ALKMaps.Renderer.Elements"});ALKMaps.Renderer.NG=ALKMaps.Class(ALKMaps.Renderer.Elements,{labelNodeType:null,updateDimensions:function(){var a=this.map.getExtent(),b=a.scale(3);this.setExtent(b,!0);var c=this.getResolution(),d=this.rendererRoot.parentNode,e=parseFloat(d.parentNode.style.left),f=parseFloat(d.parentNode.style.top);d.style.left=(b.left-a.left)/c-e+"px";d.style.top=(a.top-b.top)/c-f+"px"},setSize:function(){this.map.getExtent()&&this.updateDimensions()},drawFeature:function(a,b){if(null==b)b=a.style;if(a.geometry){var c=
this.drawGeometry(a.geometry,b,a.id);if(!1!==c&&b.label){var d=a.geometry.getCentroid();this.drawText(a.id,b,d)}else this.removeText(a.id);return c}},drawText:function(a,b,c){var d;"string"!==typeof a?d=a:(d=this.nodeFactory(a+this.LABEL_ID_SUFFIX,this.labelNodeType),d._featureId=a);d._style=b;d._x=c.x;d._y=c.y;if(b.labelXOffset||b.labelYOffset){var a=isNaN(b.labelXOffset)?0:b.labelXOffset,b=isNaN(b.labelYOffset)?0:b.labelYOffset,e=this.getResolution();c.move(a*e,b*e)}d.parentNode!==this.textRoot&&
this.textRoot.appendChild(d);return d},CLASS_NAME:"ALKMaps.Renderer.NG"});ALKMaps.Renderer.SVG2=ALKMaps.Class(ALKMaps.Renderer.NG,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",symbolMetrics:null,labelNodeType:"g",initialize:function(a){if(this.supported())ALKMaps.Renderer.Elements.prototype.initialize.apply(this,arguments),this.symbolMetrics={}},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure",
"1.1"))},updateDimensions:function(a){ALKMaps.Renderer.NG.prototype.updateDimensions.apply(this,arguments);var b=this.getResolution(),c=this.extent.getWidth(),d=this.extent.getHeight();this.rendererRoot.setAttributeNS(null,"viewBox",[this.extent.left,-this.extent.top,c,d].join(" "));this.rendererRoot.setAttributeNS(null,"width",c/b);this.rendererRoot.setAttributeNS(null,"height",d/b);if(!0===a){d=this.vectorRoot.childNodes;for(b=0,c=d.length;b<c;++b)this.setStyle(d[b]);var d=this.textRoot.childNodes,
e;for(b=0,c=d.length;b<c;++b)e=d[b],this.drawText(e,e._style,new ALKMaps.Geometry.Point(e._x,e._y))}},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "ALKMaps.Geometry.Point":c=b.externalGraphic?"image":this.isComplexSymbol(b.graphicName)?"svg":"circle";break;case "ALKMaps.Geometry.Rectangle":c="rect";break;case "ALKMaps.Geometry.LineString":c="polyline";break;case "ALKMaps.Geometry.LinearRing":c="polygon";break;case "ALKMaps.Geometry.Polygon":case "ALKMaps.Geometry.Curve":case "ALKMaps.Geometry.Surface":c=
"path"}return c},setStyle:function(a,b,c){var b=b||a._style,c=c||a._options,d=this.getResolution(),e=a._radius,f=d;if("ALKMaps.Geometry.Point"==a._geometryClass&&e){a.style.visibility="";if(!1===b.graphic)a.style.visibility="hidden";else if(b.externalGraphic){if(b.graphicTitle)a.setAttributeNS(null,"title",b.graphicTitle),e=this.nodeFactory(null,"title"),e.textContent=b.graphicTitle,a.appendChild(e);b.graphicWidth&&b.graphicHeight&&a.setAttributeNS(null,"preserveAspectRatio","none");var e=b.graphicWidth||
b.graphicHeight,g=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,g=g?g:2*b.pointRadius,e=e*d,g=g*d,h=void 0!=b.graphicYOffset?b.graphicYOffset*d:-(0.5*g),i=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",a._x+(void 0!=b.graphicXOffset?b.graphicXOffset*d:-(0.5*e)));a.setAttributeNS(null,"y",a._y+h);a.setAttributeNS(null,"width",e);a.setAttributeNS(null,"height",g);a.setAttributeNS(this.xlinkns,"href",b.externalGraphic);a.setAttributeNS(null,"style","opacity: "+i);a.onclick=ALKMaps.Renderer.SVG2.preventDefault}else if(this.isComplexSymbol(b.graphicName)){var e=
3*b.pointRadius*d,g=2*e,j=this.importSymbol(b.graphicName),f=3*this.symbolMetrics[j.id].size/g*d,d=a.parentNode,h=a.nextSibling;d&&d.removeChild(a);a.firstChild&&a.removeChild(a.firstChild);a.appendChild(j.firstChild.cloneNode(!0));a.setAttributeNS(null,"viewBox",j.getAttributeNS(null,"viewBox"));a.setAttributeNS(null,"width",g);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"x",a._x-e);a.setAttributeNS(null,"y",a._y-e);h?d.insertBefore(a,h):d&&d.appendChild(a)}else a.setAttributeNS(null,
"r",b.pointRadius*d);d=b.rotation;if(void 0!==d||void 0!==a._rotation)a._rotation=d,d|=0,"svg"!==a.nodeName?a.setAttributeNS(null,"transform",["rotate(",d,a._x,a._y,")"].join(" ")):(j=this.symbolMetrics[j.id],a.firstChild.setAttributeNS(null,"transform",["rotate(",d,j.x,j.y,")"].join(" ")))}c.isFilled?(a.setAttributeNS(null,"fill",b.fillColor),a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none");c.isStroked?(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,
"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*f),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap||"round"),a.setAttributeNS(null,"stroke-linejoin","round"),b.strokeDashstyle&&a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,f))):a.setAttributeNS(null,"stroke","none");b.pointerEvents&&a.setAttributeNS(null,"pointer-events",b.pointerEvents);null!=b.cursor&&a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*
b,d=a.strokeDashstyle;switch(d){case "solid":return"none";case "dot":return[b,4*c].join();case "dash":return[4*c,4*c].join();case "dashdot":return[4*c,4*c,b,4*c].join();case "longdash":return[8*c,4*c].join();case "longdashdot":return[8*c,4*c,b,4*c].join();default:for(var c=ALKMaps.String.trim(d).split(/\s+/g),d=0,e=c.length;d<e;d++)c[d]*=b;return c.join()}},createNode:function(a,b){var c=document.createElementNS(this.xmlns,a);b&&c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==
a.nodeName},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){var d=b.x,b=-b.y;a.setAttributeNS(null,"cx",d);a.setAttributeNS(null,"cy",b);a._x=d;a._y=b;a._radius=c;return a},drawLineString:function(a,
b){var c=this.getComponentsString(b.components);a.setAttributeNS(null,"points",c);return a},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);a.setAttributeNS(null,"points",c);return a},drawPolygon:function(a,b){for(var c=[],d,e=0,f=b.components.length;e<f;e++)c.push("M"),d=this.getComponentsString(b.components[e].components," "),c.push(d);c.push("z");a.setAttributeNS(null,"d",c.join(" "));a.setAttributeNS(null,"fill-rule","evenodd");return a},drawRectangle:function(a,b){a.setAttributeNS(null,
"x",b.x);a.setAttributeNS(null,"y",-b.y);a.setAttributeNS(null,"width",b.width);a.setAttributeNS(null,"height",b.height);return a},drawSurface:function(a,b){for(var c=[],d=0,e=b.components.length;d<e;d++)if(0==d%3&&0==d/3){var f=this.getShortString(b.components[d]);c.push("M",f)}else 1==d%3?(f=this.getShortString(b.components[d]),c.push("C",f)):(f=this.getShortString(b.components[d]),c.push(f));c.push("Z");a.setAttributeNS(null,"d",c.join(" "));return a},drawText:function(a,b,c){var d=ALKMaps.Renderer.NG.prototype.drawText.apply(this,
arguments),e=d.firstChild||this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_text","text"),f=this.getResolution();e.setAttributeNS(null,"x",c.x/f);e.setAttributeNS(null,"y",-c.y/f);d.setAttributeNS(null,"transform","scale("+f+")");b.fontColor&&e.setAttributeNS(null,"fill",b.fontColor);b.fontOpacity&&e.setAttributeNS(null,"opacity",b.fontOpacity);b.fontFamily&&e.setAttributeNS(null,"font-family",b.fontFamily);b.fontSize&&e.setAttributeNS(null,"font-size",b.fontSize);b.fontWeight&&e.setAttributeNS(null,"font-weight",
b.fontWeight);b.fontStyle&&e.setAttributeNS(null,"font-style",b.fontStyle);!0===b.labelSelect?(e.setAttributeNS(null,"pointer-events","visible"),e._featureId=a):e.setAttributeNS(null,"pointer-events","none");var g=b.labelAlign||"cm";e.setAttributeNS(null,"text-anchor",ALKMaps.Renderer.SVG2.LABEL_ALIGN[g[0]]||"middle");!0===ALKMaps.IS_GECKO&&e.setAttributeNS(null,"dominant-baseline",ALKMaps.Renderer.SVG2.LABEL_ALIGN[g[1]]||"central");for(var h=b.label.split("\n"),i=h.length;e.childNodes.length>i;)e.removeChild(e.lastChild);
for(var j=0;j<i;j++){var k=e.childNodes[j]||this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_tspan_"+j,"tspan");if(!0===b.labelSelect)k._featureId=a;!1===ALKMaps.IS_GECKO&&k.setAttributeNS(null,"baseline-shift",ALKMaps.Renderer.SVG2.LABEL_VSHIFT[g[1]]||"-35%");k.setAttribute("x",c.x/f);if(0==j){var m=ALKMaps.Renderer.SVG2.LABEL_VFACTOR[g[1]];null==m&&(m=-0.5);k.setAttribute("dy",m*(i-1)+"em")}else k.setAttribute("dy","1em");k.textContent=""===h[j]?" ":h[j];k.parentNode||e.appendChild(k)}e.parentNode||d.appendChild(e);
return d},getComponentsString:function(a,b){for(var c=a.length,d=Array(c),e=0;e<c;e++)d[e]=this.getShortString(a[e]);return d.join(b||",")},getShortString:function(a){return a.x+","+-a.y},importSymbol:function(a){if(!this.defs)this.defs=this.createDefs();var b=this.container.id+"-"+a,c=document.getElementById(b);if(null!=c)return c;var d=ALKMaps.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");var a=this.nodeFactory(b,"symbol"),e=this.nodeFactory(null,"polygon");a.appendChild(e);
for(var c=new ALKMaps.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),f=[],g,h,i=0,j=d.length;i<j;i+=2)g=d[i],h=d[i+1],c.left=Math.min(c.left,g),c.bottom=Math.min(c.bottom,h),c.right=Math.max(c.right,g),c.top=Math.max(c.top,h),f.push(g,",",h);e.setAttributeNS(null,"points",f.join(" "));d=c.getWidth();e=c.getHeight();a.setAttributeNS(null,"viewBox",[c.left-d,c.bottom-e,3*d,3*e].join(" "));this.symbolMetrics[b]={size:Math.max(d,e),x:c.getCenterLonLat().lon,y:c.getCenterLonLat().lat};this.defs.appendChild(a);
return a},getFeatureIdFromEvent:function(a){var b=ALKMaps.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!b)b=a.target,b=b.parentNode&&b!=this.rendererRoot&&b.parentNode._featureId;return b},CLASS_NAME:"ALKMaps.Renderer.SVG2"});ALKMaps.Renderer.SVG2.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};ALKMaps.Renderer.SVG2.LABEL_VSHIFT={t:"-70%",b:"0"};ALKMaps.Renderer.SVG2.LABEL_VFACTOR={t:0,b:-1};ALKMaps.Renderer.SVG2.preventDefault=function(a){a.preventDefault&&a.preventDefault()};ALKMaps.String={startsWith:function(a,b){return 0==a.indexOf(b)},contains:function(a,b){return-1!=a.indexOf(b)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){for(var a=a.split("-"),b=a[0],c=1,d=a.length;c<d;c++)var e=a[c],b=b+(e.charAt(0).toUpperCase()+e.substring(1));return b},format:function(a,b,c){b||(b=window);return a.replace(ALKMaps.String.tokenRegEx,function(a,e){for(var f,g=e.split(/\.+/),h=0;h<g.length;h++)0==h&&(f=b),f=f[g[h]];"function"==typeof f&&
(f=c?f.apply(null,c):f());return"undefined"==typeof f?"undefined":f})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return ALKMaps.String.numberRegEx.test(a)},numericIf:function(a){return ALKMaps.String.isNumeric(a)?parseFloat(a):a}};
ALKMaps.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;0<b&&(c=parseFloat(a.toPrecision(b)));return c},format:function(a,b,c,d){b="undefined"!=typeof b?b:0;c="undefined"!=typeof c?c:ALKMaps.Number.thousandsSeparator;d="undefined"!=typeof d?d:ALKMaps.Number.decimalSeparator;null!=b&&(a=parseFloat(a.toFixed(b)));var e=a.toString().split(".");1==e.length&&null==b&&(b=0);a=e[0];if(c)for(var f=/(-?[0-9]+)([0-9]{3})/;f.test(a);)a=a.replace(f,"$1"+c+"$2");0==b?b=a:
(c=1<e.length?e[1]:"0",null!=b&&(c+=Array(b-c.length+1).join("0")),b=a+d+c);return b}};ALKMaps.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var d=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,d)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};
ALKMaps.Array={filter:function(a,b,c){var d=[];if(Array.prototype.filter)d=a.filter(b,c);else{var e=a.length;if("function"!=typeof b)throw new TypeError;for(var f=0;f<e;f++)if(f in a){var g=a[f];b.call(c,g,f,a)&&d.push(g)}}return d}};ALKMaps.Bounds=ALKMaps.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,d){ALKMaps.Util.isArray(a)&&(d=a[3],c=a[2],b=a[1],a=a[0]);if(null!=a)this.left=ALKMaps.Util.toFloat(a);if(null!=b)this.bottom=ALKMaps.Util.toFloat(b);if(null!=c)this.right=ALKMaps.Util.toFloat(c);if(null!=d)this.top=ALKMaps.Util.toFloat(d)},clone:function(){return new ALKMaps.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;null!=a&&(b=this.left==a.left&&
this.right==a.right&&this.top==a.top&&this.bottom==a.bottom);return b},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(a){return!0===a?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){null==a&&(a=6);var c=Math.pow(10,a),d=Math.round(this.left*c)/c,e=Math.round(this.bottom*c)/c,f=Math.round(this.right*c)/c,c=Math.round(this.top*c)/c;return!0===b?e+","+d+","+c+","+f:d+","+e+","+f+","+c},toGeometry:function(){return new ALKMaps.Geometry.Polygon([new ALKMaps.Geometry.LinearRing([new ALKMaps.Geometry.Point(this.left,
this.bottom),new ALKMaps.Geometry.Point(this.right,this.bottom),new ALKMaps.Geometry.Point(this.right,this.top),new ALKMaps.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new ALKMaps.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new ALKMaps.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat)this.centerLonLat=
new ALKMaps.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2);return this.centerLonLat},scale:function(a,b){null==b&&(b=this.getCenterLonLat());var c,d;"ALKMaps.LonLat"==b.CLASS_NAME?(c=b.lon,d=b.lat):(c=b.x,d=b.y);return new ALKMaps.Bounds((this.left-c)*a+c,(this.bottom-d)*a+d,(this.right-c)*a+c,(this.top-d)*a+d)},add:function(a,b){if(null==a||null==b)throw new TypeError("Bounds.add cannot receive null values");return new ALKMaps.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},
extend:function(a){var b=null;if(a){switch(a.CLASS_NAME){case "ALKMaps.LonLat":b=new ALKMaps.Bounds(a.lon,a.lat,a.lon,a.lat);break;case "ALKMaps.Geometry.Point":b=new ALKMaps.Bounds(a.x,a.y,a.x,a.y);break;case "ALKMaps.Bounds":b=a}if(b){this.centerLonLat=null;if(null==this.left||b.left<this.left)this.left=b.left;if(null==this.bottom||b.bottom<this.bottom)this.bottom=b.bottom;if(null==this.right||b.right>this.right)this.right=b.right;if(null==this.top||b.top>this.top)this.top=b.top}}},containsLonLat:function(a,
b){"boolean"===typeof b&&(b={inclusive:b});var b=b||{},c=this.contains(a.lon,a.lat,b.inclusive),d=b.worldBounds;d&&!c&&(c=d.getWidth(),d=Math.round((a.lon-(d.left+d.right)/2)/c),c=this.containsLonLat({lon:a.lon-d*c,lat:a.lat},{inclusive:b.inclusive}));return c},containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){null==c&&(c=!0);if(null==a||null==b)return!1;var a=ALKMaps.Util.toFloat(a),b=ALKMaps.Util.toFloat(b),d=!1;return d=c?a>=this.left&&a<=this.right&&b>=this.bottom&&
b<=this.top:a>this.left&&a<this.right&&b>this.bottom&&b<this.top},intersectsBounds:function(a,b){"boolean"===typeof b&&(b={inclusive:b});b=b||{};if(b.worldBounds)var c=this.wrapDateLine(b.worldBounds),a=a.wrapDateLine(b.worldBounds);else c=this;if(null==b.inclusive)b.inclusive=!0;var d=!1,e=c.left==a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;if(b.inclusive||!e)var d=a.top>=c.bottom&&a.top<=c.top||c.top>a.bottom&&c.top<a.top,e=a.left>=c.left&&a.left<=c.right||c.left>=a.left&&c.left<=
a.right,f=a.right>=c.left&&a.right<=c.right||c.right>=a.left&&c.right<=a.right,d=(a.bottom>=c.bottom&&a.bottom<=c.top||c.bottom>=a.bottom&&c.bottom<=a.top||d)&&(e||f);if(b.worldBounds&&!d){var g=b.worldBounds,e=g.getWidth(),f=!g.containsBounds(c),g=!g.containsBounds(a);f&&!g?(a=a.add(-e,0),d=c.intersectsBounds(a,{inclusive:b.inclusive})):g&&!f&&(c=c.add(-e,0),d=a.intersectsBounds(c,{inclusive:b.inclusive}))}return d},containsBounds:function(a,b,c){null==b&&(b=!1);null==c&&(c=!0);var d=this.contains(a.left,
a.bottom,c),e=this.contains(a.right,a.bottom,c),f=this.contains(a.left,a.top,c),a=this.contains(a.right,a.top,c);return b?d||e||f||a:d&&e&&f&&a},determineQuadrant:function(a){var b="",c=this.getCenterLonLat(),b=b+(a.lat<c.lat?"b":"t");return b+=a.lon<c.lon?"l":"r"},transform:function(a,b){this.centerLonLat=null;var c=ALKMaps.Projection.transform({x:this.left,y:this.bottom},a,b),d=ALKMaps.Projection.transform({x:this.right,y:this.bottom},a,b),e=ALKMaps.Projection.transform({x:this.left,y:this.top},
a,b),f=ALKMaps.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,e.x);this.bottom=Math.min(c.y,d.y);this.right=Math.max(d.x,f.x);this.top=Math.max(e.y,f.y);return this},wrapDateLine:function(a,b){var b=b||{},c=b.leftTolerance||0,d=b.rightTolerance||0,e=this.clone();if(a){for(var f=a.getWidth();e.left<a.left&&e.right-d<=a.left;)e=e.add(f,0);for(;e.left+c>=a.right&&e.right>a.right;)e=e.add(-f,0);c=e.left+c;c<a.right&&c>a.left&&e.right-d>a.right&&(e=e.add(-f,0))}return e},CLASS_NAME:"ALKMaps.Bounds"});
ALKMaps.Bounds.fromString=function(a,b){var c=a.split(",");return ALKMaps.Bounds.fromArray(c,b)};ALKMaps.Bounds.fromArray=function(a,b){return!0===b?new ALKMaps.Bounds(a[1],a[0],a[3],a[2]):new ALKMaps.Bounds(a[0],a[1],a[2],a[3])};ALKMaps.Bounds.fromSize=function(a){return new ALKMaps.Bounds(0,a.h,a.w,0)};ALKMaps.Bounds.oppositeQuadrant=function(a){var b;b=""+("t"==a.charAt(0)?"b":"t");return b+="l"==a.charAt(1)?"r":"l"};ALKMaps.Element={visible:function(a){return"none"!=ALKMaps.Util.getElement(a).style.display},toggle:function(){for(var a=0,b=arguments.length;a<b;a++){var c=ALKMaps.Util.getElement(arguments[a]),d=ALKMaps.Element.visible(c)?"none":"";c.style.display=d}},remove:function(a){a=ALKMaps.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=ALKMaps.Util.getElement(a);return a.offsetHeight},hasClass:function(a,b){var c=a.className;return!!c&&RegExp("(^|\\s)"+b+"(\\s|$)").test(c)},addClass:function(a,
b){ALKMaps.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;if(c)a.className=ALKMaps.String.trim(c.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," "));return a},toggleClass:function(a,b){ALKMaps.Element.hasClass(a,b)?ALKMaps.Element.removeClass(a,b):ALKMaps.Element.addClass(a,b);return a},getStyle:function(a,b){var a=ALKMaps.Util.getElement(a),c=null;if(a&&a.style){c=a.style[ALKMaps.String.camelize(b)];c||(document.defaultView&&document.defaultView.getComputedStyle?
c=(c=document.defaultView.getComputedStyle(a,null))?c.getPropertyValue(b):null:a.currentStyle&&(c=a.currentStyle[ALKMaps.String.camelize(b)]));var d=["left","top","right","bottom"];window.opera&&-1!=ALKMaps.Util.indexOf(d,b)&&"static"==ALKMaps.Element.getStyle(a,"position")&&(c="auto")}return"auto"==c?null:c}};ALKMaps.Pixel=ALKMaps.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new ALKMaps.Pixel(this.x,this.y)},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,b){if(null==a||null==b)throw new TypeError("Pixel.add cannot receive null values");
return new ALKMaps.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();a&&(b=this.add(a.x,a.y));return b},CLASS_NAME:"ALKMaps.Pixel"});ALKMaps.Size=ALKMaps.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new ALKMaps.Size(this.w,this.h)},equals:function(a){var b=!1;null!=a&&(b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h));return b},CLASS_NAME:"ALKMaps.Size"});ALKMaps.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"ALKMaps.Console"};
(function(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b<c;++b)if(-1!=a[b].src.indexOf("firebug.js")&&console){ALKMaps.Util.extend(ALKMaps.Console,console);break}})();ALKMaps.Lang={code:null,defaultCode:"en",getCode:function(){ALKMaps.Lang.code||ALKMaps.Lang.setCode();return ALKMaps.Lang.code},setCode:function(a){var b;a||(a=null!=navigator.languages&&"string"===typeof navigator.languages[0]?navigator.languages[0]:navigator.language||navigator.userLanguage||"en-US");a=a.split("-");a[0]=a[0].toLowerCase();"object"==typeof ALKMaps.Lang[a[0]]&&(b=a[0]);if(a[1]){var c=a[0]+"-"+a[1].toUpperCase();"object"==typeof ALKMaps.Lang[c]&&(b=c)}if(!b)ALKMaps.Console.warn("Failed to find ALKMaps.Lang."+
a.join("-")+" dictionary, falling back to default language"),b=ALKMaps.Lang.defaultCode;ALKMaps.Lang.code=b},translate:function(a,b){var c=ALKMaps.Lang[ALKMaps.Lang.getCode()];(c=c&&c[a])||(c=a);b&&(c=ALKMaps.String.format(c,b));return c}};ALKMaps.i18n=ALKMaps.Lang.translate;ALKMaps.Util=ALKMaps.Util||{};
(function(){ALKMaps.Util.getElement=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];"string"==typeof d&&(d=document.getElementById(d));if(1==arguments.length)return d;a.push(d)}return a};ALKMaps.Util.isElement=function(a){return!!(a&&1===a.nodeType)};ALKMaps.Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};ALKMaps.Util.removeDuplicates=function(a){a.sort();for(var b=a.length-1;b--;)a[b]==a[b+1]&&a.splice(b+1,1)};if(void 0===window.$)window.$=
ALKMaps.Util.getElement;ALKMaps.Util.removeItem=function(a,b){for(var c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1);return a};ALKMaps.Util.indexOf=function(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1};ALKMaps.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){if(b)a.id=b;if(c)a.style.left=c.x+"px",a.style.top=c.y+"px";if(d)a.style.width=d.w+"px",a.style.height=d.h+"px";if(e)a.style.position=e;if(f)a.style.border=f;if(g)a.style.overflow=
g;if(0<=parseFloat(h)&&1>parseFloat(h))a.style.filter="alpha(opacity="+100*h+")",a.style.opacity=h;else if(1==parseFloat(h))a.style.filter="",a.style.opacity=""};ALKMaps.Util.createDiv=function(a,b,c,d,e,f,g,h){var i=document.createElement("div");if(d)i.style.backgroundImage="url("+d+")";a||(a=ALKMaps.Util.createUniqueID("ALKMapsDiv"));e||(e="absolute");ALKMaps.Util.modifyDOMElement(i,a,b,c,e,f,g,h);return i};ALKMaps.Util.createImage=function(a,b,c,d,e,f,g,h){var i=document.createElement("img");a||
(a=ALKMaps.Util.createUniqueID("ALKMapsDiv"));e||(e="relative");ALKMaps.Util.modifyDOMElement(i,a,b,c,e,f,null,g);if(h)i.style.display="none",b=function(){i.style.display="";ALKMaps.Event.stopObservingElement(i)},ALKMaps.Event.observe(i,"load",b),ALKMaps.Event.observe(i,"error",b);i.style.alt=a;i.galleryImg="no";if(d)i.src=d;return i};ALKMaps.IMAGE_RELOAD_ATTEMPTS=0;ALKMaps.Util.makeInitOnceGetter=function(a,b,c){a[b]=function(){var d=c();a[b]=function(){return d};return d}};ALKMaps.Util.makeInitOnceGetter(ALKMaps.Util,
"alphaHack",function(){var a=navigator.appVersion.split("MSIE"),a=parseFloat(a[1]),b=!1;try{b=!!document.body.filters}catch(c){}return b&&5.5<=a&&7>a});ALKMaps.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){ALKMaps.Util.modifyDOMElement(a,b,c,d,f,null,null,i);b=a.childNodes[0];if(e)b.src=e;ALKMaps.Util.modifyDOMElement(b,a.id+"_innerImage",null,d,"relative",g);if(ALKMaps.Util.alphaHack()){if("none"!=a.style.display)a.style.display="inline-block";null==h&&(h="scale");a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
b.src+"', sizingMethod='"+h+"')";0<=parseFloat(a.style.opacity)&&1>parseFloat(a.style.opacity)&&(a.style.filter+=" alpha(opacity="+100*a.style.opacity+")");b.style.filter="alpha(opacity=0)"}};ALKMaps.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){var j=ALKMaps.Util.createDiv(),i=ALKMaps.Util.createImage(null,null,null,null,null,null,null,i);i.className="olAlphaImg";j.appendChild(i);ALKMaps.Util.modifyAlphaImageDiv(j,a,b,c,d,e,f,g,h);return j};ALKMaps.Util.upperCaseObject=function(a){var b={},
c;for(c in a)b[c.toUpperCase()]=a[c];return b};ALKMaps.Util.applyDefaults=function(a,b){var a=a||{},c="function"==typeof window.Event&&b instanceof window.Event,d;for(d in b)if(void 0===a[d]||!c&&b.hasOwnProperty&&b.hasOwnProperty(d)&&!a.hasOwnProperty(d))a[d]=b[d];if(!c&&b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString"))a.toString=b.toString;return a};ALKMaps.Util.getParameterString=function(a){var b=[],c;for(c in a){var d=a[c];if(null!=d&&"function"!=typeof d){if("object"==
typeof d&&d.constructor==Array){for(var e=[],f,g=0,h=d.length;g<h;g++)f=d[g],e.push(encodeURIComponent(null===f||void 0===f?"":f));d=e.join(",")}else d=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+d)}}return b.join("&")};ALKMaps.Util.urlAppend=function(a,b){var c=a;if(b)var d=(a+" ").split(/[?&]/),c=c+(" "===d.pop()?b:d.length?"&"+b:"?"+b);return c};ALKMaps.Util.makeInitOnceGetter(ALKMaps.Util,"getImagesLocation",function(){return ALKMaps._getScriptLocation()+"img/"});ALKMaps.Util.getImageLocation=
function(a){return ALKMaps.Util.getImagesLocation()+a};ALKMaps.Util.Try=function(){for(var a=null,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a};ALKMaps.Util.getXmlNodeValue=function(a){var b=null;ALKMaps.Util.Try(function(){b=a.text;if(!b)b=a.textContent;if(!b)b=a.firstChild.nodeValue},function(){b=a.textContent});return b};ALKMaps.Util.mouseLeft=function(a,b){for(var c=a.relatedTarget||a.toElement;c!=b&&null!=c;)c=c.parentNode;return c!=b};ALKMaps.Util.DEFAULT_PRECISION=
14;ALKMaps.Util.toFloat=function(a,b){if(null==b)b=ALKMaps.Util.DEFAULT_PRECISION;"number"!==typeof a&&(a=parseFloat(a));return 0===b?a:parseFloat(a.toPrecision(b))};ALKMaps.Util.rad=function(a){return a*Math.PI/180};ALKMaps.Util.deg=function(a){return 180*a/Math.PI};ALKMaps.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};ALKMaps.Util.distVincenty=function(a,b){for(var c=ALKMaps.Util.VincentyConstants,d=c.a,e=c.b,c=c.f,f=ALKMaps.Util.rad(b.lon-a.lon),g=Math.atan((1-c)*Math.tan(ALKMaps.Util.rad(a.lat))),
h=Math.atan((1-c)*Math.tan(ALKMaps.Util.rad(b.lat))),i=Math.sin(g),g=Math.cos(g),j=Math.sin(h),h=Math.cos(h),k=f,m=2*Math.PI,l=20;1.0E-12<Math.abs(k-m)&&0<--l;){var p=Math.sin(k),n=Math.cos(k),q=Math.sqrt(h*p*h*p+(g*j-i*h*n)*(g*j-i*h*n));if(0==q)return 0;var n=i*j+g*h*n,o=Math.atan2(q,n),r=Math.asin(g*h*p/q),t=Math.cos(r)*Math.cos(r),p=n-2*i*j/t,s=c/16*t*(4+c*(4-3*t)),m=k,k=f+(1-s)*c*Math.sin(r)*(o+s*q*(p+s*n*(-1+2*p*p)))}if(0==l)return NaN;d=t*(d*d-e*e)/(e*e);c=d/1024*(256+d*(-128+d*(74-47*d)));
return(e*(1+d/16384*(4096+d*(-768+d*(320-175*d))))*(o-c*q*(p+c/4*(n*(-1+2*p*p)-c/6*p*(-3+4*q*q)*(-3+4*p*p))))).toFixed(3)/1E3};ALKMaps.Util.destinationVincenty=function(a,b,c){for(var d=ALKMaps.Util,e=d.VincentyConstants,f=e.a,g=e.b,h=e.f,e=a.lon,a=a.lat,i=d.rad(b),b=Math.sin(i),i=Math.cos(i),a=(1-h)*Math.tan(d.rad(a)),j=1/Math.sqrt(1+a*a),k=a*j,m=Math.atan2(a,i),a=j*b,l=1-a*a,f=l*(f*f-g*g)/(g*g),p=1+f/16384*(4096+f*(-768+f*(320-175*f))),n=f/1024*(256+f*(-128+f*(74-47*f))),f=c/(g*p),q=2*Math.PI;1.0E-12<
Math.abs(f-q);)var o=Math.cos(2*m+f),r=Math.sin(f),t=Math.cos(f),s=n*r*(o+n/4*(t*(-1+2*o*o)-n/6*o*(-3+4*r*r)*(-3+4*o*o))),q=f,f=c/(g*p)+s;c=k*r-j*t*i;g=Math.atan2(k*t+j*r*i,(1-h)*Math.sqrt(a*a+c*c));b=Math.atan2(r*b,j*t-k*r*i);i=h/16*l*(4+h*(4-3*l));o=b-(1-i)*h*a*(f+i*r*(o+i*t*(-1+2*o*o)));Math.atan2(a,-c);return new ALKMaps.LonLat(e+d.deg(o),d.deg(g))};ALKMaps.Util.getParameters=function(a){var a=null===a||void 0===a?window.location.href:a,b="";if(ALKMaps.String.contains(a,"?"))var b=a.indexOf("?")+
1,c=ALKMaps.String.contains(a,"#")?a.indexOf("#"):a.length,b=a.substring(b,c);for(var a={},b=b.split(/[&;]/),c=0,d=b.length;c<d;++c){var e=b[c].split("=");if(e[0]){var f=e[0];try{f=decodeURIComponent(f)}catch(g){f=unescape(f)}e=(e[1]||"").replace(/\+/g," ");try{e=decodeURIComponent(e)}catch(h){e=unescape(e)}e=e.split(",");1==e.length&&(e=e[0]);a[f]=e}}return a};ALKMaps.Util.createUniqueID=function(){var a=0;return function(b){null===b&&(b="id_");a+=1;return b+a}}();ALKMaps.INCHES_PER_UNIT={inches:1,
ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};ALKMaps.INCHES_PER_UNIT["in"]=ALKMaps.INCHES_PER_UNIT.inches;ALKMaps.INCHES_PER_UNIT.degrees=ALKMaps.INCHES_PER_UNIT.dd;ALKMaps.INCHES_PER_UNIT.nmi=1852*ALKMaps.INCHES_PER_UNIT.m;ALKMaps.METERS_PER_INCH=0.0254000508001016;ALKMaps.Util.extend(ALKMaps.INCHES_PER_UNIT,{Inch:ALKMaps.INCHES_PER_UNIT.inches,Meter:1/ALKMaps.METERS_PER_INCH,Foot:0.3048006096012192/ALKMaps.METERS_PER_INCH,IFoot:0.3048/ALKMaps.METERS_PER_INCH,ClarkeFoot:0.3047972651151/
ALKMaps.METERS_PER_INCH,SearsFoot:0.30479947153867626/ALKMaps.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/ALKMaps.METERS_PER_INCH,IInch:0.0254/ALKMaps.METERS_PER_INCH,MicroInch:2.54E-5/ALKMaps.METERS_PER_INCH,Mil:2.54E-8/ALKMaps.METERS_PER_INCH,Centimeter:0.01/ALKMaps.METERS_PER_INCH,Kilometer:1E3/ALKMaps.METERS_PER_INCH,Yard:0.9144018288036576/ALKMaps.METERS_PER_INCH,SearsYard:0.914398414616029/ALKMaps.METERS_PER_INCH,IndianYard:0.9143985307444408/ALKMaps.METERS_PER_INCH,IndianYd37:0.91439523/
ALKMaps.METERS_PER_INCH,IndianYd62:0.9143988/ALKMaps.METERS_PER_INCH,IndianYd75:0.9143985/ALKMaps.METERS_PER_INCH,IndianFoot:0.30479951/ALKMaps.METERS_PER_INCH,IndianFt37:0.30479841/ALKMaps.METERS_PER_INCH,IndianFt62:0.3047996/ALKMaps.METERS_PER_INCH,IndianFt75:0.3047995/ALKMaps.METERS_PER_INCH,Mile:1609.3472186944373/ALKMaps.METERS_PER_INCH,IYard:0.9144/ALKMaps.METERS_PER_INCH,IMile:1609.344/ALKMaps.METERS_PER_INCH,NautM:1852/ALKMaps.METERS_PER_INCH,"Lat-66":110943.31648893273/ALKMaps.METERS_PER_INCH,
"Lat-83":110946.25736872235/ALKMaps.METERS_PER_INCH,Decimeter:0.1/ALKMaps.METERS_PER_INCH,Millimeter:0.001/ALKMaps.METERS_PER_INCH,Dekameter:10/ALKMaps.METERS_PER_INCH,Decameter:10/ALKMaps.METERS_PER_INCH,Hectometer:100/ALKMaps.METERS_PER_INCH,GermanMeter:1.0000135965/ALKMaps.METERS_PER_INCH,CaGrid:0.999738/ALKMaps.METERS_PER_INCH,ClarkeChain:20.1166194976/ALKMaps.METERS_PER_INCH,GunterChain:20.11684023368047/ALKMaps.METERS_PER_INCH,BenoitChain:20.116782494375872/ALKMaps.METERS_PER_INCH,SearsChain:20.11676512155/
ALKMaps.METERS_PER_INCH,ClarkeLink:0.201166194976/ALKMaps.METERS_PER_INCH,GunterLink:0.2011684023368047/ALKMaps.METERS_PER_INCH,BenoitLink:0.20116782494375873/ALKMaps.METERS_PER_INCH,SearsLink:0.2011676512155/ALKMaps.METERS_PER_INCH,Rod:5.02921005842012/ALKMaps.METERS_PER_INCH,IntnlChain:20.1168/ALKMaps.METERS_PER_INCH,IntnlLink:0.201168/ALKMaps.METERS_PER_INCH,Perch:5.02921005842012/ALKMaps.METERS_PER_INCH,Pole:5.02921005842012/ALKMaps.METERS_PER_INCH,Furlong:201.1684023368046/ALKMaps.METERS_PER_INCH,
Rood:3.778266898/ALKMaps.METERS_PER_INCH,CapeFoot:0.3047972615/ALKMaps.METERS_PER_INCH,Brealey:375/ALKMaps.METERS_PER_INCH,ModAmFt:0.304812252984506/ALKMaps.METERS_PER_INCH,Fathom:1.8288/ALKMaps.METERS_PER_INCH,"NautM-UK":1853.184/ALKMaps.METERS_PER_INCH,"50kilometers":5E4/ALKMaps.METERS_PER_INCH,"150kilometers":15E4/ALKMaps.METERS_PER_INCH});ALKMaps.Util.extend(ALKMaps.INCHES_PER_UNIT,{mm:ALKMaps.INCHES_PER_UNIT.Meter/1E3,cm:ALKMaps.INCHES_PER_UNIT.Meter/100,dm:100*ALKMaps.INCHES_PER_UNIT.Meter,
km:1E3*ALKMaps.INCHES_PER_UNIT.Meter,kmi:ALKMaps.INCHES_PER_UNIT.nmi,fath:ALKMaps.INCHES_PER_UNIT.Fathom,ch:ALKMaps.INCHES_PER_UNIT.IntnlChain,link:ALKMaps.INCHES_PER_UNIT.IntnlLink,"us-in":ALKMaps.INCHES_PER_UNIT.inches,"us-ft":ALKMaps.INCHES_PER_UNIT.Foot,"us-yd":ALKMaps.INCHES_PER_UNIT.Yard,"us-ch":ALKMaps.INCHES_PER_UNIT.GunterChain,"us-mi":ALKMaps.INCHES_PER_UNIT.Mile,"ind-yd":ALKMaps.INCHES_PER_UNIT.IndianYd37,"ind-ft":ALKMaps.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/ALKMaps.METERS_PER_INCH});
ALKMaps.DOTS_PER_INCH=72;ALKMaps.Util.normalizeScale=function(a){return 1<a?1/a:a};ALKMaps.Util.getResolutionFromScale=function(a,b){var c;a&&(null==b&&(b="degrees"),c=1/(ALKMaps.Util.normalizeScale(a)*ALKMaps.INCHES_PER_UNIT[b]*ALKMaps.DOTS_PER_INCH));return c};ALKMaps.Util.getScaleFromResolution=function(a,b){null==b&&(b="degrees");return a*ALKMaps.INCHES_PER_UNIT[b]*ALKMaps.DOTS_PER_INCH};ALKMaps.Util.pagePosition=function(a){var b=[0,0],c=ALKMaps.Util.getViewportElement();if(!a||a==window||a==
c)return b;var d=ALKMaps.IS_GECKO&&document.getBoxObjectFor&&"absolute"==ALKMaps.Element.getStyle(a,"position")&&(""==a.style.top||""==a.style.left),e=null;if(a.getBoundingClientRect)a=a.getBoundingClientRect(),e=c.scrollTop,b[0]=a.left+c.scrollLeft,b[1]=a.top+e;else if(document.getBoxObjectFor&&!d)a=document.getBoxObjectFor(a),c=document.getBoxObjectFor(c),b[0]=a.screenX-c.screenX,b[1]=a.screenY-c.screenY;else{b[0]=a.offsetLeft;b[1]=a.offsetTop;e=a.offsetParent;if(e!=a)for(;e;)b[0]+=e.offsetLeft,
b[1]+=e.offsetTop,e=e.offsetParent;c=ALKMaps.BROWSER_NAME;if("opera"==c||"safari"==c&&"absolute"==ALKMaps.Element.getStyle(a,"position"))b[1]-=document.body.offsetTop;for(e=a.offsetParent;e&&e!=document.body;){b[0]-=e.scrollLeft;if("opera"!=c||"TR"!=e.tagName)b[1]-=e.scrollTop;e=e.offsetParent}}return b};ALKMaps.Util.makeInitOnceGetter(ALKMaps.Util,"getViewportElement",function(){return"msie"==ALKMaps.BROWSER_NAME&&"CSS1Compat"!=document.compatMode?document.body:document.documentElement});ALKMaps.Util.isEquivalentUrl=
function(a,b,c){c=c||{};ALKMaps.Util.applyDefaults(c,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0});var a=ALKMaps.Util.createUrlObject(a,c),b=ALKMaps.Util.createUrlObject(b,c),d;for(d in a)if("args"!==d&&a[d]!=b[d])return!1;for(d in a.args){if(a.args[d]!=b.args[d])return!1;delete b.args[d]}for(d in b.args)return!1;return!0};ALKMaps.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",d=c.protocol+"//"+c.host.split(":").shift()+d;0===a.indexOf("/")?
a=d+a:(c=c.pathname.split("/"),c.pop(),a=d+c.join("/")+"/"+a)}b.ignoreCase&&(a=a.toLowerCase());c=document.createElement("a");c.href=a;d={};d.host=c.host.split(":").shift();d.protocol=c.protocol;d.port=b.ignorePort80?"80"==c.port||"0"==c.port?"":c.port:""==c.port||"0"==c.port?"80":c.port;d.hash=b.ignoreHash||"#"===c.hash?"":c.hash;var e=c.search;e||(e=a.indexOf("?"),e=-1!=e?a.substr(e):"");d.args=ALKMaps.Util.getParameters(e);d.pathname="/"==c.pathname.charAt(0)?c.pathname:"/"+c.pathname;return d};
ALKMaps.Util.removeTail=function(a){var b=null,b=a.indexOf("?"),c=a.indexOf("#");return b=-1==b?-1!=c?a.substr(0,c):a:-1!=c?a.substr(0,Math.min(b,c)):a.substr(0,b)};ALKMaps.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return-1==a.indexOf("webkit")&&-1!=a.indexOf("gecko")}();ALKMaps.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}();ALKMaps.BROWSER_NAME=function(){var a="",b=navigator.userAgent.toLowerCase();-1!=b.indexOf("opera")?
a="opera":-1!=b.indexOf("msie")?a="msie":-1!=b.indexOf("mozilla")?a=-1!=b.indexOf("firefox")?"firefox":-1!=b.indexOf("trident/")?"msie11":-1!=b.indexOf("edge/")?"msie12":"mozilla":-1!=b.indexOf("safari")&&(a="safari");return a}();ALKMaps.Util.getBrowserName=function(){return ALKMaps.BROWSER_NAME};ALKMaps.Util.getRenderedDimensions=function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";for(var g=c&&c.containerElement?c.containerElement:document.body,h=!1,i=null,j=g;j&&
"body"!=j.tagName.toLowerCase();){var k=ALKMaps.Element.getStyle(j,"position");if("absolute"==k){h=!0;break}else if(k&&"static"!=k)break;j=j.parentNode}if(h&&(0===g.clientHeight||0===g.clientWidth))i=document.createElement("div"),i.style.visibility="hidden",i.style.position="absolute",i.style.overflow="visible",i.style.width=document.body.clientWidth+"px",i.style.height=document.body.clientHeight+"px",i.appendChild(f);f.style.position="absolute";if(b)if(b.w)d=b.w,f.style.width=d+"px";else if(b.h)e=
b.h,f.style.height=e+"px";if(c&&c.displayClass)f.className=c.displayClass;b=document.createElement("div");b.innerHTML=a;b.style.overflow="visible";if(b.childNodes){a=0;for(c=b.childNodes.length;a<c;a++)if(b.childNodes[a].style)b.childNodes[a].style.overflow="visible"}f.appendChild(b);i?g.appendChild(i):g.appendChild(f);if(!d)d=parseInt(b.scrollWidth),f.style.width=d+"px";e||(e=parseInt(b.scrollHeight));f.removeChild(b);i?(i.removeChild(f),g.removeChild(i)):g.removeChild(f);return new ALKMaps.Size(d,
e)};ALKMaps.Util.getScrollbarWidth=function(){var a=ALKMaps.Util._scrollbarWidth;if(null==a){var b=null,c=null,b=a=0,b=document.createElement("div");b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";b.style.width="100px";b.style.height="50px";b.style.overflow="hidden";c=document.createElement("div");c.style.width="100%";c.style.height="200px";b.appendChild(c);document.body.appendChild(b);a=c.offsetWidth;b.style.overflow="scroll";b=c.offsetWidth;document.body.removeChild(document.body.lastChild);
ALKMaps.Util._scrollbarWidth=a-b;a=ALKMaps.Util._scrollbarWidth}return a};ALKMaps.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");var a=(a+540)%360-180,d=Math.abs(a),e=Math.floor(d),f=d=(d-e)/(1/60),d=Math.floor(d),f=Math.round(10*((f-d)/(1/60))),f=f/10;60<=f&&(f-=60,d+=1,60<=d&&(d-=60,e+=1));10>e&&(e="0"+e);e+="\u00b0";0<=c.indexOf("dm")&&(10>d&&(d="0"+d),e+=d+"'",0<=c.indexOf("dms")&&(10>f&&(f="0"+f),e+=f+'"'));return e="lon"==b?e+(0>a?ALKMaps.i18n("W"):ALKMaps.i18n("E")):e+(0>a?ALKMaps.i18n("S"):
ALKMaps.i18n("N"))};ALKMaps.Util.getTextWidth=function(a,b){var c=document.createElement("span");c.appendChild(document.createTextNode(a));if(b)c.className=b;c.style.visibility="hidden";c.style.whiteSpace="nowrap";document.body.appendChild(c);var d=c.offsetWidth;document.body.removeChild(c);return parseInt(d,10)};ALKMaps.Util.buildTableCell=function(a,b,c,d){var a=a.toUpperCase(),e;null!==c&&void 0!==c&&(e="colspan='"+c+"' ");null!==d&&void 0!==d&&(e=void 0!==e?e+"class='"+d+"' ":"class='"+d+"' ");
if(void 0===b||null===b)b="";return null!==e&&void 0!==e?"<"+a+" "+e+">"+b+"</"+a+">":"<"+a+">"+b+"</"+a+">"};ALKMaps.Util.buildTableOrRow=function(a,b,c,d){var a=a.toUpperCase(),e;null!==d&&void 0!==d&&(e="id='"+d+"' ");null!==c&&void 0!==c&&(e="class='"+c+"' ");c=null!==e&&void 0!==e?"<"+a+" "+e+">":"<"+a+">";for(d=0;d<b.length;d++)c+=b[d];return c+"</"+a+">"};ALKMaps.Util.convertToStringArray=function(a){ALKMaps.Util.isArray(a)||(a=[a]);for(var b=[],c=0;c<a.length;c++)b=b.concat(a[c].split(","));
return b};ALKMaps.Util.getRegion=function(a){null!=a?("string"===typeof a&&(a=a.toUpperCase()),a="AF"===a||"1"===a||1===a?1:"AS"===a||"2"===a||2===a?2:"EU"===a||"3"===a||3===a?3:"OC"===a||"5"===a||5===a?5:"SA"===a||"6"===a||6===a?6:"ME"===a||"7"===a||7===a?7:4):a=4;return a};ALKMaps.Util.getDataSet=function(a){if("number"===typeof a||!isNaN(a))return Number(a);var b=/^PCM[0-9]{2}$/;return"string"===typeof a&&(a=a.toUpperCase(),null!=a&&("PCM_WW"===a||"PCM_NA"===a||"PCM_EU"===a||"PCM_OC"===a||"PCM_SA"===
a||"PCM_AS"===a||"PCM_AF"===a||"PCM_ME"===a||"PCM_GT"===a||ALKMaps.String.startsWith(a,"MAPSURE_")||"PCM_NA_14Q2"===a||"PCM_NA_13Q2"===a||"PCM_JP"===a||!0===b.test(a)&&18<=Number(a.substring(3))))?a:"Current"};ALKMaps.Util.getDatasetFromRegion=function(a){var b="Current";if(null!=a)if("string"===typeof a&&(a=a.toUpperCase()),"AF"===a||"1"===a||1===a)b="PCM_AF";else if("AS"===a||"2"===a||2===a)b="PCM_AS";else if("EU"===a||"3"===a||3===a)b="PCM_EU";else if("OC"===a||"5"===a||5===a)b="PCM_OC";else if("SA"===
a||"6"===a||6===a)b="PCM_SA";else if("ME"===a||"7"===a||7===a)b="PCM_ME";return b};ALKMaps.Util.rgbToHex=function(a,b,c){return"#"+(16777216+(a<<16)+(b<<8)+c).toString(16).slice(1)};ALKMaps.Util.hexToRgb=function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,e){return c+c+d+d+e+e});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null};ALKMaps.Util.buildLabelElement=function(a){var b=document.createElement("label");
null!=a.id&&b.setAttribute("id",a.id);b.innerHTML=a.text;b.className=a.cssClass||"olLabel";return b};ALKMaps.Util.buildSelectElement=function(a){var b=document.createElement("select");null!=a.id&&b.setAttribute("id",a.id);b.setAttribute("class",a.cssClass||"olSelect");for(var c=0;c<a.optValues.length;c++){var d=a.optTexts[c],e=a.optValues[c],f=document.createElement("option");f.setAttribute("value",e);d=document.createTextNode(d);f.appendChild(d);e===a.selectedValue&&f.setAttribute("selected","selected");
b.appendChild(f)}return b};ALKMaps.Util.getScriptSrc=function(a){for(var b={},c=document.getElementsByTagName("script"),d=0;d<c.length;d++)-1<c[d].src.indexOf(a)&&(b=c[d]);return b.src};ALKMaps.Util.getApiKey=function(a){a=!0===a?ALKMaps.Date.toISOString(new Date):a instanceof Date?ALKMaps.Date.toISOString(a):ALKMaps.Date.toISOString(ALKMaps.InitDate);return ALKMaps.APIKey+"|"+a};ALKMaps.Util.getYear=function(){return(new Date).getFullYear()};ALKMaps.Util.enableContextMenu=function(a){if(null!=a)a.oncontextmenu=
null};ALKMaps.Util.disableContextMenu=function(a){if(null!=a)a.oncontextmenu=function(a){a=a?a:window.event;if(a.preventDefault)a.preventDefault();else return!1}};ALKMaps.Util.addEventHelper=function(a,b,c){return a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)};ALKMaps.Util.toggleClass=function(a,b){return a=0>a.className.indexOf(b)?ALKMaps.Util.addClassHelper(a,b):ALKMaps.Util.removeClassHelper(a,b)};ALKMaps.Util.addClassHelper=function(a,b){0>a.className.indexOf(b)&&(a.className+=
" "+b);return a};ALKMaps.Util.removeClassHelper=function(a,b){a.className=a.className.replace(b,"");a.className=a.className.replace(/^\s+|\s+$/g,"");return a};ALKMaps.Util.showElement=function(a,b,c){c=c||"show";a=ALKMaps.Util.removeClassHelper(a,b||"hide");return a=ALKMaps.Util.addClassHelper(a,c)};ALKMaps.Util.hideElement=function(a,b,c){c=c||"hide";a=ALKMaps.Util.removeClassHelper(a,b||"show");return a=ALKMaps.Util.addClassHelper(a,c)};ALKMaps.Util.getSatelliteProvider=function(a){switch((a||"Default").toLowerCase()){case "sat1":a=
"DigitalGlobe";break;case "sat2":a="DigitalGlobeConsumer";break;case "sat3":a="DigitalGlobeTrueCurrency";break;case "sat4":a="DigitalGlobeColorConsumer";break;case "sat5":a="DigitalGlobeAPIVivid";break;case "sat6":a="DigitalGlobeAPIRecent";break;default:a="DigitalGlobeAPIImagery"}return a};ALKMaps.Util.getDrawerGroupFlags=function(a){var b={cities:1,labels:2,roads:4,commercial:8,borders:16,areas:32};if(!a)a=ALKMaps.CONTENT.DEFAULT;for(var c=0,a=a.split(","),d=0;d<a.length;d++){var e=b[a[d]];e&&(c|=
e)}return c};ALKMaps.Util.wrapLongitude=function(a){var b=a%180,c=Math.floor(a/180);-180>a&&0===c%2&&(b+=180);180<a&&0!==c%2&&(b-=180);return b};ALKMaps.Util.clip=function(a,b,c){return Math.min(Math.max(a,b),c)};ALKMaps.Util.longLatToTileXYZ=function(a,b,c){var a=ALKMaps.Util.clip(a,-180,180),b=ALKMaps.Util.clip(b,-85.05112878,85.05112878),a=(a+180)/360,b=Math.sin(b*Math.PI/180),b=0.5-Math.log((1+b)/(1-b))/(4*Math.PI),d=256*Math.pow(2,c),a=Math.floor(ALKMaps.Util.clip(a*d+0.5,0,d-1)),b=Math.floor(ALKMaps.Util.clip(b*
d+0.5,0,d-1));return{x:Math.floor(a/256),y:Math.floor(b/256),z:c}};ALKMaps.Util.tileXYZToQuadkey=function(a){for(var b=[],c=a.z;0<c;c--){var d="0",e=1<<c-1;0!==(a.x&e)&&d++;0!==(a.y&e)&&(d++,d++);b.push(d)}return b.join("")};ALKMaps.Util.quadKeyToTileXYZ=function(a){for(var b=0,c=0,d=a.length,e=d;0<e;e--){var f=1<<e-1;switch(a[d-e]){case "0":break;case "1":b|=f;break;case "2":c|=f;break;case "3":b|=f;c|=f;break;default:throw"Invalid quad key digit sequence.";}}return{x:b,y:c,z:d}};ALKMaps.Util.getTileBounds=
function(a){var b=Math.pow(2,a.z),c=360*a.x/b-180,d=360*(a.x+1)/b-180,e=Math.exp(4*(0.5-a.y/b)*Math.PI),f=Math.asin((e-1)/(e+1))*(180/Math.PI),e=Math.exp(4*(0.5-(a.y+1)/b)*Math.PI),a=Math.asin((e-1)/(e+1))*(180/Math.PI);return{top:f,left:c,bottom:a,right:d}};ALKMaps.Util.getQkeysFromBounds=function(a,b,c){var d=[];if(b<c)return d;for(var e=ALKMaps.Util.longLatToTileXYZ(a.right,a.top,b),f=ALKMaps.Util.longLatToTileXYZ(a.left,a.bottom,b),a=Math.min(e.x,f.x),g=Math.max(e.x,f.x),h=Math.min(e.y,f.y),e=
Math.max(e.y,f.y);a<=g;a++)for(f=h;f<=e;f++){var i=ALKMaps.Util.tileXYZToQuadkey({x:a,y:f,z:b});i.length>=c&&(i=i.substring(0,c),d.push(i))}ALKMaps.Util.removeDuplicates(d);return d}})();ALKMaps.Feature=ALKMaps.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(a,b,c){this.layer=a;this.lonlat=b;this.data=null!=c?c:{};this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup);null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;if(null!=this.marker)this.destroyMarker(this.marker),
this.marker=null;if(null!=this.popup)this.destroyPopup(this.popup),this.popup=null},onScreen:function(){var a=!1;null!=this.layer&&null!=this.layer.map&&(a=this.layer.map.getExtent().containsLonLat(this.lonlat));return a},createMarker:function(){if(null!=this.lonlat)this.marker=new ALKMaps.Marker(this.lonlat,this.data.icon);return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){if(null!=this.lonlat){if(!this.popup){var b=null,c=this.popupClass?this.popupClass:
this.data&&this.data.popupClass?this.data.popupClass:ALKMaps.Popup.Anchored;if(c===ALKMaps.Popup.SimplePopup){if(null!=this.marker&&null!=this.marker.icon)b=this.marker.icon.offset}else b=this.marker?this.marker.icon:null;this.popup=new c(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,b,a)}if(null!=this.data.overflow)this.popup.contentDiv.style.overflow=this.data.overflow;this.popup.feature=this}return this.popup},destroyPopup:function(){if(this.popup)this.popup.feature=
null,this.popup.destroy(),this.popup=null},CLASS_NAME:"ALKMaps.Feature"});ALKMaps.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};
ALKMaps.Feature.Vector=ALKMaps.Class(ALKMaps.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(a,b,c){ALKMaps.Feature.prototype.initialize.apply(this,[null,null,b]);this.lonlat=null;this.geometry=a?a:null;this.state=null;this.attributes={};if(b)this.attributes=ALKMaps.Util.extend(this.attributes,b);this.style=c?c:null},destroy:function(){if(this.layer)this.layer.removeFeatures(this),this.layer=null;this.modified=
this.geometry=null;ALKMaps.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new ALKMaps.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var b=!1;this.layer&&this.layer.map&&(b=this.layer.map.getExtent(),a?(a=this.geometry.getBounds(),b=b.intersectsBounds(a)):b=b.toGeometry().intersects(this.geometry));return b},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||this.layer&&this.layer.styleMap&&
"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(a){if(null!=this.lonlat){if(!this.popup){var b=this.data.popupSize?this.data.popupSize:new ALKMaps.Size(160,120);this.data.anchor||(new ALKMaps.Size(0,0),new ALKMaps.Pixel(0,0));var c=null,d=this.popupClass?this.popupClass:this.data.popupClass?this.data.popupClass:ALKMaps.Popup.Anchored,c=d===ALKMaps.Popup.SimplePopup?
this.data.offset?this.data.offset:new ALKMaps.Pixel(0,0):this.data.anchor?this.data.anchor:{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(0,0)};this.popup=new d(this.id+"_popup",this.lonlat,b,this.data.popupContentHTML,c,a)}if(null!=this.data.overflow)this.popup.contentDiv.style.overflow=this.data.overflow;this.popup.feature=this}return this.popup},atPoint:function(a,b,c){var d=!1;this.geometry&&(d=this.geometry.atPoint(a,b,c));return d},move:function(a){if(this.layer&&this.geometry.move){var a=
"ALKMaps.LonLat"==a.CLASS_NAME?this.layer.getViewPortPxFromLonLat(a):a,b=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),c=this.layer.map.getResolution();this.geometry.move(c*(a.x-b.x),c*(b.y-a.y));this.layer.drawFeature(this);return b}},toState:function(a){if(a==ALKMaps.State.UPDATE)switch(this.state){case ALKMaps.State.UNKNOWN:case ALKMaps.State.DELETE:this.state=a}else if(a==ALKMaps.State.INSERT)switch(this.state){case ALKMaps.State.UNKNOWN:break;default:this.state=
a}else if(a==ALKMaps.State.DELETE)switch(this.state){case ALKMaps.State.UNKNOWN:case ALKMaps.State.UPDATE:this.state=a}else if(a==ALKMaps.State.UNKNOWN)this.state=a},CLASS_NAME:"ALKMaps.Feature.Vector"});
ALKMaps.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3,arrows:null,arrowSize:"100%",arrowSpacing:100,
arrowStrokeColor:"black",arrowStrokeWidth:1,arrowStrokeOpacity:1,arrowFillColor:"white",arrowFillOpacity:1,arrowGraphicName:"chevron",arrowRotation:0},select:{fillColor:"blue",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",
labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3,arrows:null,arrowSize:"100%",arrowSpacing:100,arrowStrokeColor:"black",arrowStrokeWidth:2,arrowStrokeOpacity:1,arrowFillColor:"white",arrowFillOpacity:1,arrowGraphicName:"chevron",arrowRotation:0},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,
pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3,arrows:null,arrowSize:"100%",arrowSpacing:100,arrowStrokeColor:"black",arrowStrokeWidth:2,arrowStrokeOpacity:1,arrowFillColor:"white",arrowFillOpacity:1,arrowGraphicName:"chevron",arrowRotation:0},"delete":{display:"none"}};ALKMaps.Style=ALKMaps.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,b){ALKMaps.Util.extend(this,b);this.rules=[];b&&b.rules&&this.addRules(b.rules);this.setDefaultStyle(a||ALKMaps.Feature.Vector.style["default"]);this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy(),this.rules[a]=
null;this.defaultStyle=this.rules=null},createSymbolizer:function(a){for(var b=this.defaultsPerSymbolizer?{}:this.createLiterals(ALKMaps.Util.extend({},this.defaultStyle),a),c=this.rules,d,e=[],f=!1,g=0,h=c.length;g<h;g++)d=c[g],d.evaluate(a)&&(d instanceof ALKMaps.Rule&&d.elseFilter?e.push(d):(f=!0,this.applySymbolizer(d,b,a)));if(!1==f&&0<e.length){f=!0;g=0;for(h=e.length;g<h;g++)this.applySymbolizer(e[g],b,a)}if(0<c.length&&!1==f)b.display="none";if(null!=b.label&&"string"!==typeof b.label)b.label=
""+b.label;return b},applySymbolizer:function(a,b,c){var d=c.geometry?this.getSymbolizerPrefix(c.geometry):ALKMaps.Style.SYMBOLIZER_PREFIXES[0],a=a.symbolizer[d]||a.symbolizer;if(!0===this.defaultsPerSymbolizer)d=this.defaultStyle,ALKMaps.Util.applyDefaults(a,{pointRadius:d.pointRadius}),(!0===a.stroke||!0===a.graphic)&&ALKMaps.Util.applyDefaults(a,{strokeWidth:d.strokeWidth,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeDashstyle:d.strokeDashstyle,strokeLinecap:d.strokeLinecap}),(!0===
a.fill||!0===a.graphic)&&ALKMaps.Util.applyDefaults(a,{fillColor:d.fillColor,fillOpacity:d.fillOpacity}),!0===a.graphic&&ALKMaps.Util.applyDefaults(a,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset});
return this.createLiterals(ALKMaps.Util.extend(b,a),c)},createLiterals:function(a,b){var c=ALKMaps.Util.extend({},b.attributes||b.data);ALKMaps.Util.extend(c,this.context);for(var d in this.propertyStyles)a[d]=ALKMaps.Style.createLiteral(a[d],c,b,d);return a},findPropertyStyles:function(){var a={};this.addPropertyStyles(a,this.defaultStyle);for(var b=this.rules,c,d,e=0,f=b.length;e<f;e++){c=b[e].symbolizer;for(var g in c)if(d=c[g],"object"==typeof d)this.addPropertyStyles(a,d);else{this.addPropertyStyles(a,
c);break}}return a},addPropertyStyles:function(a,b){var c,d;for(d in b)c=b[d],"string"==typeof c&&c.match(/\$\{\w+\}/)&&(a[d]=!0);return a},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){for(var b=ALKMaps.Style.SYMBOLIZER_PREFIXES,c=0,d=b.length;c<d;c++)if(-1!=a.CLASS_NAME.indexOf(b[c]))return b[c]},clone:function(){var a=
ALKMaps.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}a.context=this.context&&ALKMaps.Util.extend({},this.context);b=ALKMaps.Util.extend({},this.defaultStyle);return new ALKMaps.Style(b,a)},CLASS_NAME:"ALKMaps.Style"});
ALKMaps.Style.createLiteral=function(a,b,c,d){if("string"==typeof a&&-1!=a.indexOf("${"))var e=a,a=ALKMaps.String.format(a,b,[c,d]),e=ALKMaps.String.trim(e),a=!0===(2<=e.length&&'}"'==e.substring(e.length-2))&&!0===ALKMaps.String.startsWith(e,'"${')?a.substring(1,a.length-1):isNaN(a)||!a?a:parseFloat(a);return a};ALKMaps.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];ALKMaps.Filter=ALKMaps.Class({initialize:function(a){ALKMaps.Util.extend(this,a)},destroy:function(){},evaluate:function(){return!0},clone:function(){return null},toString:function(){return ALKMaps.Format&&ALKMaps.Format.CQL?ALKMaps.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"ALKMaps.Filter"});ALKMaps.Control=ALKMaps.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("ALKMaps.","ol").replace(/\./g,"");ALKMaps.Util.extend(this,a);this.events=new ALKMaps.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);if(null==this.id)this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){if(this.events)this.eventListeners&&
this.events.un(this.eventListeners),this.events.destroy(),this.events=null;this.eventListeners=null;if(this.handler)this.handler.destroy(),this.handler=null;if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&"function"==typeof this.handlers[a].destroy&&this.handlers[a].destroy();this.handlers=null}if(this.map)this.map.removeControl(this),this.map=null;this.div=null},setMap:function(a){this.map=a;this.handler&&this.handler.setMap(a)},draw:function(a){if(null==this.div){this.div=
ALKMaps.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection)this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=ALKMaps.Function.False;if(""!=this.title)this.div.title=this.title}if(null!=a)this.position=a.clone();this.moveTo(this.position);return this.div},moveTo:function(a){if(null!=a&&null!=this.div)this.div.style.left=a.x+"px",this.div.style.top=a.y+"px"},activate:function(){if(this.active)return!1;this.handler&&
this.handler.activate();this.active=!0;this.map&&ALKMaps.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return!0},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&ALKMaps.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"ALKMaps.Control"});ALKMaps.Control.TYPE_BUTTON=1;
ALKMaps.Control.TYPE_TOGGLE=2;ALKMaps.Control.TYPE_TOOL=3;ALKMaps.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&&1==a.touches.length},isMultiTouch:function(a){return a.touches&&1<a.touches.length},isLeftClick:function(a){return a.which&&1==a.which||a.button&&1==a.button},isRightClick:function(a){return a.which&&3==a.which||a.button&&2==a.button},stop:function(a,b){if(!b)a.preventDefault?
a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},findElement:function(a,b){for(var c=ALKMaps.Event.element(a);c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase());)c=c.parentNode;return c},observe:function(a,b,c,d){a=ALKMaps.Util.getElement(a);d=d||!1;if("keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent))b="keydown";if(!this.observers)this.observers={};if(!a._eventCacheID){var e="eventCacheID_";a.id&&(e=
a.id+"_"+e);a._eventCacheID=ALKMaps.Util.createUniqueID(e)}e=a._eventCacheID;this.observers[e]||(this.observers[e]=[]);this.observers[e].push({element:a,name:b,observer:c,useCapture:d});a.addEventListener?"mousewheel"===b?(e=this.passiveOptionSupported(),a.addEventListener(b,c,e?{passive:!1}:d)):a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},passiveOptionSupported:function(){var a=!1,b=function(){};try{var c=Object.defineProperty&&Object.defineProperty({},"passive",{get:function(){a=
!0}});window.addEventListener("testPassiveOption",b,c);window.removeEventListener("testPassiveOption",b,c)}catch(d){}return a},stopObservingElement:function(a){(a=ALKMaps.Util.getElement(a))&&this._removeElementObservers(ALKMaps.Event.observers[a._eventCacheID])},_removeElementObservers:function(a){if(a)for(var b=a.length-1;0<=b;b--){var c=a[b];ALKMaps.Event.stopObserving.apply(this,[c.element,c.name,c.observer,c.useCapture])}},stopObserving:function(a,b,c,d){var d=d||!1,a=ALKMaps.Util.getElement(a),
e=a._eventCacheID;if("keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent))b="keydown";var f=!1,g=ALKMaps.Event.observers[e];if(g)for(var h=0;!f&&h<g.length;){var i=g[h];if(i.name==b&&i.observer==c&&i.useCapture==d){g.splice(h,1);0==g.length&&delete ALKMaps.Event.observers[e];f=!0;break}h++}f&&(a.removeEventListener?a.removeEventListener(b,c,d):a&&a.detachEvent&&a.detachEvent("on"+b,c));return f},unloadCache:function(){if(ALKMaps.Event&&ALKMaps.Event.observers){for(var a in ALKMaps.Event.observers)ALKMaps.Event._removeElementObservers.apply(this,
[ALKMaps.Event.observers[a]]);ALKMaps.Event.observers=!1}},CLASS_NAME:"ALKMaps.Event"};ALKMaps.Event.observe(window,"unload",ALKMaps.Event.unloadCache,!1);
ALKMaps.Events=ALKMaps.Class({BROWSER_EVENTS:"mouseover,mouseout,mousedown,mouseup,mousemove,click,dblclick,rightclick,dblrightclick,resize,focus,blur,touchstart,touchmove,touchend,keydown".split(","),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,b,c,d,e){ALKMaps.Util.extend(this,e);this.object=a;this.fallThrough=d;this.listeners={};this.extensions={};this.extensionCount={};
null!=b&&this.attachToElement(b)},destroy:function(){for(var a in this.extensions)"boolean"!==typeof this.extensions[a]&&this.extensions[a].destroy();this.extensions=null;this.element&&(ALKMaps.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&ALKMaps.Event.stopObserving(window,"scroll",this.clearMouseListener));this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(){},attachToElement:function(a){this.element?ALKMaps.Event.stopObservingElement(this.element):
(this.eventHandler=ALKMaps.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=ALKMaps.Function.bind(this.clearMouseCache,this));this.element=a;for(var b=0,c=this.BROWSER_EVENTS.length;b<c;b++)ALKMaps.Event.observe(a,this.BROWSER_EVENTS[b],this.eventHandler);ALKMaps.Event.observe(a,"dragstart",ALKMaps.Event.stop)},on:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.register(b,a.scope,a[b])},register:function(a,b,c,d){a in ALKMaps.Events&&!this.extensions[a]&&
(this.extensions[a]=new ALKMaps.Events[a](this));if(null!=c){if(null==b)b=this.object;var e=this.listeners[a];e||(e=[],this.listeners[a]=e,this.extensionCount[a]=0);b={obj:b,func:c};if(d){if(e.splice(this.extensionCount[a],0,b),"object"===typeof d&&(d.extension&&this.extensionCount[a]++,!0===d.always))b.always=!0}else e.push(b)}},registerPriority:function(a,b,c){this.register(a,b,c,!0)},un:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.unregister(b,a.scope,a[b])},unregister:function(a,
b,c){if(null==b)b=this.object;a=this.listeners[a];if(null!=a)for(var d=0,e=a.length;d<e;d++)if(a[d].obj==b&&a[d].func==c){a.splice(d,1);break}},remove:function(a){null!=this.listeners[a]&&(this.listeners[a]=[])},triggerEvent:function(a,b){var c=this.listeners[a];if(c&&0!=c.length){null==b&&(b={});b.object=this.object;b.element=this.element;if(!b.type)b.type=a;for(var c=c.slice(),d,e=0,f=c.length;e<f;e++){var g=c[e];!1!==d?d=g.func.apply(g.obj,[b]):!0===g.always&&g.func.apply(g.obj,[b])}this.fallThrough||
ALKMaps.Event.stop(b,!0);return d}},handleBrowserEvent:function(a){var b=a.type,c=this.listeners[b];if(c&&0!=c.length){if((c=a.touches)&&c[0]){for(var d=0,e=0,f=c.length,g,h=0;h<f;++h)g=c[h],d+=g.clientX,e+=g.clientY;a.clientX=d/f;a.clientY=e/f}if(this.includeXY)a.xy=this.getMousePosition(a);this.triggerEvent(b,a)}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;var a=document.body;if(a&&(!(0!=a.scrollTop||0!=a.scrollLeft)||!navigator.userAgent.match(/iPhone/i)))this.element.offsets=
null},getMousePosition:function(a){if(this.includeXY){if(!this.element.hasScrollEvent)ALKMaps.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0}else this.clearMouseCache();if(!this.element.scrolls){var b=ALKMaps.Util.getViewportElement();this.element.scrolls=[b.scrollLeft,b.scrollTop]}if(!this.element.lefttop)this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0];if(!this.element.offsets)this.element.offsets=ALKMaps.Util.pagePosition(this.element);
return new ALKMaps.Pixel(a.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"ALKMaps.Events"});ALKMaps.Events.buttonclick=ALKMaps.Class({target:null,events:"mousedown,mouseup,click,dblclick,touchstart,touchmove,touchend,keydown".split(","),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;0<=a;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:!0})},destroy:function(){for(var a=this.events.length-1;0<=a;--a)this.target.unregister(this.events[a],this,this.buttonClick);
delete this.target},getPressedButton:function(a){var b=3,c;do{if(ALKMaps.Element.hasClass(a,"olButton")){c=a;break}a=a.parentNode}while(0<--b&&a);return c},buttonClick:function(a){var b=!0,c=ALKMaps.Event.element(a);if(c&&(ALKMaps.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(c=this.getPressedButton(c)){if("keydown"===a.type)switch(a.keyCode){case ALKMaps.Event.KEY_RETURN:case ALKMaps.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:c}),ALKMaps.Event.stop(a),b=!1}else this.startEvt&&
(this.completeRegEx.test(a.type)&&(b=ALKMaps.Util.pagePosition(c),this.target.triggerEvent("buttonclick",{buttonElement:c,buttonXY:{x:!0===("msie"===ALKMaps.Util.getBrowserName()||"firefox"===ALKMaps.Util.getBrowserName())?this.startEvt.pageX-b[0]:this.startEvt.clientX-b[0],y:!0===("msie"===ALKMaps.Util.getBrowserName()||"firefox"===ALKMaps.Util.getBrowserName())?this.startEvt.pageY-b[1]:this.startEvt.clientY-b[1]}})),this.cancelRegEx.test(a.type)&&delete this.startEvt,ALKMaps.Event.stop(a),b=!1);
if(this.startRegEx.test(a.type))this.startEvt=a,ALKMaps.Event.stop(a),b=!1}else delete this.startEvt;return b}});ALKMaps.Control.Panel=ALKMaps.Class(ALKMaps.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,[a]);this.controls=[];this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);ALKMaps.Control.prototype.destroy.apply(this,arguments);for(var a,b=this.controls.length-1;0<=b;b--)a=this.controls[b],a.events&&a.events.un({activate:this.iconOn,
deactivate:this.iconOff}),a.panel_div=null;this.activeState=null},activate:function(){if(ALKMaps.Control.prototype.activate.apply(this,arguments)){for(var a,b=0,c=this.controls.length;b<c;b++)a=this.controls[b],(a===this.defaultControl||this.saveState&&this.activeState[a.id])&&a.activate();if(!0===this.saveState)this.defaultControl=null;this.redraw();return!0}return!1},deactivate:function(){if(ALKMaps.Control.prototype.deactivate.apply(this,arguments)){for(var a,b=0,c=this.controls.length;b<c;b++)a=
this.controls[b],this.activeState[a.id]=a.deactivate();this.redraw();return!0}return!1},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick);this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var a=this.div.childNodes.length-1;0<=a;a--)this.div.removeChild(this.div.childNodes[a]);
this.div.innerHTML="";if(this.active)for(var a=0,b=this.controls.length;a<b;a++)this.div.appendChild(this.controls[a].panel_div)},activateControl:function(a){if(!this.active)return!1;if(a.type==ALKMaps.Control.TYPE_BUTTON)a.trigger();else if(a.type==ALKMaps.Control.TYPE_TOGGLE)a.active?a.deactivate():a.activate();else if(this.allowDepress&&a.active)a.deactivate();else{for(var b,c=0,d=this.controls.length;c<d;c++)b=this.controls[c],b!=a&&(b.type===ALKMaps.Control.TYPE_TOOL||null==b.type)&&b.deactivate();
a.activate()}},addControls:function(a){ALKMaps.Util.isArray(a)||(a=[a]);this.controls=this.controls.concat(a);for(var b=0,c=a.length;b<c;b++){var d=a[b],e=this.createControlMarkup(d);ALKMaps.Element.addClass(e,d.displayClass+"ItemInactive");ALKMaps.Element.addClass(e,"olButton");if(""!=d.title&&!e.title)e.title=d.title;d.panel_div=e}this.map&&(this.addControlsToMap(a),this.redraw())},createControlMarkup:function(){return document.createElement("div")},addControlsToMap:function(a){for(var b,c=0,d=
a.length;c<d;c++)b=a[c],!0===b.autoActivate?(b.autoActivate=!1,this.map.addControl(b),b.autoActivate=!0):(this.map.addControl(b),b.deactivate()),b.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Inactive\\b"),"$1Active")},iconOff:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Active\\b"),"$1Inactive")},onButtonClick:function(a){for(var b=
this.controls,a=a.buttonElement,c=b.length-1;0<=c;--c)if(b[c].panel_div===a){this.activateControl(b[c]);break}},getControlsBy:function(a,b){var c="function"==typeof b.test;return ALKMaps.Array.filter(this.controls,function(d){return d[a]==b||c&&b.test(d[a])})},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"ALKMaps.Control.Panel"});ALKMaps.Control.ZoomIn=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"ALKMaps.Control.ZoomIn"});ALKMaps.Control.ZoomOut=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"ALKMaps.Control.ZoomOut"});ALKMaps.Control.ZoomToMaxExtent=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_BUTTON,trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"ALKMaps.Control.ZoomToMaxExtent"});ALKMaps.Control.TouchZoom=ALKMaps.Class(ALKMaps.Control.Panel,{initialize:function(a){ALKMaps.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new ALKMaps.Control.ZoomIn({displayClass:"alkTouchZoomIn"}),new ALKMaps.Control.ZoomOut({displayClass:"alkTouchZoomOut"})])},CLASS_NAME:"ALKMaps.Control.TouchZoom"});ALKMaps.Control.Measure=ALKMaps.Class(ALKMaps.Control,{handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:!0,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,[b]);var c={done:this.measureComplete,point:this.measurePartial};if(this.immediate)c.modify=this.measureImmediate;this.callbacks=ALKMaps.Util.extend(c,this.callbacks);
this.handlerOptions=ALKMaps.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new a(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(a){(this.immediate=a)?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(a,b){var c=this.active;c&&this.deactivate();this.handler=
new a(this,this.callbacks,b);c&&this.activate()},measureComplete:function(a){this.cancelDelay();this.measure(a,"measure")},measurePartial:function(a,b){this.cancelDelay();b=b.clone();this.handler.freehandMode(this.handler.evt)?this.measure(b,"measurepartial"):this.delayedTrigger=window.setTimeout(ALKMaps.Function.bind(function(){this.delayedTrigger=null;this.measure(b,"measurepartial")},this),this.partialDelay)},measureImmediate:function(a,b,c){c&&!this.handler.freehandMode(this.handler.evt)&&(this.cancelDelay(),
this.measure(b.geometry,"measurepartial"))},cancelDelay:function(){if(null!==this.delayedTrigger)window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null},measure:function(a,b){var c,d;-1<a.CLASS_NAME.indexOf("LineString")?(c=this.getBestLength(a),d=1):(c=this.getBestArea(a),d=2);this.events.triggerEvent(b,{measure:c[0],units:c[1],order:d,geometry:a})},getBestArea:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getArea(a,c),1<d);++e);
return[d,c]},getArea:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicArea(this.map.getProjectionObject()),d="m"):(c=a.getArea(),d=this.map.getUnits());var e=ALKMaps.INCHES_PER_UNIT[b];e&&(c*=Math.pow(ALKMaps.INCHES_PER_UNIT[d]/e,2));return c},getBestLength:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getLength(a,c),1<d);++e);return[d,c]},getLength:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicLength(this.map.getProjectionObject()),
d="m"):(c=a.getLength(),d=this.map.getUnits());var e=ALKMaps.INCHES_PER_UNIT[b];e&&(c*=ALKMaps.INCHES_PER_UNIT[d]/e);return c},CLASS_NAME:"ALKMaps.Control.Measure"});ALKMaps.Animation=function(a){var b=!(!a.requestAnimationFrame&&!a.webkitRequestAnimationFrame&&!a.mozRequestAnimationFrame&&!a.oRequestAnimationFrame&&!a.msRequestAnimationFrame),c=function(){var b=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,16)};return function(c,d){b.apply(a,[c,d])}}(),d=0,e={};return{isNative:b,requestFrame:c,start:function(a,b,h){var b=0<b?b:Number.POSITIVE_INFINITY,
i=++d,j=+new Date;e[i]=function(){e[i]&&+new Date-j<=b?(a(),e[i]&&c(e[i],h)):delete e[i]};c(e[i],h);return i},stop:function(a){delete e[a]}}}(window);ALKMaps.Tween=ALKMaps.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(a){this.easing=a?a:ALKMaps.Easing.Expo.easeOut},start:function(a,b,c,d){this.playing=!0;this.begin=a;this.finish=b;this.duration=c;this.callbacks=d.callbacks;this.time=0;ALKMaps.Animation.stop(this.animationId);this.animationId=null;this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=ALKMaps.Animation.start(ALKMaps.Function.bind(this.play,
this))},stop:function(){if(this.playing)this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),ALKMaps.Animation.stop(this.animationId),this.animationId=null,this.playing=!1},play:function(){var a={},b;for(b in this.begin){var c=this.begin[b],d=this.finish[b];if(null==c||null==d||isNaN(c)||isNaN(d))throw new TypeError("invalid value for Tween");a[b]=this.easing.apply(this,[this.time,c,d-c,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,
a);this.time>this.duration&&this.stop()},CLASS_NAME:"ALKMaps.Tween"});ALKMaps.Easing={CLASS_NAME:"ALKMaps.Easing"};ALKMaps.Easing.Linear={easeIn:function(a,b,c,d){return c*a/d+b},easeOut:function(a,b,c,d){return c*a/d+b},easeInOut:function(a,b,c,d){return c*a/d+b},CLASS_NAME:"ALKMaps.Easing.Linear"};
ALKMaps.Easing.Expo={easeIn:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"ALKMaps.Easing.Expo"};
ALKMaps.Easing.Quad={easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"ALKMaps.Easing.Quad"};ALKMaps.WS_Address=ALKMaps.Class({StreetAddress:null,City:null,State:null,Zip:null,Country:null,initialize:function(a){a=a||{};this.StreetAddress=void 0!==a.StreetAddress?a.StreetAddress:void 0!==a.streetAddress?a.streetAddress:null;this.City=void 0!==a.City?a.City:void 0!==a.city?a.city:null;this.State=void 0!==a.State?a.State:void 0!==a.state?a.state:null;this.Zip=void 0!==a.Zip?a.Zip:void 0!==a.zip?a.zip:null;this.Country=void 0!==a.Country?a.Country:void 0!=a.country?a.country:null},CLASS_NAME:"ALKMaps.WS_Address"});
ALKMaps.WS_Address.fromAddress=function(a){return new ALKMaps.WS_Address(a)};ALKMaps.WS_Coordinates=ALKMaps.Class({Lat:null,Lon:null,initialize:function(a){this.Lon=void 0!==a.Lon?a.Lon:a.lon;this.Lat=void 0!==a.Lat?a.Lat:a.lat},CLASS_NAME:"ALKMaps.WS_Coordinates"});ALKMaps.WS_Coordinates.fromLonLat=function(a){return new ALKMaps.WS_Coordinates(a)};ALKMaps.WS_Location=ALKMaps.Class({Address:null,Coords:null,Label:null,initialize:function(a){a=a||{};this.Address=void 0!==a.Address?a.Address:a.address;this.Coords=void 0!==a.Coords?a.Coords:a.coords;this.Label=void 0!==a.Label?a.Label:a.label},CLASS_NAME:"ALKMaps.WS_Location"});ALKMaps.WS_Location.fromLocation=function(a){a=a||{};return new ALKMaps.WS_Location({Address:ALKMaps.WS_Address.fromAddress(a.address),Coords:ALKMaps.WS_Coordinates.fromLonLat(a.lonLat),Label:a.label})};ALKMaps.Control.EditPanel=ALKMaps.Class(ALKMaps.Control.Panel,{initialize:function(a,b){ALKMaps.Control.Panel.prototype.initialize.apply(this,[b]);this.layer=a;var c="sw-resize,s-resize,se-resize,e-resize,ne-resize,n-resize,nw-resize,w-resize".split(","),d=new ALKMaps.Style({graphicName:"circle",pointRadius:6,strokeColor:"#D16115",strokeWidth:1,fillColor:"#FFFF48",fillOpacity:0.6}),e=new ALKMaps.Style({strokeColor:"#3c5cff"}),f=3;1025>window.innerWidth&&(f=10);var g=new ALKMaps.Style({cursor:"${getCursor}}",
graphicName:"square",pointRadius:f,fillColor:"white",fillOpacity:0.6,strokeColor:"#3c5cff",strokeWidth:1},{context:{getCursor:function(a){var a=ALKMaps.Util.indexOf(q.handles,a),b="inherit";-1!==a&&(a=(a+8+2*Math.round(q.rotation/90))%8,b=c[a]);return b}}}),h=new ALKMaps.Style({cursor:"crosshair",graphicName:"circle",pointRadius:f,fillColor:"white",fillOpacity:1,strokeColor:"#3c5cff",strokeWidth:1}),i=new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Point,{displayClass:"alkControlDrawFeaturePoint",
title:ALKMaps.i18n("drawPoints")}),j=new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Path,{displayClass:"alkControlDrawFeaturePath",handlerOptions:{freehandToggle:!1,freehand:!1},title:ALKMaps.i18n("clkToSetPoints")}),k=new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Path,{displayClass:"alkControlDrawFeatureFreehand",handlerOptions:{freehandToggle:null,freehand:!0},title:ALKMaps.i18n("dragToDrawLine")}),m=new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.RegularPolygon,{displayClass:"alkControlDrawFeatureCircle",
handlerOptions:{sides:40,irregular:!0},title:ALKMaps.i18n("dragToDrawEllipse")}),l=new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.RegularPolygon,{displayClass:"alkControlDrawFeatureRect",handlerOptions:{sides:4,irregular:!0,snapAngle:0},title:ALKMaps.i18n("dragToDrawRect")}),p=new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Polygon,{displayClass:"alkControlDrawFeaturePolygon",handlerOptions:{freehandToggle:!1,freehand:!1},title:ALKMaps.i18n("clkToSetPolygon")}),n=new ALKMaps.Control.DrawFeature(a,
ALKMaps.Handler.Polygon,{displayClass:"alkControlDrawFeatureFreePoly",handlerOptions:{freehandToggle:null,freehand:!0},title:ALKMaps.i18n("dragToDrawPolygon")}),q=new ALKMaps.Control.TransformFeature(a,{renderIntent:"transform",displayClass:"alkControlTransformFeature",title:ALKMaps.i18n("clkShapeToResize")}),o=new ALKMaps.Control.SelectFeature(a,{displayClass:"alkControlSelectFeature",clickout:!0,title:ALKMaps.i18n("showShapeInfo"),onSelect:function(a){var b="";switch(a.geometry.CLASS_NAME){case "ALKMaps.Geometry.Polygon":b=
ALKMaps.i18n("area")+": "+(3.861021E-7*a.geometry.getGeodesicArea(this.map.getProjection())).toFixed(4)+" sq. mi.<br>";b+=ALKMaps.i18n("perimeter")+": "+(6.21371192E-4*a.geometry.getGeodesicLength(this.map.getProjection())).toFixed(4)+" mi.<br>";break;case "ALKMaps.Geometry.LineString":b=ALKMaps.i18n("length")+": "+(6.21371192E-4*a.geometry.getGeodesicLength(this.map.getProjection())).toFixed(4)+" mi.<br>";b+=ALKMaps.i18n("nodes")+": "+a.geometry.getVertices().length+"<br>";break;case "ALKMaps.Geometry.Point":b=
ALKMaps.i18n("location")+": "+a.geometry.getVertices()[0].y.toFixed(4)+", "+a.geometry.getVertices()[0].x.toFixed(4)+"<br>"}a.geometry.getVertices();b=new ALKMaps.Popup.FramedCloud("chicken",a.geometry.getBounds().getCenterLonLat(),null,"<div style='font-size:.8em'>"+b+"</div>",null,!0,function(){o.unselect(a)});a.popup=b;this.map.addPopup(a.popup)},onUnselect:function(a){this.map.removePopup(a.popup);a.popup.destroy();a.popup=null}}),r=new ALKMaps.Control.ModifyFeature(a,{toggle:!1,clickout:!0,vertexRenderIntent:"modify",
virtualStyle:{cursor:"crosshair",graphicName:"circle",pointRadius:f,fillColor:"white",fillOpacity:0.5,strokeColor:"#3c5cff",strokeOpacity:0.8,strokeWidth:1},displayClass:"alkControlModifyFeature",title:ALKMaps.i18n("clkShapeToModify")}),f=[i,j,k,m,l,p,n,q,r,o];if(void 0!==this.controlIndex&&null!==this.controlIndex&&ALKMaps.Util.isArray(this.controlIndex)&&1<=this.controlIndex.length){m=[];for(p=0;p<this.controlIndex.length;p++)l=parseInt(this.controlIndex[p],10),!isNaN(l)&&0<=l&&l<f.length&&m.push(f[l]);
1<=m.length&&(f=m)}this.addControls(f);var t=new ALKMaps.Control.PointMenu(a);this.layer.map.addControl(t);var s=function(){q.unsetFeature()};q.events.register("activate",this,function(){this.layer.map.events.register("click",this,s)});q.events.register("deactivate",this,function(){this.layer.map.events.unregister("click",this,s)});r.events.register("activate",this,function(){0<this.layer.selectedFeatures.length&&r.selectFeature(this.layer.selectedFeatures[0])});o.events.register("deactivate",this,
function(){for(var a in this.layer.selectedFeatures)o.unselect(this.layer.selectedFeatures[a])});i.events.register("activate",this,function(){t.activate()});i.featureAdded=function(a){if(null==a.style){var b=a.layer.styleMap.createSymbolizer(a);b.graphicName=t.pointName;b.pointRadius=t.pointSize;a.style=b;a.layer.drawFeature(a)}};i.events.register("deactivate",this,function(){t.deactivate()});j.featureAdded=function(a){if(null==a.style){var b=a.layer.styleMap.createSymbolizer(a);b.strokeWidth=3;a.style=
b;a.layer.drawFeature(a)}};k.featureAdded=function(a){if(null==a.style){var b=a.layer.styleMap.createSymbolizer(a);b.strokeWidth=3;a.style=b;a.layer.drawFeature(a)}};a.styleMap.styles["default"]=d;a.styleMap.styles.select=e;a.styleMap.styles.transform=g;a.styleMap.styles.modify=h},draw:function(){var a=ALKMaps.Control.Panel.prototype.draw.apply(this,arguments);a.className="olControlALKPanel "+a.className;return a},activate:function(){ALKMaps.Control.Panel.prototype.activate.apply(this,arguments);
this.layer.getVisibility()||this.layer.setVisibility(!0)},deactivate:function(){ALKMaps.Control.Panel.prototype.deactivate.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.EditPanel"});ALKMaps.Control.DrawFeature=ALKMaps.Class(ALKMaps.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},handlerOptions:null,initialize:function(a,b,c){ALKMaps.Control.prototype.initialize.apply(this,[c]);this.callbacks=ALKMaps.Util.extend({done:this.drawFeature,modify:function(a,b){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:b})},create:function(a,b){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:b})}},this.callbacks);this.layer=a;this.handlerOptions=
this.handlerOptions||{};this.handlerOptions.layerOptions=ALKMaps.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:a.renderers,rendererOptions:a.rendererOptions});if(!("multi"in this.handlerOptions))this.handlerOptions.multi=this.multi;if(a=this.layer.styleMap&&this.layer.styleMap.styles.temporary)this.handlerOptions.layerOptions=ALKMaps.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new ALKMaps.StyleMap({"default":a})});this.handler=new b(this,this.callbacks,this.handlerOptions)},
drawFeature:function(a){a=new ALKMaps.Feature.Vector(a);if(!1!==this.layer.events.triggerEvent("sketchcomplete",{feature:a}))a.state=ALKMaps.State.INSERT,this.layer.addFeatures([a]),this.featureAdded(a),this.events.triggerEvent("featureadded",{feature:a})},insertXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertXY(a,b)},insertDeltaXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeltaXY(a,b)},insertDirectionLength:function(a,b){this.handler&&this.handler.line&&
this.handler.insertDirectionLength(a,b)},insertDeflectionLength:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(a,b)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"ALKMaps.Control.DrawFeature"});ALKMaps.Projection=ALKMaps.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,b){ALKMaps.Util.extend(this,b);this.projCode=a;if(window.Proj4js)this.proj=new Proj4js.Proj(a)},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){var b=!1;a&&(a instanceof ALKMaps.Projection||(a=new ALKMaps.Projection(a)),window.Proj4js&&this.proj.defData&&
a.proj.defData?b=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,""):a.getCode&&(b=this.getCode(),a=a.getCode(),b=b==a||!!ALKMaps.Projection.transforms[b]&&ALKMaps.Projection.transforms[b][a]===ALKMaps.Projection.nullTransform));return b},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"ALKMaps.Projection"});ALKMaps.Projection.transforms={};
ALKMaps.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}};
ALKMaps.Projection.addTransform=function(a,b,c){if(c===ALKMaps.Projection.nullTransform){var d=ALKMaps.Projection.defaults[a];d&&!ALKMaps.Projection.defaults[b]&&(ALKMaps.Projection.defaults[b]=d)}ALKMaps.Projection.transforms[a]||(ALKMaps.Projection.transforms[a]={});ALKMaps.Projection.transforms[a][b]=c};
ALKMaps.Projection.transform=function(a,b,c){if(b&&c)if(b instanceof ALKMaps.Projection||(b=new ALKMaps.Projection(b)),c instanceof ALKMaps.Projection||(c=new ALKMaps.Projection(c)),b.proj&&c.proj)a=Proj4js.transform(b.proj,c.proj,a);else{var b=b.getCode(),c=c.getCode(),d=ALKMaps.Projection.transforms;if(d[b]&&d[b][c])d[b][c](a)}return a};ALKMaps.Projection.nullTransform=function(a){return a};
(function(){function a(a){a.x=180*a.x/d;a.y=180/Math.PI*(2*Math.atan(Math.exp(a.y/d*Math.PI))-Math.PI/2);return a}function b(a){a.x=a.x*d/180;a.y=Math.log(Math.tan((90+a.y)*Math.PI/360))/Math.PI*d;return a}function c(c,d){var e=ALKMaps.Projection.addTransform,g=ALKMaps.Projection.nullTransform,f,l,p,n,q;for(f=0,l=d.length;f<l;++f){p=d[f];e(c,p,b);e(p,c,a);for(q=f+1;q<l;++q)n=d[q],e(p,n,g),e(n,p,g)}}var d=2.003750834E7,e=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],f=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326",
"EPSG:4326"],g;for(g=e.length-1;0<=g;--g)c(e[g],f);for(g=f.length-1;0<=g;--g)c(f[g],e)})();(function(){ALKMaps.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:ALKMaps.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new ALKMaps.Events(this),makeSameOrigin:function(a,b){var c=0!==a.indexOf("http"),d=!c&&a.match(this.URL_SPLIT_REGEX);if(d){var e=window.location,c=d[1]==e.protocol&&d[3]==e.hostname,d=d[4],
e=e.port;if(80!=d&&""!=d||"80"!=e&&""!=e)c=c&&d==e}c||(b?a="function"==typeof b?b(a):b+encodeURIComponent(a):ALKMaps.Console.warn(ALKMaps.i18n("proxyNeeded"),{url:a}));return a},issue:function(a){var b,c=ALKMaps.Util.extend(this.DEFAULT_CONFIG,{proxy:ALKMaps.ProxyHost}),a=ALKMaps.Util.applyDefaults(a,c),c=!1,d;for(d in a.headers)a.headers.hasOwnProperty(d)&&"x-requested-with"===d.toLowerCase()&&(c=!0);!1===c&&(a.headers["X-Requested-With"]="XMLHttpRequest");var e=new ALKMaps.Request.XMLHttpRequest,
c=!1;try{e.setWithCredentials(a.withCredentials)}catch(f){c=!0}var g=ALKMaps.Util.urlAppend(a.url,ALKMaps.Util.getParameterString(a.params||{})),g=ALKMaps.Request.makeSameOrigin(g,a.proxy);d=window.XDomainRequest?!0:!1;var h=navigator.userAgent.match(/MSIE\s?(\d+)(?:\.(\d+))?/i),i=-1;null!=h&&(i=parseInt(h[1]));9<i&&(d=!1);if(10>i&&(!0===d||!0===c)){c="";for(b in a.headers)c+="&"+b+"="+encodeURIComponent(a.headers[b]);a.excludeAuthInfo||(!0===a.useSSOToken?ALKMaps.SSOToken&&(c+="&authToken="+encodeURIComponent(ALKMaps.SSOToken)):
ALKMaps.APIKey&&(c+="&authToken="+encodeURIComponent(ALKMaps.Util.getApiKey())));a.withCredentials&&(c+="&cookies="+encodeURIComponent(document.cookie));g=-1===g.indexOf("?")?g+"?"+c.substring(1):g.indexOf("?")===g.length-1?g+c.substring(1):g+c}e.open(a.method,g,a.async,a.user,a.password);if(!d){for(b in a.headers)e.setRequestHeader(b,a.headers[b]);a.excludeAuthInfo||(!0===a.useSSOToken?ALKMaps.SSOToken&&e.setRequestHeader("Authorization",ALKMaps.SSOToken):ALKMaps.APIKey&&e.setRequestHeader("Authorization",
ALKMaps.Util.getApiKey()))}var j=this.events,k=this;e.onreadystatechange=function(){e.readyState===ALKMaps.Request.XMLHttpRequest.DONE&&!1!==j.triggerEvent("complete",{request:e,config:a,requestUrl:g})&&k.runCallbacks({request:e,config:a,requestUrl:g})};!1===a.async?e.send(a.data):window.setTimeout(function(){0!==e.readyState&&e.send(a.data)},0);return e},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?ALKMaps.Function.bind(c.callback,c.scope):c.callback,e;c.success&&(e=c.scope?ALKMaps.Function.bind(c.success,
c.scope):c.success);var f;c.failure&&(f=c.scope?ALKMaps.Function.bind(c.failure,c.scope):c.failure);if("file:"===ALKMaps.Util.createUrlObject(c.url).protocol&&b.responseText)b.status=200;d(b);if(!b.status||200<=b.status&&300>b.status)this.events.triggerEvent("success",a),e&&e(b);if(b.status&&(200>b.status||300<=b.status))this.events.triggerEvent("failure",a),f&&f(b)},GET:function(a){a=ALKMaps.Util.extend(a,{method:"GET"});return ALKMaps.Request.issue(a)},POST:function(a){a=ALKMaps.Util.extend(a,{method:"POST"});
a.headers=a.headers||{};"CONTENT-TYPE"in ALKMaps.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return ALKMaps.Request.issue(a)},PUT:function(a){a=ALKMaps.Util.extend(a,{method:"PUT"});a.headers=a.headers||{};"CONTENT-TYPE"in ALKMaps.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return ALKMaps.Request.issue(a)},DELETE:function(a){a=ALKMaps.Util.extend(a,{method:"DELETE"});a.headers=a.headers||{};"CONTENT-TYPE"in ALKMaps.Util.upperCaseObject(a.headers)||
(a.headers["Content-Type"]="application/xml");return ALKMaps.Request.issue(a)},HEAD:function(a){a=ALKMaps.Util.extend(a,{method:"HEAD"});return ALKMaps.Request.issue(a)},OPTIONS:function(a){a=ALKMaps.Util.extend(a,{method:"OPTIONS"});return ALKMaps.Request.issue(a)},parseJSONReponse:function(a){var b=null;null!=a.responseText&&0<a.responseText.length&&(b=JSON.parse(a.responseText));return b},makeSmartRequest:function(a,b,c){if(window.XDomainRequest&&!1===a.async)alert("sync is not cross-browser. Change your code using asynchronous call.");
else{var d=ALKMaps.Util.extend(d,a);if("function"===typeof a.success)d.success=function(b){b=c(b);a.success(b)};b=b(d);if(!1===a.async)return c(b)}}}})();ALKMaps.Geocoder=ALKMaps.Geocoder||{};
(function(){ALKMaps.Geocoder.reverseGeocode=function(a){var b=ALKMaps.Util.getRegion(a.region),c;c=null!=a.dataset?ALKMaps.Util.getDataSet(a.dataset):ALKMaps.Util.getDatasetFromRegion(b);b={coords:[a.lonLat.lon||a.latLng.lng,a.lonLat.lat||a.latLng.lat],region:b,dataset:c};if("boolean"===typeof a.matchNamedRoadsOnly)b.matchNamedRoadsOnly=a.matchNamedRoadsOnly;if(!isNaN(a.maxCleanupMiles))b.maxCleanupMiles=a.maxCleanupMiles;return ALKMaps.Request.makeSmartRequest({url:ALKMaps.GeocodeServiceURL+"locations",
async:a.async,params:b,withCredentials:!1,success:a.success,failure:a.failure},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};ALKMaps.Geocoder.geocode=function(a){var b=a.address,c=ALKMaps.Util.getRegion(b.region),d;d=null!=b.dataset?ALKMaps.Util.getDataSet(b.dataset):ALKMaps.Util.getDatasetFromRegion(c);var e=1;if("number"===typeof a.listSize)e=a.listSize;return ALKMaps.Request.makeSmartRequest({url:ALKMaps.GeocodeServiceURL+"locations",async:a.async,params:{street:b.addr,city:b.city,state:b.state,
postcode:b.zip,country:b.country,postcodeFilter:b.postcodefilter,splc:b.splc,list:e,region:c,dataset:d,searchString:b.searchString},withCredentials:!1,success:function(b){var c=!1,d="";if(b.constructor===Array&&null!=b[0].Errors)for(var e=0;e<b[0].Errors.length;e++)if(1===b[0].Errors[e].Type){c=!0;d=b[0].Errors[e].Description;break}!0===c?a.failure({status:777,statusText:"Unknown Error",responseText:d}):a.success(b)},failure:a.failure},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};ALKMaps.Geocoder.simpleGeocode=
function(a){var b=a.address;b.region=ALKMaps.Util.getRegion(b.region);b.dataset=null!=b.dataset?ALKMaps.Util.getDataSet(b.dataset):ALKMaps.Util.getDatasetFromRegion(b.region);return ALKMaps.Request.makeSmartRequest(a,ALKMaps.Geocoder.geocode,function(a){return new ALKMaps.LonLat(a[0].Coords.Lon,a[0].Coords.Lat)})};ALKMaps.Geocoder.singleSearchGetBaseUrl=function(a){var b=ALKMaps.Geocoder.singleSearchGetRegions(),a="EU"===a||"3"===a||3===a?b[1]:"NA"===a||"4"===a||4===a?b[0]:b[2];return ALKMaps.SingleSearchURL+
a+"/api/search"};ALKMaps.Geocoder.singleSearch=function(a){var a=a||{},b=a.query,c=a.maxResults||20,d=null;a.currentLonLat instanceof ALKMaps.LonLat&&(d=a.currentLonLat.toShortString());b={url:ALKMaps.Geocoder.singleSearchGetBaseUrl(a.region),async:a.async,withCredentials:!1,params:{query:b,maxResults:c,currentLonLat:d,excludedSearchTypes:a.excludedSearchTypes,poiCategories:a.poiCategories,countries:a.countries,countryType:a.countryType,states:a.states},success:function(b){"function"===typeof a.success&&
a.success(b)},failure:function(b){"function"===typeof a.failure&&a.failure(b)}};return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};ALKMaps.Geocoder.singleSearchGet=function(a){a=a||{};if(!("states"!==a.query&&"countries"!==a.query&&"types"!==a.query&&"poiCategories"!==a.query&&"resultTypes"!==a.query)){var b={url:ALKMaps.Geocoder.singleSearchGetBaseUrl(a.region)+"/"+a.query,async:a.async,withCredentials:!1,success:function(b){"function"===typeof a.success&&
a.success(b)},failure:function(b){"function"===typeof a.failure&&a.failure(b)}};return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)}};ALKMaps.Geocoder.singleSearchGetRegions=function(){return["NA","EU","WW"]};ALKMaps.Geocoder.singleSearchGetCountryTypes=function(){return["ISO","FIPS","GENC2","GENC3"]}})();ALKMaps.Map=ALKMaps.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:!0,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:900913",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,
minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:ALKMaps.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,loadingDiv:null,loadingCounter:0,autoAdjustZoomControl:!0,allowSafeScroll:!0,timeoutId:null,safeScrollListener:null,panLock:!1,_isInitialized:!1,initialize:function(a,b){1===arguments.length&&"object"===typeof a&&(a=(b=a)&&b.div);this.tileSize=new ALKMaps.Size(ALKMaps.Map.TILE_WIDTH,
ALKMaps.Map.TILE_HEIGHT);this.maxExtent=new ALKMaps.Bounds(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7);this.paddingForPopups=new ALKMaps.Bounds(15,15,15,15);var c=ALKMaps._getScriptLocation()+"theme/default/";this.theme=9>parseFloat(navigator.appVersion.split("MSIE")[1])?c+"ie8-style.css":c+"style.css";this.options=ALKMaps.Util.extend({},b);ALKMaps.Util.extend(this,b);ALKMaps.Util.applyDefaults(this,ALKMaps.Projection.defaults[this.projection instanceof ALKMaps.Projection?this.projection.projCode:
this.projection]);if(this.maxExtent&&!(this.maxExtent instanceof ALKMaps.Bounds))this.maxExtent=new ALKMaps.Bounds(this.maxExtent);if(this.minExtent&&!(this.minExtent instanceof ALKMaps.Bounds))this.minExtent=new ALKMaps.Bounds(this.minExtent);if(this.restrictedExtent&&!(this.restrictedExtent instanceof ALKMaps.Bounds))this.restrictedExtent=new ALKMaps.Bounds(this.restrictedExtent);if(this.center&&!(this.center instanceof ALKMaps.LonLat))this.center=new ALKMaps.LonLat(this.center);this.layers=[];
this.id=ALKMaps.Util.createUniqueID("ALKMaps.Map_");this.div=ALKMaps.Util.getElement(a);if(!this.div)this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px";ALKMaps.Element.addClass(this.div,"olMap");c=this.id+"_ALKMaps_ViewPort";this.viewPortDiv=ALKMaps.Util.createDiv(c,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);
this.events=new ALKMaps.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0});c=this.id+"_ALKMaps_Container";this.layerContainerDiv=ALKMaps.Util.createDiv(c);this.layerContainerDiv.style.width="100px";this.layerContainerDiv.style.height="100px";this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);9>parseFloat(navigator.appVersion.split("MSIE")[1])?
this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=ALKMaps.Function.bind(this.updateSize,this),ALKMaps.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){for(var c=!0,d=document.getElementsByTagName("link"),e=0,f=d.length;e<f;++e)if(ALKMaps.Util.isEquivalentUrl(d.item(e).href,this.theme)){c=!1;break}c&&(c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(c))}if(null===
this.controls)this.controls=[],this.controls=null!==ALKMaps.Control?[new ALKMaps.Control.Navigation,ALKMaps.isTouch?new ALKMaps.Control.TouchZoom:new ALKMaps.Control.PanZoomBar,new ALKMaps.Control.ArgParser,new ALKMaps.Control.ScaleLine,new ALKMaps.Control.KeyboardDefaults,new ALKMaps.Control.InfoWarning]:[];c=0;for(d=this.controls.length;c<d;c++)this.addControlToMap(this.controls[c]);this.popups=[];this.unloadDestroy=ALKMaps.Function.bind(this.destroy,this);ALKMaps.Event.observe(window,"unload",
this.unloadDestroy);c=new ALKMaps.Layer.BaseMap(this.id+"_ALKMaps.Layer.BaseMap",{},{displayInLayerSwitcher:!1});b||this.addLayer(c);if(b&&!b.layers)b.layers=[],b.layers.push(c);if(b&&b.layers){d=!1;for(e=0;e<b.layers.length;e++)if("ALKMaps.Layer.BaseMap"===b.layers[e].CLASS_NAME){d=!0;break}!1===d&&b.layers.push(c);delete this.center;this.addLayers(b.layers);b.center&&!this.getCenter()&&this.setCenter(b.center,b.zoom)}this._isInitialized=!0;this.adjustZoomControl();this.allowSafeScroll&&this.enableSafeScroll();
this.onPositionChanged=ALKMaps.Function.bind(this.updateSize,this);ALKMaps.Event.observe(this.div,"mouseover",this.onPositionChanged)},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=ALKMaps.Util.getElement(a);ALKMaps.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;if(this.panTween)this.panTween.stop(),
this.panTween=null;ALKMaps.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy?ALKMaps.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize);this.paddingForPopups=null;if(null!==this.controls){for(var a=this.controls.length-1;0<=a;--a)this.controls[a].destroy();this.controls=null}if(null!==this.layers){for(a=this.layers.length-1;0<=a;--a)this.layers[a].destroy(!1);this.layers=null}this.viewPortDiv&&
this.div.removeChild(this.viewPortDiv);this.viewPortDiv=null;if(this.eventListeners)this.events.un(this.eventListeners),this.eventListeners=null;this.events.destroy();this.events=null;if(null!==this.layers)for(var a=0,b=this.layers.length;a<b;a++){var c=this.layers[a];c.events.unregister("loadend",c,c.updateInfoWarning)}this.options=null;this.disableSafeScroll()},setOptions:function(a){var b=this.minPx&&a.restrictedExtent!=this.restrictedExtent;ALKMaps.Util.extend(this,a);b&&this.moveTo(this.getCachedCenter(),
this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var d="function"==typeof c.test;return ALKMaps.Array.filter(this[a],function(a){return a[b]==c||d&&c.test(a[b])})},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",
a)},getLayer:function(a){for(var b=null,c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.id==a){b=e;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+5*b)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a<b;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){if("ALKMaps.Layer.BaseMap"===a.CLASS_NAME)for(var b=0,c=this.layers.length;b<c;b++){var d=this.layers[b];if("ALKMaps.Layer.BaseMap"===d.CLASS_NAME&&
d.name===this.id+"_ALKMaps.Layer.BaseMap"){this.removeLayer(d);break}}b=0;for(c=this.layers.length;b<c;b++)if(this.layers[b]==a)return a=ALKMaps.i18n("layerAlreadyAdded",{layerName:a.name}),ALKMaps.Console.warn(a),!1;if(!1===this.events.triggerEvent("preaddlayer",{layer:a}))return!1;if(this.allOverlays)a.isBaseLayer=!1;a.div.className="olLayerDiv";a.div.style.overflow="";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);
this.layers.push(a);a.setMap(this);a.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(a):a.setVisibility(!1):a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();a.events.register("loadend",a,a.updateInfoWarning);return!0},addLayers:function(a){for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},removeLayer:function(a,b){a&&a.events&&a.events.unregister("loadend",a,a.updateInfoWarning);if(!1!==
this.events.triggerEvent("preremovelayer",{layer:a})){null==b&&(b=!0);a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);ALKMaps.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a&&(this.baseLayer=null,b))for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.isBaseLayer||this.allOverlays){this.setBaseLayer(e);break}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed",
{map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return ALKMaps.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);if(0>b)b=0;else if(b>this.layers.length)b=this.layers.length;if(c!=b){this.layers.splice(c,1);this.layers.splice(b,0,a);for(var c=0,d=this.layers.length;c<d;c++)this.setLayerZIndex(this.layers[c],c);this.events.triggerEvent("changelayer",{layer:a,property:"order"});this.allOverlays&&(0===b?this.setBaseLayer(a):
this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a){if(a!=this.baseLayer&&-1!=ALKMaps.Util.indexOf(this.layers,a)){var b=this.getCachedCenter(),c=ALKMaps.Util.getResolutionFromScale(this.getScale(),a.units);null!=this.baseLayer&&!this.allOverlays&&this.baseLayer.setVisibility(!1);this.baseLayer=a;if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0),
!1===this.baseLayer.inRange&&this.baseLayer.redraw();null!=b&&(a=this.getZoomForResolution(c||this.resolution,!0),this.setCenter(b,a,!1,!0));this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a);this.addControlToMap(a,b)},addControls:function(a,b){for(var c=1===arguments.length?[]:b,d=0,e=a.length;d<e;d++)this.addControl(a[d],c[d]?c[d]:null)},addControlToMap:function(a,b){a.outsideViewport=null!=a.div;if(this.displayProjection&&!a.displayProjection)a.displayProjection=
this.displayProjection;a.setMap(this);var c=a.draw(b);if(c&&!a.outsideViewport)c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c);a.autoActivate&&a.activate()},getControl:function(a){for(var b=null,c=0,d=this.controls.length;c<d;c++){var e=this.controls[c];if(e.id==a){b=e;break}}return b},removeControl:function(a){a&&a==this.getControl(a.id)&&(a.div&&a.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(a.div),ALKMaps.Util.removeItem(this.controls,
a))},addPopup:function(a,b){if(b)for(var c=this.popups.length-1;0<=c;--c)this.removePopup(this.popups[c]);a.map=this;this.popups.push(a);if(c=a.draw())c.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(c)},removePopup:function(a){ALKMaps.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;null!=this.size&&(a=this.size.clone());return a},updateSize:function(){var a=this.getCurrentSize();
if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();if(null==b)this.size=b=a;if(!a.equals(b)){this.size=a;a=0;for(b=this.layers.length;a<b;a++)this.layers[a].onMapResize();a=this.getCachedCenter();if(null!=this.baseLayer&&null!=a)b=this.getZoom(),this.zoom=null,this.setCenter(a,b)}}this.adjustZoomControl()},getCurrentSize:function(){var a=new ALKMaps.Size(this.div.clientWidth,this.div.clientHeight);if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=this.div.offsetWidth,a.h=
this.div.offsetHeight;if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height);return a},calculateBounds:function(a,b){var c=null;null==a&&(a=this.getCachedCenter());null==b&&(b=this.getResolution());if(null!=a&&null!=b)var c=this.size.w*b/2,d=this.size.h*b/2,c=new ALKMaps.Bounds(a.lon-c,a.lat-d,a.lon+c,a.lat+d);return c},enableContextMenu:function(){this.div.oncontextmenu=null},disableContextMenu:function(){this.div.oncontextmenu=function(a){a=
a?a:window.event;if(a.preventDefault)a.preventDefault();else return!1}},getCenter:function(){var a=null,b=this.getCachedCenter();b&&(a=b.clone());return a},getCachedCenter:function(){if(!this.center&&this.size)this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2});return this.center},getZoom:function(){return this.zoom},pan:function(a,b,c){c=ALKMaps.Util.applyDefaults(c,{animate:!0,dragging:!1});if(c.dragging)(0!=a||0!=b)&&this.moveByPx(a,b);else{var d=this.getViewPortPxFromLonLat(this.getCachedCenter()),
a=d.add(a,b);if(this.dragging||!a.equals(d))if(d=this.getLonLatFromViewPortPx(a),c.animate)this.panTo(d);else if(this.moveTo(d),this.dragging)this.dragging=!1,this.events.triggerEvent("moveend")}},panTo:function(a){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(a)){if(!this.panTween)this.panTween=new ALKMaps.Tween(this.panMethod);var b=this.getCachedCenter();if(!a.equals(b)){var b=this.getPixelFromLonLat(b),c=this.getPixelFromLonLat(a),d=0,e=0;this.panTween.start({x:0,y:0},
{x:c.x-b.x,y:c.y-b.y},this.panDuration,{callbacks:{eachStep:ALKMaps.Function.bind(function(a){this.moveByPx(a.x-d,a.y-e);d=Math.round(a.x);e=Math.round(a.y)},this),done:ALKMaps.Function.bind(function(){this.moveTo(a);this.dragging=!1;this.events.triggerEvent("moveend")},this)}})}}else this.setCenter(a)},setCenter:function(a,b,c,d){var e=ALKMaps.Util.getBrowserName();if(ALKMaps.String.startsWith(e,"msie")&&"EPSG:900913"===this.getProjection()&&null!=a&&(null==b||null==d)){e=b;null==b&&(e=this.getZoom());
var f=this.getCachedCenter();if(null!=f){var g=new ALKMaps.Geometry.Point(a.lon,a.lat),f=new ALKMaps.Geometry.Point(f.lon,f.lat);6378137<g.distanceTo(f)&&(b=e,d=!0)}}this.panTween&&this.panTween.stop();this.moveTo(a,b,{dragging:c,forceZoomChange:d})},moveByPx:function(a,b){var c=this.size.w/2,d=this.size.h/2,e=c+a,f=d+b,g=this.baseLayer.wrapDateLine,h=0,i=0;this.restrictedExtent&&(h=c,i=d,g=!1);a=g||e<=this.maxPx.x-h&&e>=this.minPx.x+h?Math.round(a):0;b=f<=this.maxPx.y-i&&f>=this.minPx.y+i?Math.round(b):
0;if(a||b){if(!this.dragging)this.dragging=!0,this.events.triggerEvent("movestart");this.center=null;if(a)this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-a+"px",this.minPx.x-=a,this.maxPx.x-=a;if(b)this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-b+"px",this.minPx.y-=b,this.maxPx.y-=b;for(d=0,e=this.layers.length;d<e;++d)if(c=this.layers[d],c.visibility&&(c===this.baseLayer||c.inRange))c.moveByPx(a,b),c.events.triggerEvent("move");this.events.triggerEvent("move")}},
adjustZoom:function(a){var b=this.baseLayer.resolutions,c=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(a)>c)for(var d=a|0,e=b.length;d<e;++d)if(b[d]<=c){a=d;break}return a},moveTo:function(a,b,c){null!=a&&!(a instanceof ALKMaps.LonLat)&&(a=new ALKMaps.LonLat(a));c||(c={});null!=b&&(b=parseFloat(b),this.fractionalZoom||(b=Math.round(b)));if(this.baseLayer.wrapDateLine){var d=b,b=this.adjustZoom(b);b!==d&&(!0===this.baseLayer.displayOutsideMaxExtent&&0<b&&(b-=1),a=this.getCenter())}var d=
c.dragging||this.dragging,e=c.forceZoomChange;if(!this.getCachedCenter()&&!this.isValidLonLat(a))a=this.maxExtent.getCenterLonLat(),this.center=a.clone();if(null!=this.restrictedExtent){if(null==a)a=this.center;null==b&&(b=this.getZoom());var f=this.getResolutionForZoom(b),f=this.calculateBounds(a,f);if(!this.restrictedExtent.containsBounds(f)){var g=this.restrictedExtent.getCenterLonLat();f.getWidth()>this.restrictedExtent.getWidth()?a=new ALKMaps.LonLat(g.lon,a.lat):f.left<this.restrictedExtent.left?
a=a.add(this.restrictedExtent.left-f.left,0):f.right>this.restrictedExtent.right&&(a=a.add(this.restrictedExtent.right-f.right,0));f.getHeight()>this.restrictedExtent.getHeight()?a=new ALKMaps.LonLat(a.lon,g.lat):f.bottom<this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-f.bottom):f.top>this.restrictedExtent.top&&(a=a.add(0,this.restrictedExtent.top-f.top))}}e=e||this.isValidZoomLevel(b)&&b!=this.getZoom();if(null!=this.baseLayer.restrictedMaxZoom&&b>this.baseLayer.restrictedMaxZoom)b=
this.baseLayer.restrictedMaxZoom,e=!0;f=this.isValidLonLat(a)&&!a.equals(this.center);if(e||f||d){d||this.events.triggerEvent("movestart");if(f)!e&&this.center&&this.centerLayerContainer(a),this.center=a.clone();a=e?this.getResolutionForZoom(b):this.getResolution();if(e||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px";var f=this.getMaxExtent({restricted:!0}),h=f.getCenterLonLat(),g=this.center.lon-
h.lon,h=h.lat-this.center.lat,i=Math.round(f.getWidth()/a),j=Math.round(f.getHeight()/a);this.minPx={x:(this.size.w-i)/2-g/a,y:(this.size.h-j)/2-h/a};this.maxPx={x:this.minPx.x+Math.round(f.getWidth()/a),y:this.minPx.y+Math.round(f.getHeight()/a)}}if(e)this.zoom=b,this.resolution=a;a=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(a,e,c.dragging),c.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:e}));a=this.baseLayer.getExtent();for(b=this.layers.length-1;0<=
b;--b)if(f=this.layers[b],f!==this.baseLayer&&!f.isBaseLayer){g=f.calculateInRange();if(f.inRange!=g)(f.inRange=g)||f.display(!1),this.events.triggerEvent("changelayer",{layer:f,property:"visibility"});g&&f.visibility&&(f.moveTo(a,e,c.dragging),c.dragging||f.events.triggerEvent("moveend",{zoomChanged:e}))}this.events.triggerEvent("move");d||this.events.triggerEvent("moveend");if(e){b=0;for(c=this.popups.length;b<c;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var b=
this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);if(null!=b&&null!=c){var d=parseInt(this.layerContainerDiv.style.left),a=parseInt(this.layerContainerDiv.style.top),e=Math.round(b.x-c.x),b=Math.round(b.y-c.y);this.layerContainerDiv.style.left=e+"px";this.layerContainerDiv.style.top=b+"px";d-=e;a-=b;this.minPx.x-=d;this.maxPx.x-=d;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(a){return null!=a&&0<=a&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=
!1;null!=a&&(b=this.getMaxExtent(),b=b.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&&b}));return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():null},getProjectionObject:function(){var a=null;if(null!=this.baseLayer)a=this.baseLayer.projection;return a},getMaxResolution:function(){var a=null;if(null!=this.baseLayer)a=this.baseLayer.maxResolution;return a},getMaxExtent:function(a){var b=null;if(a&&a.restricted&&this.restrictedExtent)b=this.restrictedExtent;
else if(null!=this.baseLayer)b=this.baseLayer.maxExtent;return b},getNumZoomLevels:function(){var a=null;if(null!=this.baseLayer)a=this.baseLayer.numZoomLevels;return a},getExtent:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;null!=this.baseLayer?a=this.baseLayer.getResolution():!0===this.allOverlays&&0<this.layers.length&&(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;if(null!=this.baseLayer)a=
this.baseLayer.units;return a},getScale:function(){var a=null;null!=this.baseLayer&&(a=this.getResolution(),a=ALKMaps.Util.getScaleFromResolution(a,this.baseLayer.units));return a},getZoomForExtent:function(a,b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForExtent(a,b));return c},getResolutionForZoom:function(a){var b=null;this.baseLayer&&(b=this.baseLayer.getResolutionForZoom(a));return b},getZoomForResolution:function(a,b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForResolution(a,
b));return c},zoomTo:function(a){this.isValidZoomLevel(a)&&this.setCenter(null,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,b){a instanceof ALKMaps.Bounds||(a=new ALKMaps.Bounds(a));var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){c=this.getMaxExtent();for(a=a.clone();a.right<a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)}this.setCenter(c,this.getZoomForExtent(a,b))},zoomToMaxExtent:function(a){this.zoomToExtent(this.getMaxExtent({restricted:a?
a.restricted:!0}))},zoomToScale:function(a,b){var c=ALKMaps.Util.getResolutionFromScale(a,this.baseLayer.units),d=this.size.w*c/2,c=this.size.h*c/2,e=this.getCachedCenter();this.zoomToExtent(new ALKMaps.Bounds(e.lon-d,e.lat-c,e.lon+d,e.lat+c),b)},getLonLatFromViewPortPx:function(a){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getLonLatFromViewPortPx(a));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getViewPortPxFromLonLat(a));return b},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},
getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var b=a?this.getLonLatFromPixel(a):this.getCachedCenter()||new ALKMaps.LonLat(0,0),c=this.getResolution(),a=b.add(-c/2,0),d=b.add(c/2,0),e=b.add(0,-c/2),b=b.add(0,c/2),c=new ALKMaps.Projection("EPSG:4326"),f=this.getProjectionObject()||c;f.equals(c)||(a.transform(f,c),d.transform(f,c),e.transform(f,c),b.transform(f,c));return new ALKMaps.Size(ALKMaps.Util.distVincenty(a,
d),ALKMaps.Util.distVincenty(e,b))},getViewPortPxFromLayerPx:function(a){var b=null;if(null!=a)var b=parseInt(this.layerContainerDiv.style.left),c=parseInt(this.layerContainerDiv.style.top),b=a.add(b,c);return b},getLayerPxFromViewPortPx:function(a){var b=null;if(null!=a){var b=-parseInt(this.layerContainerDiv.style.left),c=-parseInt(this.layerContainerDiv.style.top),b=a.add(b,c);if(isNaN(b.x)||isNaN(b.y))b=null}return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},
getLayerPxFromLonLat:function(a){return this.getLayerPxFromViewPortPx(this.getPixelFromLonLat(a))},showLoading:function(){},hideLoading:function(){},showMapLoadingIcon:function(){},adjustZoomControl:function(){if(this._isInitialized&&!ALKMaps.isTouch&&this.autoAdjustZoomControl)if(350>this.viewPortDiv.clientHeight)for(var a=this.controls.length-1;0<=a;a--)"ALKMaps.Control.PanZoomBar"===this.controls[a].CLASS_NAME&&(this.controls[a].destroy(),this.addControl(new ALKMaps.Control.MiniPanZoom));else for(a=
this.controls.length-1;0<=a;a--)"ALKMaps.Control.MiniPanZoom"===this.controls[a].CLASS_NAME&&(this.controls[a].destroy(),this.addControl(new ALKMaps.Control.PanZoomBar))},enableSafeScroll:function(){this.safeScrollListener=ALKMaps.Function.bindAsEventListener(this.safeScroll,this);ALKMaps.Event.observe(window,"scroll",this.safeScrollListener);this.allowSafeScroll=!0},disableSafeScroll:function(){ALKMaps.Event.stopObserving(window,"scroll",this.safeScrollListener);this.safeScrollListener=null;this.allowSafeScroll=
!1},safeScroll:function(){window.clearTimeout(this.timeoutId);var a=this.getControlsByClass("ALKMaps.Control.Navigation");if(0<a.length){for(var b=0;b<a.length;b++)a[b].disableZoomWheel();this.timeoutId=window.setTimeout(function(){for(var b=0;b<a.length;b++)a[b].enableZoomWheel()},500)}},reverseGeocode:function(a){var b=this.getProjectionObject();if(null!=a.lonLat)a.lonLat=a.lonLat.transform(b,new ALKMaps.Projection("EPSG:4326"));if(null==a.region&&null!=this.baseLayer&&null!=this.baseLayer.params&&
null!=this.baseLayer.params.REGION)a.region=this.baseLayer.params.REGION;var c={};c.lonLat=a.lonLat;c.region=a.region;c.success=function(c){if("function"===typeof a.success){for(var e,f,g=0;g<c.length;g++)e=parseFloat(c[g].Coords.Lon),f=parseFloat(c[g].Coords.Lat),e=(new ALKMaps.LonLat(e,f)).transform(new ALKMaps.Projection("EPSG:4326"),b),c[g].Coords.Lon=e.lon.toString(),c[g].Coords.Lat=e.lat.toString();a.success(c)}};c.failure=a.failure;if(null!=a.async)c.async=a.async;return ALKMaps.Geocoder.reverseGeocode(c)},
geocode:function(a){var b=this.getProjectionObject();if(null!=a.address&&null==a.address.region&&null!=this.baseLayer&&null!=this.baseLayer.params&&null!=this.baseLayer.params.REGION)a.address.region=this.baseLayer.params.REGION;var c={};c.address=a.address;c.address.region=a.address.region;c.success=function(c){if("function"===typeof a.success){for(var e,f,g=0;g<c.length;g++)e=parseFloat(c[g].Coords.Lon),f=parseFloat(c[g].Coords.Lat),e=(new ALKMaps.LonLat(e,f)).transform(new ALKMaps.Projection("EPSG:4326"),
b),c[g].Coords.Lon=e.lon.toString(),c[g].Coords.Lat=e.lat.toString();a.success(c)}};c.failure=a.failure;if(null!=a.listSize)c.listSize=a.listSize;if(null!=a.async)c.async=a.async;return ALKMaps.Geocoder.geocode(c)},simpleGeocode:function(a){var b,c=this.getProjectionObject();if(null!=a.address&&null==a.address.region&&null!=this.baseLayer&&null!=this.baseLayer.params&&null!=this.baseLayer.params.REGION)a.address.region=this.baseLayer.params.REGION;var d={};d.address=a.address;d.address.region=a.address.region;
d.success=function(d){"function"===typeof a.success&&(d instanceof ALKMaps.LonLat&&(b=d.clone().transform(new ALKMaps.Projection("EPSG:4326"),c)),a.success(b))};d.failure=a.failure;if(null!=a.async)d.async=a.async;return ALKMaps.Geocoder.simpleGeocode(d)},geoSearch:function(a){var b=this.getProjectionObject(),c={address:{}};if(null!=this.baseLayer&&null!=this.baseLayer.params&&null!=this.baseLayer.params.REGION)c.address.region=this.baseLayer.params.REGION;c.address.zip=a.place;c.success=function(c){if("function"===
typeof a.success){if(null==a.transform||!0===a.transform)for(var e,f,g=0;g<c.length;g++){if(null!=c[g].Coords)e=parseFloat(c[g].Coords.Lon),f=parseFloat(c[g].Coords.Lat),e=(new ALKMaps.LonLat(e,f)).transform(new ALKMaps.Projection("EPSG:4326"),b),c[g].Coords.Lon=e.lon.toString(),c[g].Coords.Lat=e.lat.toString();if(null!=c[g].BBox)e=c[g].BBox,e=new ALKMaps.Bounds(e.Left,e.Bottom,e.Right,e.Top),e=e.transform(new ALKMaps.Projection("EPSG:4326"),b),c[g].BBox.Left=e.left.toString(),c[g].BBox.Bottom=e.bottom.toString(),
c[g].BBox.Right=e.right.toString(),c[g].BBox.Top=e.top.toString()}a.success(c)}};c.failure=a.failure;if(null!=a.listSize)c.listSize=a.listSize;c.async=!0;return ALKMaps.Geocoder.geocode(c)},getReports:function(a){var b;if(null!=a.coords&&0<a.coords.length)for(var c=0;c<a.coords.length;c++)b=(new ALKMaps.LonLat(a.coords[c][0],a.coords[c][1])).transform(this.getProjectionObject(),new ALKMaps.Projection("EPSG:4326")),a.coords[c][0]=b.lon,a.coords[c][1]=b.lat;return ALKMaps.Services.getReports(a)},getRoutePath:function(a){var b=
this.getProjectionObject(),c=a.ioformat||{};if(null!=c.input&&1===c.input){for(var d="",e=0;e<a.stops.length;e++){a.stops[e]=a.stops[e].transform(b,new ALKMaps.Projection("EPSG:4326"));var f=[];f.push(a.stops[e].lon);f.push(a.stops[e].lat);d=d+f.toString()+(!0===(e!=a.stops.length-1)?";":"")}a.stops=d}else if(null!=c.input&&2===c.input){for(var d="",g=0;g<a.stops.length;g++)2===a.stops[g].length&&(e=(new ALKMaps.LonLat(a.stops[g][0],a.stops[g][1])).transform(b,new ALKMaps.Projection("EPSG:4326")),
f=[],f.push(e.lon),f.push(e.lat),d=d+f.toString()+(!0===(g!=a.stops.length-1)?";":""));a.stops=d}else if(d="",null!=a.stops){f=a.stops.split(";");for(g=0;g<f.length;g++)e=f[g].split(","),2===e.length&&(e=(new ALKMaps.LonLat(parseFloat(e[0]),parseFloat(e[1]))).transform(b,new ALKMaps.Projection("EPSG:4326")),d+=e.lon+","+e.lat+(!0===(g!=f.length-1)?";":""));a.stops=d}e={};e.stops=a.stops;e.options=a.options||{};e.async=a.async||!0;e.success=function(d){if("function"===typeof a.success){var e=JSON.parse(d.responseText);
if(null!=c.output&&1===c.input){d=new ALKMaps.Format.GeoJSON;d=d.read(e,"Feature").geometry.getVertices();for(e=0;e<d.length;e++)d[e]instanceof ALKMaps.Geometry.Point&&(d[e]=d[e].transform(new ALKMaps.Projection("EPSG:4326"),b))}else if(null!=c.output&&2===c.input){if(d=new ALKMaps.Format.GeoJSON,d=d.read(e,"Feature"),d instanceof ALKMaps.Feature.Vector&&null!=d.geometry&&d.geometry instanceof ALKMaps.Geometry.MultiLineString)d.geometry=d.geometry.transform(new ALKMaps.Projection("EPSG:4326"),b)}else for(var g,
d=[],e=e.geometry.coordinates,f=0;f<e.length;f++)for(var m=0;m<e[f].length;m++)g=e[f][m],2===g.length&&(g=(new ALKMaps.LonLat(g[0],g[1])).transform(new ALKMaps.Projection("EPSG:4326"),b),g=[g.lon,g.lat],d.push(g));a.success(d)}};e.failure=a.failure;ALKMaps.Services.getRoutePath(e)},getDerivedRoutePath:function(a){var b=this.getProjectionObject(),c=a.ioformat||{};if(null!=c.input&&1===c.input){for(var d="",e=0;e<a.pings.length;e++){a.pings[e]=a.pings[e].transform(b,new ALKMaps.Projection("EPSG:4326"));
var f=[];f.push(a.pings[e].lon);f.push(a.pings[e].lat);d=d+f.toString()+(!0===(e!=a.pings.length-1)?";":"")}a.pings=d}else if(null!=c.input&&2===c.input){d="";for(f=0;f<a.pings.length;f++){if(2===a.pings[f].length)e=(new ALKMaps.LonLat(a.pings[f][0],a.pings[f][1])).transform(b,new ALKMaps.Projection("EPSG:4326")),a.pings[f][0]=e.lon,a.pings[f][1]=e.lat;d=d+a.pings[f].toString()+(!0===(f!=a.pings.length-1)?";":"")}a.pings=d}else if(d="",null!=a.pings){for(var f=a.pings.split(";"),g=0;g<f.length;g++)e=
f[g].split(","),2===e.length&&(e=(new ALKMaps.LonLat(parseFloat(e[0]),parseFloat(e[1]))).transform(b,new ALKMaps.Projection("EPSG:4326")),d+=e.lon+","+e.lat+(!0===(g!=f.length-1)?";":""));a.pings=d}e={};e.pings=a.pings;e.returnJSON=!0;e.options=a.options||{};e.success=function(d){if("function"===typeof a.success){var e=d;if(null!=c.output&&1===c.input){d=new ALKMaps.Format.GeoJSON;d=d.read(e,"Feature").geometry.getVertices();for(e=0;e<d.length;e++)d[e]instanceof ALKMaps.Geometry.Point&&(d[e]=d[e].transform(new ALKMaps.Projection("EPSG:4326"),
b))}else if(null!=c.output&&2===c.input){if(d=new ALKMaps.Format.GeoJSON,d=d.read(e,"Feature"),d instanceof ALKMaps.Feature.Vector&&null!=d.geometry&&d.geometry instanceof ALKMaps.Geometry.MultiLineString)d.geometry=d.geometry.transform(new ALKMaps.Projection("EPSG:4326"),b)}else for(var g,d=[],e=e.geometry.coordinates,f=0;f<e.length;f++)for(var m=0;m<e[f].length;m++)g=e[f][m],2===g.length&&(g=(new ALKMaps.LonLat(g[0],g[1])).transform(new ALKMaps.Projection("EPSG:4326"),b),g=[g.lon,g.lat],d.push(g));
a.success(d)}};e.failure=a.failure;ALKMaps.Services.getDerivedRoutePath(e)},CLASS_NAME:"ALKMaps.Map"});ALKMaps.Map.TILE_WIDTH=256;ALKMaps.Map.TILE_HEIGHT=256;ALKMaps.Layer=ALKMaps.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales,resolutions,maxScale,minScale,maxResolution,minResolution,numZoomLevels,maxZoomLevel".split(","),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,
numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,infoWarning:"",initialize:function(a,b){this.metadata={};this.addOptions(b);this.name=a;if(null==this.id&&(this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=ALKMaps.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new ALKMaps.Events(this,this.div),this.eventListeners instanceof Object))this.events.on(this.eventListeners)},
destroy:function(a){null==a&&(a=!0);null!=this.map&&this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null},clone:function(a){null==a&&(a=new ALKMaps.Layer(this.name,this.getOptions()));ALKMaps.Util.applyDefaults(a,this);a.map=null;return a},getOptions:function(){var a={},b;for(b in this.options)a[b]=this[b];return a},setName:function(a){if(a!=
this.name)this.name=a,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})},addOptions:function(a,b){if(null==this.options)this.options={};if(a){if("string"==typeof a.projection)a.projection=new ALKMaps.Projection(a.projection);a.projection&&ALKMaps.Util.applyDefaults(a,ALKMaps.Projection.defaults[a.projection.getCode()]);if(a.maxExtent&&!(a.maxExtent instanceof ALKMaps.Bounds))a.maxExtent=new ALKMaps.Bounds(a.maxExtent);if(a.minExtent&&!(a.minExtent instanceof
ALKMaps.Bounds))a.minExtent=new ALKMaps.Bounds(a.minExtent)}ALKMaps.Util.extend(this.options,a);ALKMaps.Util.extend(this,a);if("string"==typeof this.projection)this.projection=new ALKMaps.Projection(this.projection);if(this.projection&&this.projection.getUnits())this.units=this.projection.getUnits();if(this.map){var c=this.map.getResolution(),d=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),e;for(e in a)if(a.hasOwnProperty(e)&&0<=ALKMaps.Util.indexOf(d,e)){this.initResolutions();
b&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(c),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var a=!1;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();b&&this.inRange&&this.visibility&&(this.moveTo(b,!0,!1),this.events.triggerEvent("moveend",{zoomChanged:!0}),a=!0)}return a},moveTo:function(){var a=this.visibility;this.isBaseLayer||(a=a&&this.inRange);
this.display(a)},moveByPx:function(){},setMap:function(a){if(null==this.map){this.map=a;this.maxExtent=this.maxExtent||this.map.maxExtent;this.minExtent=this.minExtent||this.map.minExtent;this.projection=this.projection||this.map.projection;if("string"==typeof this.projection)this.projection=new ALKMaps.Projection(this.projection);this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer)this.inRange=this.calculateInRange(),this.div.style.display=
this.visibility&&this.inRange?"":"none";this.setTileSize()}},afterAdd:function(){},removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();if(this.gutter)this.imageSize=new ALKMaps.Size(a.w+2*this.gutter,a.h+2*this.gutter)},getVisibility:function(){return this.visibility},setVisibility:function(a){if(a!=this.visibility)this.visibility=a,this.display(a),this.redraw(),null!=this.map&&
this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged")},display:function(a){if(a!=("none"!=this.div.style.display))this.div.style.display=a&&this.calculateInRange()?"block":"none"},calculateInRange:function(){var a=!1;this.alwaysInRange?a=!0:this.map&&(a=this.map.getResolution(),a=a>=this.minResolution&&a<=this.maxResolution);return a},setIsBaseLayer:function(a){if(a!=this.isBaseLayer)this.isBaseLayer=a,null!=this.map&&this.map.events.triggerEvent("changebaselayer",
{layer:this})},initResolutions:function(){var a,b,c,d={},e=!0;for(a=0,b=this.RESOLUTION_PROPERTIES.length;a<b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=this.options[c],e&&this.options[c]&&(e=!1);if(null==this.alwaysInRange)this.alwaysInRange=e;if(null==d.resolutions)d.resolutions=this.resolutionsFromScales(d.scales);if(null==d.resolutions)d.resolutions=this.calculateResolutions(d);if(null==d.resolutions){for(a=0,b=this.RESOLUTION_PROPERTIES.length;a<b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=null!=
this.options[c]?this.options[c]:this.map[c];if(null==d.resolutions)d.resolutions=this.resolutionsFromScales(d.scales);if(null==d.resolutions)d.resolutions=this.calculateResolutions(d)}var f;if(this.options.maxResolution&&"auto"!==this.options.maxResolution)f=this.options.maxResolution;this.options.minScale&&(f=ALKMaps.Util.getResolutionFromScale(this.options.minScale,this.units));var g;if(this.options.minResolution&&"auto"!==this.options.minResolution)g=this.options.minResolution;this.options.maxScale&&
(g=ALKMaps.Util.getResolutionFromScale(this.options.maxScale,this.units));d.resolutions&&(d.resolutions.sort(function(a,b){return b-a}),f||(f=d.resolutions[0]),g||(g=d.resolutions[d.resolutions.length-1]));if(this.resolutions=d.resolutions){b=this.resolutions.length;this.scales=Array(b);for(a=0;a<b;a++)this.scales[a]=ALKMaps.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=b}if(this.minResolution=g)this.maxScale=ALKMaps.Util.getScaleFromResolution(g,this.units);if(this.maxResolution=
f)this.minScale=ALKMaps.Util.getScaleFromResolution(f,this.units)},resolutionsFromScales:function(a){if(null!=a){var b,c,d;d=a.length;b=Array(d);for(c=0;c<d;c++)b[c]=ALKMaps.Util.getResolutionFromScale(a[c],this.units);return b}},calculateResolutions:function(a){var b,c,d=a.maxResolution;null!=a.minScale?d=ALKMaps.Util.getResolutionFromScale(a.minScale,this.units):"auto"==d&&null!=this.maxExtent&&(b=this.map.getSize(),c=this.maxExtent.getWidth()/b.w,b=this.maxExtent.getHeight()/b.h,d=Math.max(c,b));
c=a.minResolution;null!=a.maxScale?c=ALKMaps.Util.getResolutionFromScale(a.maxScale,this.units):"auto"==a.minResolution&&null!=this.minExtent&&(b=this.map.getSize(),c=this.minExtent.getWidth()/b.w,b=this.minExtent.getHeight()/b.h,c=Math.max(c,b));"number"!==typeof d&&"number"!==typeof c&&null!=this.maxExtent&&(d=this.map.getTileSize(),d=Math.max(this.maxExtent.getWidth()/d.w,this.maxExtent.getHeight()/d.h));b=a.maxZoomLevel;a=a.numZoomLevels;"number"===typeof c&&"number"===typeof d&&void 0===a?a=
Math.floor(Math.log(d/c)/Math.log(2))+1:void 0===a&&null!=b&&(a=b+1);if(!("number"!==typeof a||0>=a||"number"!==typeof d&&"number"!==typeof c)){b=Array(a);var e=2;"number"==typeof c&&"number"==typeof d&&(e=Math.pow(d/c,1/(a-1)));var f;if("number"===typeof d)for(f=0;f<a;f++)b[f]=d/Math.pow(e,f);else for(f=0;f<a;f++)b[a-1-f]=c*Math.pow(e,f);return b}},getResolution:function(){return this.getResolutionForZoom(this.map.getZoom())},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,
b){var c=this.map.getSize();return this.getZoomForResolution(Math.max(a.getWidth()/c.w,a.getHeight()/c.h),b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom)var b=Math.floor(a),c=Math.ceil(a),a=this.resolutions[b]-(a-b)*(this.resolutions[b]-this.resolutions[c]);else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a,b){var c,d;if(this.map.fractionalZoom){var e=0,f=this.resolutions[e],
g=this.resolutions[this.resolutions.length-1],h;for(c=0,d=this.resolutions.length;c<d;++c)if(h=this.resolutions[c],h>=a&&(f=h,e=c),h<=a){g=h;break}c=f-g;c=0<c?e+(f-a)/c:e}else{f=Number.POSITIVE_INFINITY;for(c=0,d=this.resolutions.length;c<d;c++)if(b){e=Math.abs(this.resolutions[c]-a);if(e>f)break;f=e}else if(this.resolutions[c]<a)break;c=Math.max(0,c-1)}return c},getLonLatFromViewPortPx:function(a){var b=null,c=this.map;if(null!=a&&c.minPx){var b=c.getResolution(),d=c.getMaxExtent({restricted:!0}),
b=new ALKMaps.LonLat((a.x-c.minPx.x)*b+d.left,(c.minPx.y-a.y)*b+d.top);this.wrapDateLine&&(b=b.wrapDateLine(this.maxExtent))}return b},getViewPortPxFromLonLat:function(a,b){var c=null;null!=a&&(b=b||this.map.getResolution(),c=this.map.calculateBounds(null,b),c=new ALKMaps.Pixel(1/b*(a.lon-c.left),1/b*(c.top-a.lat)));return c},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,d=b.length;c<d;++c){var e=b[c].firstChild||b[c],f=b[c].lastChild;if(f&&"iframe"===
f.nodeName.toLowerCase())e=f.parentNode;ALKMaps.Util.modifyDOMElement(e,null,null,null,null,null,null,a)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter)var b=this.gutter*this.map.getResolution(),a=new ALKMaps.Bounds(a.left-b,a.bottom-b,a.right+b,a.top+b);this.wrapDateLine&&(b={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()},
a=a.wrapDateLine(this.maxExtent,b));return a},updateInfoWarning:function(){},CLASS_NAME:"ALKMaps.Layer"});ALKMaps.Layer.Markers=ALKMaps.Class(ALKMaps.Layer,{isBaseLayer:!1,markers:null,drawn:!1,strategies:null,xOffset:0,initialize:function(a,b){ALKMaps.Layer.prototype.initialize.apply(this,arguments);this.markers=[];if(this.strategies)for(var c=0,d=this.strategies.length;c<d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoDestroy&&a.destroy();this.strategies=null}this.clearMarkers();this.markers=
null;ALKMaps.Layer.prototype.destroy.apply(this,arguments)},afterAdd:function(){if(this.strategies){var a,b,c;for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.activate()}},setOpacity:function(a){if(a!==this.opacity){this.opacity=a;for(var a=0,b=this.markers.length;a<b;a++)this.markers[a].setOpacity(this.opacity)}},moveTo:function(a,b,c){ALKMaps.Layer.prototype.moveTo.apply(this,arguments);var d=this.setExtent(a,b);if(!0!==this.isClusterStrategyActive()&&(b||!this.drawn||
!d)){for(var d=0,e=this.markers.length;d<e;d++)this.drawMarker(this.markers[d]);this.drawn=!0}},addMarker:function(a,b){var c=!b||!b.silent,d=!b||b.drawMarker,e={marker:a};if(c){if(!1===this.events.triggerEvent("beforemarkeradded",e))return;a=e.marker}this.markers.push(a);1>this.opacity&&!1!==d&&a.setOpacity(this.opacity);if(this.map&&this.map.getExtent())a.map=this.map,!1!==d&&this.drawMarker(a);c&&this.events.triggerEvent("aftermarkeradded",e)},addMarkers:function(a,b){this.addMarkersForClusterHack(a,
[],b)},addMarkersForClusterHack:function(a,b,c){var c=!c||!c.silent,d=[];Array.prototype.push.apply(d,a);Array.prototype.push.apply(d,b);d={markers:d};if(!(c&&!1===this.events.triggerEvent("beforemarkersadded",d))){for(var e=0;e<a.length;e++)this.addMarker(a[e]);for(a=0;a<b.length;a++)this.addMarker(b[a],{drawMarker:!1});c&&this.events.triggerEvent("aftermarkersadded",d)}},removeMarker:function(a,b){(!b||!b.silent)&&this.events.triggerEvent("beforemarkerremoved",{marker:a});a instanceof ALKMaps.Marker2?
this.removeMarkerFromMapLayerContainerDiv(a):this.markers&&this.markers.length&&(ALKMaps.Util.removeItem(this.markers,a),a.erase())},clearMarkers:function(){if(null!=this.markers)for(;0<this.markers.length;)this.removeMarker(this.markers[0])},setExtent:function(a,b){if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){this.extent=a.clone();var c=this.getResolution();this.extent=a.wrapDateLine(this.map.getMaxExtent());var d=!1,e=this.map.getMaxExtent();e.right>a.left&&e.right<a.right&&!(e.left>
a.left&&e.left<a.right)&&(d=!0);this.xOffset=!0===d?e.getWidth()/c:0;c=-a.left/c;b?this.left=c:this.xOffset=c-this.left+this.xOffset}return!0},calculateMarkerDx:function(a,b){var c=0;b&&(c=b.getWidth(),c*=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/2)/c));return c},getAdjustedPxFromLonLat:function(a){var b=this.map.getLayerPxFromLonLat(a);if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var c=this.map.getMaxExtent(),c=this.calculateMarkerDx(new ALKMaps.Bounds(a.lon,
a.lat,a.lon,a.lat),c),a=(a.lon-c)/this.getResolution()+this.left,c=parseInt(this.map.layerContainerDiv.style.left,10),c=-Math.round(c);b.x=this.xOffset+a+c}return b},drawMarker:function(a){if(a instanceof ALKMaps.Marker2)if(!a||!a.div||!(a.div.parentNode&&11!==a.div.parentNode.nodeType))this.addMarkerToMapLayerContainerDiv(a);else{var b=this.getAdjustedPxFromLonLat(a.lonlat);a.moveTo(b)}else b=this.getAdjustedPxFromLonLat(a.lonlat),null==b?a.display(!1):a.isDrawn()?a.icon&&a.icon.moveTo(b):this.div.appendChild(a.draw(b))},
getDataExtent:function(){var a=null;if(this.markers&&0<this.markers.length)for(var a=new ALKMaps.Bounds,b=0,c=this.markers.length;b<c;b++)a.extend(this.markers[b].lonlat);return a},getViewPortDataExtent:function(){var a=this.map.getExtent(),b=null;if(this.markers&&0<this.markers.length)for(var b=new ALKMaps.Bounds,c=0,d=this.markers.length;c<d;c++){var e=this.markers[c];e.lonlat.lon>a.left&&e.lonlat.lon<a.right&&e.lonlat.lat<a.top&&e.lonlat.lat>a.bottom&&b.extend(e.lonlat)}return b},addMarkerToMapLayerContainerDiv:function(a){if(a instanceof
ALKMaps.Marker2){var b=this.getAdjustedPxFromLonLat(a.lonlat),b=a.draw(b);if(!0===this.map.allowSafeScroll)b.safeScroll=!0;if(b)b.style.zIndex=a.cluster?this.map.Z_INDEX_BASE.Feature+12+this.markers.length%12:this.map.Z_INDEX_BASE.Feature+this.markers.length%12,this.map.layerContainerDiv.appendChild(b)}},removeMarkerFromMapLayerContainerDiv:function(a){if(a instanceof ALKMaps.Marker2){ALKMaps.Util.removeItem(this.markers,a);if(a.div)try{this.map.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=
null}},setVisibility:function(a){if(this.markers)for(var b=0;b<this.markers.length;b++){var c=this.markers[b];c instanceof ALKMaps.Marker2&&c.setVisibility(a)}return ALKMaps.Layer.prototype.setVisibility.apply(this,arguments)},isClusterStrategyActive:function(){var a=!1;if(null!=this.strategies)for(var b=0;b<this.strategies.length;b++)if(this.strategies[b]instanceof ALKMaps.Strategy.MarkerCluster&&!0===this.strategies[b].active){a=!0;break}return a},CLASS_NAME:"ALKMaps.Layer.Markers"});ALKMaps.Marker2=ALKMaps.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olMarker",contentDisplayClass:"olMarkerContent",padding:0,disableFirefoxOverflowHack:!1,map:null,attributes:null,closeBox:null,initialize:function(a,b,c,d,e,f){null==a&&(a=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=b;this.closeBox=
e;this.contentSize=null!=c?c:new ALKMaps.Size(ALKMaps.Marker2.WIDTH,ALKMaps.Marker2.HEIGHT);null!=d?(this.contentHTML=d,this.backgroundColor=ALKMaps.Marker2.COLOR):(a=ALKMaps.Util.getImageLocation("marker.png"),b=ALKMaps.Util.createUniqueID("OL_Icon_"),this.contentHTML=ALKMaps.Util.createAlphaImageDiv(b,null,null,a),this.backgroundColor="");this.attributes=f;this.opacity=ALKMaps.Marker2.OPACITY;this.border=ALKMaps.Marker2.BORDER;this.div=ALKMaps.Util.createDiv(this.id,null,null,null,null,null,"hidden");
this.div.className=this.displayClass;this.groupDiv=ALKMaps.Util.createDiv("_grp",null,null,null,"relative",null,"hidden");this.contentDiv=ALKMaps.Util.createDiv("_cnt",null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);e&&this.addCloseBox();this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id=
null;this.map&&this.map.events.unregister("movestart",this,this.hide);this.events.destroy();this.events=null;this.closeDiv&&(ALKMaps.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv));this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;this.destroyPopup();this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},fixPadding:function(){if("number"===typeof this.padding)this.padding=new ALKMaps.Bounds(this.padding,this.padding,
this.padding,this.padding)},draw:function(a){null==a&&null!=this.lonlat&&null!=this.map&&(a=this.map.getLayerPxFromLonLat(this.lonlat));this.moveTo(a);!this.autoSize&&!this.size&&this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&&this.moveTo(a)}},moveTo:function(a){if(null!=a&&null!=this.div)"string"===typeof this.contentHTML?
(this.div.style.left=a.x+"px",this.div.style.top=a.y+"px"):(this.div.style.left=a.x-14+"px",this.div.style.top=a.y-24+"px")},visible:function(){return ALKMaps.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="";this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setVisibility:function(a){!0!==a?this.hide():this.show()},setSize:function(a){this.size=a.clone();var b=this.getContentDivPadding(),
c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),c=c+(e+b.right);this.size.w+=c;this.size.h+=d;"msie"===ALKMaps.BROWSER_NAME&&(this.contentSize.w+=b.left+b.right,this.contentSize.h+=b.bottom+b.top);if(null!=this.div)this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px";if(null!=this.contentDiv)this.contentDiv.style.width=a.w+"px",this.contentDiv.style.height=
a.h+"px"},updateSize:function(){var a="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",b=this.map?this.map.div:document.body,c=ALKMaps.Util.getRenderedDimensions(a,null,{displayClass:this.displayClass,containerElement:b}),d=this.getSafeContentSize(c),e=null;d.equals(c)?e=c:(c={w:d.w<c.w?d.w:null,h:d.h<c.h?d.h:null},c.w&&c.h?e=d:(a=ALKMaps.Util.getRenderedDimensions(a,c,{displayClass:this.contentDisplayClass,containerElement:b}),"hidden"!==ALKMaps.Element.getStyle(this.contentDiv,
"overflow")&&a.equals(d)&&(d=ALKMaps.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=this.getSafeContentSize(a)));this.setSize(e)},setBackgroundColor:function(a){if(void 0!==a)this.backgroundColor=a;if(null!=this.div)this.div.style.backgroundColor=this.backgroundColor},setOpacity:function(a){if(void 0!==a)this.opacity=a;if(null!=this.div)this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")"},setBorder:function(a){if(void 0!==a)this.border=a;if(null!=this.div)this.div.style.border=
this.border},setContentHTML:function(a){if(null!=a)this.contentHTML=a;if(null!=this.contentDiv&&null!=this.contentHTML&&this.contentHTML!==this.contentDiv.innerHTML)"string"===typeof this.contentHTML?this.contentDiv.innerHTML=this.contentHTML:this.contentDiv.appendChild(this.contentHTML),this.autoSize&&(this.registerImageListeners(),this.updateSize())},registerImageListeners:function(){for(var a=function(){null!==this.marker.id&&(this.marker.updateSize(),ALKMaps.Event.stopObserving(this.img,"load",
this.img._onImageLoad))},b=this.contentDiv.getElementsByTagName("img"),c=0,d=b.length;c<d;c++){var e=b[c];if(0===e.width||0===e.height)e._onImgLoad=ALKMaps.Function.bind(a,{marker:this,img:e}),ALKMaps.Event.observe(e,"load",e._onImgLoad)}},getSafeContentSize:function(a){var a=a.clone(),b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),
c=c+(e+b.right);if(this.minSize)a.w=Math.max(a.w,this.minSize.w-c),a.h=Math.max(a.h,this.minSize.h-d);if(this.maxSize)a.w=Math.min(a.w,this.maxSize.w-c),a.h=Math.min(a.h,this.maxSize.h-d);return a},getContentDivPadding:function(){var a=this._contentDivPadding;if(!a){if(null==this.div.parentNode)this.div.style.display="none",document.body.appendChild(this.div);this._contentDivPadding=a=new ALKMaps.Bounds(ALKMaps.Element.getStyle(this.contentDiv,"padding-left"),ALKMaps.Element.getStyle(this.contentDiv,
"padding-bottom"),ALKMaps.Element.getStyle(this.contentDiv,"padding-right"),ALKMaps.Element.getStyle(this.contentDiv,"padding-top"));if(this.div.parentNode===document.body)document.body.removeChild(this.div),this.div.style.display=""}return a},addCloseBox:function(){this.closeDiv=ALKMaps.Util.createDiv(this.id+"_close",null,this.closeBox.size||{w:17,h:21});this.closeDiv.className=this.closeBox.displayClass||"olMarkerCloseBox";var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+"px";
this.closeDiv.style.top=a.top+"px";this.groupDiv.appendChild(this.closeDiv);a=this.closeBox.callback||function(a){ALKMaps.Event.stop(a);this.defaulClickHandler()};ALKMaps.Event.observe(this.closeDiv,"touchend",ALKMaps.Function.bindAsEventListener(a,this));ALKMaps.Event.observe(this.closeDiv,"click",ALKMaps.Function.bindAsEventListener(a,this))},registerEvents:function(){this.events=new ALKMaps.Events(this,this.div,null,!0);this.events.on({mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,
mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:this.onTouchstart,mouseover:this.onmouseover,scope:this})},onmousedown:function(a){this.mousedown=!0;ALKMaps.Event.stop(a,!0)},onmousemove:function(a){this.mousedown&&ALKMaps.Event.stop(a,!0)},onmouseup:function(a){if(this.mousedown)this.mousedown=!1,ALKMaps.Event.stop(a,!0);ALKMaps.Event.isRightClick(a)&&(!1===this.events.triggerEvent("markerrightclick",{evt:a})?ALKMaps.Util.disableContextMenu(this.div):ALKMaps.Util.enableContextMenu(this.div))},
onclick:function(a){if(!this.closeBox){if(!1===this.events.triggerEvent("markerclick",{evt:a}))return;this.defaulClickHandler()}ALKMaps.Event.stop(a,!0)},onmouseout:function(a){this.mousedown=!1;this.closeBox||this.events.triggerEvent("markerout",{evt:a})},ondblclick:function(a){ALKMaps.Event.stop(a,!0)},onTouchstart:function(a){if(!this.closeBox){if(!1===this.events.triggerEvent("markertouchstart",{evt:a}))return;this.defaulClickHandler()}ALKMaps.Event.stop(a,!0)},onmouseover:function(a){(this.closeBox||
!1!==this.events.triggerEvent("markerover",{evt:a}))&&ALKMaps.Event.stop(a,!0)},createPopup:function(a){if(null!=this.lonlat){if(!this.popup){var b=this.attributes.popupSize?this.attributes.popupSize:new ALKMaps.Size(160,120),c=null,d=this.popupClass?this.popupClass:this.attributes.popupClass?this.attributes.popupClass:ALKMaps.Popup.FramedCloud,c=d===ALKMaps.Popup.SimplePopup?this.attributes.offset?this.attributes.offset:new ALKMaps.Pixel(0,0):this.attributes.anchor?this.attributes.anchor:{size:new ALKMaps.Size(0,
0),offset:new ALKMaps.Pixel(0,0)};this.popup=new d(this.id+"_popup",this.lonlat,b,this.attributes.popupContentHTML,c,a)}if(null!=this.attributes.overflow)this.popup.contentDiv.style.overflow=this.attributes.overflow;this.popup.marker=this}return this.popup},destroyPopup:function(){if(this.popup)this.popup.marker=null,this.popup.destroy(),this.popup=null},defaulClickHandler:function(){if(this.cluster&&1<this.cluster.length){for(var a=new ALKMaps.Bounds,b=0;b<this.cluster.length;b++)a.extend(this.cluster[b].lonlat);
this.map.zoomToExtent(a)}else this.attributes&&(this.createPopup(!0),this.map.addPopup(this.popup,!0),this.popup.show())},CLASS_NAME:"ALKMaps.Marker2"});ALKMaps.Marker2.WIDTH=21;ALKMaps.Marker2.HEIGHT=25;ALKMaps.Marker2.COLOR="white";ALKMaps.Marker2.OPACITY=0.9;ALKMaps.Marker2.BORDER="1px";(function(a){function b(a,b){var c=b;if(null!=a){var d=a.toUpperCase();if(("CURRENT"===d||"PCM_WW"===d)&&("NA"===c||"na"===c||"Na"===c||"nA"===c||4===c||"4"===c))c=null}return c}a.getCustomPlaces=function(a){var a=a||{},b=a.id||-1,c=a.includePlaces||!1,d=a.tag,e=a.bounds,f=a.placeName,l=a.catId,p=a.catName;if(!1!==c){if(-180>e.left)e.left=(e.left%180+180)%180;if(180<e.left)e.left=(e.left%-180-180)%-180;if(-180>e.right)e.right=(e.right%180+180)%180;if(180<e.right)e.right=(e.right%-180-180)%-180}return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+
"CustomPlaceSets/"+b+"?",params:{includePlaces:c,tag:d,corner1:!1!==c?[e.left,e.top]:null,corner2:!1!==c?[e.right,e.bottom]:null,placeName:f,catId:l,catName:p},async:a.async,success:a.success,failure:a.failure,withCredentials:!1},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.addCustomPlaceSet=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"CustomPlaceSets?",headers:{"Content-Type":"application/json"},params:{name:a.name,tag:a.tag},async:a.async,
success:a.success,withCredentials:!1,failure:a.failure},ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.updateCustomPlaceSet=function(a){var a=a||{},b=a.id,c=a.name,d=a.tag,e=ALKMaps.Request.PUT,m="CustomPlaceSets/"+b+"?",l=f();if(10>l&&-1!==l)m="XDR/CustomPlaceSets/"+b+"/update?",e=ALKMaps.Request.POST;return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+m,headers:{"Content-Type":"application/json"},params:{name:c,tag:d},async:a.async,success:a.success,withCredentials:!1,
failure:a.failure},e,ALKMaps.Request.parseJSONReponse)};a.deleteCustomPlaceSet=function(a){var a=a||{},b=a.id,c=ALKMaps.Request.DELETE,d="CustomPlaceSets/"+b,e=f();if(10>e&&-1!==e)d="XDR/CustomPlaceSets/"+b+"/delete",c=ALKMaps.Request.POST;return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+d,headers:{"Content-Type":"application/json"},async:a.async,success:a.success,withCredentials:!1,failure:a.failure},c,ALKMaps.Request.parseJSONReponse)};a.addCustomPlace=function(a){var a=a||{},
b=a.setId,c=a.place||{},d=c.address||{},e=c.coords||{},c={CategoryId:c.categoryId,Phone:c.phone,Address:{StreetAddress:d.streetAddress,City:d.city,State:d.state,County:d.county,Zip:d.zip},Coords:{Lat:e.lat,Lon:e.lon},Region:ALKMaps.Util.getRegion(c.region),PlaceName:c.placeName},d="CustomPlaceSets/"+b+"/CustomPlace",m=f();10>m&&-1!==m&&(d="XDR/CustomPlaceSets/"+b+"/CustomPlace/Add?");b={url:ALKMaps.RouteServiceURL+d,headers:{"Content-Type":"application/json"},async:a.async,success:function(b){a.success&&
"function"===typeof a.success&&(10>m&&-1!==m?a.success(b):a.success(b.AddCustomPlaceResult))},failure:a.failure,withCredentials:!1};10>m&&-1!==m?b.params={jsonPlaceToAdd:JSON.stringify(c)}:b.data=JSON.stringify({placeToAdd:c});return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.updateCustomPlace=function(a){var a=a||{},b=a.setId,c=a.place||{},d=c.address||{},e=c.coords||{},c={Id:c.customPlaceId,CategoryId:c.categoryId,Phone:c.phone,Address:{StreetAddress:d.streetAddress,
City:d.city,State:d.state,County:d.county,Zip:d.zip},Coords:{Lat:e.lat,Lon:e.lon},Region:ALKMaps.Util.getRegion(c.region),PlaceName:c.placeName},e="CustomPlaceSets/"+b+"/CustomPlace",d=ALKMaps.Request.PUT,m=f();if(10>m&&-1!==m)e="XDR/CustomPlaceSets/"+b+"/CustomPlace/Update?",d=ALKMaps.Request.POST;b={url:ALKMaps.RouteServiceURL+e,headers:{"Content-Type":"application/json"},async:a.async,success:function(b){a.success&&"function"===typeof a.success&&(10>m&&-1!==m?a.success(b):a.success(b.UpdateCustomPlaceResult))},
failure:a.failure,withCredentials:!1};10>m&&-1!==m?b.params={jsonPlaceToUpdate:JSON.stringify(c)}:b.data=JSON.stringify({placeToUpdate:c});return ALKMaps.Request.makeSmartRequest(b,d,ALKMaps.Request.parseJSONReponse)};a.deleteCustomPlace=function(a){var a=a||{},b=a.setId,c=a.placeId,d=ALKMaps.Request.DELETE,e="CustomPlaceSets/"+b+"/CustomPlace/"+c,m=f();if(10>m&&-1!==m)e="XDR/CustomPlaceSets/"+b+"/CustomPlace/delete/"+c,d=ALKMaps.Request.POST;return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RouteServiceURL+
e,headers:{"Content-Type":"application/json"},async:a.async,success:a.success,failure:a.failure,withCredentials:!1},d,ALKMaps.Request.parseJSONReponse)};a.getCustomCategories=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"CustomCategories/"+(a.id||-1)+"?",params:{tag:a.tag,catName:a.name},async:a.async,success:a.success,failure:a.failure,withCredentials:!1},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.addCustomCategory=function(a){var a=a||{},
b=a.categoryToAdd||{},b={Name:b.name,Icon:b.icon,IconURL:b.iconURL,Tag:b.tag},c="CustomCategories/",d=f();10>d&&-1!==d&&(c="XDR/CustomCategories/Add");c={url:ALKMaps.RestServiceURL+c,headers:{"Content-Type":"application/json"},async:a.async,success:function(b){a.success&&"function"===typeof a.success&&(10>d&&-1!==d?a.success(b):a.success(b.AddCustomCategoryResult))},failure:a.failure,withCredentials:!1};10>d&&-1!==d?c.params={jsonCategory:JSON.stringify(b)}:c.data=JSON.stringify({category:b});return ALKMaps.Request.makeSmartRequest(c,
ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.updateCustomCategory=function(a){var a=a||{},b=a.categoryToUpdate||{},b={Id:b.id,Name:b.name,Icon:b.icon,IconURL:b.iconURL,Tag:b.tag},c=ALKMaps.Request.PUT,d="CustomCategories/",e=f();if(10>e&&-1!==e)c=ALKMaps.Request.POST,d="XDR/CustomCategories/Update";d={url:ALKMaps.RestServiceURL+d,headers:{"Content-Type":"application/json"},async:a.async,success:function(b){a.success&&"function"===typeof a.success&&(10>e&&-1!==e?a.success(b):a.success(b.UpdateCustomCategoryResult))},
failure:a.failure,withCredentials:!1};10>e&&-1!==e?d.params={jsonCategory:JSON.stringify(b)}:d.data=JSON.stringify({category:b});return ALKMaps.Request.makeSmartRequest(d,c,ALKMaps.Request.parseJSONReponse)};a.generateHTMLReports=function(a,b){for(var c,d,e,f={Detail:"",Directions:"",Mileage:"",State:{Stops:"",States:""},GeoTunnel:"",LeastCost:"",WeatherAlerts:"",TollDetail:{Segment:"",Summary:""}},l=a.length,b="number"===typeof b?1===b?"Km":"Miles":null!=b&&"KILOMETERS"===b.toUpperCase()?"Km":"Miles",
p=0;p<l;p++){c=a[p].__type.toUpperCase();if(ALKMaps.String.startsWith(c,"MILEAGEREPORT")){d=f;e=a[p].ReportLines;var n=b,q=[];q.push(ALKMaps.Util.buildTableOrRow("TR",[ALKMaps.Util.buildTableCell("th","Postal Code",null,"alkPostalCodeCol"),ALKMaps.Util.buildTableCell("th","Address",null,"alkAddressCol"),ALKMaps.Util.buildTableCell("th","City",null,"alkCityCol"),ALKMaps.Util.buildTableCell("th","State",null,"alkStateCol"),ALKMaps.Util.buildTableCell("th","County",null,"alkCountyCol"),ALKMaps.Util.buildTableCell("th",
"Lon, Lat",null,"alkLonLatCol"),ALKMaps.Util.buildTableCell("th",n,null,"alkLegDistanceCol"),ALKMaps.Util.buildTableCell("th","Total",null,"alkTotalDistanceCol"),ALKMaps.Util.buildTableCell("th","Cost",null,"alkTotalCostCol"),ALKMaps.Util.buildTableCell("th","Hours",null,"alkTotalHoursCol"),ALKMaps.Util.buildTableCell("th","Tolls($)",null,"alkTotalTollsCol"),ALKMaps.Util.buildTableCell("th","ETA/ETD",null,"alkETACol")],"alkReportHeaderRow"));for(n=0;n<e.length;n++){var o=e[n];q.push(ALKMaps.Util.buildTableOrRow("TR",
[ALKMaps.Util.buildTableCell("td",o.Stop.Address.Zip,null,"alkPostalCodeCol"),ALKMaps.Util.buildTableCell("td",o.Stop.Address.StreetAddress,null,"alkAddressCol"),ALKMaps.Util.buildTableCell("td",o.Stop.Address.City,null,"alkCityCol"),ALKMaps.Util.buildTableCell("td",o.Stop.Address.State,null,"alkStateCol"),ALKMaps.Util.buildTableCell("td",o.Stop.Address.County,null,"alkCountyCol"),ALKMaps.Util.buildTableCell("td",o.Stop.Coords.Lon+", "+o.Stop.Coords.Lat,null,"alkLonLatCol"),ALKMaps.Util.buildTableCell("td",
0===parseFloat(o.LMiles)?"":o.LMiles,null,"alkLegDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",0===parseFloat(o.TMiles)?"":o.TMiles,null,"alkTotalDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",0===parseFloat(o.TCostMile)?"":o.TCostMile,null,"alkTotalCostCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td","0:00"===o.THours?"":o.THours,null,"alkTotalHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",o.TTolls,null,"alkTotalTollsCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",
o.EtaEtd,null,"alkETACol")]))}e=ALKMaps.Util.buildTableOrRow("table",q,"alkReportTable alkMileageReportTable");d.Mileage=e}if(ALKMaps.String.startsWith(c,"DETAILREPORT")){d=f;e=a[p].ReportLegs;n=b;q=[];o=void 0;q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","State",null,"alkStateCol"),ALKMaps.Util.buildTableCell("th","Route",null,"alkRouteCol"),ALKMaps.Util.buildTableCell("th",n,null,"alkDistanceCol"),ALKMaps.Util.buildTableCell("th","Hours",null,"alkHoursCol"),ALKMaps.Util.buildTableCell("th",
"Interchange",null,"alkInterchangeCol"),ALKMaps.Util.buildTableCell("th","Leg "+n,null,"alkLegDistanceCol"),ALKMaps.Util.buildTableCell("th","Leg Hours",null,"alkLegHoursCol"),ALKMaps.Util.buildTableCell("th","Total "+n,null,"alkTotalDistanceCol"),ALKMaps.Util.buildTableCell("th","Total Hours",null,"alkTotalHoursCol"),ALKMaps.Util.buildTableCell("th","Leg Tolls($)",null,"alkLegTollsCol"),ALKMaps.Util.buildTableCell("th","Toll Plaza Abbr.",null,"alkTollPlazaCol")],"alkReportHeaderRow"));for(n=0;n<
e.length;n++){var o=e[n],r=o.ReportLines[0];q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",r.Stop.substring(0,7),null,"alkStateCol"),ALKMaps.Util.buildTableCell("td",r.Stop.substring(8),null,"alkRouteCol"),ALKMaps.Util.buildTableCell("td",null===r.Miles?"&nbsp;":r.Miles,null,"alkDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===r.Time?"&nbsp;":r.Time,null,"alkHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===r.TToll?"&nbsp;":r.TToll,null,"alkInterchangeCol"),
ALKMaps.Util.buildTableCell("td",null===r.LMiles?"&nbsp;":r.LMiles,null,"alkLegDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===r.LTime?"&nbsp;":r.LTime,null,"alkLegHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===r.TMiles?"&nbsp;":r.TMiles,null,"alkTotalDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===r.TTime?"&nbsp;":r.TTime,null,"alkTotalHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===r.LToll?"&nbsp;":r.LToll,null,"alkLegTollsCol alkCurrencyCol"),
ALKMaps.Util.buildTableCell("td",null===r.TollPlazaAbbr?"&nbsp;":r.TollPlazaAbbr,null,"alkTollPlazaCol")]));for(var t=1;t<o.ReportLines.length-1;t++)if(r=o.ReportLines[t],null===r.ArState||void 0===r.ArState)q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",null===r.State?"&nbsp;":r.State,null,"alkStateCol"),ALKMaps.Util.buildTableCell("td",null===r.Route?"&nbsp;":r.Route,null,"alkRouteCol"),ALKMaps.Util.buildTableCell("td",null===r.Miles?"&nbsp;":r.Miles,null,"alkDistanceCol alkNumericCol"),
ALKMaps.Util.buildTableCell("td",null===r.Time?"&nbsp;":r.Time,null,"alkHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===r.InterCh?"&nbsp;":r.InterCh,null,"alkInterchangeCol"),ALKMaps.Util.buildTableCell("td",null===r.LMiles?"&nbsp;":r.LMiles,null,"alkLegDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===r.LTime?"&nbsp;":r.LTime,null,"alkLegHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===r.TMiles?"&nbsp;":r.TMiles,null,"alkTotalDistanceCol alkNumericCol"),
ALKMaps.Util.buildTableCell("td",null===r.TTime?"&nbsp;":r.TTime,null,"alkTotalHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===r.LToll?"&nbsp;":r.LToll,null,"alkLegTollsCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===r.TollPlazaAbbr?"&nbsp;":r.TollPlazaAbbr,null,"alkTollPlazaCol")]));q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkStateCol"),ALKMaps.Util.buildTableCell("td","Arrive Loaded",null,"alkRouteCol"),ALKMaps.Util.buildTableCell("td",
"&nbsp;",null,"alkDistanceCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkHoursCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkInterchangeCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkLegDistanceCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkLegHoursCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkTotalDistanceCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkTotalHoursCol"),ALKMaps.Util.buildTableCell("td","&nbsp;",null,"alkLegTollsCol"),ALKMaps.Util.buildTableCell("td",
"&nbsp;",null,"alkTollPlazaCol")]));o=o.ReportLines[o.ReportLines.length-1]}q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",o.Stop.substring(0,5),null,"alkStateCol"),ALKMaps.Util.buildTableCell("td",o.Stop.substring(6),null,"alkRouteCol"),ALKMaps.Util.buildTableCell("td",null===o.Miles?"&nbsp;":o.Miles,null,"alkDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Time?"&nbsp;":o.Time,null,"alkHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===
o.InterCh?"&nbsp;":o.InterCh,null,"alkInterchangeCol"),ALKMaps.Util.buildTableCell("td",null===o.LMiles?"&nbsp;":o.LMiles,null,"alkLegDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.LTime?"&nbsp;":o.LTime,null,"alkLegHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===o.TMiles?"&nbsp;":o.TMiles,null,"alkTotalDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.TTime?"&nbsp;":o.TTime,null,"alkTotalHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",
null===o.TToll?"&nbsp;":o.TToll,null,"alkTotalTollsCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.TollPlazaAbbr?"&nbsp;":o.TollPlazaAbbr,null,"alkTollPlazaCol")]));e=ALKMaps.Util.buildTableOrRow("table",q,"alkReportTable alkDetailReportTable");d.Detail=e}if(ALKMaps.String.startsWith(c,"DIRECTIONSREPORT")){d=f;e=a[p].ReportLegs;q=[];q.push(ALKMaps.Util.buildTableOrRow("li",[ALKMaps.Util.buildTableCell("span","Driving Directions",null,"alkDirectionCol"),ALKMaps.Util.buildTableCell("span",
"Odometer",null,"alkOdometerCol"),ALKMaps.Util.buildTableCell("span","Time",null,"alkTimeCol"),ALKMaps.Util.buildTableCell("span","Delay",null,"alkDelayCol")],"alkHeaderRow"));for(n=0;n<e.length;n++){o=e[n];r=(null===o.Origin.Address.StreetAddress?"":o.Origin.Address.StreetAddress+", ")+o.Origin.Address.City+", "+o.Origin.Address.State+" "+o.Origin.Address.Zip;0===n&&q.push(ALKMaps.Util.buildTableOrRow("li",Array(ALKMaps.Util.buildTableCell("span",r,null,"alkDirectionCol")),"alkOrigin alkStop"));
for(var s,r=!1,t="",u=1;u<o.ReportLines.length;u++)t=o.ReportLines[u],null!==t.Direction&&ALKMaps.String.contains(t.Direction.toUpperCase(),"ALK TECHNOLOGIES")?(r=!0,q.push(ALKMaps.Util.buildTableOrRow("li",Array(ALKMaps.Util.buildTableCell("span",t.Direction,null,"alkCopyrightCol")),"alkCopyright"))):null===t.Dist||" "===t.Dist?null===t.Direction?q.push(ALKMaps.Util.buildTableOrRow("li",Array(ALKMaps.Util.buildTableCell("span",t.Warn,null,"alkDirectionCol")),"alkWarning")):r?q.push(ALKMaps.Util.buildTableOrRow("li",
Array(ALKMaps.Util.buildTableCell("span",t.Direction,null,"alkDisclaimerCol")),"alkDisclaimer")):q.push(ALKMaps.Util.buildTableOrRow("li",Array(ALKMaps.Util.buildTableCell("span",t.Direction,null,"alkDirectionCol")),"alkDirection")):(s=t.Dist,n===e.length-1&&u===o.ReportLines.length-7?q.push(ALKMaps.Util.buildTableOrRow("li",[ALKMaps.Util.buildTableCell("span",t.Direction,null,"alkDirectionCol"),ALKMaps.Util.buildTableCell("span",t.Dist,null,"alkOdometerCol"),ALKMaps.Util.buildTableCell("span",t.Time,
null,"alkTimeCol"),ALKMaps.Util.buildTableCell("span",t.Delay,null,"alkDelayCol")],"alkDestination alkStop")):q.push(ALKMaps.Util.buildTableOrRow("li",[ALKMaps.Util.buildTableCell("span",t.Direction,null,"alkDirectionCol"),ALKMaps.Util.buildTableCell("span",t.Dist,null,"alkOdometerCol"),ALKMaps.Util.buildTableCell("span",t.Time,null,"alkTimeCol"),ALKMaps.Util.buildTableCell("span",t.Delay,null,"alkDelayCol")],"alkNormal")));!1===r&&q.push(ALKMaps.Util.buildTableOrRow("li",[ALKMaps.Util.buildTableCell("span",
(null===o.Dest.Address.StreetAddress?"":o.Dest.Address.StreetAddress+", ")+o.Dest.Address.City+", "+o.Dest.Address.State+" "+o.Dest.Address.Zip,null,"alkDirectionCol"),ALKMaps.Util.buildTableCell("span",s,null,"alkOdometerCol"),ALKMaps.Util.buildTableCell("span",t.Time,null,"alkTimeCol"),ALKMaps.Util.buildTableCell("span",t.Delay,null,"alkDelayCol")],"alkStop"))}e=ALKMaps.Util.buildTableOrRow("ol",q,"alkDirectionsReport");d.Directions=e}if(ALKMaps.String.startsWith(c,"STATEREPORT")){q=a[p].MileageReportLines;
d=a[p].StateReportLines;n=b;e=[];e.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","Stop",null,"alkStopCol"),ALKMaps.Util.buildTableCell("th","Leg "+n,null,"alkLegDistanceCol"),ALKMaps.Util.buildTableCell("th","Total "+n,null,"alkTotalDistaneCol"),ALKMaps.Util.buildTableCell("th","Leg Cost/"+n,null,"alkLegCostPerDistCol"),ALKMaps.Util.buildTableCell("th","Total Cost/"+n,null,"alkTotalCostPerDistCol"),ALKMaps.Util.buildTableCell("th","Leg Hours",null,"alkLegHoursCol"),ALKMaps.Util.buildTableCell("th",
"Total Hours",null,"alkTotalHoursCol"),ALKMaps.Util.buildTableCell("th","Leg Tolls($)",null,"alkLegTollsCol"),ALKMaps.Util.buildTableCell("th","Total Tolls($)",null,"alkTotalTollsCol"),ALKMaps.Util.buildTableCell("th","Leg EST. GHG",null,"alkLegGhgCol"),ALKMaps.Util.buildTableCell("th","Total EST. GHG",null,"alkTotalGhgCol")],"alkHeaderRow"));for(n=0;n<q.length;n++)o=q[n],r=o.Stop,r=(null===r.Address.StreetAddress?"":r.Address.StreetAddress+", ")+r.Address.City+", "+r.Address.State+" "+r.Address.Zip,
e.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",null===r?"&nbsp;":r,null,"alkStopCol"),ALKMaps.Util.buildTableCell("td",null===o.LMiles?"&nbsp;":o.LMiles,null,"alkLegDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.TMiles?"&nbsp;":o.TMiles,null,"alkTotalDistaneCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.LCostMile?"&nbsp;":o.LCostMile,null,"alkLegCostPerDistCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.TCostMile?"&nbsp;":
o.TCostMile,null,"alkTotalCostPerDistCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.LHours?"&nbsp;":o.LHours,null,"alkLegHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===o.THours?"&nbsp;":o.THours,null,"alkTotalHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",null===o.LTolls?"&nbsp;":o.LTolls,null,"alkLegTollsCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.TTolls?"&nbsp;":o.TTolls,null,"alkTotalTollsCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",
null===o.LEstghg?"&nbsp;":o.LEstghg,null,"alkLegGhgCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.TEstghg?"&nbsp;":o.TEstghg,null,"alkTotalGhgCol alkNumericCol")]));q=ALKMaps.Util.buildTableOrRow("table",e,"alkReportTable alkStopsReportTable");e=[];e.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","State/Country",null,"alkStateCol"),ALKMaps.Util.buildTableCell("th","Total",null,"alkTotalDistanceCol"),ALKMaps.Util.buildTableCell("th","Toll",null,"alkTollDistanceCol"),
ALKMaps.Util.buildTableCell("th","Free",null,"alkFreeDistanceCol"),ALKMaps.Util.buildTableCell("th","Ferry",null,"alkFerryDistanceCol"),ALKMaps.Util.buildTableCell("th","Loaded",null,"alkLoadedDistanceCol"),ALKMaps.Util.buildTableCell("th","Empty",null,"alkEmptyDistanceCol"),ALKMaps.Util.buildTableCell("th","Toll($)",null,"alkTotalTollsCol")],"alkHeaderRow"));for(n=0;n<d.length;n++)o=d[n],e.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",null===o.StCntry?"&nbsp;":o.StCntry,
null,"alkStateCol"),ALKMaps.Util.buildTableCell("td",null===o.Total?"&nbsp;":o.Total,null,"alkTotalDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Toll?"&nbsp;":o.Toll,null,"alkTollDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Free?"&nbsp;":o.Free,null,"alkFreeDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Ferry?"&nbsp;":o.Ferry,null,"alkFerryDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Loaded?"&nbsp;":o.Loaded,
null,"alkLoadedDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Empty?"&nbsp;":o.Empty,null,"alkEmptyDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Tolls?"&nbsp;":o.Tolls,null,"alkTotalTollsCol alkCurrencyCol")]));e=ALKMaps.Util.buildTableOrRow("table",e,"alkReportTable alkStateReportTable");d=q;f.State.Stops=d;f.State.States=e}if(ALKMaps.String.startsWith(c,"GEOTUNNELREPORT")){d=f;e=a[p].GeoTunnelPoints;q=[];q.push(ALKMaps.Util.buildTableOrRow("tr",Array(ALKMaps.Util.buildTableCell("th",
"Longitude, Latitude",null,"alkLonLatCol")),"alkHeaderRow"));for(n=0;n<e.length;n++)o=e[n],q.push(ALKMaps.Util.buildTableOrRow("TR",Array(ALKMaps.Util.buildTableCell("td",o.Lon+", "+o.Lat,null,"alkLonLatCol"))));e=ALKMaps.Util.buildTableOrRow("table",q,"alkReportTable alkGeoTunnelReportTable");d.GeoTunnel=e}if(ALKMaps.String.startsWith(c,"LEASTCOSTREPORT")){d=f;e=a[p].ReportLines;n=b;q=[];q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","Type",null,"alkTypeCol"),ALKMaps.Util.buildTableCell("th",
n,null,"alkTotalDistanceCol"),ALKMaps.Util.buildTableCell("th","Cost",null,"alkTotalCostCol"),ALKMaps.Util.buildTableCell("th","Hours",null,"alkTotalHoursCol"),ALKMaps.Util.buildTableCell("th","Tolls($)",null,"alkTotalTollsCol"),ALKMaps.Util.buildTableCell("th","Fuel",null,"alkFuelCol"),ALKMaps.Util.buildTableCell("th","Labor",null,"alkLaborCol"),ALKMaps.Util.buildTableCell("th","Other",null,"alkOtherCol"),ALKMaps.Util.buildTableCell("th","EST. GHG",null,"alkEstghgCol")],null,"alkLeastCostReportHeader"));
for(n=0;n<e.length;n++)o=e[n],q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",null===o.LeastCostTripOptions?"&nbsp;":o.LeastCostTripOptions,null,"alkTypeCol"),ALKMaps.Util.buildTableCell("td",null===o.Miles?"&nbsp;":o.Miles,null,"alkTotalDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null===o.Cost?"&nbsp;":o.Cost,null,"alkTotalCostCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.Hours?"&nbsp;":o.Hours,null,"alkTotalHoursCol alkTimeCol"),ALKMaps.Util.buildTableCell("td",
null===o.Tolls?"&nbsp;":o.Tolls,null,"alkTotalTollsCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.Fuel?"&nbsp;":o.Fuel,null,"alkFuelCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.Labor?"&nbsp;":o.Labor,null,"alkLaborCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.Other?"&nbsp;":o.Other,null,"alkOtherCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null===o.Estghg?"&nbsp;":o.Estghg,null,"alkEstghgCol alkNumericCol")],null,o.LeastCostTripOptions));
e=ALKMaps.Util.buildTableOrRow("table",q,"alkReportTable alkLeastCostReportTable");d.LeastCost=e}if(ALKMaps.String.startsWith(c,"WEATHERALERTSREPORT")){d=f;e=a[p].WeatherAlerts;q=[];q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","Event",null,"alkEventCol"),ALKMaps.Util.buildTableCell("th","Area(s)",null,"alkAreasCol"),ALKMaps.Util.buildTableCell("th","Effective",null,"alkDateTimeCol"),ALKMaps.Util.buildTableCell("th","Expires",null,"alkDateTimeCol"),ALKMaps.Util.buildTableCell("th",
"Certainty",null,"alkFilterCol"),ALKMaps.Util.buildTableCell("th","Severity",null,"alkFilterCol"),ALKMaps.Util.buildTableCell("th","Urgency",null,"alkFilterCol")],null,"alkLeastCostReportHeader"));for(n=0;n<e.length;n++)o=e[n],q.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",null===o.AlertEvent?"&nbsp;":o.AlertEvent,null,"alkEventCol"),ALKMaps.Util.buildTableCell("td",null===o.AreaDesc?"&nbsp;":o.AreaDesc,null,"alkAreasCol"),ALKMaps.Util.buildTableCell("td",null===o.DispEffective?
"&nbsp;":o.DispEffective,null,"alkDateTimeCol"),ALKMaps.Util.buildTableCell("td",null===o.DispExpires?"&nbsp;":o.DispExpires,null,"alkDateTimeCol"),ALKMaps.Util.buildTableCell("td",null===o.Certainty?"&nbsp;":o.Certainty,null,"alkFilterCol"),ALKMaps.Util.buildTableCell("td",null===o.Severity?"&nbsp;":o.Severity,null,"alkFilterCol"),ALKMaps.Util.buildTableCell("td",null===o.Urgency?"&nbsp;":o.Urgency,null,"alkFilterCol")],null,"alkNormal")),q.push(ALKMaps.Util.buildTableOrRow("tr",Array(ALKMaps.Util.buildTableCell("td",
null===o.Summary?"&nbsp;":o.Summary,7,"alkSummaryCol")),null,"alkDirection"));e=ALKMaps.Util.buildTableOrRow("table",q,"alkReportTable alkWeatherAlertsReport");d.WeatherAlerts=e}if(ALKMaps.String.startsWith(c,"TOLLDETAILREPORT")){e=a[p].SegmentLines;c=a[p].SummaryLines;q=b;d=[];d.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","Country",null,"alkCountryCol"),ALKMaps.Util.buildTableCell("th","Road",null,"alkRoadCol"),ALKMaps.Util.buildTableCell("th","TollName",null,"alkTollNameCol"),
ALKMaps.Util.buildTableCell("th","DistanceBased "+q,null,"alkDistanceBasedCol"),ALKMaps.Util.buildTableCell("th","Pass",null,"alkPassCol"),ALKMaps.Util.buildTableCell("th","Flat ",null,"alkFlatCol")],"alkHeaderRow"));for(q=0;q<e.length;q++)n=e[q],d.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("td",null==n.Country?"&nbsp;":n.Country,null,"alkCountryCol"),ALKMaps.Util.buildTableCell("td",null==n.Road?"&nbsp;":n.Road,null,"alkRoadCol"),ALKMaps.Util.buildTableCell("td",null==n.TollName?
"&nbsp;":n.TollName,null,"alkTollNameCol"),ALKMaps.Util.buildTableCell("td",null==n.DistanceBased?"&nbsp;":n.DistanceBased,null,"alkDistanceBasedCol"),ALKMaps.Util.buildTableCell("td",null==n.Pass?"&nbsp;":n.Pass,null,"alkPassCol"),ALKMaps.Util.buildTableCell("td",null==n.Flat?"&nbsp;":n.Flat,null,"alkFlatCol")]));e=ALKMaps.Util.buildTableOrRow("table",d,"alkReportTable alkSegmentReportTable");d=[];d.push(ALKMaps.Util.buildTableOrRow("tr",[ALKMaps.Util.buildTableCell("th","Country",null,"alkCountryCol"),
ALKMaps.Util.buildTableCell("th","TollType",null,"alkTollTypeCol"),ALKMaps.Util.buildTableCell("th","TollName",null,"alkTollNameCol"),ALKMaps.Util.buildTableCell("th","TollDistance",null,"alkTollDistanceCol"),ALKMaps.Util.buildTableCell("th","Tolls(Local)",null,"alkTollsLocalCol"),ALKMaps.Util.buildTableCell("th","Tolls(EUR)",null,"alkTollsEURCol"),ALKMaps.Util.buildTableCell("th","PaymentOption",null,"alkPaymentOptionCol")],"alkHeaderRow"));for(q=0;q<c.length;q++)n=c[q],d.push(ALKMaps.Util.buildTableOrRow("tr",
[ALKMaps.Util.buildTableCell("td",null==n.Country?"&nbsp;":n.Country,null,"alkCountryCol"),ALKMaps.Util.buildTableCell("td",null==n.TollType?"&nbsp;":n.TollType,null,"alkTollTypeCol"),ALKMaps.Util.buildTableCell("td",null==n.TollName?"&nbsp;":n.TollName,null,"alkTollNameCol"),ALKMaps.Util.buildTableCell("td",null==n.TollDistance?"&nbsp;":n.TollDistance,null,"alkTollDistanceCol alkNumericCol"),ALKMaps.Util.buildTableCell("td",null==n.TollsLocal?"&nbsp;":n.TollsLocal,null,"alkTollsLocalCol alkCurrencyCol"),
ALKMaps.Util.buildTableCell("td",null==n.TollsEUR?"&nbsp;":n.TollsEUR,null,"alkTollsEURCol alkCurrencyCol"),ALKMaps.Util.buildTableCell("td",null==n.PaymentOption?"&nbsp;":n.PaymentOption,null,"alkPaymentOptionCol")]));d=ALKMaps.Util.buildTableOrRow("table",d,"alkReportTable alkSummaryReportTable");c=e;f.TollDetail.Segment=c;f.TollDetail.Summary=d}}return f};var c=function(a,b){if(null!=a){for(var c="",d=a.split(";"),e=0;e<d.length;e++){for(var f=d[e].split(","),l=0;l<f.length;l++){var p=parseFloat(f[l]),
c=c+p.toFixed(b);l<f.length-1&&(c+=",")}e<d.length-1&&(c+=";")}a=c}return a},d=function(a){var b=c(a,6),d=ALKMaps.Util.getBrowserName();if("msie11"===d||"msie12"===d){for(d=5;3<=d;d--)if(1600<b.length)b=c(a,d);else break;1600<b.length&&alert("Total length of all stops may be too long for this request.")}return b};a.getReports=function(c){for(var e="",f=0;f<c.coords.length;f++)var j=c.coords[f],k=parseFloat(j[0]).toFixed(6),j=parseFloat(j[1]).toFixed(6),j=[k,j],e=f<c.coords.length-1?e+(j+";"):e+j;
e=d(e);f=c.stopCosts||"";k=a.convertRouteReportParams(c.options);j=c.reportOptions;if(null==j.dataVersion)j.dataVersion=ALKMaps.Util.getDatasetFromRegion(k.Region);var m={url:ALKMaps.ReportServiceURL+"route/routeReports?",params:{stops:e,stopCosts:null==f?"":f,vehType:k.VehicleType,routeType:k.RoutingType,hwyOnly:k.HighwayOnly,custRdSpeeds:k.CustRdSpeeds,avoidFavors:k.UseAvoidFavors,overrideClass:k.ClassOverrides,distUnits:k.DistanceUnits,fuelUnits:k.FuelUnits,avoidTolls:k.TollDiscourage,inclFerryDist:k.InclFerryDist,
openBorders:k.BordersOpen,restrOverrides:k.OverrideRestrict,hazMat:k.HazMatType,tunnelCategory:k.TunnelCategory,routeOpt:k.RouteOptimization,lang:null==j.lang&&null!=k.Lang?k.Lang:j.lang,hubRouting:k.HubRouting,vehDimUnits:k.TrkUnits,vehHeight:k.TrkHeight,vehLength:k.TrkLength,vehWidth:k.TrkWidth,vehWeight:k.TrkWeight,axles:k.TrkAxles,truckConfig:k.TruckConfig,LCV:k.TrkLCV,reports:null==j.type?"Mileage":j.type,reportFmt:j.format,inclTollData:k.InclTollData,fuelEconLoad:k.FuelEconLoad,fuelEconEmpty:k.FuelEconEmpty,
costPerFuelUnit:k.CostPerFuelUnit,costGHG:k.CostGHG,costMaintLoad:k.CostMaintLoad,costMaintEmpty:k.CostMaintEmpty,costTimeLoad:k.CostTimeLoad,costTimeEmpty:k.CostTimeEmpty,tollCurrency:k.TollCurrency,exchangeRate:k.ExchangeRate,tollPlan:k.TollPlan,citeInt:k.CiteInt,dataVersion:j.dataVersion,region:b(j.dataVersion,k.Region),estimatedTimeOpts:null==k.EstimatedTimeOpts?j.estimatedTimeOpts:k.EstimatedTimeOpts,breakInterval:null==k.BreakInterval?j.breakInterval:k.BreakInterval,breakLength:null==k.BreakLength?
j.breakLength:k.BreakLength,borderWait:null==k.BorderWait?j.borderWait:k.BorderWait,remHrsOfSvc:null==k.RemHrsOfSvc?j.remHrsOfSvc:k.RemHrsOfSvc,useTraffic:null==k.UseTraffic?j.useTraffic:k.UseTraffic,routeId:j.routeId,elevLimit:k.ElevLimit,urgency:k.Urgency,certainty:k.Certainty,severity:k.Severity,eventNames:k.EventNames,ferryDiscourage:k.FerryDiscourage,condenseDirs:j.condenseDirs,afSetIDs:k.AFSetIDs,governorSpeedLimit:k.GovernorSpeedLimit,sideOfStreetAdherence:k.SideOfStreetAdherence,trlType:j.trlType,
trlMaxWt:j.trlMaxWt,trlMaxHt:j.trlMaxHt,trlMaxAxles:j.trlMaxAxles,trlCount:j.trlCount,minPoll:j.minPoll,emiType:j.emiType,useSites:k.UseSites,avoidState:k.AvoidState,avoidCountry:k.AvoidCountry,favorState:k.FavorState,favorCountry:k.FavorCountry,tollroads:k.TollRoads,assetID:k.AssetID,maintainHeading:k.MaintainHeading,hazMatTypes:k.HazMatTypes,tunnelCategories:k.TunnelCategories},withCredentials:!1,async:c.async,success:c.success,failure:c.failure};return ALKMaps.Request.makeSmartRequest(m,ALKMaps.Request.GET,
function(b){var b=ALKMaps.Request.parseJSONReponse(b),c;b&&(c=null!=m.params.reportFmt&&"JSON"===m.params.reportFmt.toUpperCase()?b:a.generateHTMLReports(b,m.params.distUnits));return c})};a.postReports=function(b){var b=b||{},c=b.request,d=b.dataVersion;null==d&&null!=c.ReportRoutes[0]&&null!=c.ReportRoutes[0].Stops[0]&&(d=ALKMaps.Util.getDatasetFromRegion(c.ReportRoutes[0].Stops[0].Region));var e=JSON.stringify(c);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"route/routeReports?dataVersion="+
d,headers:{"Content-Type":"application/json"},data:e,success:b.success,failure:b.failure},ALKMaps.Request.POST,function(b){var b=ALKMaps.Request.parseJSONReponse(b),d=c.ReportRoutes[0],e;b&&(e=null!=d.ReportingOptions.reportFmt&&"JSON"===d.ReportingOptions.reportFmt.toUpperCase()?b:a.generateHTMLReports(b,d.Options.distUnits));return e})};a.getRoutePath=function(c){var e=c.stops,f=a.convertRouteReportParams(c.options),e=d(e);f.DataSet=null!=c.options.dataset?ALKMaps.Util.getDataSet(c.options.dataset):
ALKMaps.Util.getDatasetFromRegion(f.Region);var j=c.async,k=c.success,c=c.failure,e={url:ALKMaps.RouteServiceURL+"route/routePath?",params:{stops:e,vehType:f.VehicleType,routeType:f.RoutingType,hwyOnly:f.HighwayOnly,avoidFavors:f.UseAvoidFavors,overrideClass:f.ClassOverrides,distUnits:f.DistanceUnits,avoidTolls:f.TollDiscourage,openBorders:f.BordersOpen,overrideRestrict:f.OverrideRestrict,hazMat:f.HazMatType,tunnelCategory:f.TunnelCategory,routeOpt:f.RouteOptimization,hubRouting:f.HubRouting,vehDimUnits:f.TrkUnits,
vehHeight:f.TrkHeight,vehLength:f.TrkLength,vehWidth:f.TrkWidth,vehWeight:f.TrkWeight,axles:f.TrkAxles,LCV:f.TrkLCV,region:b(f.DataSet,f.Region),dataset:f.DataSet,estimatedTimeOpts:f.EstimatedTimeOpts,useTraffic:f.UseTraffic,truckConfig:f.TruckConfig,elevLimit:f.ElevLimit,ferryDiscourage:f.FerryDiscourage,afSetIDs:f.AFSetIDs,governorSpeedLimit:f.GovernorSpeedLimit,sideOfStreetAdherence:f.SideOfStreetAdherence,useSites:f.UseSites,includeplids:f.Includeplids,includeVehicleRestrictedCleanupPoints:f.IncludeVehicleRestrictedCleanupPoints,
avoidState:f.AvoidState,avoidCountry:f.AvoidCountry,favorState:f.FavorState,favorCountry:f.FavorCountry,tollroads:f.TollRoads,assetID:f.AssetID,maintainHeading:f.MaintainHeading,hazMatTypes:f.HazMatTypes,tunnelCategories:f.TunnelCategories},async:j,withCredentials:!1,success:k,failure:c};ALKMaps.Request.GET(e)};var e=function(a){var a=a||{},b=a.request,c=a.dataset,c=null!=c?ALKMaps.Util.getDataSet(c):null!=b.Routes&&Array.isArray(b.Routes)?ALKMaps.Util.getDatasetFromRegion(b.Routes[0].Stops[0].Region):
ALKMaps.Util.getDatasetFromRegion(b.Route.Stops[0].Region),b=JSON.stringify(b);return{url:ALKMaps.RestServiceURL+"route/routepath?dataset="+c,headers:{"Content-Type":"application/json"},data:b,success:a.success,failure:a.failure}};a.postRoutePath=function(a){a=e(a);return ALKMaps.Request.makeSmartRequest(a,ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.postRoutePathRaw=function(a){a=e(a);return ALKMaps.Request.POST(a)};a.getDerivedRoutePath=function(a){var b=a.options||{},c=a.pings,e=a.success,
f=a.failure,m=!0===a.returnJSON?!0:!1,c=d(c),a={routePings:c};if("undefined"!==typeof b.region)a.region=ALKMaps.Util.getRegion(b.region);a.dataset="undefined"!==typeof b.dataset?ALKMaps.Util.getDataSet(b.dataset):ALKMaps.Util.getDatasetFromRegion(a.region);if("undefined"!==typeof b.offRouteMiles)a.offRouteMiles=b.offRouteMiles;if("undefined"!==typeof b.highwayOnly)a.hwyOnly=b.highwayOnly;if("undefined"!==typeof b.vehicleType)a.vehType=b.vehicleType;if("undefined"!==typeof b.routingType)a.routeType=
b.routingType;if("undefined"!==typeof b.classOverrides)a.overrideClass=b.classOverrides;if("undefined"!==typeof b.distanceUnits)a.distUnits=b.distanceUnits;if("undefined"!==typeof b.tollDiscourage)a.avoidTolls=b.tollDiscourage;if("undefined"!==typeof b.bordersOpen)a.openBorders=b.bordersOpen;if("undefined"!==typeof b.overrideRestrict)a.overrideRestrict=b.overrideRestrict;if("undefined"!==typeof b.hazMatType)a.hazMat=b.hazMatType;if("undefined"!==typeof b.tunnelCategory)a.tunnelCategory=b.tunnelCategory;
if("undefined"!==typeof b.trkUnits)a.vehDimUnits=b.trkUnits;if("undefined"!==typeof b.trkHeight)a.vehHeight=b.trkHeight;if("undefined"!==typeof b.trkLength)a.vehLength=b.trkLength;if("undefined"!==typeof b.trkWidth)a.vehWidth=b.trkWidth;if("undefined"!==typeof b.trkWeight)a.vehWeight=b.trkWeight;if("undefined"!==typeof b.trkAxles)a.axles=b.trkAxles;if("undefined"!==typeof b.trkLCV)a.LCV=b.trkLCV;if("undefined"!==typeof b.estimatedTimeOpts)a.estimatedTimeOpts=b.estimatedTimeOpts;if("undefined"!==typeof b.useTraffic)a.useTraffic=
b.useTraffic;if("undefined"!==typeof b.elevLimit)a.elevLimit=b.elevLimit;if("undefined"!==typeof b.ferryDiscourage)a.ferryDiscourage=b.ferryDiscourage;if("undefined"!==typeof b.afSetIDs)a.afSetIDs=b.afSetIDs;if("undefined"!==typeof b.governorSpeedLimit)a.governorSpeedLimit=b.governorSpeedLimit;if("undefined"!==typeof b.sideOfStreetAdherence)a.sideOfStreetAdherence=b.sideOfStreetAdherence;if("undefined"!==typeof b.avoidState)a.avoidState=b.avoidState;if("undefined"!==typeof b.avoidCountry)a.avoidCountry=
b.avoidCountry;if("undefined"!==typeof b.favorState)a.favorState=b.favorState;if("undefined"!==typeof b.favorCountry)a.favorCountry=b.favorCountry;if("undefined"!==typeof b.tollroads)a.tollroads=b.tollroads;if("undefined"!==typeof b.hazMatTypes)a.hazMatTypes=b.hazMatTypes;if("undefined"!==typeof b.tunnelCategories)a.tunnelCategories=b.tunnelCategories;ALKMaps.Request.GET({url:ALKMaps.RouteServiceURL+"derivedRoute/routePath?",params:a,async:!0,withCredentials:!1,success:function(a){var b=ALKMaps.Request.parseJSONReponse(a);
if(e)if(!0===m)e(b);else{a=[];if(b)for(var b=b.geometry.coordinates,c=0;c<b.length;c++)for(var d=0;d<b[c].length;d++)a.push(b[c][d]);e(a)}},failure:f})};a.postDerivedRoutePath=function(a){var a=a||{},b=a.request,c=a.dataset,c=null!=c?ALKMaps.Util.getDataSet(c):ALKMaps.Util.getDatasetFromRegion(),b=JSON.stringify(b);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"derivedRoute/routePath?dataset="+c,headers:{"Content-Type":"application/json"},data:b,success:a.success,failure:a.failure},
ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.postDerivedRouteReports=function(a){var a=a||{},b=a.request,c=a.dataset,c=null!=c?ALKMaps.Util.getDataSet(c):ALKMaps.Util.getDatasetFromRegion(),b=JSON.stringify(b);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"derivedRoute/routeReports?dataset="+c,headers:{"Content-Type":"application/json"},data:b,success:a.success,failure:a.failure},ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.getRoadSurfaceRoute=function(a){var a=
a||{},b=a.provider||"Default",c={routeDuration:a.routeDuration,routePath:a.routePath},c=JSON.stringify(c);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"roadSurface/route?provider="+b,headers:{"Content-Type":"application/json"},data:c,async:a.async,success:a.success,withCredentials:!1,failure:a.failure},ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.convertRouteReportParams=function(a){var b={};b.VehicleType=void 0!==a.vehicleType?a.vehicleType:a.VehicleType;b.RoutingType=
void 0!==a.routingType?a.routingType:a.RoutingType;b.HighwayOnly=void 0!==a.highwayOnly?a.highwayOnly:a.HighwayOnly;b.CustRdSpeeds=void 0!==a.custRdSpeeds?a.custRdSpeeds:a.CustRdSpeeds;b.UseAvoidFavors=void 0!==a.useAvoidFavors?a.useAvoidFavors:a.UseAvoidFavors;b.ClassOverrides=void 0!==a.classOverrides?a.classOverrides:a.ClassOverrides;b.DistanceUnits=void 0!==a.distanceUnits?a.distanceUnits:a.DistanceUnits;b.FuelUnits=void 0!==a.fuelUnits?a.fuelUnits:a.FuelUnits;b.TollDiscourage=void 0!==a.tollDiscourage?
a.tollDiscourage:a.TollDiscourage;b.InclFerryDist=void 0!==a.inclFerryDist?a.inclFerryDist:a.InclFerryDist;b.BordersOpen=void 0!==a.bordersOpen?a.bordersOpen:a.BordersOpen;b.OverrideRestrict=void 0!==a.overrideRestrict?a.overrideRestrict:a.OverrideRestrict;b.HazMatType=void 0!==a.hazMatType?a.hazMatType:a.HazMatType;b.TunnelCategory=void 0!==a.tunnelCategory?a.tunnelCategory:a.TunnelCategory;b.RouteOptimization=void 0!==a.routeOptimization?a.routeOptimization:a.RouteOptimization;b.Lang=void 0!==a.lang?
a.lang:a.Lang;b.HubRouting=void 0!==a.hubRouting?a.hubRouting:a.HubRouting;b.TrkUnits=void 0!==a.trkUnits?a.trkUnits:a.TrkUnits;b.TrkHeight=void 0!==a.trkHeight?a.trkHeight:a.TrkHeight;b.TrkLength=void 0!==a.trkLength?a.trkLength:a.TrkLength;b.TrkWidth=void 0!==a.trkWidth?a.trkWidth:a.TrkWidth;b.TrkWeight=void 0!==a.trkWeight?a.trkWeight:a.TrkWeight;b.TrkAxles=void 0!==a.trkAxles?a.trkAxles:a.TrkAxles;b.TruckConfig=void 0!==a.truckConfig?a.truckConfig:a.TruckConfig;b.TrkLCV=void 0!==a.trkLCV?a.trkLCV:
a.TrkLCV;b.InclTollData=void 0!==a.inclTollData?a.inclTollData:a.InclTollData;b.FuelEconLoad=void 0!==a.fuelEconLoad?a.fuelEconLoad:a.FuelEconLoad;b.FuelEconEmpty=void 0!==a.fuelEconEmpty?a.fuelEconEmpty:a.FuelEconEmpty;b.CostPerFuelUnit=void 0!==a.costPerFuelUnit?a.costPerFuelUnit:a.CostPerFuelUnit;b.CostGHG=void 0!==a.costGHG?a.costGHG:a.CostGHG;b.CostMaintLoad=void 0!==a.costMaintLoad?a.costMaintLoad:a.CostMaintLoad;b.CostMaintEmpty=void 0!==a.costMaintEmpty?a.costMaintEmpty:a.CostMaintEmpty;b.CostTimeLoad=
void 0!==a.costTimeLoad?a.costTimeLoad:a.CostTimeLoad;b.CostTimeEmpty=void 0!==a.costTimeEmpty?a.costTimeEmpty:a.CostTimeEmpty;b.TollCurrency=void 0!==a.tollCurrency?a.tollCurrency:a.TollCurrency;b.ExchangeRate=void 0!==a.exchangeRate?a.exchangeRate:a.ExchangeRate;b.TollPlan=void 0!==a.tollPlan?a.tollPlan:a.TollPlan;b.CiteInt=void 0!==a.citeInt?a.citeInt:a.CiteInt;b.Region=void 0!==a.region?ALKMaps.Util.getRegion(a.region):ALKMaps.Util.getRegion(a.Region);b.EstimatedTimeOpts=null!=a.estimatedTimeOpts?
a.estimatedTimeOpts:a.EstimatedTimeOpts;b.BreakInterval=null!=a.breakInterval?a.breakInterval:a.BreakInterval;b.BreakLength=null!=a.breakLength?a.breakLength:a.BreakLength;b.BorderWait=null!=a.borderWait?a.borderWait:a.BorderWait;b.RemHrsOfSvc=null!=a.remHrsOfSvc?a.remHrsOfSvc:a.RemHrsOfSvc;b.UseTraffic=null!=a.useTraffic?a.useTraffic:a.UseTraffic;b.ElevLimit=null!=a.elevLimit?a.elevLimit:a.ElevLimit;b.Urgency=null!=a.urgency?a.urgency:a.Urgency;b.Severity=null!=a.severity?a.severity:a.Severity;b.Certainty=
null!=a.certainty?a.certainty:a.Certainty;b.EventNames=null!=a.eventNames?a.eventNames:a.EventNames;b.FerryDiscourage=null!=a.ferryDiscourage?a.ferryDiscourage:a.FerryDiscourage;b.AFSetIDs=null!=a.afSetIDs?a.afSetIDs:a.AFSetIDs;b.GovernorSpeedLimit=null!=a.governorSpeedLimit?a.governorSpeedLimit:a.GovernorSpeedLimit;b.SideOfStreetAdherence=null!=a.sideOfStreetAdherence?a.sideOfStreetAdherence:a.SideOfStreetAdherence;b.UseSites=null!=a.useSites?a.useSites:a.UseSites;b.Includeplids=null!=a.includeplids?
a.includeplids:a.Includeplids;b.IncludeVehicleRestrictedCleanupPoints=null!=a.includeVehicleRestrictedCleanupPoints?a.includeVehicleRestrictedCleanupPoints:a.IncludeVehicleRestrictedCleanupPoints;b.AvoidState=null!=a.avoidState?a.avoidState:a.AvoidState;b.FavorState=null!=a.favorState?a.favorState:a.FavorState;b.AvoidCountry=null!=a.avoidCountry?a.avoidCountry:a.AvoidCountry;b.FavorCountry=null!=a.favorCountry?a.favorCountry:a.FavorCountry;b.TollRoads=null!=a.tollroads?a.tollroads:a.TollRoads;b.AssetID=
null!=a.assetID?a.assetID:a.AssetID;b.MaintainHeading=null!=a.maintainHeading?a.maintainHeading:a.MaintainHeading;b.HazMatTypes=null!=a.hazMatTypes?a.hazMatTypes:a.HazMatTypes;b.TunnelCategories=null!=a.tunnelCategories?a.tunnelCategories:a.TunnelCategories;return b};var f=function(){var a=navigator.userAgent.match(/MSIE\s?(\d+)(?:\.(\d+))?/i);return null!==a?parseInt(a[1]):-1};a.addAvoidFavorSet=function(a){var a=a||{},b={url:ALKMaps.RouteServiceURL+("AvoidFavorSets?name="+a.name+"&tag="+a.tag),
headers:{"Content-Type":"application/json"},async:a.async,withCredentials:!1,success:function(b){a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)}};b.params=b.params||{};b.params.dataset=a.dataset||"Current";return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.getAvoidFavorSets=function(a){var a=a||{},b={url:ALKMaps.RouteServiceURL+"AvoidFavorSets/"+(a.setId||-1)+"?",params:{name:a.name,
tag:a.tag,detail:null==a.detail?!0:a.detail},async:a.async,withCredentials:!1,success:function(b){a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)}};b.params=b.params||{};b.params.dataset=a.dataset||"Current";return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.updateAvoidFavorSet=function(a){var a=a||{},b=a.setId,c=a.tag,d=a.name,e="AvoidFavorSets/"+b+"?",m=ALKMaps.Request.PUT,
l=f();if(10>l&&-1!==l)e="XDR/AvoidFavorSets/"+b+"/update?",m=ALKMaps.Request.POST;b={url:ALKMaps.RouteServiceURL+e,params:{name:d,tag:c},headers:{"Content-Type":"application/json"},async:a.async,withCredentials:!1,success:function(b){a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)}};b.params=b.params||{};b.params.dataset=a.dataset||"Current";return ALKMaps.Request.makeSmartRequest(b,m,ALKMaps.Request.parseJSONReponse)};
a.deleteAvoidFavorSet=function(a){var a=a||{},b=a.setId,c="AvoidFavorSets/"+b,d=ALKMaps.Request.DELETE,e=f();if(10>e&&-1!==e)c="XDR/AvoidFavorSets/"+b+"/delete",d=ALKMaps.Request.POST;b={url:ALKMaps.RouteServiceURL+c,headers:{"Content-Type":"application/json"},async:a.async,withCredentials:!1,success:function(b){a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)}};b.params=b.params||{};b.params.dataset=a.dataset||"Current";
return ALKMaps.Request.makeSmartRequest(b,d,ALKMaps.Request.parseJSONReponse)};a.addAvoidFavor=function(a){var a=a||{},b=a.setId,c=a.projection,d=a.region,d=ALKMaps.Util.getRegion(d);if(-180>a.mapBounds.left)a.mapBounds.left=(a.mapBounds.left%180+180)%180;if(180<a.mapBounds.left)a.mapBounds.left=(a.mapBounds.left%-180-180)%-180;if(-180>a.mapBounds.right)a.mapBounds.right=(a.mapBounds.right%180+180)%180;if(180<a.mapBounds.right)a.mapBounds.right=(a.mapBounds.right%-180-180)%-180;var e=a.afPoint,c=
{MapBound1:[a.mapBounds.left,a.mapBounds.top],MapBound2:[a.mapBounds.right,a.mapBounds.bottom],Projection:c,Region:d,AFPoint:{Type:"f"===e.type||"F"===e.type||"2"===e.type||2===e.type?2:1,Point:[e.point.lon,e.point.lat],Comment:e.comment}},d="AvoidFavorSets/"+b+"/AvoidFavor",m=f();10>m&&-1!==m&&(d="XDR/AvoidFavorSets/"+b+"/AvoidFavor/add?");b={url:ALKMaps.RouteServiceURL+d,headers:{"Content-Type":"application/json"},async:a.async,withCredentials:!1,success:function(b){a.success&&"function"===typeof a.success&&
(10>m&&-1!==m?a.success(b.XDRAddAvoidFavorResult):a.success(b.AddAvoidFavorResult))},failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)}};10>m&&-1!==m?b.params={jsonAfMapLink:JSON.stringify(c)}:b.data=JSON.stringify({avoidFavorMapLink:c});b.params=b.params||{};b.params.dataset=a.dataset||"Current";return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.deleteAvoidFavor=function(a){var a=a||{},b=a.setId,c=a.afId,d="AvoidFavorSets/"+
b+"/AvoidFavor/"+c,e=ALKMaps.Request.DELETE,m=f();if(10>m&&-1!==m)d="XDR/AvoidFavorSets/"+b+"/AvoidFavor/delete/"+c,e=ALKMaps.Request.POST;b={url:ALKMaps.RouteServiceURL+d,headers:{"Content-Type":"application/json"},async:a.async,withCredentials:!1,success:function(b){a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)}};b.params=b.params||{};b.params.dataset=a.dataset||"Current";return ALKMaps.Request.makeSmartRequest(b,
e,ALKMaps.Request.parseJSONReponse)};a.poiRadiusSearch=function(a){var a=a||{},b=[a.center.lon,a.center.lat],c=ALKMaps.Util.getRegion(a.region),d;d=null!=a.dataset?ALKMaps.Util.getDataSet(a.dataset):ALKMaps.Util.getDatasetFromRegion(c);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"poi",params:{center:b,region:c,dataset:d,radius:a.radius,radiusUnits:a.radiusUnits,poiCategories:a.poiCategories||"All"},async:!0,success:function(b){a.success&&"function"===typeof a.success&&a.success(b)},
failure:function(b){a.failure&&"function"===typeof a.failure&&a.failure(b)},withCredentials:!1},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.weatherAlerts=function(a){a=a||{};a.bounds=null!=a.bounds&&a.bounds instanceof ALKMaps.Bounds?a.bounds:null;var b=Array.isArray(a.point)?[a.point[0],a.point[1]]:null,c=null;if(Array.isArray(a.route))for(var c="",d=0;d<a.route.length;d++)var e=a.route[d],f=parseFloat(e[0]).toFixed(5),e=parseFloat(e[1]).toFixed(5),e=[f,e],c=d<a.route.length-1?c+(e+
";"):c+e;a.options=a.options||{};a.options.category=a.options.category||"";a.options.urgency=a.options.urgency||"";a.options.severity=a.options.severity||"";a.options.certainty=a.options.certainty||"";a.options.category="all"===a.options.category.toLowerCase()?"":a.options.category;a.options.urgency="all"===a.options.urgency.toLowerCase()?"":a.options.urgency;a.options.severity="all"===a.options.severity.toLowerCase()?"":a.options.severity;a.options.certainty="all"===a.options.certainty.toLowerCase()?
"":a.options.certainty;if(null!=a.options.eventNames&&"string"===typeof a.options.eventNames)a.options.eventNames=[a.options.eventNames];f=d=null;if(null!=a.bounds){if(-180>a.bounds.left)a.bounds.left=(a.bounds.left%180+180)%180;if(180<a.bounds.left)a.bounds.left=(a.bounds.left%-180-180)%-180;if(-180>a.bounds.right)a.bounds.right=(a.bounds.right%180+180)%180;if(180<a.bounds.right)a.bounds.right=(a.bounds.right%-180-180)%-180;d=[a.bounds.left,a.bounds.top];f=[a.bounds.right,a.bounds.bottom]}else null==
b&&null==c&&(d=[-179,0],f=[0,90]);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"WeatherAlerts",params:{pt1:d,pt2:f,point:b,route:c,category:a.options.category,urgency:a.options.urgency,severity:a.options.severity,certainty:a.options.certainty,eventNames:a.options.eventNames,startTime:a.options.startTime,endTime:a.options.endTime},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&
a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.weatherAlertsGeoJson=function(a){return ALKMaps.Request.makeSmartRequest({url:ALKMaps.ContentServiceURL_JSON+"WeatherAlertsBBox/85.05/-179/0/-1",success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.countyPolygons=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+
"polygons/county",params:{codes:a.codes},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.zipPolygons=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"polygons/zip",params:{zipcodes:a.codes},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=
a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.statePolygons=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"polygons/state",params:{states:a.states},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getDriveTimePolygon=function(a){var a=
a||{},b=[a.center.lon,a.center.lat],c=a.options||{},d=ALKMaps.Util.getRegion(c.region),e;e=null!=c.dataset?ALKMaps.Util.getDataSet(c.dataset):ALKMaps.Util.getDatasetFromRegion(d);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"route/DriveTimePolygon",params:{center:b,minutes:a.minutes,vehType:c.vehicleType,routeType:c.routingType,hwyOnly:c.highwayOnly,overrideClass:c.classOverrides,distUnits:c.distanceUnits,avoidTolls:c.tollDiscourage,openBorders:c.bordersOpen,overrideRestrict:c.overrideRestrict,
hazMat:c.hazMatType,hazMatTypes:c.hazMatTypes,tunnelCategory:c.tunnelCategory,tunnelCategories:c.tunnelCategories,vehDimUnits:c.trkUnits,vehHeight:c.trkHeight,vehLength:c.trkLength,vehWidth:c.trkWidth,vehWeight:c.trkWeight,axles:c.trkAxles,LCV:c.trkLCV,elevLimit:c.elevLimit,region:d,dataset:e},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};
a.getTrafficIncidentsBBox=function(a){var a=a||{},b=[a.bbox[0].toFixed(6),a.bbox[1].toFixed(6),a.bbox[2].toFixed(6),a.bbox[3].toFixed(6)],c=Math.floor(Math.random()*ALKMaps.TrafficIncContentServiceURL.length);return ALKMaps.Request.makeSmartRequest({requestId:a.requestId,url:ALKMaps.TrafficIncContentServiceURL[c]+"TrafficIncidentsBBox/"+a.requestId+"/"+b[3]+"/"+b[0]+"/"+b[1]+"/"+b[2],params:{language:a.language},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=
a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getTrafficCamerasBox=function(a){a=a||{};a.bbox=a.bbox||[-179.999999,-85,180,85];var b=a.bbox[0]%180,c=a.bbox[2]%180;-180>a.bbox[0]&&(0===Math.floor(a.bbox[0]/180)%2&&(b+=180),a.bbox[0]=b);180<a.bbox[0]&&(0!==Math.floor(a.bbox[0]/180)%2&&(b-=180),a.bbox[0]=b);-180>a.bbox[2]&&(0===Math.floor(a.bbox[2]/180)%2&&(c+=180),a.bbox[2]=c);180<a.bbox[2]&&(0!==Math.floor(a.bbox[2]/180)%2&&(c-=180),
a.bbox[2]=c);b=[a.bbox[0].toFixed(6),a.bbox[1].toFixed(6),a.bbox[2].toFixed(6),a.bbox[3].toFixed(6)];return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"trafficCams/box",async:a.async,params:{bbox:b},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getTrafficCameraMetadata=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+
"trafficCam/metadata",params:{id:a.id},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getAttribution=function(a){var a=a||{},b=a.className||a.layerClass.toString(),c=a.style,d=a.imgOption,e=a.region,f=a.provider,a=!1===a.useHyperlink?!1:!0,l=null,p=new Date,n=!1;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||
navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))n=!0;switch(b){case "ALKMaps.Layer.BaseMap":ALKMaps.STYLE.compare(c,ALKMaps.STYLE.TERRAIN)&&"Foreground"===d?(f="https://www.mapbox.com/about/maps/",p="Imagery &copy; MapBox",l=!0===a?!1===n?' <a href="'+f+'" target="_blank">'+p+"</a>":' <a href="" ontouchstart="window.open('+("'"+f+"'")+')">'+p+"</a>":p):
ALKMaps.STYLE.compare(c,ALKMaps.STYLE.SATELLITE)&&"Foreground"===d?(f="http://bit.ly/mapsapiview",p="Imagery &copy; Digital Globe",l=!0===a?!1===n?' <a href="'+f+'" target="_blank">'+p+"</a>":' <a href="" ontouchstart="window.open('+("'"+f+"'")+')">'+p+"</a>":p):2===e||"AS"===e?(f="https://maps.alk.com/Account/MapDataDisclaimer/",p="Japan &copy; Shobunsha Publications, Inc. &copy; Shobunsha",l=!0===a?!1===n?', <a href="'+f+'" target="_blank">'+p+"</a>":', <a href=""  ontouchstart="window.open('+("'"+
f+"'")+')">'+p+"</a>":p):4!==e&&"NA"!==e&&(f="https://maps.alk.com/Account/MapDataDisclaimer/",p="&copy; 1987 &ndash; "+p.getFullYear()+" HERE",l=!0===a?!1===n?', <a href="'+f+'" target="_blank">'+p+"</a>":', <a href=""  ontouchstart="window.open('+("'"+f+"'")+')">'+p+"</a>":p);break;case "ALKMaps.Layer.Traffic":4===e||"NA"===e?l=' Traffic by <img src="'+ALKMaps.Util.getImageLocation("inrix-logo.png")+'"/>':(f="https://maps.alk.com/Account/TrafficDataDisclaimer/",p="Traffic Data: &copy; "+p.getFullYear()+
" HERE",l=!0===a?!1===n?' <a href="'+f+'" target="_blank">'+p+"</a>":' <a href=""  ontouchstart="window.open('+("'"+f+"'")+')">'+p+"</a>":p);break;case "ALKMaps.Layer.WeatherRadar":l=' Weather Data from <img src="'+ALKMaps.Util.getImageLocation("aeris-weather-logo.png")+'"/>';break;case "ALKMaps.Layer.WeatherRadarEU":l=' Weather Data from <img src="'+ALKMaps.Util.getImageLocation("wundergroundLogo_blue_horz.png")+'"/>';break;case "ALKMaps.PCMWEBUI.WeatherRadar":l=' Weather Data from <img src="'+ALKMaps.Util.getImageLocation("aeris-weather-logo.png")+
'"/>';break;case "ALKMaps.Layer.TrafficIncidents":l=' Traffic Incidents Data from <img src="'+ALKMaps.Util.getImageLocation("inrix-logo.png")+'"/>';break;case "ALKMaps.Layer.TrafficCameras":l=" Traffic Cameras: &copy; "+p.getFullYear()+" TrafficLand</a>";break;case "ALKMaps.Layer.RoadSurfaceRoute":case "ALKMaps.Layer.RoadSurface":a=" Global Weather Corporation","RC1"===f&&(a=" AerisWeather, LLC"),l=" Road Surface: &copy; "+p.getFullYear()+a+"</a>"}return l};a.getFrcs=function(a){var b=null;4<=a&&
(b=1);6<=a&&(b=3);8<=a&&(b=7);10<a&&(b=127);return b};a.postRailRoutePath=function(a){var b=a.async,c=a.success,d=a.failure,a=JSON.stringify({stops:a.stops,options:a.options});return ALKMaps.Request.POST({url:ALKMaps.RailServiceURL+"route/path",headers:{"Content-Type":"application/json"},data:a,async:b,withCredentials:!1,success:c,failure:d})};a.getRailStations=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RailServiceURL+"poi/Station?",params:{splc:a.splc},success:function(b){null!=
a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getNearestServicePoints=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.ContentServiceURL_POC+"ServiceLocations?",params:{latitude:a.lonLat.lat,longitude:a.lonLat.lon,distance:a.distance||10,listSize:a.listSize||50},success:function(b){null!=a.success&&"function"===typeof a.success&&
a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.routeMatrix=function(a){var b=a.origins,c=a.destinations,d=a.options||{},e=d.dataset;null==e&&(e=ALKMaps.Util.getDatasetFromRegion(b.region)||ALKMaps.Util.getDatasetFromRegion(c.region));for(var f=[],l=[],p=0;p<b.length;p++){var n=b[p],q=ALKMaps.Util.getRegion(n.region);f.push({Coords:{Lon:n.lonLat.lon,Lat:n.lonLat.lat},Region:q})}for(b=0;b<c.length;b++)p=
c[b],n=ALKMaps.Util.getRegion(p.region),l.push({Coords:{Lon:p.lonLat.lon,Lat:p.lonLat.lat},Region:n});c=a.async;b=a.success;a=a.failure;d=JSON.stringify({Origins:f,Destinations:l,Options:{VehicleType:d.vehicleType,RoutingType:d.routingType,HighwayOnly:d.highwayOnly,FuelRoute:d.fuelRoute,UseAvoidsAndFavors:d.useAvoidsAndFavors,ClassOverrides:d.classOverrides,DistanceUnits:d.distanceUnits||0,TollDiscourage:d.tollDiscourage,BordersOpen:d.bordersOpen,OverrideRestrict:d.overrideRestrict,HazMatType:d.hazMatType,
TunnelCategory:d.tunnelCategory,RouteOptimization:d.routeOptimization,TruckCfg:d.truckConfig,AFSetIDs:d.afSetIDs,ElevLimit:d.elevLimit,FerryDiscourage:d.ferryDiscourage,HoSOptions:d.hoSOptions,SideOfStreetAdherence:d.sideOfStreetAdherence,GovernorSpeedLimit:d.governorSpeedLimit,CustomRoadSpeeds:d.customRoadSpeeds,HazMatTypes:d.hazMatTypes,TunnelCategories:d.tunnelCategories}});return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"route/matrix?dataset="+e,headers:{"Content-Type":"application/json"},
data:d,async:c,withCredentials:!1,success:b,failure:a},ALKMaps.Request.POST,ALKMaps.Request.parseJSONReponse)};a.getSitesBox=function(a){a=a||{};a.bbox=a.bbox||[-179.999999,-85,180,85];var b=ALKMaps.Util.wrapLongitude(a.bbox[0]),c=ALKMaps.Util.wrapLongitude(a.bbox[2]);a.bbox[0]=b;a.bbox[2]=c;b=[a.bbox[0].toFixed(6),a.bbox[3].toFixed(6)];c=[a.bbox[2].toFixed(6),a.bbox[1].toFixed(6)];b={url:ALKMaps.DataAnywhereServiceURL+"sites/boundingbox?",params:{tag:a.qKey,cornerA:b,cornerB:c,siteType:a.siteType||
0,includeSiteGates:a.includeSiteGates||!1},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}};if(ALKMaps.SSOToken)b.useSSOToken=!0;return ALKMaps.Request.makeSmartRequest(b,ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getAvoidFavorGroup=function(a){a=a||{};return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"AvoidFavorSets/"+a.afSetId+"/Groups?",params:{detail:"true"},
success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getAvoidFavorBox=function(a){a=a||{};a.bbox=a.bbox||[-179.999999,-85,180,85];var b=ALKMaps.Util.wrapLongitude(a.bbox[0]),c=ALKMaps.Util.wrapLongitude(a.bbox[2]);a.bbox[0]=b;a.bbox[2]=c;var b=a.afSetId,c=[a.bbox[0].toFixed(6),a.bbox[3].toFixed(6)],d=[a.bbox[2].toFixed(6),a.bbox[1].toFixed(6)];
return ALKMaps.Request.makeSmartRequest({url:ALKMaps.RestServiceURL+"AvoidFavorSets/"+b+"?",params:{corner1:c,corner2:d,detail:"true"},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)};a.getTruckRestrictions=function(a){var a=a||{},b=[a.bbox[0].toFixed(6),a.bbox[1].toFixed(6),a.bbox[2].toFixed(6),a.bbox[3].toFixed(6)],c=Math.floor(Math.random()*
ALKMaps.VehicleRestrServiceURL.length);return ALKMaps.Request.makeSmartRequest({url:ALKMaps.VehicleRestrServiceURL[c]+"vehicleRestrictions/box",params:{requestId:a.requestId,bbox:b,language:a.language||"en",units:a.units||0,dataset:a.dataset},success:function(b){null!=a.success&&"function"===typeof a.success&&a.success(b)},failure:function(b){null!=a.failure&&"function"===typeof a.failure&&a.failure(b)}},ALKMaps.Request.GET,ALKMaps.Request.parseJSONReponse)}})(ALKMaps.Services=ALKMaps.Services||{});
(function(a){if(a)a.ALKMaps.Services=ALKMaps.Services,a=a.ALKMaps.Services,a.geocode=ALKMaps.Geocoder.geocode,a.reverseGeocode=ALKMaps.Geocoder.reverseGeocode,a.singleSearch=ALKMaps.Geocoder.singleSearch,a.singleSearchGet=ALKMaps.Geocoder.singleSearchGet})("undefined"===typeof L?null:L);ALKMaps.Layer.POI=ALKMaps.Class(ALKMaps.Layer.Markers,{displayInfo:!0,displayName:!0,poiMarkers:[],beforeMarkerAdded:null,initialize:function(a,b){b=b||{};this.displayInfo=!1===b.displayInfo?!1:!0;this.displayName=!1===b.displayName?!1:!0;ALKMaps.Layer.Markers.prototype.initialize.apply(this,arguments);this.events.register("beforemarkeradded",this,this._beforeMarkerAdded)},destroy:function(){this.events.unregister("beforemarkeradded",this,this._beforeMarkerAdded);ALKMaps.Layer.Markers.prototype.destroy.apply(this,
arguments)},radiusSearch:function(a){var b=this,c=a.radius,d=a.center.clone().transform(this.map.getProjectionObject(),new ALKMaps.Projection("EPSG:4326")),e=a.region,f=a.dataset,g=a.units||"Miles",h=a.categories||"All",i=a.options||{},j=i.externalGraphic,k=!isNaN(i.graphicWidth)?i.graphicWidth:26,m=!isNaN(i.graphicHeight)?i.graphicHeight:26,l="boolean"===typeof i.displayInfo?i.displayInfo:this.displayInfo,p="boolean"===typeof i.displayName?i.displayName:this.displayName,n=null;"undefined"!==i.limit&&
(null===i.limit||!isNaN(i.limit)&&1<=i.limit)?n=i.limit:9>parseFloat(navigator.appVersion.split("MSIE")[1])&&(n=200,m+=5,k+=5);!0===i.eraseOldSearches&&this.removeAllPOIs();var q="function"===typeof a.success?a.success:null,a="function"===typeof a.failure?a.failure:null,b=this;this.map.showLoading();ALKMaps.Services.poiRadiusSearch({radius:c,center:d,region:e,dataset:f,radiusUnits:g,poiCategories:h,success:function(a){var c=[];if(null!=q){var d=q(a);d instanceof Array&&(a=d)}for(d=0;d<a.length;d++){var e=
a[d].POILocation,f=a[d].POICategory,g=a[d].DistanceFromCenter;if(null==n||c.length<n){var h=j;if(null==h&&(h=b.getCategoryImage(f),null==h))continue;f={popupSize:new ALKMaps.Size(200,120),anchor:{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(12,-20)},overflow:"auto",category:f,distanceFromCenter:g,data:e,displayInfo:l,displayName:p,isPOI:!0};g=parseFloat(e.Coords.Lon);e=parseFloat(e.Coords.Lat);e=(new ALKMaps.LonLat(g,e)).transform(new ALKMaps.Projection("EPSG:4326"),b.map.getProjectionObject());
h=ALKMaps.Util.createAlphaImageDiv(null,null,new ALKMaps.Size(k,m),h,"absolute").innerHTML;h=ALKMaps.Marker2.Anchored.topright(null,e,new ALKMaps.Size(k,m),h,{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(-4,2)},null,f);h.backgroundColor="transparent";c.push(h)}else break}b.map.hideLoading();b.poiMarkers.push.apply(b.poiMarkers,c);b.addMarkers(c);b.redraw()},failure:a})},getCategoryImage:function(a){switch(a||""){case "Airport":a=ALKMaps.IMAGE.AIRPORT;break;case "Attractions":a=ALKMaps.IMAGE.ATTRACTION;
break;case "AutoDealership":a=ALKMaps.IMAGE.AUTO_DEALER;break;case "Automotive":a=ALKMaps.IMAGE.AUTO_REPAIR;break;case "Bank":a=ALKMaps.IMAGE.BANK;break;case "BridgesAndTunnels":a=ALKMaps.IMAGE.OTHER;break;case "BusTaxiLimo":a=ALKMaps.IMAGE.BUS_STOP;break;case "CATScales":a=ALKMaps.IMAGE.CAT_SCALE;break;case "CityHall":a=ALKMaps.IMAGE.MUNICIPAL;break;case "DieselExhaustFluid":a=ALKMaps.IMAGE.DIESEL_EXHAUST_FLUID;break;case "Dining":a=ALKMaps.IMAGE.RESTAURANT;break;case "Education":a=ALKMaps.IMAGE.SCHOOL;
break;case "Emergency":a=ALKMaps.IMAGE.MEDICAL;break;case "Entertainment":a=ALKMaps.IMAGE.ENTERTAINMENT;break;case "EventFacility":a=ALKMaps.IMAGE.PUBLIC_VENUE;break;case "FerryTerminal":a=ALKMaps.IMAGE.FERRY;break;case "Gas":a=ALKMaps.IMAGE.FUEL;break;case "GeographicFeature":a=ALKMaps.IMAGE.WEBSEARCH;break;case "Government":a=ALKMaps.IMAGE.MUNICIPAL;break;case "GroceryStore":a=ALKMaps.IMAGE.GROCERY;break;case "GuestHouse":a=ALKMaps.IMAGE.OTHER_LODGING;break;case "HighwayExit":a=ALKMaps.IMAGE.OTHER;
break;case "HighwayIntersection":a=ALKMaps.IMAGE.OTHER;break;case "IntermodalRampLarge":a=ALKMaps.IMAGE.OTHER;break;case "IntermodalRampMedium":a=ALKMaps.IMAGE.OTHER;break;case "IntermodalRampSmall":a=ALKMaps.IMAGE.OTHER;break;case "LCVLot":a=ALKMaps.IMAGE.OTHER;break;case "Lodging":a=ALKMaps.IMAGE.HOTEL;break;case "Marina":a=ALKMaps.IMAGE.MARINA;break;case "Municipal":a=ALKMaps.IMAGE.MUNICIPAL;break;case "OilAndGas":a=ALKMaps.IMAGE.OIL_GAS;break;case "Other":a=ALKMaps.IMAGE.OTHER;break;case "Parking":a=
ALKMaps.IMAGE.PARKING;break;case "Parks":a=ALKMaps.IMAGE.REST_AREA;break;case "PlaceOfWorship":a=ALKMaps.IMAGE.PLACE_OF_WORSHIP;break;case "PoliceStation":a=ALKMaps.IMAGE.MUNICIPAL;break;case "RailwayStation":a=ALKMaps.IMAGE.TRAIN_STATION;break;case "RentACar":a=ALKMaps.IMAGE.AUTO_RENTAL;break;case "Retail":a=ALKMaps.IMAGE.RETAIL;break;case "RVServices":a=ALKMaps.IMAGE.RV;break;case "SportsRec":a=ALKMaps.IMAGE.RECREATION;break;case "Travel":a=ALKMaps.IMAGE.ATTRACTION;break;case "TruckServices":a=
ALKMaps.IMAGE.TRUCK_STOP;break;case "WeighStation":a=ALKMaps.IMAGE.CAT_SCALE;break;default:a=null}return a},removeAllPOIs:function(){for(var a=[],b=0;b<this.markers.length;b++){var c=this.markers[b];!0!==c.attributes.isPOI&&a.push(c)}this.clearMarkers();this.addMarkers(a);this.poiMarkers=[]},removeCategory:function(a){if(null!=a)for(var b=0;b<this.poiMarkers.length;b++)this.poiMarkers[b].attributes.category===a&&this.removeMarker(this.poiMarkers[b])},setCategoryVisibility:function(a,b){if(null!=a){for(var c=
0;c<this.poiMarkers.length;c++)if(this.poiMarkers[c].attributes.category===a){var d=this.poiMarkers[c];null!=b&&"boolean"===typeof b&&d.setVisibility(b)}this.redraw()}},getPoisBy:function(a,b){var c=[],a=a.toUpperCase();if(null!=a&&null!=b)for(var d=0;d<this.poiMarkers.length;d++)if("CATEGORY"===a)this.poiMarkers[d].attributes.category===b&&c.push(this.poiMarkers[d]);else if("PLACENAME"===a)this.poiMarkers[d].attributes.data.PlaceName===b&&c.push(this.poiMarkers[d]);else if("STREETADDRESS"===a)this.poiMarkers[d].attributes.data.Address.StreetAddress===
b&&c.push(this.poiMarkers[d]);else if("STREET"===a)-1<this.poiMarkers[d].attributes.data.Address.StreetAddress.indexOf(b)&&c.push(this.poiMarkers[d]);else if("CITY"===a)this.poiMarkers[d].attributes.data.Address.City===b&&c.push(this.poiMarkers[d]);else if("STATE"===a)this.poiMarkers[d].attributes.data.Address.State===b&&c.push(this.poiMarkers[d]);else if("ZIP"===a){var e=b;"string"===typeof b&&(e=parseInt(b));var f=this.poiMarkers[d].attributes.data.Address.Zip||"",f=-1<f.indexOf("-")?parseInt(f.split("-")[0]):
parseInt(f);f===e&&c.push(this.poiMarkers[d])}else"DISTANCEFROMCENTER"===a&&Math.floor(this.poiMarkers[d].attributes.distanceFromCenter.Value)===b&&c.push(this.poiMarkers[d]);return c},_beforeMarkerAdded:function(a){var b=a.marker;if(!0===b.attributes.displayInfo){if(null==b.attributes.popupContentHTML)b.attributes.popupContentHTML="<p>Name: "+b.attributes.data.PlaceName+"<br/>Category: "+b.attributes.category+"</p>"}else b.attributes.popupContentHTML=null;if(!0===b.attributes.displayName){var c=
new ALKMaps.Popup.Anchored(b.attributes.data.PlaceName,b.lonlat,null,b.attributes.data.PlaceName,null,!1);c.autoSize=!0;c.updateRelativePosition=function(){switch(c.relativePosition){case "tl":c.anchor={size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(0,-b.contentSize.h)};break;case "br":c.anchor={size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(b.contentSize.w,0)};break;case "tr":c.anchor={size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(b.contentSize.w,-b.contentSize.h)};break;case "bl":c.anchor=
{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(0,0)}}};b.events.register("markerover",this,function(){this.map.addPopup(c);c.updateRelativePosition()});b.events.register("markerout",this,function(){this.map.removePopup(c)})}null!=this.beforeMarkerAdded&&"function"===typeof this.beforeMarkerAdded&&this.beforeMarkerAdded(b)},CLASS_NAME:"ALKMaps.Layer.POI"});(function(a){a.POI_ICONS=a.POI_ICONS||[{ID:127,BMPName:"municipal",PremiumImage:!1},{ID:189,BMPName:"industrial_estate",PremiumImage:!1},{ID:190,BMPName:"retail",PremiumImage:!1},{ID:191,BMPName:"retail",PremiumImage:!1},{ID:192,BMPName:"retail",PremiumImage:!1},{ID:193,BMPName:"retail",PremiumImage:!1},{ID:194,BMPName:"retail",PremiumImage:!1},{ID:195,BMPName:"retail",PremiumImage:!1},{ID:196,BMPName:"retail",PremiumImage:!1},{ID:197,BMPName:"retail",PremiumImage:!1},{ID:198,BMPName:"recreation",
PremiumImage:!1},{ID:199,BMPName:"recreation",PremiumImage:!1},{ID:200,BMPName:"recreation",PremiumImage:!1},{ID:203,BMPName:"recreation",PremiumImage:!1},{ID:204,BMPName:"recreation",PremiumImage:!1},{ID:205,BMPName:"recreation",PremiumImage:!1},{ID:713,BMPName:"bp",PremiumImage:!0},{ID:714,BMPName:"murphy_usa",PremiumImage:!0},{ID:966,BMPName:"clarion",PremiumImage:!0},{ID:967,BMPName:"quality_inn",PremiumImage:!0},{ID:715,BMPName:"ampm",PremiumImage:!0},{ID:716,BMPName:"quiktrip",PremiumImage:!0},
{ID:968,BMPName:"sheetz",PremiumImage:!0},{ID:969,BMPName:"van_der_valk",PremiumImage:!0},{ID:1007,BMPName:"canadian_tire",PremiumImage:!0},{ID:717,BMPName:"gto",PremiumImage:!0},{ID:611,BMPName:"suburban_extended_stay",PremiumImage:!0},{ID:612,BMPName:"radisson_sas",PremiumImage:!0},{ID:718,BMPName:"murphy_express",PremiumImage:!0},{ID:719,BMPName:"fleet_fuels",PremiumImage:!0},{ID:720,BMPName:"sunoco_canada",PremiumImage:!0},{ID:613,BMPName:"andaz",PremiumImage:!0},{ID:863,BMPName:"suitehotel",
PremiumImage:!0},{ID:970,BMPName:"suitehotel",PremiumImage:!0},{ID:660,BMPName:"bnp_paribas",PremiumImage:!0},{ID:661,BMPName:"credit_agricole",PremiumImage:!0},{ID:721,BMPName:"monoprix",PremiumImage:!0},{ID:971,BMPName:"monoprix",PremiumImage:!0},{ID:1008,BMPName:"monoprix",PremiumImage:!0},{ID:972,BMPName:"novotel",PremiumImage:!0},{ID:1101,BMPName:"euromobil",PremiumImage:!0},{ID:973,BMPName:"bistro_romain",PremiumImage:!0},{ID:864,BMPName:"exclusive_hotels",PremiumImage:!0},{ID:974,BMPName:"ibis",
PremiumImage:!0},{ID:975,BMPName:"sofitel",PremiumImage:!0},{ID:905,BMPName:"reifen_com",PremiumImage:!0},{ID:865,BMPName:"familotel",PremiumImage:!0},{ID:976,BMPName:"familotel",PremiumImage:!0},{ID:1151,BMPName:"p1",PremiumImage:!0},{ID:866,BMPName:"holland_hotels",PremiumImage:!0},{ID:977,BMPName:"holland_hotels",PremiumImage:!0},{ID:906,BMPName:"autotaalglas",PremiumImage:!0},{ID:722,BMPName:"continente",PremiumImage:!0},{ID:867,BMPName:"balladins",PremiumImage:!0},{ID:978,BMPName:"balladins",
PremiumImage:!0},{ID:868,BMPName:"ringhotels",PremiumImage:!0},{ID:979,BMPName:"ringhotels",PremiumImage:!0},{ID:1009,BMPName:"Carrefour",PremiumImage:!0},{ID:723,BMPName:"Carrefour",PremiumImage:!0},{ID:824,BMPName:"Carrefour",PremiumImage:!0},{ID:869,BMPName:"inter_hotel",PremiumImage:!0},{ID:980,BMPName:"inter_hotel",PremiumImage:!0},{ID:981,BMPName:"mercure",PremiumImage:!0},{ID:825,BMPName:"aral",PremiumImage:!0},{ID:870,BMPName:"etap",PremiumImage:!0},{ID:982,BMPName:"etap",PremiumImage:!0},
{ID:871,BMPName:"relais_du_silence",PremiumImage:!0},{ID:724,BMPName:"champion",PremiumImage:!0},{ID:826,BMPName:"champion",PremiumImage:!0},{ID:725,BMPName:"cora",PremiumImage:!0},{ID:827,BMPName:"cora",PremiumImage:!0},{ID:983,BMPName:"cora",PremiumImage:!0},{ID:984,BMPName:"formule_1",PremiumImage:!0},{ID:1010,BMPName:"asda",PremiumImage:!0},{ID:726,BMPName:"asda",PremiumImage:!0},{ID:1011,BMPName:"asda",PremiumImage:!0},{ID:828,BMPName:"asda",PremiumImage:!0},{ID:829,BMPName:"tamoil",PremiumImage:!0},
{ID:662,BMPName:"la_caixa",PremiumImage:!0},{ID:907,BMPName:"elephant_bleu",PremiumImage:!0},{ID:1012,BMPName:"ikea",PremiumImage:!0},{ID:872,BMPName:"motel_one",PremiumImage:!0},{ID:1152,BMPName:"q_park",PremiumImage:!0},{ID:1153,BMPName:"q_park",PremiumImage:!0},{ID:985,BMPName:"courtepaille",PremiumImage:!0},{ID:986,BMPName:"hippopotamus",PremiumImage:!0},{ID:987,BMPName:"les_3_brasseurs",PremiumImage:!0},{ID:988,BMPName:"quick",PremiumImage:!0},{ID:989,BMPName:"flunch",PremiumImage:!0},{ID:990,
BMPName:"pizza_pai",PremiumImage:!0},{ID:991,BMPName:"amarine",PremiumImage:!0},{ID:992,BMPName:"tablapizza",PremiumImage:!0},{ID:993,BMPName:"le_petit_bofinger",PremiumImage:!0},{ID:994,BMPName:"brasserie_flo",PremiumImage:!0},{ID:908,BMPName:"top_service_team",PremiumImage:!0},{ID:873,BMPName:"adagio_city_aparthotel",PremiumImage:!0},{ID:995,BMPName:"adagio_city_aparthotel",PremiumImage:!0},{ID:874,BMPName:"relais_chateau",PremiumImage:!0},{ID:996,BMPName:"relais_chateau",PremiumImage:!0},{ID:997,
BMPName:"all_seasons",PremiumImage:!0},{ID:998,BMPName:"max",PremiumImage:!0},{ID:875,BMPName:"pullman",PremiumImage:!0},{ID:876,BMPName:"holiday_inn",PremiumImage:!0},{ID:877,BMPName:"holiday_inn",PremiumImage:!0},{ID:878,BMPName:"tables_auberges",PremiumImage:!0},{ID:999,BMPName:"tables_auberges",PremiumImage:!0},{ID:909,BMPName:"midas",PremiumImage:!0},{ID:1013,BMPName:"mam_limited",PremiumImage:!0},{ID:727,BMPName:"intermarche",PremiumImage:!0},{ID:830,BMPName:"intermarche",PremiumImage:!0},{ID:728,
BMPName:"ecomarche",PremiumImage:!0},{ID:1201,BMPName:"ecomarche",PremiumImage:!0},{ID:910,BMPName:"roady",PremiumImage:!0},{ID:1014,BMPName:"bricomarche",PremiumImage:!0},{ID:1E3,BMPName:"restaumarche",PremiumImage:!0},{ID:911,BMPName:"first_stop",PremiumImage:!0},{ID:879,BMPName:"amarante_hotels",PremiumImage:!0},{ID:880,BMPName:"luxury_collection",PremiumImage:!0},{ID:881,BMPName:"median_hotels",PremiumImage:!0},{ID:882,BMPName:"stars_hotels",PremiumImage:!0},{ID:1251,BMPName:"papa_johns",PremiumImage:!0},
{ID:1252,BMPName:"supermacs",PremiumImage:!0},{ID:1253,BMPName:"supermacs",PremiumImage:!0},{ID:1015,BMPName:"castorama",PremiumImage:!0},{ID:883,BMPName:"gast_im_schloss",PremiumImage:!0},{ID:884,BMPName:"chateaux_et_hotels",PremiumImage:!0},{ID:1254,BMPName:"chateaux_et_hotels",PremiumImage:!0},{ID:1016,BMPName:"brico_depot",PremiumImage:!0},{ID:885,BMPName:"belambra_vvf",PremiumImage:!0},{ID:886,BMPName:"grandes_etapes",PremiumImage:!0},{ID:1255,BMPName:"grandes_etapes",PremiumImage:!0},{ID:887,
BMPName:"mgallery",PremiumImage:!0},{ID:1256,BMPName:"la_boucherie",PremiumImage:!0},{ID:888,BMPName:"golden_tulip",PremiumImage:!0},{ID:889,BMPName:"oceania_hotels",PremiumImage:!0},{ID:1257,BMPName:"oceania_hotels",PremiumImage:!0},{ID:729,BMPName:"carrefour_express",PremiumImage:!0},{ID:1102,BMPName:"sixt",PremiumImage:!0},{ID:5004,BMPName:"entertainment",PremiumImage:!1},{ID:5001,BMPName:"bank",PremiumImage:!1},{ID:5006,BMPName:"auto_rental",PremiumImage:!1},{ID:5007,BMPName:"vehicle_charging_station",
PremiumImage:!1},{ID:5008,BMPName:"hotel",PremiumImage:!1},{ID:302,BMPName:"place_of_worship",PremiumImage:!1},{ID:303,BMPName:"place_of_worship",PremiumImage:!1},{ID:304,BMPName:"place_of_worship",PremiumImage:!1},{ID:305,BMPName:"place_of_worship",PremiumImage:!1},{ID:306,BMPName:"place_of_worship",PremiumImage:!1},{ID:307,BMPName:"place_of_worship",PremiumImage:!1},{ID:308,BMPName:"place_of_worship",PremiumImage:!1},{ID:310,BMPName:"place_of_worship",PremiumImage:!1},{ID:311,BMPName:"place_of_worship",
PremiumImage:!1},{ID:312,BMPName:"place_of_worship",PremiumImage:!1},{ID:313,BMPName:"place_of_worship",PremiumImage:!1},{ID:314,BMPName:"place_of_worship",PremiumImage:!1},{ID:315,BMPName:"place_of_worship",PremiumImage:!1},{ID:316,BMPName:"place_of_worship",PremiumImage:!1},{ID:320,BMPName:"place_of_worship",PremiumImage:!1},{ID:321,BMPName:"place_of_worship",PremiumImage:!1},{ID:322,BMPName:"place_of_worship",PremiumImage:!1},{ID:323,BMPName:"place_of_worship",PremiumImage:!1},{ID:324,BMPName:"place_of_worship",
PremiumImage:!1},{ID:327,BMPName:"place_of_worship",PremiumImage:!1},{ID:328,BMPName:"place_of_worship",PremiumImage:!1},{ID:418,BMPName:"restaurant",PremiumImage:!1},{ID:419,BMPName:"restaurant",PremiumImage:!1},{ID:434,BMPName:"restaurant",PremiumImage:!1},{ID:436,BMPName:"restaurant",PremiumImage:!1},{ID:444,BMPName:"restaurant",PremiumImage:!1},{ID:446,BMPName:"restaurant",PremiumImage:!1},{ID:447,BMPName:"restaurant",PremiumImage:!1},{ID:454,BMPName:"restaurant",PremiumImage:!1},{ID:455,BMPName:"restaurant",
PremiumImage:!1},{ID:301,BMPName:"place_of_worship",PremiumImage:!1},{ID:161,BMPName:"entertainment",PremiumImage:!1},{ID:181,BMPName:"entertainment",PremiumImage:!1},{ID:182,BMPName:"entertainment",PremiumImage:!1},{ID:183,BMPName:"entertainment",PremiumImage:!1},{ID:184,BMPName:"entertainment",PremiumImage:!1},{ID:185,BMPName:"entertainment",PremiumImage:!1},{ID:250,BMPName:"retail",PremiumImage:!1},{ID:186,BMPName:"medical",PremiumImage:!1},{ID:187,BMPName:"medical",PremiumImage:!1},{ID:188,BMPName:"medical",
PremiumImage:!1},{ID:98,BMPName:"medical",PremiumImage:!1},{ID:110,BMPName:"attraction",PremiumImage:!1},{ID:101,BMPName:"airport",PremiumImage:!1},{ID:103,BMPName:"atm",PremiumImage:!1},{ID:104,BMPName:"attraction",PremiumImage:!1},{ID:105,BMPName:"auto_dealer",PremiumImage:!1},{ID:106,BMPName:"bank",PremiumImage:!1},{ID:108,BMPName:"bus_stop",PremiumImage:!1},{ID:109,BMPName:"bus_stop",PremiumImage:!1},{ID:111,BMPName:"municipal",PremiumImage:!1},{ID:112,BMPName:"commuter_rail",PremiumImage:!1},
{ID:114,BMPName:"medical",PremiumImage:!1},{ID:115,BMPName:"entertainment",PremiumImage:!1},{ID:116,BMPName:"public_venue",PremiumImage:!1},{ID:117,BMPName:"other",PremiumImage:!1},{ID:118,BMPName:"ferry",PremiumImage:!1},{ID:119,BMPName:"border_crossing",PremiumImage:!1},{ID:120,BMPName:"fuel",PremiumImage:!1},{ID:121,BMPName:"municipal",PremiumImage:!1},{ID:122,BMPName:"grocery",PremiumImage:!1},{ID:124,BMPName:"other",PremiumImage:!1},{ID:125,BMPName:"marina",PremiumImage:!1},{ID:126,BMPName:"municipal",
PremiumImage:!1},{ID:128,BMPName:"other",PremiumImage:!1},{ID:251,BMPName:"parking",PremiumImage:!1},{ID:252,BMPName:"parking",PremiumImage:!1},{ID:253,BMPName:"recreation",PremiumImage:!1},{ID:134,BMPName:"municipal",PremiumImage:!1},{ID:135,BMPName:"train_station",PremiumImage:!1},{ID:136,BMPName:"auto_rental",PremiumImage:!1},{ID:137,BMPName:"rest_area",PremiumImage:!1},{ID:139,BMPName:"retail",PremiumImage:!1},{ID:140,BMPName:"rv",PremiumImage:!1},{ID:141,BMPName:"school",PremiumImage:!1},{ID:142,
BMPName:"recreation",PremiumImage:!1},{ID:143,BMPName:"other",PremiumImage:!1},{ID:144,BMPName:"truck",PremiumImage:!1},{ID:145,BMPName:"auto_repair",PremiumImage:!1},{ID:146,BMPName:"weight_station",PremiumImage:!1},{ID:201,BMPName:"bridge_tunnel",PremiumImage:!1},{ID:202,BMPName:"bridge_tunnel",PremiumImage:!1},{ID:309,BMPName:"place_of_worship",PremiumImage:!1},{ID:317,BMPName:"place_of_worship",PremiumImage:!1},{ID:319,BMPName:"place_of_worship",PremiumImage:!1},{ID:325,BMPName:"place_of_worship",
PremiumImage:!1},{ID:326,BMPName:"place_of_worship",PremiumImage:!1},{ID:401,BMPName:"restaurant",PremiumImage:!1},{ID:402,BMPName:"restaurant",PremiumImage:!1},{ID:403,BMPName:"restaurant",PremiumImage:!1},{ID:404,BMPName:"restaurant",PremiumImage:!1},{ID:405,BMPName:"restaurant",PremiumImage:!1},{ID:406,BMPName:"restaurant",PremiumImage:!1},{ID:407,BMPName:"restaurant",PremiumImage:!1},{ID:408,BMPName:"restaurant",PremiumImage:!1},{ID:409,BMPName:"restaurant",PremiumImage:!1},{ID:410,BMPName:"restaurant",
PremiumImage:!1},{ID:411,BMPName:"restaurant",PremiumImage:!1},{ID:412,BMPName:"restaurant",PremiumImage:!1},{ID:413,BMPName:"restaurant",PremiumImage:!1},{ID:414,BMPName:"restaurant",PremiumImage:!1},{ID:415,BMPName:"restaurant",PremiumImage:!1},{ID:417,BMPName:"restaurant",PremiumImage:!1},{ID:420,BMPName:"restaurant",PremiumImage:!1},{ID:421,BMPName:"restaurant",PremiumImage:!1},{ID:422,BMPName:"restaurant",PremiumImage:!1},{ID:423,BMPName:"restaurant",PremiumImage:!1},{ID:424,BMPName:"restaurant",
PremiumImage:!1},{ID:425,BMPName:"restaurant",PremiumImage:!1},{ID:426,BMPName:"restaurant",PremiumImage:!1},{ID:427,BMPName:"restaurant",PremiumImage:!1},{ID:428,BMPName:"restaurant",PremiumImage:!1},{ID:429,BMPName:"restaurant",PremiumImage:!1},{ID:430,BMPName:"restaurant",PremiumImage:!1},{ID:431,BMPName:"restaurant",PremiumImage:!1},{ID:432,BMPName:"restaurant",PremiumImage:!1},{ID:433,BMPName:"restaurant",PremiumImage:!1},{ID:435,BMPName:"restaurant",PremiumImage:!1},{ID:437,BMPName:"restaurant",
PremiumImage:!1},{ID:438,BMPName:"restaurant",PremiumImage:!1},{ID:439,BMPName:"restaurant",PremiumImage:!1},{ID:440,BMPName:"restaurant",PremiumImage:!1},{ID:441,BMPName:"restaurant",PremiumImage:!1},{ID:442,BMPName:"restaurant",PremiumImage:!1},{ID:443,BMPName:"restaurant",PremiumImage:!1},{ID:445,BMPName:"restaurant",PremiumImage:!1},{ID:448,BMPName:"restaurant",PremiumImage:!1},{ID:449,BMPName:"restaurant",PremiumImage:!1},{ID:450,BMPName:"restaurant",PremiumImage:!1},{ID:451,BMPName:"restaurant",
PremiumImage:!1},{ID:452,BMPName:"restaurant",PremiumImage:!1},{ID:453,BMPName:"restaurant",PremiumImage:!1},{ID:456,BMPName:"restaurant",PremiumImage:!1},{ID:457,BMPName:"restaurant",PremiumImage:!1},{ID:458,BMPName:"restaurant",PremiumImage:!1},{ID:459,BMPName:"restaurant",PremiumImage:!1},{ID:460,BMPName:"restaurant",PremiumImage:!1},{ID:461,BMPName:"restaurant",PremiumImage:!1},{ID:462,BMPName:"restaurant",PremiumImage:!1},{ID:463,BMPName:"restaurant",PremiumImage:!1},{ID:464,BMPName:"restaurant",
PremiumImage:!1},{ID:465,BMPName:"restaurant",PremiumImage:!1},{ID:466,BMPName:"restaurant",PremiumImage:!1},{ID:2E3,BMPName:"o2shops",PremiumImage:!1},{ID:2001,BMPName:"scania",PremiumImage:!1},{ID:416,BMPName:"restaurant",PremiumImage:!1},{ID:102,BMPName:"other_airport",PremiumImage:!1},{ID:147,BMPName:"municipal",PremiumImage:!1},{ID:148,BMPName:"medical",PremiumImage:!1},{ID:149,BMPName:"retail",PremiumImage:!1},{ID:150,BMPName:"medical",PremiumImage:!1},{ID:151,BMPName:"parking",PremiumImage:!1},
{ID:152,BMPName:"attraction",PremiumImage:!1},{ID:153,BMPName:"attraction",PremiumImage:!1},{ID:154,BMPName:"attraction",PremiumImage:!1},{ID:155,BMPName:"attraction",PremiumImage:!1},{ID:156,BMPName:"entertainment",PremiumImage:!1},{ID:157,BMPName:"entertainment",PremiumImage:!1},{ID:158,BMPName:"entertainment",PremiumImage:!1},{ID:159,BMPName:"entertainment",PremiumImage:!1},{ID:160,BMPName:"entertainment",PremiumImage:!1},{ID:162,BMPName:"municipal",PremiumImage:!1},{ID:163,BMPName:"municipal",
PremiumImage:!1},{ID:164,BMPName:"municipal",PremiumImage:!1},{ID:165,BMPName:"municipal",PremiumImage:!1},{ID:166,BMPName:"attraction",PremiumImage:!1},{ID:167,BMPName:"other",PremiumImage:!1},{ID:168,BMPName:"retail",PremiumImage:!1},{ID:169,BMPName:"school",PremiumImage:!1},{ID:170,BMPName:"recreation",PremiumImage:!1},{ID:171,BMPName:"recreation",PremiumImage:!1},{ID:172,BMPName:"recreation",PremiumImage:!1},{ID:173,BMPName:"entertainment",PremiumImage:!1},{ID:174,BMPName:"park",PremiumImage:!1},
{ID:502,BMPName:"best_western",PremiumImage:!0},{ID:503,BMPName:"ramada",PremiumImage:!0},{ID:504,BMPName:"novotel",PremiumImage:!0},{ID:505,BMPName:"ibis",PremiumImage:!0},{ID:506,BMPName:"sofitel",PremiumImage:!0},{ID:507,BMPName:"hotel",PremiumImage:!1},{ID:508,BMPName:"mercure",PremiumImage:!0},{ID:509,BMPName:"comfort_inn",PremiumImage:!0},{ID:510,BMPName:"hotel",PremiumImage:!1},{ID:511,BMPName:"hilton",PremiumImage:!0},{ID:512,BMPName:"hotel",PremiumImage:!1},{ID:513,BMPName:"hotel",PremiumImage:!1},
{ID:514,BMPName:"hyatt_regency",PremiumImage:!0},{ID:515,BMPName:"formule_1",PremiumImage:!0},{ID:516,BMPName:"hotel",PremiumImage:!1},{ID:517,BMPName:"hotel",PremiumImage:!1},{ID:518,BMPName:"clarion",PremiumImage:!0},{ID:519,BMPName:"hotel",PremiumImage:!1},{ID:520,BMPName:"hotel",PremiumImage:!1},{ID:521,BMPName:"all_seasons",PremiumImage:!0},{ID:522,BMPName:"quality_inn",PremiumImage:!0},{ID:523,BMPName:"radisson",PremiumImage:!0},{ID:524,BMPName:"sleep_inn",PremiumImage:!0},{ID:525,BMPName:"travelodge",
PremiumImage:!0},{ID:526,BMPName:"hotel",PremiumImage:!1},{ID:527,BMPName:"crowne_plaza",PremiumImage:!0},{ID:501,BMPName:"holiday_inn",PremiumImage:!0},{ID:528,BMPName:"hotel",PremiumImage:!1},{ID:529,BMPName:"hotel",PremiumImage:!1},{ID:530,BMPName:"hotel",PremiumImage:!1},{ID:531,BMPName:"hotel",PremiumImage:!1},{ID:532,BMPName:"hotel",PremiumImage:!1},{ID:551,BMPName:"auto_dealer",PremiumImage:!1},{ID:552,BMPName:"auto_dealer",PremiumImage:!1},{ID:553,BMPName:"auto_dealer",PremiumImage:!1},{ID:554,
BMPName:"auto_dealer",PremiumImage:!1},{ID:555,BMPName:"auto_dealer",PremiumImage:!1},{ID:556,BMPName:"auto_dealer",PremiumImage:!1},{ID:557,BMPName:"auto_dealer",PremiumImage:!1},{ID:558,BMPName:"auto_dealer",PremiumImage:!1},{ID:559,BMPName:"auto_dealer",PremiumImage:!1},{ID:560,BMPName:"auto_dealer",PremiumImage:!1},{ID:561,BMPName:"auto_dealer",PremiumImage:!1},{ID:562,BMPName:"auto_dealer",PremiumImage:!1},{ID:563,BMPName:"auto_dealer",PremiumImage:!1},{ID:564,BMPName:"auto_dealer",PremiumImage:!1},
{ID:565,BMPName:"auto_dealer",PremiumImage:!1},{ID:567,BMPName:"auto_dealer",PremiumImage:!1},{ID:569,BMPName:"auto_dealer",PremiumImage:!1},{ID:570,BMPName:"auto_dealer",PremiumImage:!1},{ID:571,BMPName:"auto_dealer",PremiumImage:!1},{ID:572,BMPName:"auto_dealer",PremiumImage:!1},{ID:573,BMPName:"auto_dealer",PremiumImage:!1},{ID:574,BMPName:"auto_dealer",PremiumImage:!1},{ID:575,BMPName:"auto_dealer",PremiumImage:!1},{ID:576,BMPName:"auto_dealer",PremiumImage:!1},{ID:577,BMPName:"auto_dealer",PremiumImage:!1},
{ID:578,BMPName:"auto_dealer",PremiumImage:!1},{ID:579,BMPName:"auto_dealer",PremiumImage:!1},{ID:580,BMPName:"auto_dealer",PremiumImage:!1},{ID:581,BMPName:"auto_dealer",PremiumImage:!1},{ID:582,BMPName:"auto_dealer",PremiumImage:!1},{ID:583,BMPName:"auto_dealer",PremiumImage:!1},{ID:584,BMPName:"auto_dealer",PremiumImage:!1},{ID:585,BMPName:"auto_dealer",PremiumImage:!1},{ID:586,BMPName:"auto_dealer",PremiumImage:!1},{ID:587,BMPName:"auto_dealer",PremiumImage:!1},{ID:588,BMPName:"auto_dealer",PremiumImage:!1},
{ID:589,BMPName:"auto_dealer",PremiumImage:!1},{ID:590,BMPName:"auto_dealer",PremiumImage:!1},{ID:591,BMPName:"auto_dealer",PremiumImage:!1},{ID:592,BMPName:"auto_dealer",PremiumImage:!1},{ID:593,BMPName:"auto_dealer",PremiumImage:!1},{ID:594,BMPName:"auto_dealer",PremiumImage:!1},{ID:595,BMPName:"auto_dealer",PremiumImage:!1},{ID:596,BMPName:"auto_dealer",PremiumImage:!1},{ID:597,BMPName:"auto_dealer",PremiumImage:!1},{ID:598,BMPName:"auto_dealer",PremiumImage:!1},{ID:599,BMPName:"auto_dealer",PremiumImage:!1},
{ID:600,BMPName:"auto_dealer",PremiumImage:!1},{ID:601,BMPName:"auto_dealer",PremiumImage:!1},{ID:602,BMPName:"auto_dealer",PremiumImage:!1},{ID:651,BMPName:"bank",PremiumImage:!1},{ID:652,BMPName:"bank",PremiumImage:!1},{ID:653,BMPName:"bank",PremiumImage:!1},{ID:701,BMPName:"grocery",PremiumImage:!1},{ID:702,BMPName:"grocery",PremiumImage:!1},{ID:751,BMPName:"motorcycle_dealer",PremiumImage:!1},{ID:752,BMPName:"motorcycle_dealer",PremiumImage:!1},{ID:753,BMPName:"motorcycle_dealer",PremiumImage:!1},
{ID:533,BMPName:"intercontinental",PremiumImage:!0},{ID:5005,BMPName:"airport",PremiumImage:!1},{ID:7,BMPName:"auto_dealer",PremiumImage:!1},{ID:9,BMPName:"bank",PremiumImage:!1},{ID:22,BMPName:"fuel",PremiumImage:!1},{ID:25,BMPName:"hotel",PremiumImage:!1},{ID:26,BMPName:"place_of_worship",PremiumImage:!1},{ID:30,BMPName:"o2shops",PremiumImage:!1},{ID:31,BMPName:"other",PremiumImage:!1},{ID:34,BMPName:"parking",PremiumImage:!1},{ID:41,BMPName:"restaurant",PremiumImage:!1},{ID:42,BMPName:"retail",
PremiumImage:!1},{ID:44,BMPName:"scania",PremiumImage:!1},{ID:48,BMPName:"truck",PremiumImage:!1},{ID:51,BMPName:"motorcycle_dealer",PremiumImage:!1},{ID:467,BMPName:"mcdonalds",PremiumImage:!0},{ID:655,BMPName:"boa",PremiumImage:!0},{ID:656,BMPName:"rbc",PremiumImage:!0},{ID:800,BMPName:"arco",PremiumImage:!0},{ID:801,BMPName:"bp",PremiumImage:!0},{ID:802,BMPName:"chevron",PremiumImage:!0},{ID:803,BMPName:"conoco",PremiumImage:!0},{ID:804,BMPName:"phillips_66",PremiumImage:!0},{ID:805,BMPName:"shell",
PremiumImage:!0},{ID:806,BMPName:"76",PremiumImage:!0},{ID:807,BMPName:"sinclair",PremiumImage:!0},{ID:808,BMPName:"texaco",PremiumImage:!0},{ID:468,BMPName:"starbucks",PremiumImage:!0},{ID:469,BMPName:"arbys",PremiumImage:!0},{ID:470,BMPName:"bahama_breeze",PremiumImage:!0},{ID:471,BMPName:"baskin_robbins",PremiumImage:!0},{ID:472,BMPName:"bennigans",PremiumImage:!0},{ID:473,BMPName:"big_boy",PremiumImage:!0},{ID:474,BMPName:"bonanza",PremiumImage:!0},{ID:475,BMPName:"bonefish",PremiumImage:!0},
{ID:476,BMPName:"boston_market",PremiumImage:!0},{ID:477,BMPName:"carls_jr",PremiumImage:!0},{ID:478,BMPName:"carrabbas",PremiumImage:!0},{ID:479,BMPName:"chilis",PremiumImage:!0},{ID:480,BMPName:"dairy_queen",PremiumImage:!0},{ID:481,BMPName:"dennys",PremiumImage:!0},{ID:482,BMPName:"dunkin_donuts",PremiumImage:!0},{ID:483,BMPName:"hardees",PremiumImage:!0},{ID:484,BMPName:"la_salsa",PremiumImage:!0},{ID:485,BMPName:"olive_garden",PremiumImage:!0},{ID:486,BMPName:"outback",PremiumImage:!0},{ID:487,
BMPName:"panda_express",PremiumImage:!0},{ID:488,BMPName:"papa_johns",PremiumImage:!0},{ID:489,BMPName:"perkins",PremiumImage:!0},{ID:490,BMPName:"ponderosa",PremiumImage:!0},{ID:491,BMPName:"popeyes",PremiumImage:!0},{ID:492,BMPName:"red_lobster",PremiumImage:!0},{ID:493,BMPName:"ruby_Tuesday",PremiumImage:!0},{ID:494,BMPName:"smokey_bones",PremiumImage:!0},{ID:495,BMPName:"sonic",PremiumImage:!0},{ID:496,BMPName:"subway",PremiumImage:!0},{ID:497,BMPName:"tgi_fridays",PremiumImage:!0},{ID:498,BMPName:"tj_cinnamons",
PremiumImage:!0},{ID:499,BMPName:"wendys",PremiumImage:!0},{ID:500,BMPName:"whataburger",PremiumImage:!0},{ID:534,BMPName:"amerihost",PremiumImage:!0},{ID:535,BMPName:"baymont",PremiumImage:!0},{ID:536,BMPName:"days_inn",PremiumImage:!0},{ID:537,BMPName:"doubletree",PremiumImage:!0},{ID:538,BMPName:"econo_lodge",PremiumImage:!0},{ID:539,BMPName:"radisson_edwardian",PremiumImage:!0},{ID:809,BMPName:"murphy_usa",PremiumImage:!0},{ID:540,BMPName:"country_inn",PremiumImage:!0},{ID:541,BMPName:"hampton_inn",
PremiumImage:!0},{ID:542,BMPName:"hawthorn_suites",PremiumImage:!0},{ID:543,BMPName:"la_quinta_inn",PremiumImage:!0},{ID:544,BMPName:"lexington",PremiumImage:!0},{ID:545,BMPName:"motel_6",PremiumImage:!0},{ID:546,BMPName:"red_roof_inn",PremiumImage:!0},{ID:547,BMPName:"regent",PremiumImage:!0},{ID:548,BMPName:"rodeway_inn",PremiumImage:!0},{ID:549,BMPName:"hyatt_summerfield_suites",PremiumImage:!0},{ID:550,BMPName:"americinn",PremiumImage:!0},{ID:831,BMPName:"microtel",PremiumImage:!0},{ID:810,BMPName:"ampm",
PremiumImage:!0},{ID:704,BMPName:"meijer",PremiumImage:!0},{ID:811,BMPName:"quiktrip",PremiumImage:!0},{ID:812,BMPName:"sheetz",PremiumImage:!0},{ID:813,BMPName:"wawa",PremiumImage:!0},{ID:705,BMPName:"wawa",PremiumImage:!0},{ID:832,BMPName:"van_der_valk",PremiumImage:!0},{ID:833,BMPName:"delta",PremiumImage:!0},{ID:814,BMPName:"canadian_tire",PremiumImage:!0},{ID:901,BMPName:"canadian_tire",PremiumImage:!0},{ID:834,BMPName:"park_plaza",PremiumImage:!0},{ID:815,BMPName:"gto",PremiumImage:!0},{ID:902,
BMPName:"bosch",PremiumImage:!0},{ID:657,BMPName:"chase",PremiumImage:!0},{ID:658,BMPName:"wells_fargo",PremiumImage:!0},{ID:706,BMPName:"giant_eagle",PremiumImage:!0},{ID:921,BMPName:"giant_eagle",PremiumImage:!0},{ID:707,BMPName:"giant_food",PremiumImage:!0},{ID:922,BMPName:"meijer_pharmacy",PremiumImage:!0},{ID:923,BMPName:"publix",PremiumImage:!0},{ID:708,BMPName:"publix",PremiumImage:!0},{ID:941,BMPName:"publix",PremiumImage:!0},{ID:924,BMPName:"walgreens",PremiumImage:!0},{ID:942,BMPName:"bostons",
PremiumImage:!0},{ID:943,BMPName:"flemings",PremiumImage:!0},{ID:944,BMPName:"lee_roy_selmons",PremiumImage:!0},{ID:945,BMPName:"pizza_pizza",PremiumImage:!0},{ID:946,BMPName:"capital_grille",PremiumImage:!0},{ID:947,BMPName:"in_n_out_burger",PremiumImage:!0},{ID:948,BMPName:"jimmy_johns",PremiumImage:!0},{ID:949,BMPName:"roys",PremiumImage:!0},{ID:835,BMPName:"studio_6",PremiumImage:!0},{ID:950,BMPName:"cheeseburger_in_paradise",PremiumImage:!0},{ID:951,BMPName:"pf_changs",PremiumImage:!0},{ID:836,
BMPName:"canadas_best_value_inn",PremiumImage:!0},{ID:837,BMPName:"americas_best_value_inn",PremiumImage:!0},{ID:838,BMPName:"hotel_indigo",PremiumImage:!0},{ID:839,BMPName:"holiday_inn_express",PremiumImage:!0},{ID:840,BMPName:"staybridge_suites",PremiumImage:!0},{ID:841,BMPName:"candlewood_suites",PremiumImage:!0},{ID:842,BMPName:"hyatt_place",PremiumImage:!0},{ID:843,BMPName:"comfort_suites",PremiumImage:!0},{ID:844,BMPName:"cambria_suites",PremiumImage:!0},{ID:845,BMPName:"main_stay_suites",PremiumImage:!0},
{ID:846,BMPName:"suburban_extended_stay",PremiumImage:!0},{ID:1001,BMPName:"best_buy",PremiumImage:!0},{ID:1002,BMPName:"dicks_sporting",PremiumImage:!0},{ID:952,BMPName:"blue_coral_seafood",PremiumImage:!0},{ID:953,BMPName:"seasons_52",PremiumImage:!0},{ID:954,BMPName:"auntie_annes",PremiumImage:!0},{ID:816,BMPName:"getgo",PremiumImage:!0},{ID:709,BMPName:"getgo",PremiumImage:!0},{ID:847,BMPName:"park_inn",PremiumImage:!0},{ID:848,BMPName:"radisson_sas",PremiumImage:!0},{ID:955,BMPName:"longhorn",
PremiumImage:!0},{ID:659,BMPName:"rbc_centura",PremiumImage:!0},{ID:1003,BMPName:"nespresso",PremiumImage:!0},{ID:956,BMPName:"el_chico",PremiumImage:!0},{ID:957,BMPName:"firehouse_subs",PremiumImage:!0},{ID:958,BMPName:"cantina_laredo",PremiumImage:!0},{ID:959,BMPName:"cool_river",PremiumImage:!0},{ID:960,BMPName:"good_eats",PremiumImage:!0},{ID:961,BMPName:"iii_forks",PremiumImage:!0},{ID:962,BMPName:"luckys_cafe",PremiumImage:!0},{ID:963,BMPName:"silver_fox",PremiumImage:!0},{ID:817,BMPName:"murphy_express",
PremiumImage:!0},{ID:818,BMPName:"fleet_fuels",PremiumImage:!0},{ID:849,BMPName:"travelodge_canada",PremiumImage:!0},{ID:819,BMPName:"sunoco_canada",PremiumImage:!0},{ID:964,BMPName:"pizza_73",PremiumImage:!0},{ID:850,BMPName:"americinn",PremiumImage:!0},{ID:851,BMPName:"americinn",PremiumImage:!0},{ID:852,BMPName:"americinn",PremiumImage:!0},{ID:1004,BMPName:"marks_work_wearhouse",PremiumImage:!0},{ID:853,BMPName:"crowne_plaza",PremiumImage:!0},{ID:854,BMPName:"crowne_plaza",PremiumImage:!0},{ID:855,
BMPName:"holiday_inn",PremiumImage:!0},{ID:856,BMPName:"holiday_inn",PremiumImage:!0},{ID:857,BMPName:"holiday_inn",PremiumImage:!0},{ID:858,BMPName:"holiday_inn",PremiumImage:!0},{ID:859,BMPName:"holiday_inn_express",PremiumImage:!0},{ID:860,BMPName:"thriftlodge_canada",PremiumImage:!0},{ID:820,BMPName:"meijer_gas_station",PremiumImage:!0},{ID:710,BMPName:"ingles_markets",PremiumImage:!0},{ID:821,BMPName:"ingles_gas_express",PremiumImage:!0},{ID:925,BMPName:"ingles_pharmacy",PremiumImage:!0},{ID:711,
BMPName:"sav_mor_foods",PremiumImage:!0},{ID:903,BMPName:"kal_tire",PremiumImage:!0},{ID:965,BMPName:"mcalisters_deli",PremiumImage:!0},{ID:1005,BMPName:"future_shop",PremiumImage:!0},{ID:1006,BMPName:"abc_fine_wine",PremiumImage:!0},{ID:861,BMPName:"andaz",PremiumImage:!0},{ID:904,BMPName:"certigard",PremiumImage:!0},{ID:862,BMPName:"ascend_collection",PremiumImage:!0},{ID:822,BMPName:"martins",PremiumImage:!0},{ID:926,BMPName:"martins",PremiumImage:!0},{ID:712,BMPName:"martins",PremiumImage:!0},
{ID:823,BMPName:"giant_food",PremiumImage:!0},{ID:927,BMPName:"giant_food",PremiumImage:!0},{ID:175,BMPName:"recreation",PremiumImage:!1},{ID:176,BMPName:"attraction",PremiumImage:!1},{ID:177,BMPName:"attraction",PremiumImage:!1},{ID:178,BMPName:"attraction",PremiumImage:!1},{ID:179,BMPName:"attraction",PremiumImage:!1},{ID:180,BMPName:"attraction",PremiumImage:!1},{ID:1981,BMPName:"steephilldownwards",PremiumImage:!1},{ID:1982,BMPName:"steephillupwards",PremiumImage:!1},{ID:1983,BMPName:"riskofgrounding",
PremiumImage:!1},{ID:1984,BMPName:"sharpcurve",PremiumImage:!1},{ID:1985,BMPName:"lateralwind",PremiumImage:!1},{ID:1986,BMPName:"treeoverhang",PremiumImage:!1},{ID:1987,BMPName:"roadnarrows",PremiumImage:!1},{ID:1988,BMPName:"noleftturntrucks",PremiumImage:!1},{ID:1989,BMPName:"norightturntrucks",PremiumImage:!1},{ID:1990,BMPName:"nouturnfortrucks",PremiumImage:!1},{ID:1991,BMPName:"truck",PremiumImage:!1},{ID:3200,BMPName:"survey",PremiumImage:!1},{ID:3300,BMPName:"survey",PremiumImage:!1},{ID:5050,
BMPName:"truck",PremiumImage:!1},{ID:5E3,BMPName:"truck",PremiumImage:!1},{ID:1605,BMPName:"truck",PremiumImage:!1},{ID:1612,BMPName:"truck",PremiumImage:!1},{ID:1603,BMPName:"truck",PremiumImage:!1},{ID:1608,BMPName:"truck",PremiumImage:!1},{ID:2026,BMPName:"other",PremiumImage:!1},{ID:2027,BMPName:"other",PremiumImage:!1},{ID:1976,BMPName:"weight_station",PremiumImage:!1},{ID:5003,BMPName:"vehicle_charging_station",PremiumImage:!1},{ID:5002,BMPName:"medical",PremiumImage:!1},{ID:1992,BMPName:"extralane",
PremiumImage:!1},{ID:1993,BMPName:"extralane_right",PremiumImage:!1},{ID:1994,BMPName:"extralane_left",PremiumImage:!1},{ID:1995,BMPName:"lanemergeright",PremiumImage:!1},{ID:1996,BMPName:"lanemergeleft",PremiumImage:!1},{ID:1997,BMPName:"lanemergecenter",PremiumImage:!1},{ID:1998,BMPName:"levelcwithbarrier",PremiumImage:!1},{ID:1999,BMPName:"levelcwobarrier",PremiumImage:!1},{ID:1980,BMPName:"accidentwarning",PremiumImage:!1},{ID:1979,BMPName:"fuel",PremiumImage:!1},{ID:890,BMPName:"hotel",PremiumImage:!1},
{ID:891,BMPName:"hotel",PremiumImage:!1},{ID:329,BMPName:"place_of_worship",PremiumImage:!1},{ID:330,BMPName:"place_of_worship",PremiumImage:!1},{ID:1977,BMPName:"sharpcurve_left",PremiumImage:!1},{ID:331,BMPName:"place_of_worship",PremiumImage:!1},{ID:332,BMPName:"place_of_worship",PremiumImage:!1},{ID:333,BMPName:"place_of_worship",PremiumImage:!1},{ID:680,BMPName:"restaurant",PremiumImage:!1},{ID:681,BMPName:"restaurant",PremiumImage:!1},{ID:682,BMPName:"restaurant",PremiumImage:!1},{ID:683,BMPName:"restaurant",
PremiumImage:!1},{ID:684,BMPName:"restaurant",PremiumImage:!1},{ID:685,BMPName:"restaurant",PremiumImage:!1},{ID:686,BMPName:"restaurant",PremiumImage:!1},{ID:687,BMPName:"restaurant",PremiumImage:!1},{ID:688,BMPName:"restaurant",PremiumImage:!1},{ID:689,BMPName:"restaurant",PremiumImage:!1},{ID:690,BMPName:"restaurant",PremiumImage:!1},{ID:691,BMPName:"restaurant",PremiumImage:!1},{ID:692,BMPName:"restaurant",PremiumImage:!1},{ID:19,BMPName:"custom",PremiumImage:!1},{ID:113,BMPName:"custom",PremiumImage:!1},
{ID:129,BMPName:"custom",PremiumImage:!1},{ID:130,BMPName:"custom",PremiumImage:!1},{ID:131,BMPName:"custom",PremiumImage:!1},{ID:132,BMPName:"custom",PremiumImage:!1},{ID:133,BMPName:"custom",PremiumImage:!1},{ID:1600,BMPName:"fuel",PremiumImage:!1},{ID:2002,BMPName:"other",PremiumImage:!1},{ID:1300,BMPName:"1a_autoservice",PremiumImage:!0},{ID:1301,BMPName:"a_hereford_beefstouw",PremiumImage:!0},{ID:1302,BMPName:"abba",PremiumImage:!0},{ID:1303,BMPName:"adecco",PremiumImage:!0},{ID:1304,BMPName:"adeslas",
PremiumImage:!0},{ID:1305,BMPName:"andiamo",PremiumImage:!0},{ID:1306,BMPName:"anna",PremiumImage:!0},{ID:1307,BMPName:"aposto",PremiumImage:!0},{ID:1308,BMPName:"asturienne",PremiumImage:!0},{ID:1309,BMPName:"avia",PremiumImage:!0},{ID:1310,BMPName:"bb_hotels",PremiumImage:!0},{ID:1311,BMPName:"barcelo",PremiumImage:!0},{ID:1312,BMPName:"bernard_philibert",PremiumImage:!0},{ID:1313,BMPName:"bilxperten",PremiumImage:!0},{ID:1314,BMPName:"boeuf_a_six_pattes",PremiumImage:!0},{ID:1315,BMPName:"bricorama",
PremiumImage:!0},{ID:1316,BMPName:"brit_hotel",PremiumImage:!0},{ID:1317,BMPName:"bryggeriet",PremiumImage:!0},{ID:1318,BMPName:"campanile",PremiumImage:!0},{ID:1319,BMPName:"camping-qualite",PremiumImage:!0},{ID:1320,BMPName:"campsa",PremiumImage:!0},{ID:1321,BMPName:"cargo",PremiumImage:!0},{ID:1322,BMPName:"charme__relax",PremiumImage:!0},{ID:1323,BMPName:"cic",PremiumImage:!0},{ID:1324,BMPName:"clim_plus",PremiumImage:!0},{ID:1325,BMPName:"concerto",PremiumImage:!0},{ID:1326,BMPName:"concorde_hotels",
PremiumImage:!0},{ID:1327,BMPName:"courtyard",PremiumImage:!0},{ID:1328,BMPName:"credit_mutuel",PremiumImage:!0},{ID:1329,BMPName:"crown_plaza",PremiumImage:!0},{ID:1330,BMPName:"decathlon",PremiumImage:!0},{ID:1331,BMPName:"deltour_hotel",PremiumImage:!0},{ID:1332,BMPName:"driver",PremiumImage:!0},{ID:1333,BMPName:"erg",PremiumImage:!0},{ID:1334,BMPName:"flair_hotel",PremiumImage:!0},{ID:1335,BMPName:"go_ape",PremiumImage:!0},{ID:1336,BMPName:"grand_buffet",PremiumImage:!0},{ID:1337,BMPName:"gulf",
PremiumImage:!0},{ID:1338,BMPName:"hertz",PremiumImage:!0},{ID:1341,BMPName:"la_plateforme_du_batiment",PremiumImage:!0},{ID:1342,BMPName:"leroy_merlin",PremiumImage:!0},{ID:1343,BMPName:"lindex",PremiumImage:!0},{ID:1344,BMPName:"logis",PremiumImage:!0},{ID:1345,BMPName:"logis_dexception",PremiumImage:!0},{ID:1347,BMPName:"media_markt",PremiumImage:!0},{ID:1348,BMPName:"migrol",PremiumImage:!0},{ID:1349,BMPName:"national_atesa",PremiumImage:!0},{ID:1350,BMPName:"netto",PremiumImage:!0},{ID:1351,
BMPName:"nordsee",PremiumImage:!0},{ID:1352,BMPName:"okq8",PremiumImage:!0},{ID:1353,BMPName:"petronor",PremiumImage:!0},{ID:1354,BMPName:"point_p",PremiumImage:!0},{ID:1355,BMPName:"point_p_tp",PremiumImage:!0},{ID:1356,BMPName:"premiere_classe",PremiumImage:!0},{ID:1357,BMPName:"pum",PremiumImage:!0},{ID:1358,BMPName:"q8",PremiumImage:!0},{ID:1359,BMPName:"raiffeisen",PremiumImage:!0},{ID:1360,BMPName:"rautia",PremiumImage:!0},{ID:1361,BMPName:"renaissance",PremiumImage:!0},{ID:1362,BMPName:"repsol",
PremiumImage:!0},{ID:1363,BMPName:"saturn",PremiumImage:!0},{ID:1364,BMPName:"sfic",PremiumImage:!0},{ID:1366,BMPName:"stars",PremiumImage:!0},{ID:1367,BMPName:"taverne_de_maitre_kanter",PremiumImage:!0},{ID:1368,BMPName:"thansendk",PremiumImage:!0},{ID:1369,BMPName:"toys_r_us",PremiumImage:!0},{ID:1370,BMPName:"treff",PremiumImage:!0},{ID:1371,BMPName:"una_hotels__resorts",PremiumImage:!0},{ID:1372,BMPName:"unaway",PremiumImage:!0},{ID:1373,BMPName:"veti",PremiumImage:!0},{ID:1374,BMPName:"vips",
PremiumImage:!0},{ID:1375,BMPName:"budget",PremiumImage:!0},{ID:4,BMPName:"livesearch",PremiumImage:!1},{ID:1258,BMPName:"livesearch",PremiumImage:!1},{ID:1259,BMPName:"generic",PremiumImage:!1},{ID:50,BMPName:"truck",PremiumImage:!1},{ID:1978,BMPName:"sharpcurve_right",PremiumImage:!1},{ID:206,BMPName:"other",PremiumImage:!1},{ID:5079,BMPName:"def",PremiumImage:!1},{ID:2003,BMPName:"other",PremiumImage:!1},{ID:2004,BMPName:"other",PremiumImage:!1},{ID:2005,BMPName:"other",PremiumImage:!1},{ID:2006,
BMPName:"other",PremiumImage:!1},{ID:2007,BMPName:"other",PremiumImage:!1},{ID:2008,BMPName:"other",PremiumImage:!1},{ID:2009,BMPName:"other",PremiumImage:!1},{ID:93,BMPName:"safety_camera",PremiumImage:!1},{ID:4095,BMPName:"safety_camera",PremiumImage:!1},{ID:568,BMPName:"auto_dealer",PremiumImage:!1},{ID:928,BMPName:"medical",PremiumImage:!1},{ID:2010,BMPName:"other",PremiumImage:!1},{ID:2011,BMPName:"other",PremiumImage:!1},{ID:1260,BMPName:"games_venues",PremiumImage:!1},{ID:91,BMPName:"",PremiumImage:!1},
{ID:92,BMPName:"",PremiumImage:!1},{ID:99,BMPName:"",PremiumImage:!1},{ID:665,BMPName:"restaurant",PremiumImage:!1},{ID:666,BMPName:"restaurant",PremiumImage:!1},{ID:667,BMPName:"restaurant",PremiumImage:!1},{ID:668,BMPName:"restaurant",PremiumImage:!1},{ID:669,BMPName:"restaurant",PremiumImage:!1},{ID:670,BMPName:"restaurant",PremiumImage:!1},{ID:671,BMPName:"restaurant",PremiumImage:!1},{ID:672,BMPName:"restaurant",PremiumImage:!1},{ID:673,BMPName:"restaurant",PremiumImage:!1},{ID:674,BMPName:"restaurant",
PremiumImage:!1},{ID:675,BMPName:"restaurant",PremiumImage:!1},{ID:676,BMPName:"restaurant",PremiumImage:!1},{ID:677,BMPName:"restaurant",PremiumImage:!1},{ID:678,BMPName:"restaurant",PremiumImage:!1},{ID:679,BMPName:"restaurant",PremiumImage:!1},{ID:90,BMPName:"",PremiumImage:!1},{ID:2012,BMPName:"other",PremiumImage:!1},{ID:2013,BMPName:"other",PremiumImage:!1},{ID:2014,BMPName:"other",PremiumImage:!1},{ID:2015,BMPName:"other",PremiumImage:!1},{ID:2016,BMPName:"other",PremiumImage:!1},{ID:2017,
BMPName:"other",PremiumImage:!1},{ID:2018,BMPName:"other",PremiumImage:!1},{ID:2019,BMPName:"other",PremiumImage:!1},{ID:2020,BMPName:"other",PremiumImage:!1},{ID:2021,BMPName:"other",PremiumImage:!1},{ID:2022,BMPName:"other",PremiumImage:!1},{ID:2023,BMPName:"other",PremiumImage:!1},{ID:2024,BMPName:"other",PremiumImage:!1},{ID:2025,BMPName:"other",PremiumImage:!1},{ID:3E3,BMPName:"oil_gas",PremiumImage:!1},{ID:3001,BMPName:"wells",PremiumImage:!1},{ID:3002,BMPName:"oil_well",PremiumImage:!1},{ID:3003,
BMPName:"gas_well",PremiumImage:!1},{ID:3004,BMPName:"water_well",PremiumImage:!1},{ID:3005,BMPName:"coal_methane_well",PremiumImage:!1},{ID:3006,BMPName:"other_well",PremiumImage:!1},{ID:3100,BMPName:"other_facility",PremiumImage:!1}]})(ALKMaps);ALKMaps.Control.SingleSearch=ALKMaps.Class(ALKMaps.Control,{componentLocation:"topleft",componentWidth:"wide",div:null,doneTypingInterval:700,doneTypingImmediate:!1,placeholderText:"Address ...",minSearchTextLength:3,DEFAULT_SEARCH_OPTION:{region:"NA",maxResults:20},searchOption:{},locationRelevance:null,hideResults:!1,geocodingLayer:null,classNamePrefix:"",markerStyle:{externalGraphic:null,graphicHeight:26,graphicWidth:26,graphicXOffset:-13,graphicYOffset:-13},markerConfig:{exclusive:!0,centerOnMap:!0,
zoomLevel:12},popupConfig:{show:!0,id:null,displayClass:"single-search",size:new ALKMaps.Size(200,50),offset:new ALKMaps.Pixel(0,-13),closeBox:!1,closeBoxCallback:null,exclusive:!0},displaySystem:"metric",isDivExternal:!1,errorMessageBox:null,errorMessage:null,addressElement:null,addressText:"",resultsListElement:null,geolocation:navigator.geolocation,watchId:null,keyboardControl:null,navControl:null,marker:null,deviceLocation:null,resultTypes:null,destroy:function(){this.deactivate();ALKMaps.Control.prototype.destroy.apply(this,
arguments)},activate:function(){var a=this;try{ALKMaps.Geocoder.singleSearchGet({query:"resultTypes",region:"ww",async:!0,success:function(b){a.resultTypes=b.ResultTypes}})}catch(b){}if(ALKMaps.Control.prototype.activate.apply(this,arguments)){if(this.geolocation)this.watchId=this.geolocation.watchPosition(ALKMaps.Function.bind(this.geolocate,this),ALKMaps.Function.bind(this.failure,this),this.geolocationOptions);return!0}return!1},deactivate:function(){this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId);
return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){this.deviceLocation=new ALKMaps.LonLat(a.coords.longitude,a.coords.latitude)},failure:function(a){this.deviceLocation=null;this.events.triggerEvent("locationfailed",{error:a})},setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);if(null==this.geocodingLayer){var b=ALKMaps.Util.createUniqueID("ALKMaps.Control.SingleSearch_Layer");this.geocodingLayer=new ALKMaps.Layer.VectorMarkers(b,{displayInLayerSwitcher:this.displayInLayerSwitcher})}this.map.addLayers([this.geocodingLayer]);
for(b=0;b<this.map.controls.length;b++){if("ALKMaps.Control.KeyboardDefaults"===this.map.controls[b].CLASS_NAME)this.keyboardControl=this.map.controls[b];if("ALKMaps.Control.Navigation"===this.map.controls[b].CLASS_NAME)this.navControl=this.map.controls[b]}},onMouseOver:function(){null!=this.navControl&&this.navControl.deactivate()},onMouseOut:function(){null!=this.navControl&&this.navControl.activate()},deactivateKeyboardControl:function(){null!=this.keyboardControl&&this.keyboardControl.deactivate()},
activateKeyboardControl:function(){null!=this.keyboardControl&&this.keyboardControl.activate()},draw:function(){var a=this.createDivContainerElement(),b=document.createElement("div"),c=this.createAddressInputElement();b.appendChild(c);var c=this.createResultsListElement(),d=document.createElement("div"),e=document.createElement("div");d.appendChild(c);e.appendChild(d);b.appendChild(e);a.appendChild(b);a.onmouseover=ALKMaps.Function.bind(this.onMouseOver,this);a.onmouseout=ALKMaps.Function.bind(this.onMouseOut,
this);this.isDivExternal||this.map.div.appendChild(a);return a},createDivContainerElement:function(){if(null==this.div)ALKMaps.Control.prototype.draw.apply(this),this.div.className=ALKMaps.String.format("${prefix}alkmaps-geo-panel ${prefix}alkmaps-geo-panel-position",{prefix:this.classNamePrefix}),this.div.className+=" alkmaps-"+this.componentLocation,this.div.className+=" alkmaps-geo-"+this.componentWidth;else{if("string"===typeof this.div)this.div=document.getElementById(this.div);this.div.className+=
ALKMaps.String.format("${prefix}alkmaps-geo-panel",{prefix:this.classNamePrefix});this.isDivExternal=!0}return this.div},createTextboxInput:function(a,b,c){var d=document.createElement("input");ALKMaps.Util.extend(d,{name:a,type:"text",className:"alkmpas-input-sm alkmaps-geo-input alkmaps-geo-"+a,placeholder:b,value:c});d.events=new ALKMaps.Events(this,d,null,!0,{});return d},createAddressInputElement:function(){this.addressText="";this.addressElement=this.createTextboxInput("address",this.placeholderText,
this.addressText);this.attachEventHandler();var a=document.createElement("div");a.className="alkmaps-geo-row";a.appendChild(this.addressElement);var b=document.createElement("div");b.appendChild(a);return b},createErrorMessageElement:function(){this.errorMessageBox=document.createElement("div");this.errorMessageBox.className="alert alert-danger hide";this.errorMessage=document.createElement("div");this.errorMessageBox.appendChild(this.errorMessage);return this.errorMessageBox},createResultsListElement:function(){this.resultsListElement=
document.createElement("ul");this.resultsListElement.className="alkmaps-geo-resultsList hide";return this.resultsListElement},createResultsIcon:function(a){var b=document.createElement("div");b.className="results-icon";var c=document.createElement("img");c.src=this.getIconImage(a);b.appendChild(c);return b},createResultsAddress:function(a,b){var c=document.createElement("div");c.className="results-address";var d=document.createElement("span");d.className="results-text";if(null!=b)d.className="results-"+
b+"-text";d.innerHTML=a;c.appendChild(d);return c},createResultsCity:function(a){var b=document.createElement("div");b.className="results-city";var c=document.createElement("span");c.className="results-text";c.innerHTML=a;b.appendChild(c);return b},createResultsLonLat:function(a){var b=document.createElement("div");b.className="results-city";var c=document.createElement("span"),d=document.createElement("span"),e=document.createElement("span"),f=document.createElement("span"),g=document.createElement("span"),
h=document.createElement("span"),i=document.createElement("span");c.innerHTML=a.Coords.Lat;d.innerHTML=", ";e.innerHTML=a.Coords.Lon;var j=this.getUserLocation();if(null!=j)j=ALKMaps.Util.distVincenty(j,new ALKMaps.LonLat(a.Coords.Lon,a.Coords.Lat)),f.innerHTML="english"===this.displaySystem?"("+(0.621371*j).toFixed(2)+" mi.)":"("+j.toFixed(2)+" km.)";g.className="results-type";h.className="label-position label label-warning";if(null!=this.resultTypes)i.innerHTML=this.resultTypes[a.ResultType];h.appendChild(i);
g.appendChild(h);b.appendChild(c);b.appendChild(d);b.appendChild(e);b.appendChild(f);b.appendChild(g);return b},regionalInformation:function(a){var b=null!==a.Address.City&&""!=a.Address.City?a.Address.City+", ":"",c=null!==a.Address.Zip&&""!==a.Address.Zip?" "+a.Address.Zip:"",d=null!==a.Address.County&&""!==a.Address.County?", "+a.Address.County:"";return 4==a.Region||5==a.Region?b+a.Address.State+c:b+a.Address.Country+c+d},createResultElement:function(a){var b=document.createElement("a");b.href=
"#";b.setAttribute("tabindex","0");var c=this.createResultsIcon(a);b.appendChild(c);c=this.resultTypes[a.ResultType];if("POI"===c||"POIType"===c){var c=this.createResultsAddress(a.ShortString,"poi"),d=this.createResultsAddress(a.Address.StreetAddress),e=this.createResultsCity(this.regionalInformation(a));b.appendChild(c);b.appendChild(d);b.appendChild(e)}else c=this.createResultsAddress(a.ShortString),b.appendChild(c);c=this.createResultsLonLat(a);b.appendChild(c);var f=this;ALKMaps.Util.addEventHelper(b,
"keydown",function(b){40===b.keyCode&&null!=b.target.parentElement.nextElementSibling&&b.target.parentElement.nextElementSibling.children[0].focus();38===b.keyCode&&null!=b.target.parentElement.previousElementSibling&&b.target.parentElement.previousElementSibling.children[0].focus();if(13===b.keyCode){var c=f.events.triggerEvent("locationenter",{location:a});if(!1===c)return;f.processResponseItem(a);if(!0===f.hideResults)f.resultsListElement=ALKMaps.Util.hideElement(f.resultsListElement,"show","hide")}if(27===
b.keyCode&&(c=f.events.triggerEvent("resultslistescape",{resultsListElement:f.resultsListElement}),!1!==c))f.resultsListElement=ALKMaps.Util.hideElement(f.resultsListElement,"show","hide")});ALKMaps.Util.addEventHelper(b,"mousedown",function(c){if(!1!==f.events.triggerEvent("locationclick",{location:a}))f.processResponseItem(a),!0===f.hideResults?f.resultsListElement=ALKMaps.Util.hideElement(f.resultsListElement,"show","hide"):(b.focus(),c.preventDefault())});ALKMaps.Util.addEventHelper(b,"blur",
function(){!1!==f.events.triggerEvent("locationblur",{location:a})&&f.activateKeyboardControl()});ALKMaps.Util.addEventHelper(b,"focus",function(){!1!==f.events.triggerEvent("locationfocus",{location:a})&&f.deactivateKeyboardControl()});c=document.createElement("li");c.className="results-item";c.appendChild(b);return c},debounce:function(a,b,c,d){var e;return function(){var f=arguments,g=c&&!e;clearTimeout(e);e=setTimeout(function(){e=null;c||a.apply(d,f)},b);g&&a.apply(d,f)}},setSearchOption:function(a,
b){"query"!==a&&"maxResults"!==a&&"currentLonLat"!==a&&"excludedSearchTypes"!==a&&"poiCategories"!==a&&"countries"!==a&&"countryType"!==a&&"states"!==a&&"region"!==a&&"async"!==a&&"success"!==a&&"failure"!==a?alert("'"+a+"' is not a valid key."):this.searchOption[a]=b},searchCompleted:function(a){if(!1!==this.events.triggerEvent("searchcompleted",{locations:a.Locations})){this.resultsListElement.innerHTML="";if(0<a.Locations.length){for(var b=0;b<a.Locations.length;b++)this.resultsListElement.appendChild(this.createResultElement(a.Locations[b]));
this.resultsListElement=ALKMaps.Util.showElement(this.resultsListElement,"hide","show")}else ALKMaps.Util.hideElement(this.resultsListElement,"show","hide");this.events.triggerEvent("resultslistdrawn",{locations:a.Locations})}},searchFailed:function(){alert("Search failed.")},getUserLocation:function(){var a=ALKMaps.Util.extend({},this.DEFAULT_SEARCH_OPTION);ALKMaps.Util.extend(a,this.searchOption);if(null==a.currentLonLat){var b=this.getLocationReference();a.currentLonLat=b}return a.currentLonLat},
onDoneTyping:function(){var a=ALKMaps.Util.extend({},this.DEFAULT_SEARCH_OPTION);ALKMaps.Util.extend(a,this.searchOption);var b=this.addressElement.value;if(null!=a.query)b=a.query;if(!(null==b||b.length<=this.minSearchTextLength)){b={query:b};if(null!=a.maxResults)b.maxResults=a.maxResults;if(null==a.currentLonLat){var c=this.getLocationReference();a.currentLonLat=c}c=this.getUserLocation();if(null!=c)b.currentLonLat=c;if(null!=a.excludedSearchTypes)b.excludedSearchTypes=a.excludedSearchTypes;if(null!=
a.poiCategories)b.poiCategories=a.poiCategories;if(null!=a.countries)b.countries=a.countries;if(null!=a.countryType)b.countryType=a.countryType;if(null!=a.states)b.states=a.states;if(null!=a.region)b.region=a.region;if(!1===a.async)b.async=a.async;c=ALKMaps.Function.bind(this.searchCompleted,this);if("function"===typeof a.success)c=a.success;var d=ALKMaps.Function.bind(this.searchFailed,this);if("function"===typeof a.failure)d=a.failure;b.success=c;b.failure=d;ALKMaps.Geocoder.singleSearch(b)}},onKeyup:function(a){13===
a.keyCode&&""!==this.resultsListElement.innerHTML&&this.resultsListElement.children[0].children[0].focus()},attachEventHandler:function(){this.addressElement.events.on({click:function(){this.addressElement.focus()}});ALKMaps.Util.addEventHelper(this.addressElement,"input",this.debounce(this.onDoneTyping,this.doneTypingInterval,this.doneTypingImmediate,this));ALKMaps.Util.addEventHelper(this.addressElement,"blur",ALKMaps.Function.bind(this.activateKeyboardControl,this));ALKMaps.Util.addEventHelper(this.addressElement,
"focus",ALKMaps.Function.bind(this.deactivateKeyboardControl,this));ALKMaps.Util.addEventHelper(this.addressElement,"keyup",ALKMaps.Function.bind(this.onKeyup,this))},getLocationReference:function(){var a=null;"device"===this.locationRelevance?a=this.deviceLocation:"mapCenter"===this.locationRelevance&&(a=this.map.getCenter().clone().transform(this.map.getProjectionObject(),new ALKMaps.Projection("EPSG:4326")));return a},getIconImage:function(a){var b=this.events.triggerEvent("beforegeticon",{location:a});
if(null!=b&&0<b.length)return b;b=this.resultTypes[a.ResultType];if("POI"!==b&&"POIType"!==b)return ALKMaps.Util.getImageLocation("cat_poi_address_2d.png");for(var b=null,c=0;c<this.POI_ICONS.length;c++){var d=this.POI_ICONS[c];if(d.ID===a.POITypeID){b=d;break}}return null==b||b.PremiumImage?ALKMaps.Util.getImageLocation("cat_poi_other_2d.png"):ALKMaps.Util.getImageLocation("cat_poi_"+b.BMPName+"_2d.png")},removeMarker:function(){this.marker&&(this.geocodingLayer.removeMarker(this.marker),null!=this.marker.myPopup&&
this.map.removePopup(this.marker.myPopup))},processResponseItem:function(a){if(!1!==this.events.triggerEvent("beforeprocessresponseitem",{location:a})){var b=this.getIconImage(a);this.markerConfig.exclusive&&this.removeMarker();var c=(new ALKMaps.LonLat(a.Coords.Lon,a.Coords.Lat)).transform(new ALKMaps.Projection("EPSG:4326"),this.map.getProjectionObject());this.marker=this.drawPoint(c,b,this.formatAddressString(a.Address,!0,this.popupConfig.displayClass),this.popupConfig.show);this.markerConfig.centerOnMap&&
this.map.setCenter(c,this.markerConfig.zoomLevel)}},drawPoint:function(a,b,c,d){var e=null,e=ALKMaps.Util.extend({},this.markerStyle);if(null==this.markerStyle.externalGraphic)e.externalGraphic=b;e=this.geocodingLayer.createMarker(a,{markerType:"custom"},e);if(d)a="function"===typeof this.popupCloseBoxCallback?new ALKMaps.Popup.SimplePopup(this.popupConfig.id||null,a,this.popupConfig.size||null,c,this.popupConfig.offset||null,this.popupConfig.closeBox,this.popupConfig.closeBoxCallback):new ALKMaps.Popup.SimplePopup(this.popupConfig.id||
null,a,this.popupConfig.size||null,c,this.popupConfig.offset||null,this.popupConfig.closeBox),a.feature=e,e.myPopup=a,this.map.addPopup(a,this.popupConfig.exclusive);return e},formatAddressString:function(a,b,c){var d="";null!=a.StreetAddress&&""!==a.StreetAddress&&(d+=a.StreetAddress+", ",d+=b?"<br />":"");null!=a.City&&""!==a.City&&(d+=a.City+", ");d+=a.State+" "+a.Zip;return d=null!=c&&0<c.length?'<span class="'+c+'">'+d+"</span>":"<span>"+d+"</span>"},CLASS_NAME:"ALKMaps.Control.SingleSearch"});
ALKMaps.Control.SingleSearch.prototype.POI_ICONS=ALKMaps.POI_ICONS;ALKMaps.Geometry=ALKMaps.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new ALKMaps.Geometry},setBounds:function(a){if(a)this.bounds=a.clone()},clearBounds:function(){this.bounds=null;this.parent&&this.parent.clearBounds()},extendBounds:function(a){this.getBounds()?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){null==this.bounds&&this.calculateBounds();
return this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(a,b,c){var d=!1;null!=this.getBounds()&&null!=a&&(b=null!=b?b:0,c=null!=c?c:0,d=(new ALKMaps.Bounds(this.bounds.left-b,this.bounds.bottom-c,this.bounds.right+b,this.bounds.top+c)).containsLonLat(a));return d},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return ALKMaps.Format&&ALKMaps.Format.WKT?ALKMaps.Format.WKT.prototype.write(new ALKMaps.Feature.Vector(this)):
Object.prototype.toString.call(this)},CLASS_NAME:"ALKMaps.Geometry"});ALKMaps.Geometry.fromWKT=function(a){var b;if(ALKMaps.Format&&ALKMaps.Format.WKT){var c=ALKMaps.Geometry.fromWKT.format;if(!c)c=new ALKMaps.Format.WKT,ALKMaps.Geometry.fromWKT.format=c;a=c.read(a);if(a instanceof ALKMaps.Feature.Vector)b=a.geometry;else if(ALKMaps.Util.isArray(a)){b=a.length;for(var c=Array(b),d=0;d<b;++d)c[d]=a[d].geometry;b=new ALKMaps.Geometry.Collection(c)}}return b};
ALKMaps.Geometry.segmentsIntersect=function(a,b,c){var d=c&&c.point,c=c&&c.tolerance,e=!1,f=a.x1-b.x1,g=a.y1-b.y1,h=a.x2-a.x1,i=a.y2-a.y1,j=b.y2-b.y1,k=b.x2-b.x1,m=j*h-k*i,j=k*g-j*f,g=h*g-i*f;0==m?0==j&&0==g&&(e=!0):(f=j/m,m=g/m,0<=f&&1>=f&&0<=m&&1>=m&&(d?(h=a.x1+f*h,m=a.y1+f*i,e=new ALKMaps.Geometry.Point(h,m)):e=!0));if(c)if(e){if(d){a=[a,b];b=0;a:for(;2>b;++b){f=a[b];for(i=1;3>i;++i)if(h=f["x"+i],m=f["y"+i],d=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(m-e.y,2)),d<c){e.x=h;e.y=m;break a}}}}else{a=[a,
b];b=0;a:for(;2>b;++b){h=a[b];m=a[(b+1)%2];for(i=1;3>i;++i)if(f={x:h["x"+i],y:h["y"+i]},g=ALKMaps.Geometry.distanceToSegment(f,m),g.distance<c){e=d?new ALKMaps.Geometry.Point(f.x,f.y):!0;break a}}}return e};ALKMaps.Geometry.distanceToSegment=function(a,b){var c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,i=g-e,j=h-f,k=(i*(c-e)+j*(d-f))/(Math.pow(i,2)+Math.pow(j,2));0>=k||(1<=k?(e=g,f=h):(e+=k*i,f+=k*j));return{distance:Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2)),x:e,y:f}};ALKMaps.Geometry.Point=ALKMaps.Class(ALKMaps.Geometry,{x:null,y:null,initialize:function(a,b){ALKMaps.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(b)},clone:function(a){null==a&&(a=new ALKMaps.Geometry.Point(this.x,this.y));ALKMaps.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new ALKMaps.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g,h;a instanceof ALKMaps.Geometry.Point?
(e=this.x,f=this.y,g=a.x,h=a.y,d=Math.sqrt(Math.pow(e-g,2)+Math.pow(f-h,2)),d=!c?d:{x0:e,y0:f,x1:g,y1:h,distance:d}):(d=a.distanceTo(this,b),c&&(d={x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0,distance:d.distance}));return d},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},toShortString:function(){return this.x+", "+this.y},move:function(a,b){this.x+=a;this.y+=b;this.clearBounds()},rotate:function(a,b){var a=a*(Math.PI/180),c=this.distanceTo(b),
d=a+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d);this.y=b.y+c*Math.sin(d);this.clearBounds()},getCentroid:function(){return new ALKMaps.Geometry.Point(this.x,this.y)},resize:function(a,b,c){this.x=b.x+a*(void 0==c?1:c)*(this.x-b.x);this.y=b.y+a*(this.y-b.y);this.clearBounds();return this},intersects:function(a){var b=!1;return b="ALKMaps.Geometry.Point"==a.CLASS_NAME?this.equals(a):a.intersects(this)},transform:function(a,b){if(a&&b)ALKMaps.Projection.transform(this,a,b),this.bounds=
null;return this},getVertices:function(){return[this]},CLASS_NAME:"ALKMaps.Geometry.Point"});ALKMaps.Geometry.Point.transformArray=function(a,b,c){var d=[];if(null!=a&&a instanceof Array&&0<a.length)for(var e=0;e<a.length;e++)if(a[e]instanceof ALKMaps.Geometry.Point)d.push(a[e].clone().transform(b,c));else return[];return d};ALKMaps.Control.BaseGeolocate=ALKMaps.Class(ALKMaps.Control,{geolocation:navigator.geolocation,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate();ALKMaps.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(!this.geolocation)return this.events.triggerEvent("locationuncapable"),!1;return ALKMaps.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(ALKMaps.Function.bind(this.geolocate,this),ALKMaps.Function.bind(this.failure,
this),this.geolocationOptions):this.getCurrentLocation(),!0):!1},deactivate:function(){this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId);return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){var b=(new ALKMaps.LonLat(a.coords.longitude,a.coords.latitude)).transform(new ALKMaps.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&this.map.setCenter(b);this.events.triggerEvent("locationupdated",{position:a,point:new ALKMaps.Geometry.Point(b.lon,
b.lat)})},getCurrentLocation:function(){if(!this.active||this.watch)return!1;this.geolocation.getCurrentPosition(ALKMaps.Function.bind(this.geolocate,this),ALKMaps.Function.bind(this.failure,this),this.geolocationOptions);return!0},failure:function(a){this.events.triggerEvent("locationfailed",{error:a})},CLASS_NAME:"ALKMaps.Control.BaseGeolocate"});ALKMaps.Control.Geolocate=ALKMaps.Class(ALKMaps.Control.Panel,{autoActivate:!0,draw:function(){ALKMaps.Control.Panel.prototype.draw.apply(this,arguments);var a=new ALKMaps.Control.BaseGeolocate({bind:!1,geolocationOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:7E3}});this.map.addControl(a);var b=new ALKMaps.Layer.Vector("Location",{displayInLayerSwitcher:!1});this.map.addLayers([b]);var c=!0,d={fillColor:"#09F",strokeOpacity:0.6,fillOpacity:0.05,strokeWidth:1,strokeColor:"#09F"};a.events.register("locationupdated",
a,function(a){b.removeAllFeatures();var f=new ALKMaps.Feature.Vector(ALKMaps.Geometry.Polygon.createRegularPolygon(new ALKMaps.Geometry.Point(a.point.x,a.point.y),a.position.coords.accuracy/111200/2,40,0),{},d),g="circle",h=0,i=5,j=a.position.coords.heading;null!=j&&(g="chevron",h=j,i=9);b.addFeatures([new ALKMaps.Feature.Vector(a.point,{},{graphicName:g,fillColor:"#09F",strokeColor:"#FFF",strokeWidth:1,fillOpacity:0.8,pointRadius:i,rotation:h}),f]);c&&(this.map.zoomToExtent(b.getDataExtent()),c=
!1)});a.events.register("locationfailed",this,function(){ALKMaps.Console.log("Location detection failed")});this.addControls([new ALKMaps.Control.Button({displayClass:"alkLocationToggle",eventListeners:{activate:function(){a.deactivate();c=a.watch=!0;a.activate()},deactivate:function(){b.removeAllFeatures();a.deactivate()}},type:ALKMaps.Control.TYPE_TOGGLE})]);this.addControls([new ALKMaps.Control.Button({displayClass:"alkLocLockToggle",eventListeners:{activate:function(){if(0===b.features.length)return!1;
a.bind=!0;a.active&&this.map.zoomToExtent(b.getDataExtent())},deactivate:function(){a.bind=!1}},type:ALKMaps.Control.TYPE_TOGGLE})]);this.div.className="olControlALKPanel "+this.div.className;return this.div},CLASS_NAME:"ALKMaps.Control.Geolocate"});ALKMaps.Format=ALKMaps.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){ALKMaps.Util.extend(this,a);this.options=a},destroy:function(){},read:function(){throw Error("Read not implemented.");},write:function(){throw Error("Write not implemented.");},CLASS_NAME:"ALKMaps.Format"});ALKMaps.Format.JSON=ALKMaps.Class(ALKMaps.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||!("function"==typeof JSON.parse&&"function"==typeof JSON.stringify))}(),read:function(a,b){var c;if(this.nativeJSON)c=JSON.parse(a,b);else try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(c=eval("("+a+")"),"function"===typeof b)){var d=
function(a,c){if(c&&"object"===typeof c)for(var e in c)c.hasOwnProperty(e)&&(c[e]=d(e,c[e]));return b(a,c)};c=d("",c)}}catch(e){}if(this.keepData)this.data=c;return c},write:function(a,b){this.pretty=!!b;var c=null,d=typeof a;if(this.serialize[d])try{c=!this.pretty&&this.nativeJSON?JSON.stringify(a):this.serialize[d].apply(this,[a])}catch(e){ALKMaps.Console.error("Trouble serializing: "+e)}return c},writeIndent:function(){var a=[];if(this.pretty)for(var b=0;b<this.level;++b)a.push(this.indent);return a.join("")},
writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(null==a)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var b=["{"];this.level+=1;var c,d,e,f=!1;for(c in a)a.hasOwnProperty(c)&&(d=ALKMaps.Format.JSON.prototype.write.apply(this,[c,this.pretty]),e=ALKMaps.Format.JSON.prototype.write.apply(this,[a[c],this.pretty]),
null!=d&&null!=e&&(f&&b.push(","),b.push(this.writeNewline(),this.writeIndent(),d,":",this.writeSpace(),e),f=!0));this.level-=1;b.push(this.writeNewline(),this.writeIndent(),"}");return b.join("")},array:function(a){var b,c=["["];this.level+=1;for(var d=0,e=a.length;d<e;++d)b=ALKMaps.Format.JSON.prototype.write.apply(this,[a[d],this.pretty]),null!=b&&(0<d&&c.push(","),c.push(this.writeNewline(),this.writeIndent(),b));this.level-=1;c.push(this.writeNewline(),this.writeIndent(),"]");return c.join("")},
string:function(a){var b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,d){var e=b[d];if(e)return e;e=d.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)})+'"':'"'+a+'"'},number:function(a){return isFinite(a)?""+a:"null"},"boolean":function(a){return""+a},date:function(a){function b(a){return 10>a?"0"+a:a}return'"'+a.getFullYear()+"-"+b(a.getMonth()+1)+"-"+
b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"ALKMaps.Format.JSON"});ALKMaps.Geometry.Collection=ALKMaps.Class(ALKMaps.Geometry,{components:null,componentTypes:null,initialize:function(a){ALKMaps.Geometry.prototype.initialize.apply(this,arguments);this.components=[];null!=a&&this.addComponents(a)},destroy:function(){this.components.length=0;this.components=null;ALKMaps.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),b=0,c=this.components.length;b<c;b++)a.addComponent(this.components[b].clone());ALKMaps.Util.applyDefaults(a,
this);return a},getComponentsString:function(){for(var a=[],b=0,c=this.components.length;b<c;b++)a.push(this.components[b].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;var a=new ALKMaps.Bounds,b=this.components;if(b)for(var c=0,d=b.length;c<d;c++)a.extend(b[c].getBounds());null!=a.left&&null!=a.bottom&&null!=a.right&&null!=a.top&&this.setBounds(a)},addComponents:function(a){ALKMaps.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<c;b++)this.addComponent(a[b])},
addComponent:function(a,b){var c=!1;if(a&&(null==this.componentTypes||-1<ALKMaps.Util.indexOf(this.componentTypes,a.CLASS_NAME))){if(null!=b&&b<this.components.length){var c=this.components.slice(0,b),d=this.components.slice(b,this.components.length);c.push(a);this.components=c.concat(d)}else this.components.push(a);a.parent=this;this.clearBounds();c=!0}return c},removeComponents:function(a){var b=!1;ALKMaps.Util.isArray(a)||(a=[a]);for(var c=a.length-1;0<=c;--c)b=this.removeComponent(a[c])||b;return b},
removeComponent:function(a){ALKMaps.Util.removeItem(this.components,a);this.clearBounds();return!0},getLength:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getLength();return a},getArea:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getArea();return a},getGeodesicArea:function(a){for(var b=0,c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicArea(a);return b},getCentroid:function(a){if(!a)return this.components.length&&
this.components[0].getCentroid();a=this.components.length;if(!a)return!1;for(var b=[],c=[],d=0,e=Number.MAX_VALUE,f,g=0;g<a;++g){f=this.components[g];var h=f.getArea();f=f.getCentroid(!0);!isNaN(h)&&!isNaN(f.x)&&!isNaN(f.y)&&(b.push(h),d+=h,e=h<e&&0<h?h:e,c.push(f))}a=b.length;if(0===d){for(g=0;g<a;++g)b[g]=1;d=b.length}else{for(g=0;g<a;++g)b[g]/=e;d/=e}for(var i=e=0,g=0;g<a;++g)f=c[g],h=b[g],e+=f.x*h,i+=f.y*h;return new ALKMaps.Geometry.Point(e/d,i/d)},getGeodesicLength:function(a){for(var b=0,c=
0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicLength(a);return b},move:function(a,b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0;d<this.components.length;++d)this.components[d].resize(a,b,c);return this},distanceTo:function(a,b){for(var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g=Number.POSITIVE_INFINITY,h=0,i=this.components.length;h<
i&&!(d=this.components[h].distanceTo(a,b),f=c?d.distance:d,f<g&&(g=f,e=d,0==g));++h);return e},equals:function(a){var b=!0;if(!a||!a.CLASS_NAME||this.CLASS_NAME!=a.CLASS_NAME)b=!1;else if(!ALKMaps.Util.isArray(a.components)||a.components.length!=this.components.length)b=!1;else for(var c=0,d=this.components.length;c<d;++c)if(!this.components[c].equals(a.components[c])){b=!1;break}return b},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].transform(a,
b);this.bounds=null}return this},intersects:function(a){for(var b=!1,c=0,d=this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);return b},getVertices:function(a){for(var b=[],c=0,d=this.components.length;c<d;++c)Array.prototype.push.apply(b,this.components[c].getVertices(a));return b},CLASS_NAME:"ALKMaps.Geometry.Collection"});ALKMaps.Geometry.MultiPoint=ALKMaps.Class(ALKMaps.Geometry.Collection,{componentTypes:["ALKMaps.Geometry.Point"],addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"ALKMaps.Geometry.MultiPoint"});ALKMaps.Geometry.Curve=ALKMaps.Class(ALKMaps.Geometry.MultiPoint,{componentTypes:["ALKMaps.Geometry.Point"],getLength:function(){var a=0;if(this.components&&1<this.components.length)for(var b=1,c=this.components.length;b<c;b++)a+=this.components[b-1].distanceTo(this.components[b]);return a},getGeodesicLength:function(a){var b=this;if(a){var c=new ALKMaps.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;if(b.components&&1<b.components.length)for(var d,e=1,f=b.components.length;e<
f;e++)c=b.components[e-1],d=b.components[e],a+=ALKMaps.Util.distVincenty({lon:c.x,lat:c.y},{lon:d.x,lat:d.y});return 1E3*a},CLASS_NAME:"ALKMaps.Geometry.Curve"});ALKMaps.Geometry.LineString=ALKMaps.Class(ALKMaps.Geometry.Curve,{removeComponent:function(a){var b=this.components&&2<this.components.length;b&&ALKMaps.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return b},intersects:function(a){var b=!1,c=a.CLASS_NAME;if("ALKMaps.Geometry.LineString"==c||"ALKMaps.Geometry.LinearRing"==c||"ALKMaps.Geometry.Point"==c){var d=this.getSortedSegments(),a="ALKMaps.Geometry.Point"==c?[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:a.getSortedSegments(),e,f,g,h,
i,j,k,m=0,l=d.length;a:for(;m<l;++m){c=d[m];e=c.x1;f=c.x2;g=c.y1;h=c.y2;var p=0,n=a.length;for(;p<n;++p){i=a[p];if(i.x1>f)break;if(!(i.x2<e)&&(j=i.y1,k=i.y2,!(Math.min(j,k)>Math.max(g,h))&&!(Math.max(j,k)<Math.min(g,h))&&ALKMaps.Geometry.segmentsIntersect(c,i))){b=!0;break a}}}}else b=a.intersects(this);return b},getSortedSegments:function(){for(var a=this.components.length-1,b=Array(a),c,d,e=0;e<a;++e)c=this.components[e],d=this.components[e+1],b[e]=c.x<d.x?{x1:c.x,y1:c.y,x2:d.x,y2:d.y}:{x1:d.x,
y1:d.y,x2:c.x,y2:c.y};return b.sort(function(a,b){return a.x1-b.x1})},splitWithSegment:function(a,b){for(var c=!(b&&!1===b.edge),d=b&&b.tolerance,e=[],f=this.getVertices(),g=[],h=[],i=!1,j,k,m,l={point:!0,tolerance:d},p=null,n=0,q=f.length-2;n<=q;++n)if(d=f[n],g.push(d.clone()),j=f[n+1],k={x1:d.x,y1:d.y,x2:j.x,y2:j.y},k=ALKMaps.Geometry.segmentsIntersect(a,k,l),k instanceof ALKMaps.Geometry.Point&&((m=k.x===a.x1&&k.y===a.y1||k.x===a.x2&&k.y===a.y2||k.equals(d)||k.equals(j)?!0:!1)||c))k.equals(h[h.length-
1])||h.push(k.clone()),!(0===n&&k.equals(d))&&!k.equals(j)&&(i=!0,k.equals(d)||g.push(k),e.push(new ALKMaps.Geometry.LineString(g)),g=[k.clone()]);i&&(g.push(j.clone()),e.push(new ALKMaps.Geometry.LineString(g)));if(0<h.length)var o=a.x1<a.x2?1:-1,r=a.y1<a.y2?1:-1,p={lines:e,points:h.sort(function(a,b){return o*a.x-o*b.x||r*a.y-r*b.y})};return p},split:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h;if(a instanceof ALKMaps.Geometry.LineString){var i=this.getVertices(),j,k,m,l,p,n=[];g=[];for(var q=
0,o=i.length-2;q<=o;++q){j=i[q];k=i[q+1];m={x1:j.x,y1:j.y,x2:k.x,y2:k.y};h=h||[a];d&&n.push(j.clone());for(var r=0;r<h.length;++r)if(l=h[r].splitWithSegment(m,b))if(p=l.lines,0<p.length&&(p.unshift(r,1),Array.prototype.splice.apply(h,p),r+=p.length-2),d)for(var t=0,s=l.points.length;t<s;++t)p=l.points[t],p.equals(j)||(n.push(p),g.push(new ALKMaps.Geometry.LineString(n)),n=p.equals(k)?[]:[p.clone()])}d&&0<g.length&&0<n.length&&(n.push(k.clone()),g.push(new ALKMaps.Geometry.LineString(n)))}else c=a.splitWith(this,
b);h&&1<h.length?f=!0:h=[];g&&1<g.length?e=!0:g=[];if(f||e)c=d?[g,h]:h;return c},splitWith:function(a,b){return a.split(this,b)},getVertices:function(a){return!0===a?[this.components[0],this.components[this.components.length-1]]:!1===a?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e={},f=Number.POSITIVE_INFINITY;if(a instanceof ALKMaps.Geometry.Point){for(var g=this.getSortedSegments(),h=a.x,i=a.y,j,k=0,
m=g.length;k<m;++k)if(j=g[k],d=ALKMaps.Geometry.distanceToSegment(a,j),d.distance<f){if(f=d.distance,e=d,0===f)break}else if(j.x2>h&&(i>j.y1&&i<j.y2||i<j.y1&&i>j.y2))break;e=c?{distance:e.distance,x0:e.x,y0:e.y,x1:h,y1:i}:e.distance}else if(a instanceof ALKMaps.Geometry.LineString){var g=this.getSortedSegments(),h=a.getSortedSegments(),l,p,n=h.length,q={point:!0},k=0,m=g.length;a:for(;k<m;++k){i=g[k];j=i.x1;p=i.y1;for(var o=0;o<n;++o)if(d=h[o],l=ALKMaps.Geometry.segmentsIntersect(i,d,q)){f=0;e={distance:0,
x0:l.x,y0:l.y,x1:l.x,y1:l.y};break a}else if(d=ALKMaps.Geometry.distanceToSegment({x:j,y:p},d),d.distance<f)f=d.distance,e={distance:f,x0:j,y0:p,x1:d.x,y1:d.y}}if(!c)e=e.distance;0!==f&&i&&(d=a.distanceTo(new ALKMaps.Geometry.Point(i.x2,i.y2),b),k=c?d.distance:d,k<f&&(e=c?{distance:f,x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0}:k))}else e=a.distanceTo(this,b),c&&(e={distance:e.distance,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0});return e},simplify:function(a){if(this&&null!==this){var b=this.getVertices();if(3>b.length)return this;
var c=function(a,b,d,i){for(var j=0,k=0,m=b,l;m<d;m++){l=a[b];var p=a[d],n=a[m],n=Math.abs(0.5*(l.x*p.y+p.x*n.y+n.x*l.y-p.x*l.y-n.x*p.y-l.x*n.y));l=Math.sqrt(Math.pow(l.x-p.x,2)+Math.pow(l.y-p.y,2));l=2*(n/l);l>j&&(j=l,k=m)}j>i&&k!=b&&(e.push(k),c(a,b,k,i),c(a,k,d,i))},d=b.length-1,e=[];e.push(0);for(e.push(d);b[0].equals(b[d]);)d--,e.push(d);c(b,0,d,a);a=[];e.sort(function(a,b){return a-b});for(d=0;d<e.length;d++)a.push(b[e[d]]);return new ALKMaps.Geometry.LineString(a)}return this},CLASS_NAME:"ALKMaps.Geometry.LineString"});ALKMaps.Geometry.MultiLineString=ALKMaps.Class(ALKMaps.Geometry.Collection,{componentTypes:["ALKMaps.Geometry.LineString"],split:function(a,b){for(var c=null,d=b&&b.mutual,e,f,g,h,i=[],j=[a],k=0,m=this.components.length;k<m;++k){f=this.components[k];g=!1;for(var l=0;l<j.length;++l)if(e=f.split(j[l],b)){if(d){g=e[0];for(var p=0,n=g.length;p<n;++p)0===p&&i.length?i[i.length-1].addComponent(g[p]):i.push(new ALKMaps.Geometry.MultiLineString([g[p]]));g=!0;e=e[1]}if(e.length){e.unshift(l,1);Array.prototype.splice.apply(j,
e);break}}g||(i.length?i[i.length-1].addComponent(f.clone()):i=[new ALKMaps.Geometry.MultiLineString(f.clone())])}i&&1<i.length?g=!0:i=[];j&&1<j.length?h=!0:j=[];if(g||h)c=d?[i,j]:j;return c},splitWith:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h,i,j;if(a instanceof ALKMaps.Geometry.LineString){j=[];i=[a];for(var k=0,m=this.components.length;k<m;++k){g=!1;f=this.components[k];for(var l=0;l<i.length;++l)if(e=i[l].split(f,b)){d&&(g=e[0],g.length&&(g.unshift(l,1),Array.prototype.splice.apply(i,g),
l+=g.length-2),e=e[1],0===e.length&&(e=[f.clone()]));g=0;for(var p=e.length;g<p;++g)0===g&&j.length?j[j.length-1].addComponent(e[g]):j.push(new ALKMaps.Geometry.MultiLineString([e[g]]));g=!0}g||(j.length?j[j.length-1].addComponent(f.clone()):j=[new ALKMaps.Geometry.MultiLineString([f.clone()])])}}else c=a.split(this);i&&1<i.length?h=!0:i=[];j&&1<j.length?g=!0:j=[];if(h||g)c=d?[i,j]:j;return c},CLASS_NAME:"ALKMaps.Geometry.MultiLineString"});ALKMaps.Geometry.LinearRing=ALKMaps.Class(ALKMaps.Geometry.LineString,{componentTypes:["ALKMaps.Geometry.Point"],addComponent:function(a,b){var c=!1,d=this.components.pop();if(null!=b||!a.equals(d))c=ALKMaps.Geometry.Collection.prototype.addComponent.apply(this,arguments);ALKMaps.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return c},removeComponent:function(a){var b=this.components&&3<this.components.length;b&&(this.components.pop(),ALKMaps.Geometry.Collection.prototype.removeComponent.apply(this,
arguments),ALKMaps.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]));return b},move:function(a,b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d-1;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0,e=this.components.length;d<e-1;++d)this.components[d].resize(a,b,c);return this},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].transform(a,
b);this.bounds=null}return this},getCentroid:function(){if(this.components&&2<this.components.length){for(var a=0,b=0,c=0;c<this.components.length-1;c++)var d=this.components[c],e=this.components[c+1],a=a+(d.x+e.x)*(d.x*e.y-e.x*d.y),b=b+(d.y+e.y)*(d.x*e.y-e.x*d.y);c=-1*this.getArea();return new ALKMaps.Geometry.Point(a/(6*c),b/(6*c))}return null},getArea:function(){var a=0;if(this.components&&2<this.components.length){for(var b=a=0,c=this.components.length;b<c-1;b++)var d=this.components[b],e=this.components[b+
1],a=a+(d.x+e.x)*(e.y-d.y);a=-a/2}return a},getGeodesicArea:function(a){var b=this;if(a){var c=new ALKMaps.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;c=b.components&&b.components.length;if(2<c){for(var d,e,f=0;f<c-1;f++)d=b.components[f],e=b.components[f+1],a+=ALKMaps.Util.rad(e.x-d.x)*(2+Math.sin(ALKMaps.Util.rad(d.y))+Math.sin(ALKMaps.Util.rad(e.y)));a=40680631590769*a/2}return a},containsPoint:function(a){for(var b=ALKMaps.Number.limitSigDigs,c=b(a.x,14),a=b(a.y,14),
d=this.components.length-1,e,f,g,h,i,j=0,k=0;k<d;++k)if(e=this.components[k],g=b(e.x,14),e=b(e.y,14),f=this.components[k+1],h=b(f.x,14),f=b(f.y,14),e==f){if(a==e&&(g<=h&&c>=g&&c<=h||g>=h&&c<=g&&c>=h)){j=-1;break}}else{i=b((a-f)*((h-g)/(f-e))+h,14);if(i==c&&(e<f&&a>=e&&a<=f||e>f&&a<=e&&a>=f)){j=-1;break}i<=c||g!=h&&(i<Math.min(g,h)||i>Math.max(g,h))||(e<f&&a>=e&&a<f||e>f&&a<e&&a>=f)&&++j}return-1==j?1:!!(j&1)},intersects:function(a){var b=!1;if("ALKMaps.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);
else if("ALKMaps.Geometry.LineString"==a.CLASS_NAME)b=a.intersects(this);else if("ALKMaps.Geometry.LinearRing"==a.CLASS_NAME)b=ALKMaps.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var c=0,d=a.components.length;c<d&&!(b=a.components[c].intersects(this));++c);return b},getVertices:function(a){return!0===a?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"ALKMaps.Geometry.LinearRing"});ALKMaps.Geometry.Polygon=ALKMaps.Class(ALKMaps.Geometry.Collection,{componentTypes:["ALKMaps.Geometry.LinearRing"],getArea:function(){var a=0;if(this.components&&0<this.components.length)for(var a=a+Math.abs(this.components[0].getArea()),b=1,c=this.components.length;b<c;b++)a-=Math.abs(this.components[b].getArea());return a},getGeodesicArea:function(a){var b=0;if(this.components&&0<this.components.length)for(var b=b+Math.abs(this.components[0].getGeodesicArea(a)),c=1,d=this.components.length;c<d;c++)b-=
Math.abs(this.components[c].getGeodesicArea(a));return b},containsPoint:function(a){var b=this.components.length,c=!1;if(0<b&&(c=this.components[0].containsPoint(a),1!==c&&c&&1<b))for(var d,e=1;e<b;++e)if(d=this.components[e].containsPoint(a)){c=1===d?1:!1;break}return c},intersects:function(a){var b=!1,c,d;if("ALKMaps.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("ALKMaps.Geometry.LineString"==a.CLASS_NAME||"ALKMaps.Geometry.LinearRing"==a.CLASS_NAME){for(c=0,d=this.components.length;c<
d&&!(b=a.intersects(this.components[c]));++c);if(!b)for(c=0,d=a.components.length;c<d&&!(b=this.containsPoint(a.components[c]));++c);}else for(c=0,d=a.components.length;c<d&&!(b=this.intersects(a.components[c]));++c);if(!b&&"ALKMaps.Geometry.Polygon"==a.CLASS_NAME){var e=this.components[0];for(c=0,d=e.components.length;c<d&&!(b=a.containsPoint(e.components[c]));++c);}return b},distanceTo:function(a,b){return b&&!1===b.edge&&this.intersects(a)?0:ALKMaps.Geometry.Collection.prototype.distanceTo.apply(this,
[a,b])},CLASS_NAME:"ALKMaps.Geometry.Polygon"});ALKMaps.Geometry.Polygon.createRegularPolygon=function(a,b,c,d){var e=Math.PI*(1/c-0.5);d&&(e+=d/180*Math.PI);for(var f,g=[],h=0;h<c;++h)f=e+2*h*Math.PI/c,d=a.x+b*Math.cos(f),f=a.y+b*Math.sin(f),g.push(new ALKMaps.Geometry.Point(d,f));a=new ALKMaps.Geometry.LinearRing(g);return new ALKMaps.Geometry.Polygon([a])};
ALKMaps.Geometry.Polygon.createGeodesicPolygon=function(a,b,c,d,e){"EPSG:4326"!==e.getCode()&&a.transform(e,new ALKMaps.Projection("EPSG:4326"));for(var a=new ALKMaps.LonLat(a.x,a.y),f,g=[],h=0;h<c;h++)f=360*h/c+d,f=ALKMaps.Util.destinationVincenty(a,f,b),f.transform(new ALKMaps.Projection("EPSG:4326"),e),f=new ALKMaps.Geometry.Point(f.lon,f.lat),g.push(f);b=new ALKMaps.Geometry.LinearRing(g);return new ALKMaps.Geometry.Polygon([b])};ALKMaps.Geometry.MultiPolygon=ALKMaps.Class(ALKMaps.Geometry.Collection,{componentTypes:["ALKMaps.Geometry.Polygon"],CLASS_NAME:"ALKMaps.Geometry.MultiPolygon"});ALKMaps.Format.GeoJSON=ALKMaps.Class(ALKMaps.Format.JSON,{ignoreExtraDims:!1,read:function(a,b,c){var b=b?b:"FeatureCollection",d=null,e=null;if(e="string"==typeof a?ALKMaps.Format.JSON.prototype.read.apply(this,[a,c]):a)if("string"!=typeof e.type)ALKMaps.Console.error("Bad GeoJSON - no type: "+a);else{if(this.isValidType(e,b))switch(b){case "Geometry":try{d=this.parseGeometry(e)}catch(f){ALKMaps.Console.error(f)}break;case "Feature":try{d=this.parseFeature(e),d.type="Feature"}catch(g){ALKMaps.Console.error(g)}break;
case "FeatureCollection":switch(d=[],e.type){case "Feature":try{d.push(this.parseFeature(e))}catch(h){d=null,ALKMaps.Console.error(h)}break;case "FeatureCollection":a=0;for(b=e.features.length;a<b;++a)try{d.push(this.parseFeature(e.features[a]))}catch(i){d=null,ALKMaps.Console.error(i)}break;default:try{var j=this.parseGeometry(e);d.push(new ALKMaps.Feature.Vector(j))}catch(k){d=null,ALKMaps.Console.error(k)}}}}else ALKMaps.Console.error("Bad JSON: "+a);return d},isValidType:function(a,b){var c=!1;
switch(b){case "Geometry":-1==ALKMaps.Util.indexOf("Point,MultiPoint,LineString,MultiLineString,Polygon,MultiPolygon,Box,GeometryCollection".split(","),a.type)?ALKMaps.Console.error("Unsupported geometry type: "+a.type):c=!0;break;case "FeatureCollection":c=!0;break;default:a.type==b?c=!0:ALKMaps.Console.error("Cannot convert types from "+a.type+" to "+b)}return c},parseFeature:function(a){var b,c,d;c=a.properties?a.properties:{};d=a.geometry&&a.geometry.bbox||a.bbox;try{b=this.parseGeometry(a.geometry)}catch(e){throw e;
}b=new ALKMaps.Feature.Vector(b,c);if(d)b.bounds=ALKMaps.Bounds.fromArray(d);if(a.id)b.fid=a.id;return b},parseGeometry:function(a){if(null==a)return null;var b,c=!1;if("GeometryCollection"==a.type){if(!ALKMaps.Util.isArray(a.geometries))throw"GeometryCollection must have geometries array: "+a;b=a.geometries.length;for(var c=Array(b),d=0;d<b;++d)c[d]=this.parseGeometry.apply(this,[a.geometries[d]]);b=new ALKMaps.Geometry.Collection(c);c=!0}else{if(!ALKMaps.Util.isArray(a.coordinates))throw"Geometry must have coordinates array: "+
a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{b=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(e){throw e;}}this.internalProjection&&this.externalProjection&&!c&&b.transform(this.externalProjection,this.internalProjection);return b},parseCoords:{point:function(a){if(!1==this.ignoreExtraDims&&2!=a.length)throw"Only 2D points are supported: "+a;return new ALKMaps.Geometry.Point(a[0],a[1])},multipoint:function(a){for(var b=[],c=null,
d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new ALKMaps.Geometry.MultiPoint(b)},linestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new ALKMaps.Geometry.LineString(b)},multilinestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.linestring.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new ALKMaps.Geometry.MultiLineString(b)},
polygon:function(a){for(var b=[],c,d,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g;}c=new ALKMaps.Geometry.LinearRing(d.components);b.push(c)}return new ALKMaps.Geometry.Polygon(b)},multipolygon:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.polygon.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new ALKMaps.Geometry.MultiPolygon(b)},box:function(a){if(2!=a.length)throw"GeoJSON box coordinates must have 2 elements";
return new ALKMaps.Geometry.Polygon([new ALKMaps.Geometry.LinearRing([new ALKMaps.Geometry.Point(a[0][0],a[0][1]),new ALKMaps.Geometry.Point(a[1][0],a[0][1]),new ALKMaps.Geometry.Point(a[1][0],a[1][1]),new ALKMaps.Geometry.Point(a[0][0],a[1][1]),new ALKMaps.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,b){var c={type:null};if(ALKMaps.Util.isArray(a)){c.type="FeatureCollection";var d=a.length;c.features=Array(d);for(var e=0;e<d;++e){var f=a[e];if(!f instanceof ALKMaps.Feature.Vector)throw"FeatureCollection only supports collections of features: "+
f;c.features[e]=this.extract.feature.apply(this,[f])}}else if(0==a.CLASS_NAME.indexOf("ALKMaps.Geometry"))c=this.extract.geometry.apply(this,[a]);else if(a instanceof ALKMaps.Feature.Vector&&(c=this.extract.feature.apply(this,[a]),a.layer&&a.layer.projection))c.crs=this.createCRSObject(a);return ALKMaps.Format.JSON.prototype.write.apply(this,[c,b])},createCRSObject:function(a){var a=a.layer.projection.toString(),b={};a.match(/epsg:/i)&&(a=parseInt(a.substring(a.indexOf(":")+1)),b=4326==a?{type:"name",
properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+a}});return b},extract:{feature:function(a){var b=this.extract.geometry.apply(this,[a.geometry]),b={type:"Feature",properties:a.attributes,geometry:b};if(null!=a.fid)b.id=a.fid;return b},geometry:function(a){if(null==a)return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME.split(".")[2],a=this.extract[b.toLowerCase()].apply(this,
[a]);return"Collection"==b?{type:"GeometryCollection",geometries:a}:{type:b,coordinates:a}},point:function(a){return[a.x,a.y]},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,
[a.components[c]]));return b},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},multipolygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.polygon.apply(this,[a.components[c]]));return b},collection:function(a){for(var b=a.components.length,c=Array(b),d=0;d<b;++d)c[d]=this.extract.geometry.apply(this,[a.components[d]]);return c}},CLASS_NAME:"ALKMaps.Format.GeoJSON"});ALKMaps.Control.OverviewMap=ALKMaps.Class(ALKMaps.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,initialize:function(a){this.layers=[];this.handlers={};ALKMaps.Control.prototype.initialize.apply(this,[a])},destroy:function(){if(this.mapDiv){this.handlers.click&&this.handlers.click.destroy();this.handlers.drag&&this.handlers.drag.destroy();
this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle);this.extentRectangle=null;if(this.rectEvents)this.rectEvents.destroy(),this.rectEvents=null;if(this.ovmap)this.ovmap.destroy(),this.ovmap=null;this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv)this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null;if(this.minimizeDiv)this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null;this.map.events.un({buttonclick:this.onButtonClick,
moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this});ALKMaps.Control.prototype.destroy.apply(this,arguments)}},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(0===this.layers.length)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";
this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=ALKMaps.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);
if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var a=ALKMaps.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=ALKMaps.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.div.appendChild(this.maximizeDiv);a=ALKMaps.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=
ALKMaps.Util.createAlphaImageDiv("ALKMaps_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&&this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&&this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",
this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(0!=b||0!=c){var d=this.rectPxBounds.top,e=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),f=this.rectPxBounds.getWidth(),c=Math.max(0,d-c),c=Math.min(c,this.ovmap.size.h-this.hComp-a),b=Math.max(0,e-b),b=Math.min(b,this.ovmap.size.w-this.wComp-f);this.setRectPxBounds(new ALKMaps.Bounds(b,c+a,b+f,c))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),
c=a.xy.x-b.x,d=a.xy.y-b.y,e=this.rectPxBounds.top,f=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),b=this.rectPxBounds.getWidth(),d=Math.max(0,e+d),d=Math.min(d,this.ovmap.size.h-a),c=Math.max(0,f+c),c=Math.min(c,this.ovmap.size.w-b);this.setRectPxBounds(new ALKMaps.Bounds(c,d+a,c+b,d));this.updateMapToRect()},onButtonClick:function(a){a.buttonElement===this.minimizeDiv?this.minimizeControl():a.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(a){this.element.style.display=
"";this.showToggle(!1);null!=a&&ALKMaps.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(!0);null!=a&&ALKMaps.Event.stop(a)},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":""},update:function(){null==this.ovmap&&this.createMap();(this.autoPan||!this.isSuitableOverview())&&this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.maxExtent,a=
new ALKMaps.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));b=this.ovmap.getResolution()/this.map.getResolution();return b>this.minRatio&&b<=this.maxRatio&&this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?
b=this.minRatio*a:c<=this.minRatio&&(b=this.maxRatio*a);this.ovmap.getProjection()!=this.map.getProjection()?(a=this.map.center.clone(),a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):a=this.map.center;this.ovmap.setCenter(a,this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=ALKMaps.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new ALKMaps.Map(this.mapDiv,a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);
ALKMaps.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(ALKMaps.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(ALKMaps.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(ALKMaps.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(ALKMaps.Element.getStyle(this.extentRectangle,"border-bottom-width")))?
this.hComp:2;this.handlers.drag=new ALKMaps.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new ALKMaps.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new ALKMaps.Events(this,this.extentRectangle,null,!0);this.rectEvents.register("mouseover",this,function(){!this.handlers.drag.active&&!this.map.dragging&&this.handlers.drag.activate()});
this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var a=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,b=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&&b?ALKMaps.INCHES_PER_UNIT[a]/ALKMaps.INCHES_PER_UNIT[b]:1}},updateRectToMap:function(){var a=this.getRectBoundsFromMapBounds(this.ovmap.getProjection()!=
this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent());a&&this.setRectPxBounds(a)},updateMapToRect:function(){var a=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject()));this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=
Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp),a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp),e=Math.max(a-c,0),f=Math.max(d-b,0);e<this.minRectSize||f<this.minRectSize?(this.extentRectangle.className=this.displayClass+this.minRectDisplayClass,e=c+e/2-this.minRectSize/2,this.extentRectangle.style.top=Math.round(b+f/2-this.minRectSize/2)+"px",this.extentRectangle.style.left=Math.round(e)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=
this.minRectSize+"px"):(this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(b)+"px",this.extentRectangle.style.left=Math.round(c)+"px",this.extentRectangle.style.height=Math.round(f)+"px",this.extentRectangle.style.width=Math.round(e)+"px");this.rectPxBounds=new ALKMaps.Bounds(Math.round(c),Math.round(d),Math.round(a),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=this.getOverviewPxFromLonLat({lon:a.left,lat:a.bottom}),a=this.getOverviewPxFromLonLat({lon:a.right,
lat:a.top}),c=null;b&&a&&(c=new ALKMaps.Bounds(b.x,b.y,a.x,a.y));return c},getMapBoundsFromRectBounds:function(a){var b=this.getLonLatFromOverviewPx({x:a.left,y:a.bottom}),a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new ALKMaps.Bounds(b.lon,b.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat();return{lon:d.lon+(a.x-b.w/2)*c,lat:d.lat-(a.y-b.h/2)*c}},getOverviewPxFromLonLat:function(a){var b=
this.ovmap.getResolution(),c=this.ovmap.getExtent();if(c)return{x:Math.round(1/b*(a.lon-c.left)),y:Math.round(1/b*(c.top-a.lat))}},CLASS_NAME:"ALKMaps.Control.OverviewMap"});ALKMaps.Handler=ALKMaps.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(a,b,c){ALKMaps.Util.extend(this,c);this.control=a;this.callbacks=b;(a=this.map||a.map)&&this.setMap(a);this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){return null==this.keyMask?!0:((a.shiftKey?ALKMaps.Handler.MOD_SHIFT:0)|(a.ctrlKey?ALKMaps.Handler.MOD_CTRL:0)|(a.altKey?ALKMaps.Handler.MOD_ALT:0))==this.keyMask},activate:function(){if(this.active)return!1;
for(var a=ALKMaps.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.register(a[b],this[a[b]]);return this.active=!0},deactivate:function(){if(!this.active)return!1;for(var a=ALKMaps.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]]);this.active=!1;return!0},callback:function(a,b){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,b)},register:function(a,b){this.map.events.registerPriority(a,this,b);this.map.events.registerPriority(a,
this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return!0},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"ALKMaps.Handler"});ALKMaps.Handler.MOD_NONE=0;ALKMaps.Handler.MOD_SHIFT=1;ALKMaps.Handler.MOD_CTRL=2;ALKMaps.Handler.MOD_ALT=4;ALKMaps.Handler.Drag=ALKMaps.Class(ALKMaps.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,lockMapPanning:!0,panLock:!1,initialize:function(a,b,c){ALKMaps.Handler.prototype.initialize.apply(this,arguments);if(!0===this.documentDrag){var d=this;this._docMove=function(a){d.mousemove({xy:{x:a.clientX,y:a.clientY},element:document})};this._docUp=function(a){d.mouseup({xy:{x:a.clientX,
y:a.clientY}})}}},dragstart:function(a){var b=!0;this.dragging=!1;if(this.checkModifiers(a)&&(ALKMaps.Event.isLeftClick(a)||ALKMaps.Event.isSingleTouch(a))){if(!0!==this.map.panLock&&!0===this.lockMapPanning)this.panLock=!0,this.map.panLock=!0;this.started=!0;this.last=this.start=a.xy;ALKMaps.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(a);this.callback("down",[a.xy]);ALKMaps.Event.stop(a);if(!this.oldOnselectstart)this.oldOnselectstart=document.onselectstart?document.onselectstart:
ALKMaps.Function.True;document.onselectstart=ALKMaps.Function.False;b=!this.stopDown}else this.started=!1,this.last=this.start=null;return b},dragmove:function(a){this.lastMoveEvt=a;if(this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y)){!0===this.documentDrag&&this.documentEvents&&(a.element===document?(this.adjustXY(a),this.setEvent(a)):this.removeDocumentEvents());if(0<this.interval)this.timeoutId=setTimeout(ALKMaps.Function.bind(this.removeTimeout,this),this.interval);this.dragging=
!0;this.move(a);this.callback("move",[a.xy]);if(!this.oldOnselectstart)this.oldOnselectstart=document.onselectstart,document.onselectstart=ALKMaps.Function.False;this.last=a.xy}return!0},dragend:function(a){if(this.started){!0===this.documentDrag&&this.documentEvents&&(this.adjustXY(a),this.removeDocumentEvents());var b=this.start!=this.last;this.dragging=this.started=!1;ALKMaps.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);b&&this.callback("done",[a.xy]);
document.onselectstart=this.oldOnselectstart}this.panLock=!0;this.panLock=!1;this.map.panLock=!1;return!0},down:function(){},move:function(){},up:function(){},out:function(){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){if(!this.touch)this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this});return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},
removeTimeout:function(){this.timeoutId=null;this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&&ALKMaps.Util.mouseLeft(a,this.map.viewPortDiv))if(!0===this.documentDrag)this.addDocumentEvents();else{var b=this.start!=this.last;this.dragging=this.started=!1;ALKMaps.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);b&&this.callback("done",
[a.xy]);if(document.onselectstart)document.onselectstart=this.oldOnselectstart}return!0},click:function(){return this.start==this.last},activate:function(){var a=!1;if(ALKMaps.Handler.prototype.activate.apply(this,arguments))this.dragging=!1,a=!0;return a},deactivate:function(){var a=!1;if(ALKMaps.Handler.prototype.deactivate.apply(this,arguments))this.dragging=this.started=this.touch=!1,this.last=this.start=null,a=!0,ALKMaps.Element.removeClass(this.map.viewPortDiv,"olDragDown");return a},adjustXY:function(a){var b=
ALKMaps.Util.pagePosition(this.map.viewPortDiv);a.xy.x-=b[0];a.xy.y-=b[1]},addDocumentEvents:function(){ALKMaps.Element.addClass(document.body,"olDragDown");this.documentEvents=!0;ALKMaps.Event.observe(document,"mousemove",this._docMove);ALKMaps.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){ALKMaps.Element.removeClass(document.body,"olDragDown");this.documentEvents=!1;ALKMaps.Event.stopObserving(document,"mousemove",this._docMove);ALKMaps.Event.stopObserving(document,
"mouseup",this._docUp)},CLASS_NAME:"ALKMaps.Handler.Drag"});ALKMaps.Handler.RegularPolygon=ALKMaps.Class(ALKMaps.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,b,c){if(!c||!c.layerOptions||!c.layerOptions.styleMap)this.style=ALKMaps.Util.extend(ALKMaps.Feature.Vector.style["default"],{});ALKMaps.Handler.Drag.prototype.initialize.apply(this,[a,b,c]);this.options=c?c:{}},setOptions:function(a){ALKMaps.Util.extend(this.options,
a);ALKMaps.Util.extend(this,a)},activate:function(){var a=!1;if(ALKMaps.Handler.Drag.prototype.activate.apply(this,arguments))a=ALKMaps.Util.extend({displayInLayerSwitcher:!1,calculateInRange:ALKMaps.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions),this.layer=new ALKMaps.Layer.Vector(this.CLASS_NAME,a),this.map.addLayer(this.layer),a=!0;return a},deactivate:function(){var a=!1;if(ALKMaps.Handler.Drag.prototype.deactivate.apply(this,arguments))this.dragging&&this.cancel(),null!=this.layer.map&&
(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.feature=this.layer=null,a=!0;return a},down:function(a){this.fixedRadius=!!this.radius;a=this.layer.getLonLatFromViewPortPx(a.xy);this.origin=new ALKMaps.Geometry.Point(a.lon,a.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&&this.clear();this.feature=new ALKMaps.Feature.Vector;this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],
{silent:!0});this.layer.drawFeature(this.feature,this.style)},move:function(a){var b=this.layer.getLonLatFromViewPortPx(a.xy),b=new ALKMaps.Geometry.Point(b.lon,b.lat);this.irregular?(a=Math.sqrt(2)*Math.abs(b.y-this.origin.y)/2,this.radius=Math.max(this.map.getResolution()/2,a)):this.fixedRadius?this.origin=b:(this.calculateAngle(b,a),this.radius=Math.max(this.map.getResolution()/2,b.distanceTo(this.origin)));this.modifyGeometry();this.irregular&&(a=b.x-this.origin.x,b=b.y-this.origin.y,this.feature.geometry.resize(1,
this.origin,0==b?a/(this.radius*Math.sqrt(2)):a/b),this.feature.geometry.move(a/2,b/2));this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();this.start==this.last&&this.callback("done",[a.xy])},out:function(){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-0.5);this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180));this.feature.geometry=ALKMaps.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var a,
b,c=this.feature.geometry.components[0];c.components.length!=this.sides+1&&(this.createGeometry(),c=this.feature.geometry.components[0]);for(var d=0;d<this.sides;++d)b=c.components[d],a=this.angle+2*d*Math.PI/this.sides,b.x=this.origin.x+this.radius*Math.cos(a),b.y=this.origin.y+this.radius*Math.sin(a),b.clearBounds()},calculateAngle:function(a,b){var c=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&!b[this.snapToggle]){var d=Math.PI/180*this.snapAngle;this.angle=
Math.round(c/d)*d}else this.angle=c},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){this.layer&&(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(a){this.callbacks[a]&&this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]);!this.persist&&("done"==a||"cancel"==a)&&this.clear()},CLASS_NAME:"ALKMaps.Handler.RegularPolygon"});ALKMaps.Handler.Feature=ALKMaps.Class(ALKMaps.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},rightclick:{"in":"rightclick",out:"rightclickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,touch:!1,clickTolerance:4,geometryTypes:null,featureAttributesFilter:null,stopClick:!0,stopDown:!0,stopUp:!1,alwaysTrigger:!1,initialize:function(a,
b,c,d){ALKMaps.Handler.prototype.initialize.apply(this,[a,c,d]);this.layer=b},touchstart:function(a){if(!this.touch)this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,rightclick:this.rightclick,scope:this});return ALKMaps.Event.isMultiTouch(a)?!0:this.mousedown(a)},touchmove:function(a){ALKMaps.Event.stop(a)},mousedown:function(a){if(ALKMaps.Event.isLeftClick(a)||ALKMaps.Event.isSingleTouch(a))this.down=
a.xy;return this.handle(a)?!this.stopDown:!0},mouseup:function(a){this.up=a.xy;return!0===(this.control.handleRightClicks&&ALKMaps.Event.isRightClick(a)?this.rightclick(a):this.handle(a))?!this.stopUp:!0},click:function(a){return this.handle(a)?!this.stopClick:!0},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out)return!0;this.handle(a);return!0},dblclick:function(a){if(window.getSelection)try{window.getSelection().removeAllRanges()}catch(b){}else document.selection&&document.selection.empty();
return this.handle(a)?!this.stopClick:!0},rightclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){var b=null==this.geometryTypes||-1<ALKMaps.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME);null!=a.attributes&&!0===a.attributes.isArrow&&(b=!1);if(!0===b&&null!=this.featureAttributesFilter&&this.featureAttributesFilter instanceof Array){for(var c=!1,d=0;d<this.featureAttributesFilter.length;d++){var e=this.featureAttributesFilter[d];if(null!=e.property&&a.attributes[e.property]===
e.value){c=!0;break}}b=b&&c}return b},handle:function(a){if(this.feature&&!this.feature.layer)this.feature=null;var b=a.type,c=!1,d=!!this.feature,e="mouseup"===b&&this.control.handleRightClicks&&ALKMaps.Event.isRightClick(a),f="click"==b||"dblclick"==b||"touchstart"==b;if((this.feature=this.layer.getFeatureFromEvent(a))&&!this.feature.layer)this.feature=null;if(this.lastFeature&&!this.lastFeature.layer)this.lastFeature=null;this.feature?("touchstart"===b&&ALKMaps.Event.stop(a),a=this.feature!=this.lastFeature,
this.geometryTypeMatches(this.feature)?(d&&a?(this.lastFeature&&this.triggerCallback(b,"out",[this.lastFeature]),this.triggerCallback(b,"in",[this.feature])):!d||f?this.triggerCallback(b,"in",[this.feature]):!0===e&&this.triggerCallback("rightclick","in",[this.feature]),this.lastFeature=this.feature,c=!0):(this.lastFeature&&(d&&a||f)?this.triggerCallback(b,"out",[this.lastFeature]):this.lastFeature&&!0===e&&this.triggerCallback("rightclick","out",[this.lastFeature]),this.feature=null)):this.lastFeature&&
(d||f)?this.triggerCallback(b,"out",[this.lastFeature]):this.lastFeature&&!0===e&&this.triggerCallback("rightclick","out",[this.lastFeature]);return c},triggerCallback:function(a,b,c){(b=this.EVENTMAP[a][b])&&("click"==a&&this.up&&this.down?Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))<=this.clickTolerance&&this.callback(b,c):this.callback(b,c))},activate:function(){var a=!1;ALKMaps.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,
changelayer:this.handleMapEvents,scope:this}),a=!0);return a},deactivate:function(){var a=!1;if(ALKMaps.Handler.prototype.deactivate.apply(this,arguments))this.moveLayerBack(),this.up=this.down=this.lastFeature=this.feature=null,this.touch=!1,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0;return a},handleMapEvents:function(a){("removelayer"==a.type||"order"==a.property)&&this.moveLayerToTop()},moveLayerToTop:function(){this.layer.setZIndex(Math.max(this.map.Z_INDEX_BASE.Feature-
1,this.layer.getZIndex())+1)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},register:function(a,b){!0===this.alwaysTrigger?(this.map.events.register(a,this,b,{always:!0}),this.map.events.register(a,this,this.setEvent,{always:!0})):ALKMaps.Handler.prototype.register.apply(this,[a,b])},CLASS_NAME:"ALKMaps.Handler.Feature"});ALKMaps.StyleMap=ALKMaps.Class({styles:null,extendDefault:!0,initialize:function(a,b){this.styles={"default":new ALKMaps.Style(ALKMaps.Feature.Vector.style["default"]),select:new ALKMaps.Style(ALKMaps.Feature.Vector.style.select),temporary:new ALKMaps.Style(ALKMaps.Feature.Vector.style.temporary),"delete":new ALKMaps.Style(ALKMaps.Feature.Vector.style["delete"])};if(a instanceof ALKMaps.Style)this.styles["default"]=a,this.styles.select=a,this.styles.temporary=a,this.styles["delete"]=a;else if("object"==
typeof a)for(var c in a)if(a[c]instanceof ALKMaps.Style)this.styles[c]=a[c];else if("object"==typeof a[c])this.styles[c]=new ALKMaps.Style(a[c]);else{this.styles["default"]=new ALKMaps.Style(a);this.styles.select=new ALKMaps.Style(a);this.styles.temporary=new ALKMaps.Style(a);this.styles["delete"]=new ALKMaps.Style(a);break}ALKMaps.Util.extend(this,b)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a,b){a||(a=new ALKMaps.Feature.Vector);
this.styles[b]||(b="default");a.renderIntent=b;var c={};this.extendDefault&&"default"!=b&&(c=this.styles["default"].createSymbolizer(a));return ALKMaps.Util.extend(c,this.styles[b].createSymbolizer(a))},addUniqueValueRules:function(a,b,c,d){var e=[],f;for(f in c)e.push(new ALKMaps.Rule({symbolizer:c[f],context:d,filter:new ALKMaps.Filter.Comparison({type:ALKMaps.Filter.Comparison.EQUAL_TO,property:b,value:f})}));this.styles[a].addRules(e)},CLASS_NAME:"ALKMaps.StyleMap"});ALKMaps.Layer.Vector=ALKMaps.Class(ALKMaps.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,arrowLookup:null,initialize:function(a,b){ALKMaps.Layer.prototype.initialize.apply(this,arguments);(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||
!this.renderer.supported())this.renderer=null,this.displayError();if(!this.styleMap)this.styleMap=new ALKMaps.StyleMap;this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies)for(var c=0,d=this.strategies.length;c<d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoDestroy&&a.destroy();this.strategies=null}if(this.protocol)this.protocol.autoDestroy&&this.protocol.destroy(),
this.protocol=null;this.destroyFeatures();this.arrowLookup=this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&&this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;this.events.unregister("moveend",this,this._updateVectorArrows);ALKMaps.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new ALKMaps.Layer.Vector(this.name,this.getOptions()));for(var a=ALKMaps.Layer.prototype.clone.apply(this,[a]),b=this.features,c=b.length,d=Array(c),
e=0;e<c;++e)d[e]=b[e].clone();a.features=d;return a},refresh:function(a){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,b=this.renderers.length;a<b;a++){var c=this.renderers[a];if((c="function"==typeof c?c:ALKMaps.Renderer[c])&&c.prototype.supported()){this.renderer=new c(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&ALKMaps.Console.userError(ALKMaps.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},
setMap:function(a){ALKMaps.Layer.prototype.setMap.apply(this,arguments);if(this.renderer){this.renderer.map=this.map;var b=this.map.getSize();b.w*=this.ratio;b.h*=this.ratio;this.renderer.setSize(b)}else this.map.removeLayer(this);this.events.register("moveend",this,this._updateVectorArrows)},afterAdd:function(){if(this.strategies){var a,b,c;for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.activate()}},removeMap:function(){this.drawn=!1;if(this.strategies){var a,b,c;
for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.deactivate()}},onMapResize:function(){ALKMaps.Layer.prototype.onMapResize.apply(this,arguments);var a=this.map.getSize();a.w*=this.ratio;a.h*=this.ratio;this.renderer.setSize(a)},moveTo:function(a,b,c){ALKMaps.Layer.prototype.moveTo.apply(this,arguments);var d=!0;if(b&&null!=this.arrowLookup)for(var e=0;e<this.arrowLookup.length;e++)this.removeFeatures(this.arrowLookup[e].arrows),this.arrowLookup[e].arrows=[];if(!c){this.renderer.root.style.visibility=
"hidden";e=this.map.getSize();d=e.w;e=e.h;d=d/2*this.ratio-d/2;e=e/2*this.ratio-e/2;d+=parseInt(this.map.layerContainerDiv.style.left,10);d=-Math.round(d);e+=parseInt(this.map.layerContainerDiv.style.top,10);e=-Math.round(e);this.div.style.left=d+"px";this.div.style.top=e+"px";d=this.renderer.setExtent(this.map.getExtent().scale(this.ratio),b);this.renderer.root.style.visibility="visible";if(!0===ALKMaps.IS_GECKO)this.div.scrollLeft=this.div.scrollLeft;if(!b&&d)for(var f in this.unrenderedFeatures)e=
this.unrenderedFeatures[f],this.drawFeature(e)}if(!this.drawn||b||!d){this.drawn=!0;f=0;for(d=this.features.length;f<d;f++)this.renderer.locked=f!==d-1,e=this.features[f],this.drawFeature(e)}},display:function(a){ALKMaps.Layer.prototype.display.apply(this,arguments);var b=this.div.style.display;if(b!=this.renderer.root.style.display)this.renderer.root.style.display=b},addFeatures:function(a,b){ALKMaps.Util.isArray(a)||(a=[a]);var c=!b||!b.silent;if(c){var d={features:a};if(!1===this.events.triggerEvent("beforefeaturesadded",
d))return;a=d.features}if(null==this.arrowLookup)this.arrowLookup=[];for(var d=[],e=0,f=a.length;e<f;e++){this.renderer.locked=e!=a.length-1?!0:!1;var g=a[e];if(this.geometryType&&!(g.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);g.layer=this;if(!g.style&&this.style)g.style=ALKMaps.Util.extend({},this.style);if(c){if(!1===this.events.triggerEvent("beforefeatureadded",{feature:g}))continue;this.preFeatureInsert(g)}d.push(g);
this.features.push(g);this.drawFeature(g);c&&(this.events.triggerEvent("featureadded",{feature:g}),this.onFeatureInsert(g))}c&&this.events.triggerEvent("featuresadded",{features:d})},removeFeatures:function(a,b){if(a&&0!==a.length){if(a===this.features)return this.removeAllFeatures(b);ALKMaps.Util.isArray(a)||(a=[a]);a===this.selectedFeatures&&(a=a.slice());var c=!b||!b.silent;c&&this.events.triggerEvent("beforefeaturesremoved",{features:a});for(var d=a.length-1;0<=d;d--){this.renderer.locked=0!=
d&&a[d-1].geometry?!0:!1;var e=a[d];delete this.unrenderedFeatures[e.id];c&&this.events.triggerEvent("beforefeatureremoved",{feature:e});this.features=ALKMaps.Util.removeItem(this.features,e);e.layer=null;e.geometry&&this.renderer.eraseFeatures(e);-1!=ALKMaps.Util.indexOf(this.selectedFeatures,e)&&ALKMaps.Util.removeItem(this.selectedFeatures,e);var f=this.getFeatureArrows(e);null!=f&&(-1!=ALKMaps.Util.indexOf(this.arrowLookup,f)&&ALKMaps.Util.removeItem(this.arrowLookup,f),0<f.arrows.length&&this.removeFeatures(f.arrows));
c&&this.events.triggerEvent("featureremoved",{feature:e})}c&&this.events.triggerEvent("featuresremoved",{features:a})}},removeAllFeatures:function(a){var a=!a||!a.silent,b=this.features;a&&this.events.triggerEvent("beforefeaturesremoved",{features:b});for(var c,d=b.length-1;0<=d;d--)c=b[d],a&&this.events.triggerEvent("beforefeatureremoved",{feature:c}),c.layer=null,a&&this.events.triggerEvent("featureremoved",{feature:c});this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=
[];this.arrowLookup=[];a&&this.events.triggerEvent("featuresremoved",{features:b})},destroyFeatures:function(a,b){if(void 0==a)a=this.features;if(a){this.removeFeatures(a,b);for(var c=a.length-1;0<=c;c--)a[c].destroy()}},drawFeature:function(a,b){if(this.drawn){if("object"!=typeof b){!b&&a.state===ALKMaps.State.DELETE&&(b="delete");var c=b||a.renderIntent;(b=a.style||this.style)||(b=this.styleMap.createSymbolizer(a,c))}c=this.renderer.drawFeature(a,b);if(a.geometry instanceof ALKMaps.Geometry.Point&&
null!=a.attributes&&null!=a.attributes.svg){var d=a.attributes.svg,e=document.getElementById(a.geometry.id);if(null!=e){var f=ALKMaps.Util.createDiv(null,null,null,null,"relative"),g=d.content;0!==g.indexOf("<svg")&&(g="<svg>"+g+"</svg>");f.innerHTML=g;var f=f.childNodes[0],g=parseFloat(e.getAttribute("cx")),h=parseFloat(e.getAttribute("cy"));e.parentNode.replaceChild(f,e);var i=d.size instanceof ALKMaps.Size?d.size.w:f.getBBox().width||30,j=d.size instanceof ALKMaps.Size?d.size.h:f.getBBox().height||
30,k=d.offset instanceof ALKMaps.Pixel?d.offset.x:i/2,d=d.offset instanceof ALKMaps.Pixel?d.offset.y:j/2;f.setAttributeNS(null,"id",a.geometry.id);f.setAttributeNS(null,"x",g-k);f.setAttributeNS(null,"y",h-d);f.setAttributeNS(null,"width",i);f.setAttributeNS(null,"height",j);f._featureId=e._featureId;f._boundsBottom=a.geometry.getBounds().bottom;f._geometryClass=a.geometry.CLASS_NAME;f._style=e._style;f._options=e._options}}e=this.getFeatureArrows(a);if(null==e&&(a.geometry instanceof ALKMaps.Geometry.LineString||
a.geometry instanceof ALKMaps.Geometry.MultiLineString)){if(null==a.attributes.routeId&&("line"===b.arrows||"end"===b.arrows))e={id:a.id,arrows:[]},this.arrowLookup.push(e),this.drawVectorArrows(e)}else null!=e&&this.drawVectorArrows(e);!1===c||null===c?this.unrenderedFeatures[a.id]=a:delete this.unrenderedFeatures[a.id]}},eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");
var b=null;(a=this.renderer.getFeatureIdFromEvent(a))&&(b="string"===typeof a?this.getFeatureById(a):a);return b},getFeatureBy:function(a,b){for(var c=null,d=0,e=this.features.length;d<e;++d)if(this.features[d][a]==b){c=this.features[d];break}return c},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},getFeaturesByAttribute:function(a,b){var c,d,e=this.features.length,f=[];for(c=0;c<e;c++)(d=this.features[c])&&d.attributes&&
d.attributes[a]===b&&f.push(d);return f},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var a=null,b=this.features;if(b&&0<b.length)for(var c=null,d=0,e=b.length;d<e;d++)if(c=b[d].geometry)null===a&&(a=new ALKMaps.Bounds),a.extend(c.getBounds());return a},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,d=b.length;c<d;++c){var e=b[c].firstChild||b[c],f=b[c].lastChild;f&&"iframe"===f.nodeName.toLowerCase()?e=f.parentNode:
"defs"===e.nodeName.toLowerCase()&&f&&"g"===f.nodeName.toLowerCase()&&(e=f);ALKMaps.Util.modifyDOMElement(e,null,null,null,null,null,null,a)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},drawVectorArrows:function(a){if(null!=a.arrows&&0<a.arrows.length)this.removeFeatures(a.arrows),a.arrows=[];var b=this.getFeatureById(a.id),c=b.style||{};if(null!=c.arrows){var d=[];if(null!=b.geometry)if(b.geometry instanceof ALKMaps.Geometry.LineString)d=[b.geometry];
else if(b.geometry instanceof ALKMaps.Geometry.MultiLineString)d=b.geometry.components;for(var e=0,b=c.arrowSpacing||ALKMaps.Feature.Vector.style["default"].arrowSpacing,f,g,h=[],i=this.map.baseLayer.getExtent(),j=0;j<d.length;j++){var k=d[j];if("line"===c.arrows)for(var m=null,l=null,p=1;p<k.components.length;p++){f=k.components[p-1];var n=k.components[p];f=new ALKMaps.LonLat(f.x,f.y);n=new ALKMaps.LonLat(n.x,n.y);null!=m&&(f=m.clone(),m=null);null!=l&&(n=l.clone());var q=this.map.getViewPortPxFromLonLat(f),
o=this.map.getViewPortPxFromLonLat(n);if(i.containsLonLat(f)&&i.containsLonLat(n)){f=o.x-q.x;g=o.y-q.y;var r=Math.sqrt(f*f+g*g),e=e+r;e>=b?(n=n.clone(),100!==Math.floor(e)&&(m=r-(e-b),e=(o.y-q.y)/(o.x-q.x),m=0<o.x-q.x?q.x+m/Math.sqrt(1+e*e):q.x-m/Math.sqrt(1+e*e),n=this.map.getLonLatFromViewPortPx(new ALKMaps.Pixel(m,e*(m-q.x)+q.y)),m=n.clone(),p--),e=0,f=Math.atan2(g,f),f*=180/Math.PI,f+=90,n=this.createVectorArrow(new ALKMaps.Geometry.Point(n.lon,n.lat),c,f,a.id),h.push(n)):null!=l&&(l=null)}else if(q=
i.toGeometry(),g=new ALKMaps.Geometry.LineString([new ALKMaps.Geometry.Point(f.lon,f.lat),new ALKMaps.Geometry.Point(n.lon,n.lat)]),q.intersects(g)){for(var o=q.getVertices(),t,q=[],r={x1:f.lon,y1:f.lat,x2:n.lon,y2:n.lat},s=0;s<o.length;s++)t=s<o.length-1?{x1:o[s].x,y1:o[s].y,x2:o[s+1].x,y2:o[s+1].y}:{x1:o[s].x,y1:o[s].y,x2:o[0].x,y2:o[0].y},t=ALKMaps.Geometry.segmentsIntersect(r,t,{point:!0,tolerance:0}),null!=t&&t instanceof ALKMaps.Geometry.Point&&q.push(t);2===q.length?(l=g.components[0].distanceTo(q[0]),
m=g.components[0].distanceTo(q[1]),l<=m?(m=new ALKMaps.LonLat(q[0].x,q[0].y),l=new ALKMaps.LonLat(q[1].x,q[1].y)):(m=new ALKMaps.LonLat(q[1].x,q[1].y),l=new ALKMaps.LonLat(q[0].x,q[0].y)),p--):1===q.length&&(i.containsLonLat(n)?(m=new ALKMaps.LonLat(q[0].x,q[0].y),p--):i.containsLonLat(f)&&(l=new ALKMaps.LonLat(q[0].x,q[0].y),p--))}}else"end"===c.arrows&&(p=d[d.length-1],k=p.components[p.components.length-1],l=p.components[p.components.length-2],p=new ALKMaps.LonLat(k.x,k.y),l=new ALKMaps.LonLat(l.x,
l.y),p=this.map.getViewPortPxFromLonLat(p),l=this.map.getViewPortPxFromLonLat(l),f=p.x-l.x,g=p.y-l.y,f=Math.atan2(g,f),f*=180/Math.PI,f+=90,k=this.createVectorArrow(k,c,f,a.id),h.push(k))}if(0<h.length)this.addFeatures(h),a.arrows=h}},createVectorArrow:function(a,b,c,d){var e=null;if(null!=b.arrows){var f=b.strokeWidth||ALKMaps.Feature.Vector.style["default"].strokeWidth,g=b.arrowSize||ALKMaps.Feature.Vector.style["default"].arrowSize,e={arrows:b.arrows,arrowGraphicName:b.arrowGraphicName||ALKMaps.Feature.Vector.style["default"].arrowGraphicName,
arrowRotation:c,arrowStrokeColor:b.arrowStrokeColor,arrowStrokeWidth:b.arrowStrokeWidth,arrowStrokeOpacity:b.arrowStrokeOpacity,arrowFillOpacity:b.arrowFillOpacity,arrowFillColor:b.arrowFillColor};if(null!=g)"string"===typeof g&&(b=g.indexOf("%"),-1<b?(null==f&&(f=this.map.getZoom()),f/=1.75,g=parseInt(g.substring(0,b)),g=f*(g/100)):g=parseInt(g)),e.arrowSize=g;e=ALKMaps.Util.applyDefaults(e,ALKMaps.Feature.Vector.style["default"])}a=new ALKMaps.Feature.Vector(a,null,e);a.attributes.geomId=d;a.attributes.rotation=
c;a.attributes.isArrow=!0;return a},getFeatureArrows:function(a){var b=null,a=a.id;if(null!=this.arrowLookup)for(var c=0;c<this.arrowLookup.length;c++)this.arrowLookup[c].id===a&&(b=this.arrowLookup[c]);return b},_updateVectorArrows:function(){if(null!=this.arrowLookup)for(var a=0;a<this.arrowLookup.length;a++)this.drawVectorArrows(this.arrowLookup[a])},CLASS_NAME:"ALKMaps.Layer.Vector"});ALKMaps.Layer.Vector.RootContainer=ALKMaps.Class(ALKMaps.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(a){for(var b=this.layers,c,d=0;d<b.length;d++)if(c=b[d].getFeatureFromEvent(a))return c},setMap:function(a){ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer);this.resetRoots();
ALKMaps.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var a,b=0;b<this.map.layers.length;++b)a=this.map.layers[b],-1!=ALKMaps.Util.indexOf(this.layers,a)&&a.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var a,b=0;b<this.layers.length;++b)a=this.layers[b],this.renderer&&a.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(a.renderer)},handleChangeLayer:function(a){var b=a.layer;"order"==a.property&&-1!=ALKMaps.Util.indexOf(this.layers,b)&&
(this.resetRoots(),this.collectRoots())},CLASS_NAME:"ALKMaps.Layer.Vector.RootContainer"});ALKMaps.Control.DragFeatureData=ALKMaps.Class(ALKMaps.Control,{geometryTypes:null,onStart:function(){},onDrag:function(){},onComplete:function(){},onEnter:function(){},overTarget:function(){},outTarget:function(){},onDrop:function(){},documentDrag:!1,layer:null,layers:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,[b]);this.initLayer(a);this.handlers={drag:new ALKMaps.Handler.Drag(this,ALKMaps.Util.extend({down:this.downFeature,
move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new ALKMaps.Handler.Feature(this,this.layer,ALKMaps.Util.extend({over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},initLayer:function(a){ALKMaps.Util.isArray(a)?(this.layers=a,this.layer=new ALKMaps.Layer.Vector.RootContainer(this.id+"_container",{layers:a})):this.layer=a},destroy:function(){this.active&&
this.layers&&this.map.removeLayer(this.layer);ALKMaps.Control.prototype.destroy.apply(this,[]);this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate());return ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)this.handlers.drag.deactivate(),this.handlers.feature.deactivate(),this.feature=this.target=null,this.dragging=!1,this.lastPixel=null,ALKMaps.Element.removeClass(this.map.viewPortDiv,
this.displayClass+"Over"),this.layers&&this.map.removeLayer(this.layer);return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){var b=!1;if(null==a)return b;this.over=!0;if(this.handlers.drag.dragging)this.target=a,this.overTarget(this.feature,a,this.lastPixel);else{if(!0===this.onEnter(a))this.handlers.feature.stopDown=!0;else{this.handlers.feature.stopDown=!1;return}this.feature=a;this.handlers.drag.activate();b=!0}return b},downFeature:function(a){this.lastPixel=
a;ALKMaps.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over");this.onStart(this.feature,a)},moveFeature:function(a){this.lastPixel=a||this.lastPixel;this.onDrag(this.feature,a)},upFeature:function(a){if(!0===this.over)if(null==this.target)this.onDrop(this.feature,this.feature,a);else if(this.feature.id===this.target.id)this.onDrop(this.feature,this.feature,a);else this.handlers.drag.deactivate(),this.onDrop(this.feature,this.target,a);else this.handlers.drag.deactivate(),this.onDrop(this.feature,
null,a);this.target=null;ALKMaps.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over")},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){this.over=!1;this.target=null;if(!this.handlers.drag.dragging)this.feature=null,this.handlers.drag.deactivate();this.outTarget(this.feature,a,this.lastPixel)},cancel:function(){this.over=!1;this.feature=this.target=null;this.handlers.drag.deactivate();ALKMaps.Element.removeClass(this.map.viewPortDiv,this.displayClass+
"Over")},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);ALKMaps.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.deactivate();if(this.layers)this.layer.destroy(),this.layers=null;this.initLayer(a);this.handlers.feature.layer=this.layer;b&&this.activate()},CLASS_NAME:"ALKMaps.Control.DragFeatureData"});ALKMaps.Filter.FeatureId=ALKMaps.Class(ALKMaps.Filter,{fids:null,type:"FID",initialize:function(a){this.fids=[];ALKMaps.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var b=0,c=this.fids.length;b<c;b++)if((a.fid||a.id)==this.fids[b])return!0;return!1},clone:function(){var a=new ALKMaps.Filter.FeatureId;ALKMaps.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"ALKMaps.Filter.FeatureId"});ALKMaps.Popup=ALKMaps.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){if("number"==typeof this.padding)this.padding=new ALKMaps.Bounds(this.padding,this.padding,this.padding,this.padding)},panMapIfOutOfView:!1,keepInMap:!1,
closeOnMove:!1,map:null,initialize:function(a,b,c,d,e,f){null==a&&(a=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=b;this.contentSize=null!=c?c:new ALKMaps.Size(ALKMaps.Popup.WIDTH,ALKMaps.Popup.HEIGHT);if(null!=d)this.contentHTML=d;this.backgroundColor=ALKMaps.Popup.COLOR;this.opacity=ALKMaps.Popup.OPACITY;this.border=ALKMaps.Popup.BORDER;this.div=ALKMaps.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;this.groupDiv=ALKMaps.Util.createDiv(this.id+
"_GroupDiv",null,null,null,"relative",null,"hidden");a=this.div.id+"_contentDiv";this.contentDiv=ALKMaps.Util.createDiv(a,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);e&&this.addCloseBox(f);this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id=null;this.closeOnMove&&this.map&&this.map.events.unregister("movestart",
this,this.hide);this.events.destroy();this.events=null;this.closeDiv&&(ALKMaps.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv));this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;null!=this.map&&this.map.removePopup(this);this.panMapIfOutOfView=this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},draw:function(a){null==a&&null!=this.lonlat&&null!=this.map&&(a=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&&
this.map.events.register("movestart",this,this.hide);!this.disableFirefoxOverflowHack&&"firefox"==ALKMaps.BROWSER_NAME&&(this.map.events.register("movestart",this,function(){var a=document.defaultView.getComputedStyle(this.contentDiv,null).getPropertyValue("overflow");if("hidden"!=a)this.contentDiv._oldOverflow=a,this.contentDiv.style.overflow="hidden"}),this.map.events.register("moveend",this,function(){var a=this.contentDiv._oldOverflow;if(a)this.contentDiv.style.overflow=a,this.contentDiv._oldOverflow=
null}));this.moveTo(a);!this.autoSize&&!this.size&&this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();this.panMapIfOutOfView&&this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&&this.moveTo(a)}},moveTo:function(a){if(null!=a&&null!=this.div)this.div.style.left=a.x+"px",this.div.style.top=a.y+"px"},visible:function(){return ALKMaps.Element.visible(this.div)},
toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="";this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(a){this.size=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),c=c+(e+b.right);this.size.w+=c;this.size.h+=d;
"msie"==ALKMaps.BROWSER_NAME&&null!=this.contentSize&&(this.contentSize.w+=b.left+b.right,this.contentSize.h+=b.bottom+b.top);if(null!=this.div)this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px";if(null!=this.contentDiv)this.contentDiv.style.width=a.w+"px",this.contentDiv.style.height=a.h+"px"},updateSize:function(){var a="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",b=this.map?this.map.div:document.body,c=ALKMaps.Util.getRenderedDimensions(a,
null,{displayClass:this.displayClass,containerElement:b}),d=this.getSafeContentSize(c),e=null;d.equals(c)?e=c:(c={w:d.w<c.w?d.w:null,h:d.h<c.h?d.h:null},c.w&&c.h?e=d:(a=ALKMaps.Util.getRenderedDimensions(a,c,{displayClass:this.contentDisplayClass,containerElement:b}),"hidden"!=ALKMaps.Element.getStyle(this.contentDiv,"overflow")&&a.equals(d)&&(d=ALKMaps.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=this.getSafeContentSize(a)));this.setSize(e)},setBackgroundColor:function(a){if(void 0!=a)this.backgroundColor=
a;if(null!=this.div)this.div.style.backgroundColor=this.backgroundColor},setOpacity:function(a){if(void 0!=a)this.opacity=a;if(null!=this.div)this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")"},setBorder:function(a){if(void 0!=a)this.border=a;if(null!=this.div)this.div.style.border=this.border},setContentHTML:function(a){if(null!=a)this.contentHTML=a;if(null!=this.contentDiv&&null!=this.contentHTML&&this.contentHTML!=this.contentDiv.innerHTML)this.contentDiv.innerHTML=
this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize())},registerImageListeners:function(){for(var a=function(){null!==this.popup.id&&(this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),ALKMaps.Event.stopObserving(this.img,"load",this.img._onImageLoad))},b=this.contentDiv.getElementsByTagName("img"),c=0,d=b.length;c<d;c++){var e=b[c];if(0==e.width||0==e.height)e._onImgLoad=ALKMaps.Function.bind(a,{popup:this,img:e}),ALKMaps.Event.observe(e,
"load",e._onImgLoad)}},getSafeContentSize:function(a){var a=a.clone(),b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),c=c+(e+b.right);if(this.minSize)a.w=Math.max(a.w,this.minSize.w-c),a.h=Math.max(a.h,this.minSize.h-d);if(this.maxSize)a.w=Math.min(a.w,this.maxSize.w-c),a.h=Math.min(a.h,this.maxSize.h-d);if(this.map&&this.map.size){e=
b=0;if(this.keepInMap&&!this.panMapIfOutOfView)switch(e=this.map.getPixelFromLonLat(this.lonlat),this.relativePosition){case "tr":b=e.x;e=this.map.size.h-e.y;break;case "tl":b=this.map.size.w-e.x;e=this.map.size.h-e.y;break;case "bl":b=this.map.size.w-e.x;e=e.y;break;case "br":b=e.x;e=e.y;break;default:b=e.x,e=this.map.size.h-e.y}d=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-d-e;a.w=Math.min(a.w,this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-
c-b);a.h=Math.min(a.h,d)}return a},getContentDivPadding:function(){var a=this._contentDivPadding;if(!a){if(null==this.div.parentNode)this.div.style.display="none",document.body.appendChild(this.div);this._contentDivPadding=a=new ALKMaps.Bounds(ALKMaps.Element.getStyle(this.contentDiv,"padding-left"),ALKMaps.Element.getStyle(this.contentDiv,"padding-bottom"),ALKMaps.Element.getStyle(this.contentDiv,"padding-right"),ALKMaps.Element.getStyle(this.contentDiv,"padding-top"));if(this.div.parentNode==document.body)document.body.removeChild(this.div),
this.div.style.display=""}return a},addCloseBox:function(a){this.closeDiv=ALKMaps.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+"px";this.closeDiv.style.top=b.top+"px";this.groupDiv.appendChild(this.closeDiv);a=a||function(a){this.hide();ALKMaps.Event.stop(a)};ALKMaps.Event.observe(this.closeDiv,"touchend",ALKMaps.Function.bindAsEventListener(a,this));ALKMaps.Event.observe(this.closeDiv,
"click",ALKMaps.Function.bindAsEventListener(a,this))},panIntoView:function(){var a=this.map.getSize(),b=this.map.getViewPortPxFromLayerPx(new ALKMaps.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),c=b.clone();if(b.x<this.map.paddingForPopups.left)c.x=this.map.paddingForPopups.left;else if(b.x+this.size.w>a.w-this.map.paddingForPopups.right)c.x=a.w-this.map.paddingForPopups.right-this.size.w;if(b.y<this.map.paddingForPopups.top)c.y=this.map.paddingForPopups.top;else if(b.y+this.size.h>
a.h-this.map.paddingForPopups.bottom)c.y=a.h-this.map.paddingForPopups.bottom-this.size.h;this.map.pan(b.x-c.x,b.y-c.y)},registerEvents:function(){this.events=new ALKMaps.Events(this,this.div,null,!0);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:function(a){ALKMaps.Event.stop(a,!0)},scope:this})},onmousedown:function(a){this.mousedown=!0;ALKMaps.Event.stop(a,!0)},onmousemove:function(a){this.mousedown&&
ALKMaps.Event.stop(a,!0)},onmouseup:function(a){if(this.mousedown)this.mousedown=!1,ALKMaps.Event.stop(a,!0)},onclick:function(a){ALKMaps.Event.stop(a,!0)},onmouseout:function(){this.mousedown=!1},ondblclick:function(a){ALKMaps.Event.stop(a,!0)},CLASS_NAME:"ALKMaps.Popup"});ALKMaps.Popup.WIDTH=200;ALKMaps.Popup.HEIGHT=200;ALKMaps.Popup.COLOR="white";ALKMaps.Popup.OPACITY=1;ALKMaps.Popup.BORDER="0px";ALKMaps.Popup.Anchored=ALKMaps.Class(ALKMaps.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(a,b,c,d,e,f,g){ALKMaps.Popup.prototype.initialize.apply(this,[a,b,c,d,f,g]);this.anchor=null!=e?e:{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(0,0)}},destroy:function(){this.relativePosition=this.anchor=null;ALKMaps.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();ALKMaps.Popup.prototype.show.apply(this,arguments)},moveTo:function(a){var b=
this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);a=this.calculateNewPx(a);ALKMaps.Popup.prototype.moveTo.apply(this,Array(a));this.relativePosition!=b&&this.updateRelativePosition()},setSize:function(a){ALKMaps.Popup.prototype.setSize.apply(this,arguments);this.lonlat&&this.map&&this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))},calculateRelativePosition:function(a){a=this.map.getLonLatFromLayerPx(a);a=this.map.getExtent().determineQuadrant(a);return ALKMaps.Bounds.oppositeQuadrant(a)},
updateRelativePosition:function(){},calculateNewPx:function(a){var a=a.offset(this.anchor.offset),b=this.size||this.contentSize,c="t"==this.relativePosition.charAt(0);a.y+=c?-b.h:this.anchor.size.h;c="l"==this.relativePosition.charAt(1);a.x+=c?-b.w:this.anchor.size.w;return a},CLASS_NAME:"ALKMaps.Popup.Anchored"});ALKMaps.Popup.AnchoredBubble=ALKMaps.Class(ALKMaps.Popup.Anchored,{rounded:!1,initialize:function(a,b,c,d,e,f,g){this.padding=new ALKMaps.Bounds(0,ALKMaps.Popup.AnchoredBubble.CORNER_SIZE,0,ALKMaps.Popup.AnchoredBubble.CORNER_SIZE);ALKMaps.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(a){ALKMaps.Popup.Anchored.prototype.draw.apply(this,arguments);this.setContentHTML();this.setBackgroundColor();this.setOpacity();return this.div},updateRelativePosition:function(){},setSize:function(a){ALKMaps.Popup.Anchored.prototype.setSize.apply(this,
arguments)},setBackgroundColor:function(a){if(void 0!=a)this.backgroundColor=a;if(null!=this.div&&null!=this.contentDiv)this.div.style.background="transparent"},setOpacity:function(a){ALKMaps.Popup.Anchored.prototype.setOpacity.call(this,a)},setBorder:function(){this.border=0},CLASS_NAME:"ALKMaps.Popup.AnchoredBubble"});ALKMaps.Popup.AnchoredBubble.CORNER_SIZE=5;ALKMaps.Renderer.Canvas=ALKMaps.Class(ALKMaps.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(a,b){ALKMaps.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};if(this.hitDetection)this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d")},setExtent:function(){ALKMaps.Renderer.prototype.setExtent.apply(this,
arguments);return!1},eraseGeometry:function(a,b){this.eraseFeatures(this.features[b][0])},supported:function(){return ALKMaps.CANVAS_SUPPORTED},setSize:function(a){this.size=a.clone();var b=this.root;b.style.width=a.w+"px";b.style.height=a.h+"px";b.width=a.w;b.height=a.h;this.resolution=null;if(this.hitDetection)b=this.hitCanvas,b.style.width=a.w+"px",b.style.height=a.h+"px",b.width=a.w,b.height=a.h},drawFeature:function(a,b){var c;if(a.geometry){b=this.applyDefaultSymbolizer(b||a.style);c=a.geometry.getBounds();
var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());d=c&&c.intersectsBounds(this.extent,{worldBounds:d});(c="none"!==b.display&&!!c&&d)?this.features[a.id]=[a,b]:delete this.features[a.id];this.pendingRedraw=!0}if(this.pendingRedraw&&!this.locked)this.redraw(),this.pendingRedraw=!1;return c},drawGeometry:function(a,b,c){var d=a.CLASS_NAME;if("ALKMaps.Geometry.Collection"==d||"ALKMaps.Geometry.MultiPoint"==d||"ALKMaps.Geometry.MultiLineString"==d||"ALKMaps.Geometry.MultiPolygon"==
d)for(d=0;d<a.components.length;d++)this.drawGeometry(a.components[d],b,c);else switch(a.CLASS_NAME){case "ALKMaps.Geometry.Point":this.drawPoint(a,b,c);break;case "ALKMaps.Geometry.LineString":this.drawLineString(a,b,c);break;case "ALKMaps.Geometry.LinearRing":this.drawLinearRing(a,b,c);break;case "ALKMaps.Geometry.Polygon":this.drawPolygon(a,b,c)}},drawExternalGraphic:function(a,b,c){var d=new Image;if(b.graphicTitle)d.title=b.graphicTitle;var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||
b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f),i=b.graphicOpacity||b.fillOpacity;d.onload=ALKMaps.Function.bind(function(){if(this.features[c]){var b=this.getLocalXY(a),k=b[0],b=b[1];if(!isNaN(k)&&!isNaN(b)){var k=k+g|0,b=b+h|0,m=this.canvas;m.globalAlpha=i;var l=ALKMaps.Renderer.Canvas.drawImageScaleFactor||(ALKMaps.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?
320/window.screen.width:1);m.drawImage(d,k*l,b*l,e*l,f*l);this.hitDetection&&(this.setHitContextStyle("fill",c),this.hitContext.fillRect(k,b,e,f))}}},this);d.src=b.externalGraphic},drawNamedSymbol:function(a,b,c){var d,e,f,g;f=Math.PI/180;var h=ALKMaps.Renderer.symbol[b.graphicName];if(!h)throw Error(b.graphicName+" is not a valid symbol name");if(h.length&&!(2>h.length)&&(a=this.getLocalXY(a),e=a[0],g=a[1],!isNaN(e)&&!isNaN(g))){this.canvas.lineCap="round";this.canvas.lineJoin="round";if(this.hitDetection)this.hitContext.lineCap=
"round",this.hitContext.lineJoin="round";if(b.graphicName in this.cachedSymbolBounds)d=this.cachedSymbolBounds[b.graphicName];else{d=new ALKMaps.Bounds;for(a=0;a<h.length;a+=2)d.extend(new ALKMaps.LonLat(h[a],h[a+1]));this.cachedSymbolBounds[b.graphicName]=d}this.canvas.save();this.hitDetection&&this.hitContext.save();this.canvas.translate(e,g);this.hitDetection&&this.hitContext.translate(e,g);a=f*b.rotation;isNaN(a)||(this.canvas.rotate(a),this.hitDetection&&this.hitContext.rotate(a));f=2*b.pointRadius/
Math.max(d.getWidth(),d.getHeight());this.canvas.scale(f,f);this.hitDetection&&this.hitContext.scale(f,f);a=d.getCenterLonLat().lon;d=d.getCenterLonLat().lat;this.canvas.translate(-a,-d);this.hitDetection&&this.hitContext.translate(-a,-d);g=b.strokeWidth;b.strokeWidth=g/f;if(!1!==b.fill){this.setCanvasStyle("fill",b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",
c,b);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.fill()}}if(!1!==b.stroke){this.setCanvasStyle("stroke",b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",c,b,f);this.hitContext.beginPath();for(a=0;a<h.length;a+=
2)d=h[a],e=h[a+1],0==a&&this.hitContext.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.stroke()}}b.strokeWidth=g;this.canvas.restore();this.hitDetection&&this.hitContext.restore();this.setCanvasStyle("reset")}},setCanvasStyle:function(a,b){"fill"===a?(this.canvas.globalAlpha=b.fillOpacity,this.canvas.fillStyle=b.fillColor):"stroke"===a?(this.canvas.globalAlpha=b.strokeOpacity,this.canvas.strokeStyle=b.strokeColor,this.canvas.lineWidth=b.strokeWidth):(this.canvas.globalAlpha=
0,this.canvas.lineWidth=1)},featureIdToHex:function(a){a=Number(a.split("_").pop())+1;if(16777216<=a)this.hitOverflow=a-16777215,a=a%16777216+1;var a="000000"+a.toString(16),b=a.length;return a="#"+a.substring(b-6,b)},setHitContextStyle:function(a,b,c,d){b=this.featureIdToHex(b);if("fill"==a)this.hitContext.globalAlpha=1,this.hitContext.fillStyle=b;else if("stroke"==a)if(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=b,"undefined"===typeof d)this.hitContext.lineWidth=c.strokeWidth+2;else{if(!isNaN(d))this.hitContext.lineWidth=
c.strokeWidth+2/d}else this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1},drawPoint:function(a,b,c){if(!1!==b.graphic)if(b.externalGraphic)this.drawExternalGraphic(a,b,c);else if(b.graphicName&&"circle"!=b.graphicName)this.drawNamedSymbol(a,b,c);else{var d=this.getLocalXY(a),a=d[0],d=d[1];if(!isNaN(a)&&!isNaN(d)){var e=2*Math.PI,f=b.pointRadius;!1!==b.fill&&(this.setCanvasStyle("fill",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",
c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.fill()));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(a,b,c){b=ALKMaps.Util.applyDefaults({fill:!1},b);this.drawLinearRing(a,b,c)},drawLinearRing:function(a,
b,c){!1!==b.fill&&(this.setCanvasStyle("fill",b),this.renderPath(this.canvas,a,b,c,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.renderPath(this.hitContext,a,b,c,"fill")));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.renderPath(this.canvas,a,b,c,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",c,b),this.renderPath(this.hitContext,a,b,c,"stroke")));this.setCanvasStyle("reset")},renderPath:function(a,b,c,d,e){b=b.components;c=b.length;a.beginPath();var d=
this.getLocalXY(b[0]),f=d[1];if(!isNaN(d[0])&&!isNaN(f)){a.moveTo(d[0],d[1]);for(d=1;d<c;++d)f=this.getLocalXY(b[d]),a.lineTo(f[0],f[1]);"fill"===e?a.fill():a.stroke()}},drawPolygon:function(a,b,c){var a=a.components,d=a.length;this.drawLinearRing(a[0],b,c);for(var e=1;e<d;++e){this.canvas.globalCompositeOperation="destination-out";if(this.hitDetection)this.hitContext.globalCompositeOperation="destination-out";this.drawLinearRing(a[e],ALKMaps.Util.applyDefaults({stroke:!1,fillOpacity:1},b),c);this.canvas.globalCompositeOperation=
"source-over";if(this.hitDetection)this.hitContext.globalCompositeOperation="source-over";this.drawLinearRing(a[e],ALKMaps.Util.applyDefaults({fill:!1},b),c)}},drawText:function(a,b){var c=this.getLocalXY(a);this.setCanvasStyle("reset");this.canvas.fillStyle=b.fontColor;this.canvas.globalAlpha=b.fontOpacity||1;var d=[b.fontStyle?b.fontStyle:"normal","normal",b.fontWeight?b.fontWeight:"normal",b.fontSize?b.fontSize:"1em",b.fontFamily?b.fontFamily:"sans-serif"].join(" "),e=b.label.split("\n"),f=e.length;
if(this.canvas.fillText){this.canvas.font=d;this.canvas.textAlign=ALKMaps.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[0]]||"center";this.canvas.textBaseline=ALKMaps.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[1]]||"middle";var g=ALKMaps.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];null==g&&(g=-0.5);d=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;c[1]+=d*g*(f-1);for(g=0;g<f;g++){if(b.labelOutlineWidth)this.canvas.save(),this.canvas.strokeStyle=b.labelOutlineColor,this.canvas.lineWidth=
b.labelOutlineWidth,this.canvas.strokeText(e[g],c[0],c[1]+d*g+1),this.canvas.restore();this.canvas.fillText(e[g],c[0],c[1]+d*g)}}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=d;var h=ALKMaps.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[0]];null==h&&(h=-0.5);g=ALKMaps.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];null==g&&(g=-0.5);d=this.canvas.mozMeasureText("xx");c[1]+=d*(1+g*f);for(g=0;g<f;g++){var i=c[0]+h*this.canvas.mozMeasureText(e[g]),j=c[1]+g*d;this.canvas.translate(i,j);this.canvas.mozDrawText(e[g]);
this.canvas.translate(-i,-j)}}this.setCanvasStyle("reset")},getLocalXY:function(a){var b=this.getResolution(),c=this.extent;return[(a.x-this.featureDx)/b+-c.left/b,c.top/b-a.y/b]},clear:function(){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,0,b,a);this.features={};this.hitDetection&&this.hitContext.clearRect(0,0,b,a)},getFeatureIdFromEvent:function(a){var b;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging&&(a=a.xy,a=this.hitContext.getImageData(a.x|0,
a.y|0,1,1).data,255===a[3]&&(a=a[2]+256*(a[1]+256*a[0])))){a="ALKMaps.Feature.Vector_"+(a-1+this.hitOverflow);try{b=this.features[a][0]}catch(c){}}return b},eraseFeatures:function(a){ALKMaps.Util.isArray(a)||(a=[a]);for(var b=0;b<a.length;++b)delete this.features[a[b].id];this.redraw()},redraw:function(){if(!this.locked){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,0,b,a);this.hitDetection&&this.hitContext.clearRect(0,0,b,a);var a=[],c,d,e=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&
this.map.getMaxExtent(),f;for(f in this.features)if(this.features.hasOwnProperty(f))b=this.features[f][0],c=b.geometry,this.calculateFeatureDx(c.getBounds(),e),d=this.features[f][1],this.drawGeometry(c,d,b.id),d.label&&a.push([b,d]);b=0;for(c=a.length;b<c;++b)f=a[b],this.drawText(f[0].geometry.getCentroid(),f[1])}},CLASS_NAME:"ALKMaps.Renderer.Canvas"});ALKMaps.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};ALKMaps.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};
ALKMaps.Renderer.Canvas.drawImageScaleFactor=null;ALKMaps.Control.HeatMapLegend=ALKMaps.Class(ALKMaps.Control,{headerTag:"h3",headerTitleText:"",headerTitleElement:null,imageLegendElement:null,minValueElement:null,maxValueElement:null,header:null,body:null,layerId:null,visible:!0,draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.header)this.header=document.createElement("div"),this.header.className=this.displayClass+"-header",this.div.appendChild(this.header),this.headerTitleElement=document.createElement(this.headerTag),
this.headerTitleElement.className="olTitle",this.headerTitleElement.innerHTML=this.headerTitleText,this.header.appendChild(this.headerTitleElement);if(!this.body)this.body=document.createElement("div"),this.body.className=this.displayClass+"-body",this.div.appendChild(this.body),this.drawItems();this.map.events.register("moveend",this,this.updateScale);this.updateScale();this.changeVisibility(!0);return this.div},drawItems:function(){this.minValueElement=document.createElement("span");this.maxValueElement=
document.createElement("span");this.imageLegendElement=document.createElement("img");this.minValueElement.className="olMinValue";this.maxValueElement.className="olMaxValue";this.imageLegendElement.className="olImageLegend";this.body.appendChild(this.minValueElement);this.body.appendChild(this.maxValueElement);this.body.appendChild(this.imageLegendElement)},updateScale:function(){},updateHeaderTitle:function(a){this.headerTitleText=a;this.headerTitleElement.innerHTML(a)},updateMinMax:function(a,b){this.minValueElement.innerHTML=
a;this.maxValueElement.innerHTML=b;0===b?this.changeVisibility(!1):this.changeVisibility(!0)},updateLegendGradient:function(a){var b=document.createElement("canvas");b.width=100;b.height=10;for(var c=b.getContext("2d"),d=c.createLinearGradient(0,0,100,1),e=0;e<a.length;e++)d.addColorStop(a[e][0],a[e][1]);c.fillStyle=d;c.fillRect(0,0,100,10);this.imageLegendElement.src=b.toDataURL()},changeVisibility:function(a){this.div.style.visibility="hidden";if(!0===this.visible&&!0===a)this.div.style.visibility=
""},CLASS_NAME:"ALKMaps.Control.HeatMapLegend"});ALKMaps.Layer.HeatMap=ALKMaps.Class(ALKMaps.Layer.Vector,{DEFAULT_GRADIENT:[[0.1,"#5cbb43"],[0.9,"#eddd2e"],[0.99,"#e2b11d"],[1,"#d11515"]],points:[],pointRadius:10,opacity:0.7,colorGradient:null,renderers:["Canvas"],legendDisplayClass:null,legendControl:null,externalDivForLegend:null,pointTemplates:{},initialize:function(a,b){ALKMaps.Layer.Vector.prototype.initialize.apply(this,[a,b]);b=b||{};this.points=b.points||this.points;this.pointRadius=b.pointRadius||this.pointRadius;this.colorGradient=b.colorGradient||
this.DEFAULT_GRADIENT;this.opacity=b.opacity||this.opacity;this.shadowCanvas=document.createElement("canvas");this.shadowCanvas.style.cssText="position:absolute;left:0;top:0;";this.shadowCtx=this.shadowCanvas.getContext("2d");this.renderBoundaries=[1E4,1E4,0,0];var c=!0===b.legendControlVisible?!0:!1;this.legendControl=null!=this.legendDisplayClass?new ALKMaps.Control.HeatMapLegend({displayClass:this.legendDisplayClass,div:this.externalDivForLegend,visible:c}):new ALKMaps.Control.HeatMapLegend({div:this.externalDivForLegend,
visible:c});this.legendControl.layerId=this.id},setMap:function(a){ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments);var b=this.map.getSize();this.width=b.w;this.height=b.h;this.map.events.register("moveend",this,this._onMove);this.shadowCanvas.width=this.width;this.shadowCanvas.height=this.height;this.map.addControl(this.legendControl);this.draw();this.legendControl.updateLegendGradient(this.colorGradient)},destroy:function(){this.shadowCanvas=null;this.map.events.unregister("moveend",
this,this._onMove);ALKMaps.Layer.Vector.prototype.destroy.apply(this,arguments)},draw:function(){this.renderer.root.width=this.width;this.renderer.root.height=this.height;this.renderer.colorMap=this.getColorMap();this.shadowCtx.clearRect(0,0,this.width,this.height);this.renderer.canvas.clearRect(0,0,this.width,this.height);0<this.points.length?(0<this.createIntensityMask()[1]&&this.colorizeIntensityMask(),this.redraw()):this.legendControl.changeVisibility(!1)},createIntensityMask:function(){for(var a=
this.map.getExtent(),b={},c=0;c<this.points.length;c++)if(a.containsLonLat(this.points[c])){var d=this.map.getViewPortPxFromLonLat(this.points[c]),e=Math.floor(d.x),f=Math.floor(d.y),d=e+f*this.width;b[d]=b[d]?b[d]+1:1}a=0;c=Number.POSITIVE_INFINITY;for(d in b)a=Math.max(b[d],a),c=Math.min(b[d],c);0===a&&(c=0);this.legendControl.updateMinMax(c,a);var g=this.pointRadius,h=this.getColorGradientMinAlpha();for(d in b){var e=Math.floor(d%this.width),f=Math.floor(d/this.width),e=e-g,f=f-g,i=this.getPointTemplate(g),
j=h;0<a-c&&(j=(b[d]-c)/(a-c));this.shadowCtx.globalAlpha=j<h?h:j;this.shadowCtx.drawImage(i,e,f);e<this.renderBoundaries[0]&&(this.renderBoundaries[0]=e);f<this.renderBoundaries[1]&&(this.renderBoundaries[1]=f);e+2*g>this.renderBoundaries[2]&&(this.renderBoundaries[2]=e+2*g);f+2*g>this.renderBoundaries[3]&&(this.renderBoundaries[3]=f+2*g)}return[c,a]},getColorMap:function(){if(null!=this.colorMap)return this.colorMap;var a=document.createElement("canvas"),b=a.getContext("2d");a.width=256;a.height=
1;for(var a=b.createLinearGradient(0,0,256,1),c=0;c<this.colorGradient.length;c++)a.addColorStop(this.colorGradient[c][0],this.colorGradient[c][1]);b.fillStyle=a;b.fillRect(0,0,256,1);return this.colorMap=b.getImageData(0,0,256,1)},colorizeIntensityMask:function(){var a=this.renderBoundaries[0],b=this.renderBoundaries[1],c=this.renderBoundaries[2]-a,d=this.renderBoundaries[3]-b,e=this.width,f=this.height;0>a&&(a=0);0>b&&(b=0);a+c>e&&(c=e-a);b+d>f&&(d=f-b);for(var c=this.shadowCtx.getImageData(a,b,
c,d),d=c.data,e=d.length,f=this.getColorMap().data,g=3;g<e;g+=4){var h=4*d[g];if(h)d[g-3]=f[h],d[g-2]=f[h+1],d[g-1]=f[h+2],d[g]=255*this.opacity,this.renderBoundaries=[1E4,1E4,0,0]}this.renderer.canvas.putImageData(c,a,b)},setPoints:function(a){this.points=a;this.draw()},addPoints:function(a){this.points=this.points.concat(a);this.draw()},clearPoints:function(){this.points=[];this.draw()},updateOptions:function(a){a=a||{};if(null!=a.pointRadius)this.pointRadius=a.pointRadius;if(null!=a.opacity)this.opacity=
a.opacity;if(null!=a.colorGradient)this.colorGradient=a.colorGradient,this.colorMap=null;this.draw();this.legendControl.updateLegendGradient(this.colorGradient)},_onMove:function(){var a=this.map.getSize();this.width=a.w;this.height=a.h;this.draw()},getColorGradientMinAlpha:function(){for(var a=1,b=0;b<this.colorGradient.length;b++)a=Math.min(this.colorGradient[b][0],a);return a},getPointTemplate:function(a){if(null!=this.pointTemplates[a])return this.pointTemplates[a];var b=document.createElement("canvas"),
c=b.getContext("2d");b.width=b.height=2*a;var d=c.createRadialGradient(a,a,0,a,a,a);d.addColorStop(0,"rgba(0,0,0,1)");d.addColorStop(1,"rgba(0,0,0,0)");c.fillStyle=d;c.fillRect(0,0,2*a,2*a);return this.pointTemplates[a]=b},setVisibility:function(a){this.legendControl.changeVisibility(a);return ALKMaps.Layer.Vector.prototype.setVisibility.apply(this,arguments)},CLASS_NAME:"ALKMaps.Layer.HeatMap"});ALKMaps.Lang.ro={panup:"Mut\u0103 Sus",panleft:"Mut\u0103 St\u00e2nga",zoomworld:"Harta Lumii",panright:"Mut\u0103 Dreapta",pandown:"Mut\u0103 Jos",zoomin:"Apropiere",zoomout:"Dep\u0103rtare",dragme:"Trage",dragToChangeRoute:"Trage pentru a schimba ruta",drawPoints:"Trasare puncte",clkToSetPoints:"Face\u021bi clic pentru a seta punct linie. Dublu-clic pentru a termina.",dragToDrawLine:"Trage pentru a desena o linie neregulat\u0103.",dragToDrawEllipse:"Trage pentru a desena o elips\u0103.",dragToDrawRect:"Trage pentru a desena un dreptunghi.",
clkToSetPolygon:"Face\u021bi clic pentru a seta punctele unui poligon. Dublu-clic pentru a termina.",dragToDrawPolygon:"Trage pentru a desena un poligon neregulat.",clkShapeToResize:"Apas\u0103 o form\u0103 pentru a o redimensiona sau a o muta. Pozi\u021biona\u021bi cursor al\u0103turi de col\u021b pentru a roti.",clkShapeToModify:"Face\u021bi clic pe o form\u0103 pentru a modifica punctele acesteia. Cu cursorul pozi\u021bionat deasupra uni punct, folosi\u021bi tasta \u0218tergere pentru \u00eendep\u0103rtare.",
showShapeInfo:"Afi\u0219are caset\u0103 informa\u021bie form\u0103.",area:"Arie",length:"Lungime",nodes:"Noduri",perimeter:"Perimetru",location:"Loca\u021bie",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Rule=ALKMaps.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};ALKMaps.Util.extend(this,a);this.symbolizers&&delete this.symbolizer;this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null;delete this.symbolizers},evaluate:function(a){var b=
this.getContext(a),c=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var d=a.layer.map.getScale();this.minScaleDenominator&&(c=d>=ALKMaps.Style.createLiteral(this.minScaleDenominator,b));c&&this.maxScaleDenominator&&(c=d<ALKMaps.Style.createLiteral(this.maxScaleDenominator,b));c&&this.filter&&(c="ALKMaps.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(a):this.filter.evaluate(b));return c},getContext:function(a){var b=this.context;b||(b=a.attributes||a.data);"function"==typeof this.context&&
(b=this.context(a));return b},clone:function(){var a=ALKMaps.Util.extend({},this);if(this.symbolizers){var b=this.symbolizers.length;a.symbolizers=Array(b);for(var c=0;c<b;++c)a.symbolizers[c]=this.symbolizers[c].clone()}else{a.symbolizer={};for(var d in this.symbolizer)b=this.symbolizer[d],c=typeof b,"object"===c?a.symbolizer[d]=ALKMaps.Util.extend({},b):"string"===c&&(a.symbolizer[d]=b)}a.filter=this.filter&&this.filter.clone();a.context=this.context&&ALKMaps.Util.extend({},this.context);return new ALKMaps.Rule(a)},
CLASS_NAME:"ALKMaps.Rule"});ALKMaps.Symbolizer=ALKMaps.Class({zIndex:0,initialize:function(a){ALKMaps.Util.extend(this,a)},clone:function(){return new (eval(this.CLASS_NAME))(ALKMaps.Util.extend({},this))},CLASS_NAME:"ALKMaps.Symbolizer"});ALKMaps.Symbolizer.Point=ALKMaps.Class(ALKMaps.Symbolizer,{initialize:function(a){ALKMaps.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"ALKMaps.Symbolizer.Point"});ALKMaps.Symbolizer.Line=ALKMaps.Class(ALKMaps.Symbolizer,{initialize:function(a){ALKMaps.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"ALKMaps.Symbolizer.Line"});ALKMaps.Symbolizer.Polygon=ALKMaps.Class(ALKMaps.Symbolizer,{initialize:function(a){ALKMaps.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"ALKMaps.Symbolizer.Polygon"});ALKMaps.Symbolizer.Text=ALKMaps.Class(ALKMaps.Symbolizer,{initialize:function(a){ALKMaps.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"ALKMaps.Symbolizer.Text"});ALKMaps.Symbolizer.Raster=ALKMaps.Class(ALKMaps.Symbolizer,{initialize:function(a){ALKMaps.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"ALKMaps.Symbolizer.Raster"});ALKMaps.Style2=ALKMaps.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(a){ALKMaps.Util.extend(this,a);this.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy();delete this.rules},clone:function(){var a=ALKMaps.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}return new ALKMaps.Style2(a)},
CLASS_NAME:"ALKMaps.Style2"});(function(a){if(a){a.ALKMaps.Util=ALKMaps.Util;var b=a.ALKMaps.Util;b.showLoading=function(){};b.hideLoading=function(){};b.showMapLoadingIcon=function(){};b.VirtualTile=a.Class.extend({options:{detailLevel:16,cacheInterval:3},_virtualTileArray:[],initialize:function(b){a.setOptions(this,b);this._virtualTileArray=[]},_virtualTile:function(a,b,e){return{qKey:a,timeStamp:b,data:e}},expireVirtualTiles:function(){var a=6E4*this.options.cacheInterval,b=(new Date).getTime();if(0!==this._virtualTileArray.length)for(var e=
0;e<this._virtualTileArray.length;e++)if(null!=this._virtualTileArray[e].timeStamp&&b-this._virtualTileArray[e].timeStamp>a)this._virtualTileArray[e].timeStamp=null},updateVirtualTile:function(a,b){for(var e=this._virtualTileArray.length-1;0<=e;e--)a===this._virtualTileArray[e].qkey&&this._virtualTileArray.splice(e,1);e=(new Date).getTime();this._virtualTileArray.push(this._virtualTile(a,e,b))},getCachedVirtualTile:function(a){for(var b=0;b<this._virtualTileArray.length;b++)if(null!=this._virtualTileArray[b].timeStamp&&
a===this._virtualTileArray[b].qKey)return this._virtualTileArray[b]},getExpiredVirtualTile:function(a){for(var b=0;b<this._virtualTileArray.length;b++)if(null==this._virtualTileArray[b].timeStamp&&a===this._virtualTileArray[b].qKey)return this._virtualTileArray[b]},_getVisitedQkeys:function(){for(var a=[],b=0;b<this._virtualTileArray.length;b++)null!=this._virtualTileArray[b].timeStamp&&a.push(this._virtualTileArray[b].qKey);return a},getCachedTileQkeys:function(a){var b=this._getVisitedQkeys();return a.filter(function(a){return 0<=
b.indexOf(a)})},getVirtualBounds:function(c){for(var d=[],e=this._getVisitedQkeys(),c=c.filter(function(a){return 0>e.indexOf(a)}),f=0;f<c.length;f++){var g=c[f],h=b.quadKeyToTileXYZ(g),i=b.getTileBounds(h),h=a.latLng(i.top,i.left),i=a.latLng(i.bottom,i.right),h=a.latLngBounds(h,i);d.push({qKey:g,bounds:h})}return d},CLASS_NAME:"ALKMaps.Util.VirtualTile"});b.virtualTile=function(a){return new b.VirtualTile(a)}}})("undefined"===typeof L?null:L);ALKMaps.Renderer.VML=ALKMaps.Class(ALKMaps.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var b=document.createStyleSheet(),c="shape,rect,oval,fill,stroke,imagedata,group,textbox".split(","),d=0,e=c.length;d<e;d++)b.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}ALKMaps.Renderer.Elements.prototype.initialize.apply(this,
arguments)}},supported:function(){return!!document.namespaces},setExtent:function(a,b){var c=ALKMaps.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=a.left/d|0,d=a.top/d-this.size.h|0;b||!this.offset?(this.offset={x:e,y:d},d=e=0):(e-=this.offset.x,d-=this.offset.y);this.root.coordorigin=e-this.xOffset+" "+d;for(var e=[this.root,this.vectorRoot,this.textRoot],f=0,g=e.length;f<g;++f)d=e[f],d.coordsize=this.size.w+" "+this.size.h;this.root.style.flip="y";return c},
setSize:function(a){ALKMaps.Renderer.prototype.setSize.apply(this,arguments);for(var b=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],c=this.size.w+"px",d=this.size.h+"px",e,f=0,g=b.length;f<g;++f)e=b[f],e.style.width=c,e.style.height=d},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "ALKMaps.Geometry.Point":c=b.externalGraphic?"olv:rect":this.isComplexSymbol(b.graphicName)?"olv:shape":"olv:oval";break;case "ALKMaps.Geometry.Rectangle":c="olv:rect";break;case "ALKMaps.Geometry.LineString":case "ALKMaps.Geometry.LinearRing":case "ALKMaps.Geometry.Polygon":case "ALKMaps.Geometry.Curve":c=
"olv:shape"}return c},setStyle:function(a,b,c,d){var b=b||a._style,c=c||a._options,e=b.fillColor;if("ALKMaps.Geometry.Point"===a._geometryClass)if(b.externalGraphic){c.isFilled=!0;if(b.graphicTitle)a.title=b.graphicTitle;var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=this.getResolution(),h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),i=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f);a.style.left=((d.x-this.featureDx)/
g-this.offset.x+h|0)+"px";a.style.top=(d.y/g-this.offset.y-(i+f)|0)+"px";a.style.width=e+"px";a.style.height=f+"px";a.style.flip="y";a.style.display="";if(!1===b.graphic)a.style.display="none";e="none";c.isStroked=!1}else this.isComplexSymbol(b.graphicName)?(f=this.importSymbol(b.graphicName),a.path=f.path,a.coordorigin=f.left+","+f.bottom,f=f.size,a.coordsize=f+","+f,this.drawCircle(a,d,b.pointRadius),a.style.flip="y"):this.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=e:a.filled="false";
d=a.getElementsByTagName("fill");d=0==d.length?null:d[0];if(c.isFilled){d||(d=this.createNode("olv:fill",a.id+"_fill"));d.opacity=b.fillOpacity;if("ALKMaps.Geometry.Point"===a._geometryClass&&b.externalGraphic){if(b.graphicOpacity)d.opacity=b.graphicOpacity;d.src=b.externalGraphic;d.type="frame";if(!b.graphicWidth||!b.graphicHeight)d.aspect="atmost"}d.parentNode!=a&&a.appendChild(d)}else d&&a.removeChild(d);e=b.rotation;if(void 0!==e||void 0!==a._rotation)if(a._rotation=e,b.externalGraphic)this.graphicRotate(a,
h,i,b),d.opacity=0;else if("ALKMaps.Geometry.Point"===a._geometryClass)a.style.rotation=e||0;h=a.getElementsByTagName("stroke");h=0==h.length?null:h[0];if(c.isStroked){if(h||(h=this.createNode("olv:stroke",a.id+"_stroke"),a.appendChild(h)),h.on=!0,h.color=b.strokeColor,h.weight=b.strokeWidth+"px",h.opacity=b.strokeOpacity,h.endcap="butt"==b.strokeLinecap?"flat":b.strokeLinecap||"round",b.strokeDashstyle)h.dashstyle=this.dashStyle(b)}else if(a.stroked=!1,h)h.on=!1;if("inherit"!=b.cursor&&null!=b.cursor)a.style.cursor=
b.cursor;return a},graphicRotate:function(a,b,c,d){var d=d||a._style,e=d.rotation||0,f,g;if(!d.graphicWidth||!d.graphicHeight){var h=new Image;h.onreadystatechange=ALKMaps.Function.bind(function(){if("complete"==h.readyState||"interactive"==h.readyState)f=h.width/h.height,g=Math.max(2*d.pointRadius,d.graphicWidth||0,d.graphicHeight||0),b*=f,d.graphicWidth=g*f,d.graphicHeight=g,this.graphicRotate(a,b,c,d)},this);h.src=d.externalGraphic}else{g=Math.max(d.graphicWidth,d.graphicHeight);f=d.graphicWidth/
d.graphicHeight;var i=Math.round(d.graphicWidth||g*f),j=Math.round(d.graphicHeight||g);a.style.width=i+"px";a.style.height=j+"px";var k=document.getElementById(a.id+"_image");k||(k=this.createNode("olv:imagedata",a.id+"_image"),a.appendChild(k));k.style.width=i+"px";k.style.height=j+"px";k.src=d.externalGraphic;k.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";k=e*Math.PI/180;e=Math.sin(k);k=Math.cos(k);e="progid:DXImageTransform.Microsoft.Matrix(M11="+
k+",M12="+-e+",M21="+e+",M22="+k+",SizingMethod='auto expand')\n";(k=d.graphicOpacity||d.fillOpacity)&&1!=k&&(e+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+k+")\n");a.style.filter=e;e=new ALKMaps.Geometry.Point(-b,-c);i=(new ALKMaps.Bounds(0,0,i,j)).toGeometry();i.rotate(d.rotation,e);i=i.getBounds();a.style.left=Math.round(parseInt(a.style.left)+i.left)+"px";a.style.top=Math.round(parseInt(a.style.top)-i.bottom)+"px"}},postDraw:function(a){a.style.visibility="visible";var b=a._style.fillColor,
c=a._style.strokeColor;if("none"==b&&a.fillcolor!=b)a.fillcolor=b;if("none"==c&&a.strokecolor!=c)a.strokecolor=c},setNodeDimension:function(a,b){var c=b.getBounds();if(c){var d=this.getResolution(),c=new ALKMaps.Bounds((c.left-this.featureDx)/d-this.offset.x|0,c.bottom/d-this.offset.y|0,(c.right-this.featureDx)/d-this.offset.x|0,c.top/d-this.offset.y|0);a.style.left=c.left+"px";a.style.top=c.top+"px";a.style.width=c.getWidth()+"px";a.style.height=c.getHeight()+"px";a.coordorigin=c.left+" "+c.top;
a.coordsize=c.getWidth()+" "+c.getHeight()}},dashStyle:function(a){a=a.strokeDashstyle;switch(a){case "solid":case "dot":case "dash":case "dashdot":case "longdash":case "longdashdot":return a;default:return a=a.split(/[ ,]/),2==a.length?1*a[0]>=2*a[1]?"longdash":1==a[0]||1==a[1]?"dot":"dash":4==a.length?1*a[0]>=2*a[1]?"longdashdot":"dashdot":"solid"}},createNode:function(a,b){var c=document.createElement(a);if(b)c.id=b;c.unselectable="on";c.onselectstart=ALKMaps.Function.False;return c},nodeTypeCompare:function(a,
b){var c=b,d=c.indexOf(":");-1!=d&&(c=c.substr(d+1));var e=a.nodeName,d=e.indexOf(":");-1!=d&&(e=e.substr(d+1));return c==e},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){if(!isNaN(b.x)&&!isNaN(b.y)){var d=this.getResolution();a.style.left=((b.x-this.featureDx)/d-this.offset.x|0)-c+"px";a.style.top=
(b.y/d-this.offset.y|0)-c+"px";b=2*c;a.style.width=b+"px";a.style.height=b+"px";return a}return!1},drawLineString:function(a,b){return this.drawLine(a,b,!1)},drawLinearRing:function(a,b){return this.drawLine(a,b,!0)},drawLine:function(a,b,c){this.setNodeDimension(a,b);for(var d=this.getResolution(),e=b.components.length,f=Array(e),g,h,i=0;i<e;i++)g=b.components[i],h=(g.x-this.featureDx)/d-this.offset.x|0,g=g.y/d-this.offset.y|0,f[i]=" "+h+","+g+" l ";a.path="m"+f.join("")+(c?" x e":" e");return a},
drawPolygon:function(a,b){this.setNodeDimension(a,b);var c=this.getResolution(),d=[],e,f,g,h,i,j,k,m,l,p;for(e=0,f=b.components.length;e<f;e++){d.push("m");g=b.components[e].components;h=0===e;j=i=null;for(k=0,m=g.length;k<m;k++)l=g[k],p=(l.x-this.featureDx)/c-this.offset.x|0,l=l.y/c-this.offset.y|0,p=" "+p+","+l,d.push(p),0==k&&d.push(" l"),h||(i?i!=p&&(j?j!=p&&(h=!0):j=p):i=p);d.push(h?" x ":" ")}d.push("e");a.path=d.join("");return a},drawRectangle:function(a,b){var c=this.getResolution();a.style.left=
((b.x-this.featureDx)/c-this.offset.x|0)+"px";a.style.top=(b.y/c-this.offset.y|0)+"px";a.style.width=(b.width/c|0)+"px";a.style.height=(b.height/c|0)+"px";return a},drawText:function(a,b,c){var d=this.nodeFactory(a+this.LABEL_ID_SUFFIX,"olv:rect"),e=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),f=this.getResolution();d.style.left=((c.x-this.featureDx)/f-this.offset.x|0)+"px";d.style.top=(c.y/f-this.offset.y|0)+"px";d.style.flip="y";e.innerText=b.label;if("inherit"!=b.cursor&&null!=
b.cursor)e.style.cursor=b.cursor;if(b.fontColor)e.style.color=b.fontColor;if(b.fontOpacity)e.style.filter="alpha(opacity="+100*b.fontOpacity+")";if(b.fontFamily)e.style.fontFamily=b.fontFamily;if(b.fontSize)e.style.fontSize=b.fontSize;if(b.fontWeight)e.style.fontWeight=b.fontWeight;if(b.fontStyle)e.style.fontStyle=b.fontStyle;if(!0===b.labelSelect)d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME;e.style.whiteSpace="nowrap";e.inset="1px,0px,0px,0px";d.parentNode||(d.appendChild(e),
this.textRoot.appendChild(d));b=b.labelAlign||"cm";1==b.length&&(b+="m");a=e.clientWidth*ALKMaps.Renderer.VML.LABEL_SHIFT[b.substr(0,1)];e=e.clientHeight*ALKMaps.Renderer.VML.LABEL_SHIFT[b.substr(1,1)];d.style.left=parseInt(d.style.left)-a-1+"px";d.style.top=parseInt(d.style.top)+e+"px"},moveRoot:function(a){var b=this.map.getLayer(a.container.id);b instanceof ALKMaps.Layer.Vector.RootContainer&&(b=this.map.getLayer(this.container.id));b&&b.renderer.clear();ALKMaps.Renderer.Elements.prototype.moveRoot.apply(this,
arguments);b&&b.redraw()},importSymbol:function(a){var b=this.container.id+"-"+a,c=this.symbolCache[b];if(c)return c;c=ALKMaps.Renderer.symbol[a];if(!c)throw Error(a+" is not a valid symbol name");for(var a=new ALKMaps.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),d=["m"],e=0;e<c.length;e+=2){var f=c[e],g=c[e+1];a.left=Math.min(a.left,f);a.bottom=Math.min(a.bottom,g);a.right=Math.max(a.right,f);a.top=Math.max(a.top,g);d.push(f);d.push(g);0==e&&d.push("l")}d.push("x e");c=d.join(" ");d=(a.getWidth()-
a.getHeight())/2;0<d?(a.bottom-=d,a.top+=d):(a.left+=d,a.right-=d);c={path:c,size:a.getWidth(),left:a.left,bottom:a.bottom};return this.symbolCache[b]=c},CLASS_NAME:"ALKMaps.Renderer.VML"});ALKMaps.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};ALKMaps.Lang.es={unhandledRequest:"Respuesta a petici\u00f3n no gestionada ${statusText}",Permalink:"Enlace permanente",Overlays:"Capas superpuestas","Base Layer":"Capa Base",readNotImplemented:"Lectura no implementada.",writeNotImplemented:"Escritura no implementada.",noFID:"No se puede actualizar un elemento para el que no existe FID.",errorLoadingGML:"Error cargando el fichero GML ${url}",browserNotSupported:"Su navegador no soporta renderizaci\u00f3n vectorial. Los renderizadores soportados actualmente son:\n${renderers}",
componentShouldBe:"addFeatures : el componente debe ser del tipo ${geomType}",getFeatureError:"getFeatureFromEvent se ha llamado desde una capa sin renderizador. Esto normalmente quiere decir que se ha destruido una capa, pero no el manejador asociado a ella.",minZoomLevelError:"La propiedad minZoomLevel debe s\u00f3lo utilizarse con las capas que tienen FixedZoomLevels. El hecho de que una capa wfs compruebe minZoomLevel es una reliquia del pasado. Sin embargo, no podemos eliminarla sin discontinuar probablemente las aplicaciones OL que puedan depender de ello. As\u00ed pues estamos haci\u00e9ndolo obsoleto --la comprobaci\u00f3n minZoomLevel se eliminar\u00e1 en la versi\u00f3n 3.0. Utilice el ajuste de resolution min/max en su lugar, tal como se describe aqu\u00ed: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"Transacci\u00f3n WFS: \u00c9XITO ${response}",commitFailed:"Transacci\u00f3n WFS: FALL\u00d3 ${response}",googleWarning:"La capa Google no pudo ser cargada correctamente.<br><br>Para evitar este mensaje, seleccione una nueva Capa Base en el selector de capas en la esquina superior derecha.<br><br>Probablemente, esto se debe a que el script de la biblioteca de Google Maps no fue correctamente incluido en su p\u00e1gina, o no contiene la clave del API correcta para su sitio.<br><br>Desarrolladores: Para ayudar a hacer funcionar esto correctamente, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>haga clic aqu\u00ed</a>",
getLayerWarning:"La capa ${layerType} no pudo ser cargada correctamente.<br><br>Para evitar este mensaje, seleccione una nueva Capa Base en el selector de capas en la esquina superior derecha.<br><br>Probablemente, esto se debe a que el script de la biblioteca ${layerLib} no fue correctamente incluido en su p\u00e1gina.<br><br>Desarrolladores: Para ayudar a hacer funcionar esto correctamente, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>haga clic aqu\u00ed</a>","Scale = 1 : ${scaleDenom}":"Escala = 1 : ${scaleDenom}",
W:"O",E:"E",N:"N",S:"S",Graticule:"Ret\u00edcula",layerAlreadyAdded:"Intent\u00f3 a\u00f1adir la capa: ${layerName} al mapa, pero ya hab\u00eda sido a\u00f1adida previamente",reprojectDeprecated:"Est\u00e1 usando la opci\u00f3n 'reproject' en la capa ${layerName}. Esta opci\u00f3n es obsoleta: su uso fue dise\u00f1ado para soportar la visualizaci\u00f3n de datos sobre mapas base comerciales, pero ahora esa funcionalidad deber\u00eda conseguirse mediante el soporte de la proyecci\u00f3n Spherical Mercator. M\u00e1s informaci\u00f3n disponible en http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"Este m\u00e9todo es obsoleto y se eliminar\u00e1 en la versi\u00f3n 3.0. Por favor utilice el m\u00e9todo ${newMethod} en su lugar.",boundsAddError:"Debe proporcionar los valores x e y a la funci\u00f3n add.",lonlatAddError:"Debe proporcionar los valores lon y lat a la funci\u00f3n add.",pixelAddError:"Debe proporcionar los valores x e y a la funci\u00f3n add.",unsupportedGeometryType:"Tipo de geometr\u00eda no soportada: ${geomType}",filterEvaluateNotImplemented:"evaluate no est\u00e1 implementado para este tipo de filtro.",
end:"",panup:"Panoramizar hacia arriba",panleft:"Panoramizar a la izquierda",zoomworld:"Zoom mundo",panright:"Panoramizar a la derecha",pandown:"Panoramizar hacia abajo",zoomin:"Zoom para acercar",zoomout:"Zoom para alejar",dragme:"Arr\u00e1streme",dragToChangeRoute:"Arrastrar para cambiar ruta",drawPoints:"Dibujar puntos",clkToSetPoints:"Hacer clic para configurar puntos para una l\u00ednea. Hacer doble clic para terminar.",dragToDrawLine:"Arrastrar para dibujar una l\u00ednea a mano alzada.",dragToDrawEllipse:"Arrastrar para dibujar una elipse.",
dragToDrawRect:"Arrastrar para dibujar un rect\u00e1ngulo.",clkToSetPolygon:"Hacer clic para configurar puntos para un pol\u00edgono. Hacer doble clic para terminar.",dragToDrawPolygon:"Arrastrar para dibujar un pol\u00edgono a mano alzada.",clkShapeToResize:"Hacer clic en una forma para reajustar su tama\u00f1o o moverla. Posicionar el cursor cerca de una esquina para rotarla.",clkShapeToModify:"Hacer clic en una forma para modificar los puntos de la forma. Con el cursor sobre un punto, presione la tecla Eliminar para eliminar.",
showShapeInfo:"Mostrar cuadro de informaci\u00f3n de la forma.",area:"Area",length:"Longitud",nodes:"Nodes",perimeter:"Per\u00edmetro",location:"Ubicaci\u00f3n",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Layer.AvoidFavor=ALKMaps.Class(ALKMaps.Layer.Vector,{styleMap:new ALKMaps.StyleMap({"default":new ALKMaps.Style({strokeColor:"${strokeColor}",strokeWidth:"${strokeWidth}",strokeDashstyle:"longdash",strokeOpacity:0.8},{context:{strokeColor:function(a){return 1===a.attributes.afType?"#b30000":"#00b300"},strokeWidth:function(a){var a=a.layer.map.getZoom(),b=2;12<a&&(b=2);14<a&&(b=4);17<a&&(b=8);19<a&&(b=14);return b}}})}),frameAvoidFavor:!1,initialize:function(a,b){b=b||{};this.frameAvoidFavor=
b.frameAvoidFavor||this.frameAvoidFavor;ALKMaps.Layer.Vector.prototype.initialize.apply(this,arguments);if(null!=b.styleMap)this.styleMap=b.styleMap},setMap:function(a){this.projection=a.getProjectionObject();ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments)},_transformToGeoJson:function(a,b,c){return{type:"Feature",geometry:{coordinates:c.Geometries,type:"MultiLineString"},properties:{afId:c.AvoidFavorID,afType:c.AvoidFavorType,comment:c.Comment,extraInfo:c.ExtraInfo,setId:b,setName:a}}},
_transformToVector:function(a){return(new ALKMaps.Format.GeoJSON({externalProjection:new ALKMaps.Projection("EPSG:4326"),internalProjection:this.map.getProjectionObject()})).read(a)},_convertToFeatures:function(a){var b=[];if(a&&Array.isArray(a)){for(var c=0;c<a.length;c++)for(var d=a[c],e=d.SetID,f=d.Name,d=d.Links||d.GroupLinks,g=0;g<d.length;g++){var h=this._transformToVector(this._transformToGeoJson(f,e,d[g]));Array.isArray(h)?b=b.concat(h):b.push(h)}return b}},_filterFeatures:function(a,b){var c=
[];if(1===b||2===b)for(var d=0;d<a.length;d++){var e=a[d];e.attributes.afType===b&&c.push(e)}else c=a;return c},_zoomToExtent:function(a,b){for(var c=null,d=0;d<a.length;d++){var e=a[d].geometry.getBounds();null!=e&&(null==c?c=e.clone():c.extend(e))}!0===b&&null!==c&&this.map.zoomToExtent(c)},getAvoidFavorSets:function(a){var a=a||{},b=this;ALKMaps.Services.getAvoidFavorSets({detail:!1,success:function(c){null!=a.success&&"function"===typeof a.success&&a.success(c,b)},failure:function(c){null!=a.failure&&
"function"===typeof a.failure?a.failure(c,b):alert(c.status+"\n"+c.statusText+"\n "+c.responseText)}})},addAvoidFavorPolygonGroup:function(a){if(a&&a.afSetId){var b=a.afType,c=a.frameAvoidFavor||this.frameAvoidFavor,d=this;ALKMaps.Services.getAvoidFavorGroup({afSetId:a.afSetId,success:function(e){var e=d._convertToFeatures(e),e=d._filterFeatures(e,b),f=!0;null!=a.success&&"function"===typeof a.success&&(f=a.success(e,d));ALKMaps.Util.isArray(e)&&0<e.length&&!1!=f&&(d.addFeatures(e),d._zoomToExtent(e,
c))},failure:function(b){null!=a.failure&&"function"===typeof a.failure?a.failure(b,d):alert(b.status+"\n"+b.statusText+"\n "+b.responseText)}})}},addAvoidFavorPolygon:function(a){if(a&&a.afSetId){var b=a.afType,c=a.frameAvoidFavor||this.frameAvoidFavor,d=this;ALKMaps.Services.getAvoidFavorBox({bbox:a.bbox,afSetId:a.afSetId,success:function(e){var e=d._convertToFeatures(e),e=d._filterFeatures(e,b),f=!0;null!=a.success&&"function"===typeof a.success&&(f=a.success(e,d));0<e.length&&!1!=f&&(d.addFeatures(e),
d._zoomToExtent(e,c))},failure:function(b){null!=a.failure&&"function"===typeof a.failure?a.failure(b,d):alert(b.status+"\n"+b.statusText+"\n "+b.responseText)}})}},removeAvoidFavorPolygon:function(a){var b=!1,a=this.getFeatureById(a);null!=a&&a instanceof ALKMaps.Feature.Vector&&(this.removeFeatures([a],null),b=!0);return b},CLASS_NAME:"ALKMaps.Layer.AvoidFavor"});ALKMaps.Control.InfoWarning=ALKMaps.Class(ALKMaps.Control,{separator:", ",template:"${layers}",initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map.events.un({removelayer:this.updateInfoWarning,addlayer:this.updateInfoWarning,changelayer:this.updateInfoWarning,changebaselayer:this.updateInfoWarning,scope:this});ALKMaps.Control.prototype.destroy.apply(this,arguments)},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateInfoWarning,
changelayer:this.updateInfoWarning,addlayer:this.updateInfoWarning,removelayer:this.updateInfoWarning,scope:this});this.updateInfoWarning();return this.div},updateInfoWarning:function(){var a=[];if(this.map&&this.map.layers){for(var b=0,c=this.map.layers.length;b<c;b++){var d=this.map.layers[b];d.infoWarning&&d.getVisibility()&&-1===ALKMaps.Util.indexOf(a,d.infoWarning)&&a.push(d.infoWarning)}this.div.innerHTML=ALKMaps.String.format(this.template,{layers:a.join(this.separator)})}},CLASS_NAME:"ALKMaps.Control.InfoWarning"});ALKMaps.Lang.it={unhandledRequest:"Codice di ritorno della richiesta ${statusText}",Permalink:"Permalink",Overlays:"Overlays","Base Layer":"Livello base",readNotImplemented:"Lettura non implementata.",writeNotImplemented:"Scrittura non implementata.",noFID:"Impossibile aggiornare un elemento grafico che non abbia il FID.",errorLoadingGML:"Errore nel caricamento del file GML ${url}",browserNotSupported:"Il tuo browser non supporta il rendering vettoriale. I renderizzatore attualemnte supportati sono:\n${renderers}",
componentShouldBe:"addFeatures : il componente dovrebbe essere di tipo ${geomType}",getFeatureError:"getFeatureFromEvent chiamata su di un livello senza renderizzatore. Ci\u00f2 significa che il livello \u00e8 stato cancellato, ma non i gestori associati ad esso.",minZoomLevelError:"La propriet\u00e0 minZoomLevel \u00e8 da utilizzare solamente con livelli che abbiano FixedZoomLevels. Il fatto che questo livello wfs controlli la propriet\u00e0 minZoomLevel \u00e8 un retaggio del passato. Non possiamo comunque rimuoverla senza rompere le vecchie applicazioni che dipendono su di essa.Quindi siamo costretti a deprecarla -- minZoomLevel e sar\u00e0 rimossa dalla vesione 3.0. Si prega di utilizzare i settaggi di risoluzione min/max come descritto qui: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"Transazione WFS: SUCCESS ${response}",commitFailed:"Transazione WFS: FAILED ${response}",googleWarning:"Il livello Google non \u00e8 riuscito a caricare correttamente.<br><br>Per evitare questo messaggio, seleziona un nuovo BaseLayer nel selettore di livelli nell'angolo in alto a destra.<br><br>Pi\u00f9 precisamente, ci\u00f2 accade perch\u00e8 la libreria Google Maps non \u00e8 stata inclusa nella pagina, oppure non contiene la corretta API key per il tuo sito.<br><br>Sviluppatori: Per aiuto su come farlo funzionare correttamente, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>clicca qui</a>",
getLayerWarning:"Il livello ${layerType} non \u00e8 riuscito a caricare correttamente.<br><br>Per evitare questo messaggio, seleziona un nuovo BaseLayer nel selettore di livelli nell'angolo in alto a destra.<br><br>Pi\u00f9 precisamente, ci\u00f2 accade perch\u00e8 la libreria ${layerLib} non \u00e8 stata inclusa nella pagina.<br><br>Sviluppatori: Per aiuto su come farlo funzionare correttamente, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>clicca qui</a>","Scale = 1 : ${scaleDenom}":"Scala = 1 : ${scaleDenom}",
layerAlreadyAdded:"Stai cercando di aggiungere il livello: ${layerName} alla mappa, ma tale livello \u00e8 gi\u00e0 stato aggiunto.",reprojectDeprecated:"Stai utilizzando l'opzione 'reproject' sul livello ${layerName}. Questa opzione \u00e8 deprecata: il suo utilizzo \u00e8 stato introdotto persupportare il disegno dei dati sopra mappe commerciali, ma tale funzionalit\u00e0 dovrebbe essere ottenuta tramite l'utilizzo della proiezione Spherical Mercator. Per maggiori informazioni consultare qui http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"Questo metodo \u00e8 stato deprecato e sar\u00e0 rimosso dalla versione 3.0. Si prega di utilizzare il metodo ${newMethod} in alternativa.",boundsAddError:"Devi specificare i valori di x e y alla funzione add.",lonlatAddError:"Devi specificare i valori di lon e lat alla funzione add.",pixelAddError:"Devi specificare i valori di x e y alla funzione add.",unsupportedGeometryType:"Tipo di geometria non supportata: ${geomType}",end:"",panup:"Zoomare in alto",panleft:"Zoomare a sinistra",
zoomworld:"Zoomare mondo",panright:"Zoomare a destra",pandown:"Zoomare in basso",zoomin:"Zoomare avanti",zoomout:"Zoomare indietro",dragme:"Trascinami",dragToChangeRoute:"Trascina per cambiare percorso",drawPoints:"Segna punti",clkToSetPoints:"Cliccare per impostare i punti di una linea. Fare doppio click per terminare.",dragToDrawLine:"Trascina per disegnare una linea a mano libera",dragToDrawEllipse:"Trascina per disegnare un rettangolo.",dragToDrawRect:"Trascina per disegnare un'elisse.",clkToSetPolygon:"Clicca per impostare dei punti in un poligono. Fare doppio clic per terminare.",
dragToDrawPolygon:"Trascina per disegnare un poligono a mano libera.",clkShapeToResize:"Clicca una figura per ridimensionarla o per spostarla.",clkShapeToModify:"Clicca una figura per modificare i punti figura. Con il cursore sopra un punto, premere il tasto Cancella per rimuoverlo.",showShapeInfo:"Mostra riquadro info figura.",area:"Area",length:"Lunghezza",nodes:"Nodi",perimeter:"Perimetro",location:"Posizione",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",
nextMapView:"Next map view"};(function(a){if(a){var b=a.ALKMaps.Layer;b.WeatherAlerts=a.GeoJSON.extend({_weatherAlerts:[],alertFilters:{urgency:"All",severity:"All",certainty:"All",eventNames:[],startTime:null,endTime:null},initialize:function(b,d){if(void 0===d||null===d)d={style:this.setStyle.bind(this),onEachFeature:this.onEachFeature.bind(this),filter:this.setFeatureFilter.bind(this),alertFilters:this.alertFilters};else{if(!d.style)d.style=this.setStyle.bind(this);if(!d.onEachFeature)d.onEachFeature=this.onEachFeature.bind(this);
if(!d.filter)d.filter=this.setFeatureFilter.bind(this);if(null!=d.alertFilters)this.alertFilters=d.alertFilters}void 0===b&&(b=null);a.GeoJSON.prototype.initialize.call(this,b,d)},_addToEventList:function(a,b,e){return null==a[b]?(a[b]=e,{event:b,color:e}):null},addAlerts:function(){var b=this;a.ALKMaps.Services.weatherAlertsGeoJson({success:function(a){b.removeAlerts();b._weatherAlerts=a;for(var e={},f=[],g=0;g<a.features.length;g++){var h=a.features[g].properties,h=b._addToEventList(e,h.eventName,
h.color);null!==h&&f.push(h)}f.sort(function(a,b){return a.event.toUpperCase()<b.event.toUpperCase()?-1:a.event.toUpperCase()>b.event.toUpperCase()?1:0});b.addData(a);b.fire("weatherAlertsAdded",{alerts:f});return b},failure:function(){}});return b},removeAlerts:function(){this._weatherAlerts=[];this.clearLayers();this.fire("weatherAlertsRemoved")},getAlerts:function(){var a=this._map.getBounds(),b={},e=[],f;for(f in this._layers){var g=this._layers[f],h=g.getBounds();a.intersects(h)&&(g=this._addToEventList(b,
g.feature.properties.eventName,g.feature.properties.color),null!==g&&e.push(g))}return e},getAlertFilters:function(){return this.alertFilters},setAlertFilters:function(a){this.alertFilters=a;this.options.alertFilters=a},redraw:function(){this.clearLayers();this.addData(this._weatherAlerts);this.fire("weatherAlertsRedrawn",{alerts:this.getAlerts()})},setStyle:function(a){return{fillColor:a.properties.color,weight:1,opacity:0.1,color:a.properties.color,fillOpacity:0.2}},setPopupContent:function(a){a=
a.properties;return"<div style='font-size:11px'>"+('<strong>title: </strong><a href="'+a.eventId+'" target="_blank">'+a.title+"</a></br>")+("<strong>summary: </strong>"+a.summary+"</br>")+("<strong>event: </strong>"+a.eventName+"</br>")+("<strong>effective: </strong>"+a.dispEffective+"</br>")+("<strong>expires: </strong>"+a.dispExpires+"</br>")+("<strong>urgency: </strong>"+a.urgency+"</br>")+("<strong>severity: </strong>"+a.severity+"</br>")+("<strong>certainty: </strong>"+a.certainty+"</br>")+"</div>"},
onEachFeature:function(a,b){if(a.properties&&a.properties.title){var e=this.setPopupContent(a);b.bindPopup(e)}},_showSeverity:function(a){var b=!1;if(void 0===this.alertFilters.severity||null===this.alertFilters.severity)b=!0;else if("ALL"===this.alertFilters.severity.toUpperCase()||this.alertFilters.severity.toUpperCase()===a.toUpperCase())b=!0;return b},_showUrgency:function(a){var b=!1;if(void 0===this.alertFilters.urgency||null===this.alertFilters.urgency)b=!0;else if("ALL"===this.alertFilters.urgency.toUpperCase()||
this.alertFilters.urgency.toUpperCase()===a.toUpperCase())b=!0;return b},_showCertainty:function(a){var b=!1;if(void 0===this.alertFilters.certainty||null===this.alertFilters.certainty)b=!0;else if("ALL"===this.alertFilters.certainty.toUpperCase()||this.alertFilters.certainty.toUpperCase()===a.toUpperCase())b=!0;return b},_showEvent:function(a){var b=!1;if(void 0===this.alertFilters.eventNames||null===this.alertFilters.eventNames||0===this.alertFilters.eventNames.length)b=!0;else for(var e=0;e<this.alertFilters.eventNames.length;e++)if(this.alertFilters.eventNames[e].toUpperCase()===
a.toUpperCase()){b=!0;break}return b},_toDate:function(a){return new Date(a)},_showTime:function(a,b){var e=!1;if(null===a||null===b)e=!0;else{e=!1;if(void 0===this.alertFilters.startTime||null===this.alertFilters.startTime||this._toDate(b)>this._toDate(this.alertFilters.startTime))e=!0;var f=!1;if(void 0===this.alertFilters.endTime||null===this.alertFilters.endTime||this._toDate(a)<this._toDate(this.alertFilters.endTime))f=!0;e=e&&f}return e},setFeatureFilter:function(a){var b=this._showSeverity(a.properties.severity),
e=this._showUrgency(a.properties.urgency),f=this._showCertainty(a.properties.certainty),g=this._showEvent(a.properties.eventName),a=this._showTime(a.properties.dispEffective,a.properties.dispExpires);return b&&e&&f&&g&&a},CLASS_NAME:"ALKMaps.Layer.WeatherAlerts"});b.weatherAlerts=function(){return new b.WeatherAlerts}}})("undefined"===typeof L?null:L);ALKMaps.Control.DragPan=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var a={interval:this.kineticInterval};"object"===typeof this.enableKinetic&&(a=ALKMaps.Util.extend(a,this.enableKinetic));this.kinetic=new ALKMaps.Kinetic(a)}this.handler=new ALKMaps.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},
panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(a){this.kinetic&&this.kinetic.update(a);this.panned=!0;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!0,animate:!1})},panMapDone:function(a){if(this.panned){var b=null;this.kinetic&&(b=this.kinetic.end(a));this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!b,animate:!1});if(b){var c=this;this.kinetic.move(b,function(a,b,f){c.map.pan(a,b,{dragging:!f,animate:!1})})}this.panned=
!1}},CLASS_NAME:"ALKMaps.Control.DragPan"});ALKMaps.Strategy=ALKMaps.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){ALKMaps.Util.extend(this,a);this.options=a;this.active=!1},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(a){this.layer=a},activate:function(){return!this.active?this.active=!0:!1},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"ALKMaps.Strategy"});ALKMaps.Strategy.Cluster=ALKMaps.Class(ALKMaps.Strategy,{distance:20,attribute:null,rule:null,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,maxZoomLevel:null,activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,
moveend:this.cluster,scope:this}));return a},cacheFeatures:function(a){var b=!0;if(!this.clustering)this.clearCache(),this.features=a.features,this.cluster(),b=!1;return b},clearCache:function(){this.features=null},beforeFeatureClustering:function(){return!0},cluster:function(a){if((!a||a.zoomChanged||a&&a.recluster)&&this.features){var b=this.layer.map.getResolution();if(b!==this.resolution||!this.clustersExist()||a&&a.recluster){this.resolution=b;for(var a=[],c,d,e,b=0;b<this.features.length;++b)if(c=
this.features[b],d=this.beforeFeatureClustering(c,this.layer),(null==d||!0===d)&&c.geometry){d=!1;for(var f=a.length-1;0<=f;--f)if(e=a[f],this.shouldCluster(e,c)){this.addToCluster(e,c);d=!0;break}d||a.push(this.createCluster(this.features[b]))}this.layer.removeAllFeatures();if(0<a.length){if(1<this.threshold){c=a.slice();a=[];b=0;for(e=c.length;b<e;++b)d=c[b],d.attributes.count<this.threshold?Array.prototype.push.apply(a,d.cluster):a.push(d)}this.clustering=!0;this.layer.addFeatures(a);this.clustering=
!1}this.clusters=a}}},recluster:function(){this.cluster({recluster:!0})},clustersExist:function(){var a=!1;if(this.clusters&&0<this.clusters.length&&this.clusters.length===this.layer.features.length)for(var a=!0,b=0;b<this.clusters.length;++b)if(this.clusters[b]!==this.layer.features[b]){a=!1;break}return a},shouldCluster:function(a,b){var c=!1,d=this.layer.map;if(null==this.maxZoomLevel||this.maxZoomLevel>=d.getZoom()){c=!0;null!=this.rule&&(c=this.rule.evaluate(a.cluster[0])&&this.rule.evaluate(b));
d=!0;null!=this.attribute&&(d=(a.cluster[0].attributes[this.attribute]||a.cluster[0].data[this.attribute])===(b.attributes[this.attribute]||b.data[this.attribute]));var e=a.geometry.getBounds().getCenterLonLat(),f=b.geometry.getBounds().getCenterLonLat(),e=Math.sqrt(Math.pow(e.lon-f.lon,2)+Math.pow(e.lat-f.lat,2))/this.resolution,c=c&&d&&e<=this.distance}return c},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},createCluster:function(a){var b=a.geometry.getBounds().getCenterLonLat(),
b=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.Point(b.lon,b.lat),{count:1});b.cluster=[a];return b},CLASS_NAME:"ALKMaps.Strategy.Cluster"});ALKMaps.Lang.ja=ALKMaps.Util.applyDefaults({unhandledRequest:"\u672a\u51e6\u7406\u306e\u8981\u6c42\u306f ${statusText} \u3092\u8fd4\u3057\u307e\u3059",Permalink:"\u30d1\u30fc\u30de\u30ea\u30f3\u30af",Overlays:"\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4","Base Layer":"\u57fa\u5e95\u30ec\u30a4\u30e4\u30fc",readNotImplemented:"\u8aad\u307f\u8fbc\u307f\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",writeNotImplemented:"\u66f8\u304d\u8fbc\u307f\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",
noFID:"FID \u306e\u306a\u3044\u5730\u7269\u306f\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3002",errorLoadingGML:"GML \u30d5\u30a1\u30a4\u30eb ${url} \u306e\u8aad\u307f\u8fbc\u307f\u30a8\u30e9\u30fc",browserNotSupported:"\u3042\u306a\u305f\u306e\u30d6\u30e9\u30a6\u30b6\u306f\u30d9\u30af\u30bf\u30fc\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u30b9\u306e\u63cf\u5199\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u73fe\u6642\u70b9\u3067\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306f\u4ee5\u4e0b\u306e\u3082\u306e\u3067\u3059\u3002\n${renderers}",
componentShouldBe:"addFeatures: \u8981\u7d20\u306f ${geomType} \u3067\u3042\u308b\u3079\u304d\u3067\u3059",getFeatureError:"getFeatureFromEvent \u304c\u30ec\u30f3\u30c0\u30e9\u30fc\u306e\u306a\u3044\u30ec\u30a4\u30e4\u30fc\u304b\u3089\u547c\u3070\u308c\u307e\u3057\u305f\u3002\u901a\u5e38\u3001\u3053\u308c\u306f\u3042\u306a\u305f\u304c\u30ec\u30a4\u30e4\u30fc\u3092\u3001\u305d\u308c\u306b\u95a2\u9023\u3065\u3051\u3089\u308c\u305f\u3044\u304f\u3064\u304b\u306e\u30cf\u30f3\u30c9\u30e9\u3092\u9664\u3044\u3066\u3001\u7834\u58ca\u3057\u3066\u3057\u307e\u3063\u305f\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002",
minZoomLevelError:"minZoomLevel \u30d7\u30ed\u30d1\u30c6\u30a3\u306f FixedZoomLevels \u3092\u7d99\u627f\u3059\u308b\u30ec\u30a4\u30e4\u30fc\u3067\u306e\u4f7f\u7528\u306e\u307f\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e minZoomLevel \u306b\u5bfe\u3059\u308b WFS \u30ec\u30a4\u30e4\u30fc\u306e\u691c\u67fb\u306f\u6b74\u53f2\u7684\u306a\u3082\u306e\u3067\u3059\u3002\u3057\u304b\u3057\u306a\u304c\u3089\u3001\u3053\u306e\u691c\u67fb\u3092\u9664\u53bb\u3059\u308b\u3068\u305d\u308c\u306b\u4f9d\u5b58\u3059\u308b ALKMaps \u30d9\u30fc\u30b9\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7834\u58ca\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u3088\u3063\u3066\u5ec3\u6b62\u304c\u4e88\u5b9a\u3055\u308c\u3066\u304a\u308a\u3001\u3053\u306e minZoomLevel \u691c\u67fb\u306f\u30d0\u30fc\u30b8\u30e7\u30f33.0\u3067\u9664\u53bb\u3055\u308c\u307e\u3059\u3002\u4ee3\u308f\u308a\u306b\u3001http://trac.openlayers.org/wiki/SettingZoomLevels \u3067\u89e3\u8aac\u3055\u308c\u3066\u3044\u308b\u3001\u6700\u5c0f\u304a\u3088\u3073\u6700\u5927\u89e3\u50cf\u5ea6\u8a2d\u5b9a\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002",
commitSuccess:"WFS \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3: \u6210\u529f ${response}",commitFailed:"WFS \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3: \u5931\u6557 ${response}",googleWarning:"Google \u30ec\u30a4\u30e4\u30fc\u304c\u6b63\u3057\u304f\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3048\u307e\u305b\u3093\u3067\u3057\u305f\u3002<br><br>\u3053\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6d88\u3059\u306b\u306f\u3001\u53f3\u4e0a\u306e\u9685\u306b\u3042\u308b\u30ec\u30a4\u30e4\u30fc\u5207\u308a\u66ff\u3048\u90e8\u5206\u3067\u65b0\u3057\u3044\u57fa\u5e95\u30ec\u30a4\u30e4\u30fc\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002<br><br>\u304a\u305d\u3089\u304f\u3001\u3053\u308c\u306f Google \u30de\u30c3\u30d7\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u7d44\u307f\u8fbc\u307e\u308c\u3066\u3044\u306a\u3044\u304b\u3001\u3042\u306a\u305f\u306e\u30b5\u30a4\u30c8\u306b\u5bfe\u5fdc\u3059\u308b\u6b63\u3057\u3044 API \u30ad\u30fc\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3067\u3059\u3002<br><br>\u958b\u767a\u8005\u306e\u65b9\u3078: \u6b63\u3057\u3044\u52d5\u4f5c\u3092\u3055\u305b\u308b\u305f\u3081\u306b<a href='http://trac.openlayers.org/wiki/Google' target='_blank'>\u3053\u3061\u3089\u306e\u30a6\u30a3\u30ad</a>\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002",
getLayerWarning:"${layerType} \u30ec\u30a4\u30e4\u30fc\u304c\u6b63\u3057\u304f\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3048\u307e\u305b\u3093\u3067\u3057\u305f\u3002<br><br>\u3053\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6d88\u3059\u306b\u306f\u3001\u53f3\u4e0a\u306e\u9685\u306b\u3042\u308b\u30ec\u30a4\u30e4\u30fc\u5207\u308a\u66ff\u3048\u90e8\u5206\u3067\u65b0\u3057\u3044\u57fa\u5e95\u30ec\u30a4\u30e4\u30fc\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002<br><br>\u304a\u305d\u3089\u304f\u3001\u3053\u308c\u306f ${layerLib} \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u6b63\u3057\u304f\u7d44\u307f\u8fbc\u307e\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3067\u3059\u3002<br><br>\u958b\u767a\u8005\u306e\u65b9\u3078: \u6b63\u3057\u3044\u52d5\u4f5c\u3092\u3055\u305b\u308b\u305f\u3081\u306b<a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>\u3053\u3061\u3089\u306e\u30a6\u30a3\u30ad</a>\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002",
"Scale = 1 : ${scaleDenom}":"\u7e2e\u5c3a = 1 : ${scaleDenom}",W:"\u897f",E:"\u6771",N:"\u5317",S:"\u5357",layerAlreadyAdded:"\u3042\u306a\u305f\u306f\u300c${layerName}\u300d\u3092\u5730\u56f3\u306b\u8ffd\u52a0\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3057\u305f\u304c\u3001\u305d\u306e\u30ec\u30a4\u30e4\u30fc\u306f\u65e2\u306b\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059",reprojectDeprecated:"\u3042\u306a\u305f\u306f\u300c${layerName}\u300d\u30ec\u30a4\u30e4\u30fc\u3067 reproject \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5546\u7528\u306e\u57fa\u5e95\u5730\u56f3\u4e0a\u306b\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u76ee\u7684\u3067\u8a2d\u8a08\u3055\u308c\u307e\u3057\u305f\u304c\u3001\u73fe\u5728\u3067\u306f\u305d\u306e\u6a5f\u80fd\u306f Spherical Mercator \u30b5\u30dd\u30fc\u30c8\u3092\u5229\u7528\u3057\u3066\u5b9f\u73fe\u3055\u308c\u3066\u304a\u308a\u3001\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u4f7f\u7528\u306f\u975e\u63a8\u5968\u3067\u3059\u3002\u8ffd\u52a0\u306e\u60c5\u5831\u306f http://trac.openlayers.org/wiki/SphericalMercator \u3067\u5165\u624b\u3067\u304d\u307e\u3059\u3002",
methodDeprecated:"\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u5ec3\u6b62\u304c\u4e88\u5b9a\u3055\u308c\u3066\u304a\u308a\u3001\u30d0\u30fc\u30b8\u30e7\u30f33.0\u3067\u9664\u53bb\u3055\u308c\u307e\u3059\u3002\u4ee3\u308f\u308a\u306b ${newMethod} \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002",boundsAddError:"x \u3068 y \u4e21\u65b9\u306e\u5024\u3092 add \u95a2\u6570\u306b\u6e21\u3055\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002",lonlatAddError:"lon \u3068 lat \u4e21\u65b9\u306e\u5024\u3092 add \u95a2\u6570\u306b\u6e21\u3055\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002",
pixelAddError:"x \u3068 y \u306e\u5024\u4e21\u65b9\u3092 add \u95a2\u6570\u306b\u6e21\u3055\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002",unsupportedGeometryType:"\u672a\u5bfe\u5fdc\u306e\u5f62\u72b6\u578b: ${geomType}",filterEvaluateNotImplemented:"\u3053\u306e\u30d5\u30a3\u30eb\u30bf\u30fc\u578b\u306b\u3064\u3044\u3066 evaluate \u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",panup:"\u4e0a\u306b\u79fb\u52d5",panleft:"\u5de6\u306b\u79fb\u52d5",zoomworld:"\u30ba\u30fc\u30e0\u30ef\u30fc\u30eb\u30c9",
panright:"\u53f3\u306b\u79fb\u52d5",pandown:"\u4e0b\u306b\u79fb\u52d5",zoomin:"\u30ba\u30fc\u30e0\u30a4\u30f3",zoomout:"\u30ba\u30fc\u30e0\u30a2\u30a6\u30c8",dragme:"\u3053\u3053\u3092\u30c9\u30e9\u30c3\u30b0",dragToChangeRoute:"\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3068\u30eb\u30fc\u30c8\u3092\u5909\u66f4\u3067\u304d\u307e\u3059",drawPoints:"\u30dd\u30a4\u30f3\u30c8\u3092\u63cf\u304d\u307e\u3059",clkToSetPoints:"\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u7dda\u3092\u63cf\u304f\u305f\u3081\u306e\u30dd\u30a4\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u7d42\u4e86\u3057\u307e\u3059\u3002",
dragToDrawLine:"\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3068\u30d5\u30ea\u30fc\u30cf\u30f3\u30c9\u3067\u7dda\u3092\u5f15\u304d\u307e\u3059\u3002",dragToDrawEllipse:"\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3068\u6955\u5186\u5f62\u3092\u63cf\u304d\u307e\u3059\u3002",dragToDrawRect:"\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3068\u9577\u65b9\u5f62\u3092\u63cf\u304d\u307e\u3059\u3002",clkToSetPolygon:"\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u591a\u89d2\u5f62\u3092\u63cf\u304f\u305f\u3081\u306e\u30dd\u30a4\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u7d42\u4e86\u3057\u307e\u3059\u3002",
dragToDrawPolygon:"\u30c9\u30e9\u30c3\u30b0\u3059\u308b\u3068\u30d5\u30ea\u30fc\u30cf\u30f3\u30c9\u3067\u591a\u89d2\u5f62\u3092\u63cf\u304d\u307e\u3059\u3002",clkShapeToResize:"\u56f3\u5f62\u306e\u30b5\u30a4\u30ba\u5909\u66f4\u3084\u79fb\u52d5\u3092\u3059\u308b\u306b\u306f\u56f3\u5f62\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u56de\u8ee2\u3055\u305b\u308b\u306b\u306f\u30ab\u30fc\u30bd\u30eb\u3092\u89d2\u306e\u8fd1\u304f\u306b\u5408\u308f\u305b\u307e\u3059\u3002",clkShapeToModify:"\u56f3\u5f62\u306e\u30dd\u30a4\u30f3\u30c8\u3092\u5909\u66f4\u3059\u308b\u306b\u306f\u56f3\u5f62\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u30dd\u30a4\u30f3\u30c8\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001\u305d\u306e\u30dd\u30a4\u30f3\u30c8\u306e\u4e0a\u306b\u30ab\u30fc\u30bd\u30eb\u3092\u5408\u308f\u305b\u3066\u304b\u3089\u524a\u9664\u30ad\u30fc\u3092\u62bc\u3057\u307e\u3059\u3002",
showShapeInfo:"\u56f3\u5f62\u60c5\u5831\u30dc\u30c3\u30af\u30b9\u306e\u8868\u793a\u3002",area:"\u9762\u7a4d",length:"\u8ddd\u96e2",nodes:"\u7bc0",perimeter:"\u5468\u56f2",location:"\u5834\u6240",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Strategy.CustomPlaces=ALKMaps.Class(ALKMaps.Strategy,{ratio:1,resFactor:null,visitedTiles:{},resolution:null,bounds:null,zoomChanged:!1,initialize:function(a){a=a||{};this.visitedTiles={};ALKMaps.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,scope:this}),this.layer.events.on({refresh:this.update,scope:this}),!0===this.layer.visibility&&this.update());return a},deactivate:function(){var a=
ALKMaps.Strategy.prototype.deactivate.call(this);a&&(this.layer.events.un({moveend:this.update,scope:this}),this.layer.events.un({refresh:this.update,scope:this}));return a},update:function(a){var b=this.layer.map.getExtent();if(b){var c=!this.bounds||!this.bounds.containsBounds(b),d=this.layer.map.baseLayer.getServerResolution();!c&&this.resFactor&&(c=this.resolution/d,c=c>=this.resFactor||c<=1/this.resFactor);if(c){var c=b.getCenterLonLat(),e=b.getWidth()*this.ratio,b=b.getHeight()*this.ratio;this.bounds=
new ALKMaps.Bounds(c.lon-e/2,c.lat-b/2,c.lon+e/2,c.lat+b/2);this.resolution=d;if(a)this.zoomChanged=a.zoomChanged?a.zoomChanged:!1;this.triggerRead()}}},triggerRead:function(){if(this.zoomChanged)this.layer.destroyFeatures(),this.visitedTiles={},this.zoomChanged=!1;for(var a=this.boundsToTiles(this.bounds),b=[],c=0;c<a.length;c++)a[c].id in this.visitedTiles||b.push(a[c]);this.layer.protocol.readTiles(b,{callback:this.merge,scope:this})},boundsToTiles:function(a){for(var b=this.layer.map.getMaxExtent(),
c=[],d=this.resolution,e=d*(this.layer.tileSize.w||256),d=d*(this.layer.tileSize.h||256),f=Math.floor((a.left-b.left)/e),g=Math.floor((a.right-b.left)/e),h=Math.floor((b.top-a.top)/d),a=Math.floor((b.top-a.bottom)/d),i=this.layer.map.baseLayer.getServerZoom();h<=a;h++)for(var j=f;j<=g;j++){var k={};if(this.layer.map.baseLayer.wrapDateLine)var m=Math.pow(2,i),m=(j%m+m)%m;k.id=i+"-"+m+"-"+h;var l=j*e+b.left,p=b.top-h*d,l=new ALKMaps.Bounds(l,p-d,l+e,p),p=new ALKMaps.Projection("EPSG:4326"),l=l.clone().transform(this.layer.map.getProjectionObject(),
p);if(-180>l.left)l.left=(l.left%180+180)%180;if(180<l.left)l.left=(l.left%-180-180)%-180;if(-180>l.right)l.right=(l.right%180+180)%180;if(180<l.right)l.right=(l.right%-180-180)%-180;k.bounds=l;k.custPlaceSetId=this.layer.custPlaceSetId;k.custPlaceTag=this.layer.custPlaceTag;k.placeName=this.layer.custPlaceName;k.catId=this.layer.custCatId;k.catName=this.layer.custCatName;c.push(k)}return c},merge:function(a){this.visitedTiles[a.id]=!0;if((a=a.features)&&0<a.length){var b=new ALKMaps.Projection("EPSG:4326"),
c=this.layer.map.getProjectionObject();if(!c.equals(b))for(var d,e=0,f=a.length;e<f;++e)(d=a[e].geometry)&&d.transform(b,c);this.layer.addFeatures(a)}},CLASS_NAME:"ALKMaps.Strategy.CustomPlaces"});ALKMaps.Control.FeatureSlicer=ALKMaps.Class(ALKMaps.Control,{citeCompliant:!1,documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,tolerance:{toLine:10,toLineEnd:10},nearTheLinePointerClass:"olControlFeatureSlicerLineOver",overTheLineEndsPointerClass:"olControlFeatureSlicerLineEndOver",lineStyle:{strokeColor:"#ff0000",strokeWidth:1},lineEndStyle:{graphicName:"square",pointRadius:4,strokeColor:"#000000",fillColor:"#ffffff",strokeWidth:1,fillOpacity:1},onLineDrawn:function(){},
onLineStretched:function(){},onLineMoved:function(){},mouseoverLine:function(){},enabled:!0,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,[a]);this.layer=new ALKMaps.Layer.Vector(ALKMaps.Util.createUniqueID("ALKMaps.Control.FeatureSlicer_"),{displayInLayerSwitcher:!1,calculateInRange:ALKMaps.Function.True,wrapDateLine:this.citeCompliant});this.handlers={drawLine:new ALKMaps.Handler.Point(this,{done:this.drawLineWithEndMarkers},{style:{pointRadius:0}}),drag:new ALKMaps.Handler.Drag(this,
ALKMaps.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new ALKMaps.Handler.Feature(this,this.layer,ALKMaps.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:null})}},ajustLineBounds:function(a){var b=new ALKMaps.Bounds;b.extend(a.geometry.components[0]);b.extend(a.geometry.components[1]);
return b},onMouseclick:function(a){if(!0===this.enabled&&!1===this.handlers.drawLine.active&&4<=this.layer.features.length){this.layer.destroyFeatures();this.handlers.feature.deactivate();this.dragging=!1;this.lastPixel=null;if(this.feature)this.feature.destroy(),this.feature=null;this.handlers.drawLine.activate();a=this.layer.getLonLatFromViewPortPx(a.xy);this.drawLineWithEndMarkers(new ALKMaps.Geometry.Point(a.lon,a.lat))}},onMousemove:function(a){if(!0===this.enabled){var b=null,b=!0===this.handlers.drawLine.active?
this.layer.features[0]:this.layer.features[1];if(null!=b)if(!0===this.handlers.drawLine.active)a=this.layer.getLonLatFromViewPortPx(a.xy),b.geometry.components[1].x=a.lon,b.geometry.components[1].y=a.lat,b.geometry.bounds=this.ajustLineBounds(b),this.layer.drawFeature(b);else if(!1===this.handlers.drawLine.active&&!this.handlers.drag.dragging){var c=this.layer.getLonLatFromViewPortPx(a.xy),d=new ALKMaps.Geometry.Point(c.lon,c.lat),c=b.geometry.distanceTo(d,{details:!0}),e=this.layer.getViewPortPxFromLonLat({lon:c.x0,
lat:c.y0}),f=b.geometry.components[0].distanceTo(d)/this.map.getResolution(),b=b.geometry.components[1].distanceTo(d)/this.map.getResolution();f>=this.tolerance.toLineEnd&&b>=this.tolerance.toLineEnd&&e.distanceTo(a.xy)<=this.tolerance.toLine?(ALKMaps.Element.addClass(this.map.viewPortDiv,this.nearTheLinePointerClass),this.mouseoverLine(c)):ALKMaps.Element.removeClass(this.map.viewPortDiv,this.nearTheLinePointerClass)}}},drawLineWithEndMarkers:function(a){if(0===this.layer.features.length){var b=
new ALKMaps.Feature.Vector(a,null,this.lineEndStyle);this.layer.addFeatures([new ALKMaps.Feature.Vector(new ALKMaps.Geometry.LineString([a.clone(),a.clone()]),null,this.lineStyle),b],{silent:!0})}else{var c=this.layer.features[0].clone();c.geometry.components[0].bounds=new ALKMaps.Bounds(c.geometry.components[0].x,c.geometry.components[0].y,c.geometry.components[0].x,c.geometry.components[0].y);c.geometry.components[1].bounds=new ALKMaps.Bounds(c.geometry.components[1].x,c.geometry.components[1].y,
c.geometry.components[1].x,c.geometry.components[1].y);c.geometry.bounds=this.ajustLineBounds(c);var d=c.clone();c.style={strokeColor:"#FFFFFF",strokeWidth:12,strokeOpacity:0.2};var e=this.layer.features[1].clone();this.layer.destroyFeatures();b=new ALKMaps.Feature.Vector(a,null,this.lineEndStyle);this.layer.addFeatures([c,d,e,b],{silent:!0});this.handlers.drawLine.deactivate();this.handlers.feature.activate();this.onLineDrawn(this.layer.features[1])}},clickFeature:function(){},clickoutFeature:function(){},
destroy:function(){this.layer.destroy(!1);this.layer=null;ALKMaps.Control.prototype.destroy.apply(this,[])},activate:function(){this.enabled=!0;this.map.addLayer(this.layer);this.map.events.register("click",this,this.onMouseclick);this.map.events.register("mousemove",this,this.onMousemove);return this.handlers.drawLine.activate()&&ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.enabled=!1;this.map.events.unregister("click",this,this.onMouseclick);this.map.events.unregister("mousemove",
this,this.onMousemove);this.handlers.drawLine.deactivate();this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.dragging=!1;this.lastPixel=null;null!=this.layer.map&&(this.layer.destroyFeatures(),this.map.removeLayer(this.layer,!1),this.feature&&this.feature.destroy());this.feature=null;ALKMaps.Element.removeClass(this.map.viewPortDiv,this.overTheLineEndsPointerClass);return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){if(!0===this.enabled){var b=
!1;if(null==a)return b;this.handlers.drag.dragging?this.over=this.feature.id==a.id?!0:!1:(this.feature=a,this.handlers.drag.activate(),this.over=b=!0,a.geometry instanceof ALKMaps.Geometry.Point&&ALKMaps.Element.addClass(this.map.viewPortDiv,this.overTheLineEndsPointerClass));return b}},downFeature:function(a){if(!0===this.enabled)ALKMaps.Element.removeClass(this.map.viewPortDiv,this.nearTheLinePointerClass),ALKMaps.Element.removeClass(this.map.viewPortDiv,this.overTheLineEndsPointerClass),this.lastPixel=
a},moveFeature:function(a){if(!0===this.enabled){var b=this.layer.features[0],c=this.layer.features[1],d=this.layer.features[2],e=this.layer.features[3],f=this.map.getResolution(),g=f*(a.x-this.lastPixel.x),f=f*(this.lastPixel.y-a.y);this.feature.geometry instanceof ALKMaps.Geometry.Point?this.feature.id===e.id?(e.geometry.move(g,f),this.layer.drawFeature(e),b.geometry.components[1]=e.geometry.clone(),c.geometry.components[1]=e.geometry.clone()):(d.geometry.move(g,f),this.layer.drawFeature(d),b.geometry.components[0]=
d.geometry.clone(),c.geometry.components[0]=d.geometry.clone()):(b.geometry.move(g,f),c.geometry.move(g,f),d.geometry.move(g,f),e.geometry.move(g,f),this.layer.drawFeature(d),this.layer.drawFeature(e));b.geometry.bounds=this.ajustLineBounds(b);c.geometry.bounds=this.ajustLineBounds(c);this.layer.drawFeature(b);this.layer.drawFeature(c);this.lastPixel=a}},upFeature:function(){if(!0===this.enabled)if(this.over||this.handlers.drag.deactivate(),this.feature.geometry instanceof ALKMaps.Geometry.Point)ALKMaps.Element.addClass(this.map.viewPortDiv,
this.overTheLineEndsPointerClass),this.onLineStretched(this.layer.features[1]);else this.onLineMoved(this.layer.features[1])},doneDragging:function(){},outFeature:function(a){if(!0===this.enabled)if(this.handlers.drag.dragging){if(this.feature.id==a.id)this.over=!1}else this.over=!1,this.handlers.drag.deactivate(),ALKMaps.Element.removeClass(this.map.viewPortDiv,this.overTheLineEndsPointerClass),this.feature=null},cancel:function(){},setMap:function(a){this.handlers.drawLine.setMap(a);this.handlers.drag.setMap(a);
this.handlers.feature.setMap(a);ALKMaps.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.FeatureSlicer"});ALKMaps.Lang.pl={panup:"Przesu\u0144 w\u00a0g\u00f3r\u0119",panleft:"Przesu\u0144 w\u00a0lewo",zoomworld:"Zmie\u0144 skal\u0119",panright:"Przesu\u0144 w\u00a0prawo",pandown:"Przesu\u0144 w\u00a0d\u00f3\u0142",zoomin:"Przybli\u017cenie",zoomout:"Oddalenie",dragme:"Przeci\u0105gnij mnie",dragToChangeRoute:"Przeci\u0105gnij, aby zmieni\u0107 tras\u0119",drawPoints:"Przeci\u0105gnij punkty",clkToSetPoints:"Kliknij, aby wybra\u0107 punkty dla linii. Kliknij dwukrotnie, aby zako\u0144czy\u0107.",dragToDrawLine:"Przeci\u0105gnij, aby narysowa\u0107 lini\u0119 odr\u0119czn\u0105.",
dragToDrawEllipse:"Przeci\u0105gnij, aby narysowa\u0107 elips\u0119.",dragToDrawRect:"Przeci\u0105gnij, aby narysowa\u0107 prostok\u0105t.",clkToSetPolygon:"Kliknij, aby wybra\u0107 punkty dla wieloboku. Kliknij dwukrotnie, aby zako\u0144czy\u0107.",dragToDrawPolygon:"Przeci\u0105gnij, aby narysowa\u0107 wielobok odr\u0119czny.",clkShapeToResize:"Kliknij kszta\u0142t, aby zmieni\u0107 rozmiar lub przesun\u0105\u0107. Umie\u015b\u0107 kursor w pobli\u017cu naro\u017cnika, aby obr\u00f3ci\u0107.",clkShapeToModify:"Kliknij kszta\u0142t, aby zmodyfikowa\u0107 punkty kszta\u0142tu. Umie\u015b\u0107 kursor nad punktem i naci\u015bnij klawisz Delete (Usu\u0144), aby usun\u0105\u0107.",
showShapeInfo:"Poka\u017c okno informacyjne kszta\u0142tu.",area:"Obszar",length:"D\u0142ugo\u015b\u0107",nodes:"W\u0119z\u0142y",perimeter:"Obw\u00f3d",location:"Lokalizacja",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Layer.DriveTime=ALKMaps.Class(ALKMaps.Layer.Vector,{framePolygon:!0,initialize:function(a,b){b=b||{};this.framePolygon=b.framePolygon||this.framePolygon;ALKMaps.Layer.Vector.prototype.initialize.apply(this,arguments)},setMap:function(a){this.projection=a.getProjectionObject();ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments)},addDriveTimePolygon:function(a){var a=a||{},b=a.center.clone().transform(this.projection,new ALKMaps.Projection("EPSG:4326")),c=a.minutes||5,d=a.style||null,
e=a.framPolygon||this.framePolygon,f=a.options||{};f.region=null!=f.region?ALKMaps.Util.getRegion(f.region):null!=this.map.baseLayer&&null!=this.map.baseLayer.params&&null!=this.map.baseLayer.params.REGION?this.map.baseLayer.params.REGION:"NA";f.dataset=null!=f.dataset?ALKMaps.Util.getDataSet(f.dataset):ALKMaps.Util.getDatasetFromRegion(f.region);var g=this,h;ALKMaps.Services.getDriveTimePolygon({center:b,minutes:c,options:f,success:function(b){for(var c=[],b=b.coordinates[0],f=0;f<b.length;f++){var m=
(new ALKMaps.Geometry.Point(b[f][0],b[f][1])).transform(new ALKMaps.Projection("EPSG:4326"),g.projection);c.push(m)}c=new ALKMaps.Geometry.LinearRing(c);c=new ALKMaps.Feature.Vector(c,null,d);g.addFeatures([c]);h=c.id;!0===e&&g.map.zoomToExtent(c.geometry.bounds);null!=a.success&&"function"===typeof a.success&&a.success(h)},failure:function(b){g.map.hideLoading();null!=a.failure&&"function"===typeof a.failure?a.failure(b):alert(b.status+"\n"+b.statusText+"\n "+b.responseText)}})},removeDriveTimePolygon:function(a){var b=
!1,a=this.getFeatureById(a);null!=a&&a instanceof ALKMaps.Feature.Vector&&(this.removeFeatures([a],null),b=!0);return b},CLASS_NAME:"ALKMaps.Layer.DriveTime"});ALKMaps.Handler.Box=ALKMaps.Class(ALKMaps.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(a,b,c){ALKMaps.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new ALKMaps.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){ALKMaps.Handler.prototype.destroy.apply(this,arguments);if(this.dragHandler)this.dragHandler.destroy(),this.dragHandler=null},setMap:function(a){ALKMaps.Handler.prototype.setMap.apply(this,
arguments);this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(){this.callback("start",[]);this.zoomBox=ALKMaps.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);ALKMaps.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x,c=this.dragHandler.start.y,d=Math.abs(b-a.x),e=Math.abs(c-a.y),f=this.getBoxOffsets();
this.zoomBox.style.width=d+f.width+1+"px";this.zoomBox.style.height=e+f.height+1+"px";this.zoomBox.style.left=(a.x<b?b-d-f.left:b-f.left)+"px";this.zoomBox.style.top=(a.y<c?c-e-f.top:c-f.top)+"px"},endBox:function(a){var b;if(5<Math.abs(this.dragHandler.start.x-a.x)||5<Math.abs(this.dragHandler.start.y-a.y)){var c=this.dragHandler.start;b=Math.min(c.y,a.y);var d=Math.max(c.y,a.y),e=Math.min(c.x,a.x),a=Math.max(c.x,a.x);b=new ALKMaps.Bounds(e,d,a,b)}else b=this.dragHandler.start.clone();this.removeBox();
this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;ALKMaps.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return ALKMaps.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return ALKMaps.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var a=
document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var b=3==a.clientWidth;document.body.removeChild(a);var a=parseInt(ALKMaps.Element.getStyle(this.zoomBox,"border-left-width")),c=parseInt(ALKMaps.Element.getStyle(this.zoomBox,"border-right-width")),d=parseInt(ALKMaps.Element.getStyle(this.zoomBox,"border-top-width")),e=parseInt(ALKMaps.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,
right:c,top:d,bottom:e,width:!1===b?a+c:0,height:!1===b?d+e:0}}return this.boxOffsets},CLASS_NAME:"ALKMaps.Handler.Box"});ALKMaps.Control.ZoomBox=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,initialize:function(a){a=a||{};a.title=a.title||ALKMaps.i18n("boxZoom");ALKMaps.Control.prototype.initialize.apply(this,[a])},draw:function(){this.handler=new ALKMaps.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof ALKMaps.Bounds){var b;if(this.out){b=Math.abs(a.right-a.left);var c=Math.abs(a.top-a.bottom);b=Math.min(this.map.size.h/
c,this.map.size.w/b);var c=this.map.getExtent(),d=this.map.getLonLatFromPixel(a.getCenterPixel()),a=d.lon-c.getWidth()/2*b,e=d.lon+c.getWidth()/2*b,f=d.lat-c.getHeight()/2*b;b=d.lat+c.getHeight()/2*b;b=new ALKMaps.Bounds(a,f,e,b)}else b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),c=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new ALKMaps.Bounds(b.lon,b.lat,c.lon,c.lat);c=this.map.getZoom();this.map.zoomToExtent(b);c==this.map.getZoom()&&!0==this.alwaysZoom&&this.map.zoomTo(c+(this.out?
-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()+1)},CLASS_NAME:"ALKMaps.Control.ZoomBox"});ALKMaps.Popup.Framed=ALKMaps.Class(ALKMaps.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(a,b,c,d,e,f,g){ALKMaps.Popup.Anchored.prototype.initialize.apply(this,arguments);if(this.fixedRelativePosition)this.updateRelativePosition(),this.calculateRelativePosition=function(){return this.relativePosition};this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;if(f)this.closeDiv.style.zIndex=1;
this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.isAlphaImage=this.imageSize=this.imageSrc=null;this.fixedRelativePosition=!1;this.positionBlocks=null;for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];b.image&&b.div.removeChild(b.image);b.image=null;b.div&&this.groupDiv.removeChild(b.div);b.div=null}this.blocks=null;ALKMaps.Popup.Anchored.prototype.destroy.apply(this,
arguments)},setBackgroundColor:function(){},setBorder:function(){},setOpacity:function(){},setSize:function(a){ALKMaps.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px";this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var b=
ALKMaps.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return b=b.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var a=null,b;for(b in this.positionBlocks){a=b;break}a=this.positionBlocks[a];for(b=0;b<a.blocks.length;b++){var c={};this.blocks.push(c);c.div=ALKMaps.Util.createDiv(this.id+"_FrameDecorationDiv_"+b,null,null,null,"absolute",null,"hidden",null);c.image=(this.isAlphaImage?ALKMaps.Util.createAlphaImageDiv:ALKMaps.Util.createImage)(this.id+
"_FrameDecorationImg_"+b,null,this.imageSize,this.imageSrc,"absolute",null,null,null);c.div.appendChild(c.image);this.groupDiv.appendChild(c.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&&this.relativePosition){for(var a=this.positionBlocks[this.relativePosition],b=0;b<a.blocks.length;b++){var c=a.blocks[b],d=this.blocks[b],e=c.anchor.left,f=c.anchor.bottom,g=c.anchor.right,h=c.anchor.top,i=isNaN(c.size.w)?this.size.w-(g+e):c.size.w,j=isNaN(c.size.h)?this.size.h-(f+
h):c.size.h;d.div.style.width=(0>i?0:i)+"px";d.div.style.height=(0>j?0:j)+"px";d.div.style.left=null!=e?e+"px":"";d.div.style.bottom=null!=f?f+"px":"";d.div.style.right=null!=g?g+"px":"";d.div.style.top=null!=h?h+"px":"";d.image.style.left=c.position.x+"px";d.image.style.top=c.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"ALKMaps.Popup.Framed"});ALKMaps.Popup.FramedCloud=ALKMaps.Class(ALKMaps.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new ALKMaps.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new ALKMaps.Pixel(44,0),padding:new ALKMaps.Bounds(8,40,8,9),blocks:[{size:new ALKMaps.Size("auto","auto"),anchor:new ALKMaps.Bounds(0,51,22,0),position:new ALKMaps.Pixel(0,0)},{size:new ALKMaps.Size(22,"auto"),anchor:new ALKMaps.Bounds(null,50,0,0),position:new ALKMaps.Pixel(-1238,
0)},{size:new ALKMaps.Size("auto",19),anchor:new ALKMaps.Bounds(0,32,22,null),position:new ALKMaps.Pixel(0,-631)},{size:new ALKMaps.Size(22,18),anchor:new ALKMaps.Bounds(null,32,0,null),position:new ALKMaps.Pixel(-1238,-632)},{size:new ALKMaps.Size(81,35),anchor:new ALKMaps.Bounds(null,0,0,null),position:new ALKMaps.Pixel(0,-688)}]},tr:{offset:new ALKMaps.Pixel(-45,0),padding:new ALKMaps.Bounds(8,40,8,9),blocks:[{size:new ALKMaps.Size("auto","auto"),anchor:new ALKMaps.Bounds(0,51,22,0),position:new ALKMaps.Pixel(0,
0)},{size:new ALKMaps.Size(22,"auto"),anchor:new ALKMaps.Bounds(null,50,0,0),position:new ALKMaps.Pixel(-1238,0)},{size:new ALKMaps.Size("auto",19),anchor:new ALKMaps.Bounds(0,32,22,null),position:new ALKMaps.Pixel(0,-631)},{size:new ALKMaps.Size(22,19),anchor:new ALKMaps.Bounds(null,32,0,null),position:new ALKMaps.Pixel(-1238,-631)},{size:new ALKMaps.Size(81,35),anchor:new ALKMaps.Bounds(0,0,null,null),position:new ALKMaps.Pixel(-215,-687)}]},bl:{offset:new ALKMaps.Pixel(45,0),padding:new ALKMaps.Bounds(8,
9,8,40),blocks:[{size:new ALKMaps.Size("auto","auto"),anchor:new ALKMaps.Bounds(0,21,22,32),position:new ALKMaps.Pixel(0,0)},{size:new ALKMaps.Size(22,"auto"),anchor:new ALKMaps.Bounds(null,21,0,32),position:new ALKMaps.Pixel(-1238,0)},{size:new ALKMaps.Size("auto",21),anchor:new ALKMaps.Bounds(0,0,22,null),position:new ALKMaps.Pixel(0,-629)},{size:new ALKMaps.Size(22,21),anchor:new ALKMaps.Bounds(null,0,0,null),position:new ALKMaps.Pixel(-1238,-629)},{size:new ALKMaps.Size(81,33),anchor:new ALKMaps.Bounds(null,
null,0,0),position:new ALKMaps.Pixel(-101,-674)}]},br:{offset:new ALKMaps.Pixel(-44,0),padding:new ALKMaps.Bounds(8,9,8,40),blocks:[{size:new ALKMaps.Size("auto","auto"),anchor:new ALKMaps.Bounds(0,21,22,32),position:new ALKMaps.Pixel(0,0)},{size:new ALKMaps.Size(22,"auto"),anchor:new ALKMaps.Bounds(null,21,0,32),position:new ALKMaps.Pixel(-1238,0)},{size:new ALKMaps.Size("auto",21),anchor:new ALKMaps.Bounds(0,0,22,null),position:new ALKMaps.Pixel(0,-629)},{size:new ALKMaps.Size(22,21),anchor:new ALKMaps.Bounds(null,
0,0,null),position:new ALKMaps.Pixel(-1238,-629)},{size:new ALKMaps.Size(81,33),anchor:new ALKMaps.Bounds(0,null,null,0),position:new ALKMaps.Pixel(-311,-674)}]}},minSize:new ALKMaps.Size(105,10),maxSize:new ALKMaps.Size(1200,660),initialize:function(a,b,c,d,e,f,g){this.imageSrc=ALKMaps.Util.getImageLocation("cloud-popup-relative.png");ALKMaps.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"ALKMaps.Popup.FramedCloud"});ALKMaps.Control.DragFeature=ALKMaps.Class(ALKMaps.Control,{geometryTypes:null,onStart:function(){},onDrag:function(){},onComplete:function(){},onEnter:function(){},onLeave:function(){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.handlers={drag:new ALKMaps.Handler.Drag(this,ALKMaps.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,
out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new ALKMaps.Handler.Feature(this,this.layer,ALKMaps.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(a){if(this.handlers.feature.touch&&!this.over&&this.overFeature(a))this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown=!1},
clickoutFeature:function(a){if(this.handlers.feature.touch&&this.over)this.outFeature(a),this.handlers.drag.stopDown=!0},destroy:function(){this.layer=null;ALKMaps.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=!1;this.lastPixel=null;ALKMaps.Element.removeClass(this.map.viewPortDiv,
this.displayClass+"Over");return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){var b=!1;if(null==a)return b;this.handlers.drag.dragging?this.over=this.feature.id==a.id?!0:!1:(this.feature=a,this.handlers.drag.activate(),this.over=b=!0,ALKMaps.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(a));return b},downFeature:function(a){this.lastPixel=a;this.onStart(this.feature,a)},moveFeature:function(a){var b=this.map.getResolution();this.feature.geometry.move(b*
(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y));this.layer.drawFeature(this.feature);this.lastPixel=a;this.onDrag(this.feature,a)},upFeature:function(){this.over||this.handlers.drag.deactivate()},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){if(this.handlers.drag.dragging){if(this.feature.id==a.id)this.over=!1}else this.over=!1,this.handlers.drag.deactivate(),ALKMaps.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(a),this.feature=
null},cancel:function(){this.handlers.drag.deactivate();this.over=!1},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);ALKMaps.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.DragFeature"});ALKMaps.Control.SelectFeature=ALKMaps.Class(ALKMaps.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,[b]);if(null===this.scope)this.scope=this;this.initLayer(a);var c={click:this.clickFeature,
clickout:this.clickoutFeature};if(this.hover)c.over=this.overFeature,c.out=this.outFeature;this.callbacks=ALKMaps.Util.extend(c,this.callbacks);this.handlers={feature:new ALKMaps.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};if(this.box)this.handlers.box=new ALKMaps.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"})},initLayer:function(a){ALKMaps.Util.isArray(a)?(this.layers=a,this.layer=new ALKMaps.Layer.Vector.RootContainer(this.id+
"_container",{layers:a})):this.layer=a},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer);ALKMaps.Control.prototype.destroy.apply(this,arguments);this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate());return ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&&(this.handlers.feature.deactivate(),
this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer));return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){for(var b=this.layers||[this.layer],c,d,e=0;e<b.length;++e){c=b[e];for(var f=c.selectedFeatures.length-1;0<=f;--f)d=c.selectedFeatures[f],(!a||a.except!=d)&&this.unselect(d)}},clickFeature:function(a){this.hover||(-1<ALKMaps.Util.indexOf(a.layer.selectedFeatures,a)?this.toggleSelect()?this.unselect(a):this.multipleSelect()||
this.unselectAll({except:a}):(this.multipleSelect()||this.unselectAll({except:a}),this.select(a)))},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(a){var b=a.layer;this.hover&&(this.highlightOnly?this.highlight(a):-1==
ALKMaps.Util.indexOf(b.selectedFeatures,a)&&this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);b&&b.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var b=a.layer;if(!1!==this.events.triggerEvent("beforefeaturehighlighted",{feature:a}))a._prevHighlighter=a._lastHighlighter,a._lastHighlighter=
this.id,b.drawFeature(a,this.selectStyle||this.renderIntent),this.events.triggerEvent("featurehighlighted",{feature:a})},unhighlight:function(a){var b=a.layer;if(void 0==a._prevHighlighter)delete a._lastHighlighter;else{if(a._prevHighlighter!=this.id)a._lastHighlighter=a._prevHighlighter;delete a._prevHighlighter}b.drawFeature(a,a.style||a.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var b=this.onBeforeSelect.call(this.scope,a),c=a.layer;
if(!1!==b&&(b=c.events.triggerEvent("beforefeatureselected",{feature:a}),!1!==b)){c.selectedFeatures.push(a);this.highlight(a);if(!this.handlers.feature.lastFeature)this.handlers.feature.lastFeature=c.selectedFeatures[0];c.events.triggerEvent("featureselected",{feature:a});this.onSelect.call(this.scope,a)}},unselect:function(a){var b=a.layer;this.unhighlight(a);ALKMaps.Util.removeItem(b.selectedFeatures,a);b.events.triggerEvent("featureunselected",{feature:a});this.onUnselect.call(this.scope,a)},
selectBox:function(a){if(a instanceof ALKMaps.Bounds){var b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new ALKMaps.Bounds(b.lon,b.lat,a.lon,a.lat);this.multipleSelect()||this.unselectAll();a=this.multiple;this.multiple=!0;var c=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:c});for(var d,e=0;e<c.length;++e){d=c[e];for(var f=0,g=d.features.length;f<g;++f){var h=d.features[f];h.getVisibility()&&(null==this.geometryTypes||
-1<ALKMaps.Util.indexOf(this.geometryTypes,h.geometry.CLASS_NAME))&&b.toGeometry().intersects(h.geometry)&&-1==ALKMaps.Util.indexOf(d.selectedFeatures,h)&&this.select(h)}}this.multiple=a;this.events.triggerEvent("boxselectionend",{layers:c})}},setMap:function(a){this.handlers.feature.setMap(a);this.box&&this.handlers.box.setMap(a);ALKMaps.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.unselectAll();this.deactivate();if(this.layers)this.layer.destroy(),
this.layers=null;this.initLayer(a);this.handlers.feature.layer=this.layer;b&&this.activate()},CLASS_NAME:"ALKMaps.Control.SelectFeature"});ALKMaps.Handler.Keyboard=ALKMaps.Class(ALKMaps.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(a,b,c){ALKMaps.Handler.prototype.initialize.apply(this,arguments);this.eventListener=ALKMaps.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;ALKMaps.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(ALKMaps.Handler.prototype.activate.apply(this,arguments)){this.observeElement=
this.observeElement||document;for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)ALKMaps.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return!0}return!1},deactivate:function(){var a=!1;if(ALKMaps.Handler.prototype.deactivate.apply(this,arguments)){for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)ALKMaps.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=!0}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&this.callback(a.type,[a])},CLASS_NAME:"ALKMaps.Handler.Keyboard"});ALKMaps.Control.ModifyFeature=ALKMaps.Class(ALKMaps.Control,{geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,b){b=b||{};this.layer=a;this.vertices=
[];this.virtualVertices=[];this.virtualStyle=ALKMaps.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,b.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=ALKMaps.Control.ModifyFeature.RESHAPE;ALKMaps.Control.prototype.initialize.apply(this,[b]);if(!ALKMaps.Util.isArray(this.deleteCodes))this.deleteCodes=[this.deleteCodes];var c=this,d={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,
onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};if(!1===this.standalone)this.selectControl=new ALKMaps.Control.SelectFeature(a,d);this.dragControl=new ALKMaps.Control.DragFeature(a,{geometryTypes:["ALKMaps.Geometry.Point"],onStart:function(a,b){c.dragStart.apply(c,[a,b])},onDrag:function(a,b){c.dragVertex.apply(c,[a,b])},onComplete:function(a){c.dragComplete.apply(c,[a])},featureCallbacks:{over:function(a){(!0!==c.standalone||a._sketch||
c.feature===a)&&c.dragControl.overFeature.apply(c.dragControl,[a])}}});this.handlers={keyboard:new ALKMaps.Handler.Keyboard(this,{keydown:this.handleKeypress})}},destroy:function(){this.layer=null;this.standalone||this.selectControl.destroy();this.dragControl.destroy();ALKMaps.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){var a=
!1;if(ALKMaps.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:!0});this.layer.removeFeatures(this.virtualVertices,{silent:!0});this.vertices=[];this.dragControl.deactivate();var b=(a=this.feature)&&a.geometry&&a.layer;!1===this.standalone?(b&&this.selectControl.unselect.apply(this.selectControl,[a]),this.selectControl.deactivate()):b&&this.unselectFeature(a);this.handlers.keyboard.deactivate();a=!0}return a},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",
{feature:a})},selectFeature:function(a){if(!this.standalone||!1!==this.beforeSelectFeature(a))this.feature=a,this.modified=!1,this.resetVertices(),this.dragControl.activate(),this.onModificationStart(this.feature);var b=a.modified;if(a.geometry&&(!b||!b.geometry))this._originalGeometry=a.geometry.clone()},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,{silent:!0});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:!0});this.virtualVertices=[];this.dragHandle&&
(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle);this.feature=null;this.dragControl.deactivate();this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified",{feature:a,modified:this.modified});this.modified=!1},dragStart:function(a,b){if(a!=this.feature&&!a.geometry.parent&&a!=this.dragHandle&&a!=this.radiusHandle&&(!1===this.standalone&&this.feature&&
this.selectControl.clickFeature.apply(this.selectControl,[this.feature]),null==this.geometryTypes||-1!=ALKMaps.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)))this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[a]),this.dragControl.overFeature.apply(this.dragControl,[a]),this.dragControl.lastPixel=b,this.dragControl.handlers.drag.started=!0,this.dragControl.handlers.drag.start=b,this.dragControl.handlers.drag.last=b},dragVertex:function(a,b){this.modified=!0;if("ALKMaps.Geometry.Point"==
this.feature.geometry.CLASS_NAME){if(this.feature!=a)this.feature=a;this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b})}else{if(a._index)a.geometry.parent.addComponent(a.geometry,a._index),delete a._index,ALKMaps.Util.removeItem(this.virtualVertices,a),this.vertices.push(a);else if(a==this.dragHandle){if(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle)this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=
null}else a!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b});if(0<this.virtualVertices.length)this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[];this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent)}this.layer.drawFeature(a)},dragComplete:function(){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",
{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=ALKMaps.State.INSERT&&this.feature.state!=ALKMaps.State.DELETE&&(this.feature.state=ALKMaps.State.UPDATE,this.modified&&this._originalGeometry)){var a=this.feature;a.modified=ALKMaps.Util.extend(a.modified,{geometry:this._originalGeometry});delete this._originalGeometry}},resetVertices:function(){this.dragControl.feature&&this.dragControl.outFeature(this.dragControl.feature);if(0<this.vertices.length)this.layer.removeFeatures(this.vertices,
{silent:!0}),this.vertices=[];if(0<this.virtualVertices.length)this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[];if(this.dragHandle)this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null;if(this.radiusHandle)this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null;this.feature&&"ALKMaps.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&ALKMaps.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&
(ALKMaps.Control.ModifyFeature.ROTATE|ALKMaps.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&ALKMaps.Control.ModifyFeature.RESHAPE&&(this.mode&ALKMaps.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(a){var b=a.keyCode;if(this.feature&&-1!=ALKMaps.Util.indexOf(this.deleteCodes,b)&&(b=this.dragControl.feature)&&-1!=ALKMaps.Util.indexOf(this.vertices,b)&&!this.dragControl.handlers.drag.dragging&&b.geometry.parent)b.geometry.parent.removeComponent(b.geometry),
this.layer.events.triggerEvent("vertexremoved",{vertex:b.geometry,feature:this.feature,pixel:a.xy}),this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},collectVertices:function(){function a(c){var d,e,f;if("ALKMaps.Geometry.Point"==c.CLASS_NAME)e=new ALKMaps.Feature.Vector(c),e._sketch=!0,e.renderIntent=
b.vertexRenderIntent,b.vertices.push(e);else{f=c.components.length;"ALKMaps.Geometry.LinearRing"==c.CLASS_NAME&&(f-=1);for(d=0;d<f;++d)e=c.components[d],"ALKMaps.Geometry.Point"==e.CLASS_NAME?(e=new ALKMaps.Feature.Vector(e),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e)):a(e);if(b.createVertices&&"ALKMaps.Geometry.MultiPoint"!=c.CLASS_NAME)for(d=0,f=c.components.length;d<f-1;++d){e=c.components[d];var g=c.components[d+1];if("ALKMaps.Geometry.Point"==e.CLASS_NAME&&"ALKMaps.Geometry.Point"==
g.CLASS_NAME)e=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.Point((e.x+g.x)/2,(e.y+g.y)/2),null,b.virtualStyle),e.geometry.parent=c,e._index=d+1,e._sketch=!0,b.virtualVertices.push(e)}}}this.vertices=[];this.virtualVertices=[];var b=this;a.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:!0});this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var a=this.feature.geometry,b=a.getBounds().getCenterLonLat(),b=new ALKMaps.Geometry.Point(b.lon,
b.lat),c=new ALKMaps.Feature.Vector(b);b.move=function(b,c){ALKMaps.Geometry.Point.prototype.move.call(this,b,c);a.move(b,c)};c._sketch=!0;this.dragHandle=c;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var a=this.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=new ALKMaps.Geometry.Point(c.lon,c.lat),b=new ALKMaps.Geometry.Point(b.right,b.bottom),c=new ALKMaps.Feature.Vector(b),e=this.mode&ALKMaps.Control.ModifyFeature.RESIZE,
f=this.mode&ALKMaps.Control.ModifyFeature.RESHAPE,g=this.mode&ALKMaps.Control.ModifyFeature.ROTATE;b.move=function(b,c){ALKMaps.Geometry.Point.prototype.move.call(this,b,c);var j=this.x-d.x,k=this.y-d.y,m=j-b,l=k-c;if(g){var p=Math.atan2(l,m),p=Math.atan2(k,j)-p,p=p*(180/Math.PI);a.rotate(p,d)}if(e){var n;f?(k/=l,n=j/m/k):(m=Math.sqrt(m*m+l*l),k=Math.sqrt(j*j+k*k)/m);a.resize(k,d,n)}};c._sketch=!0;this.radiusHandle=c;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],
{silent:!0})},setMap:function(a){this.standalone||this.selectControl.setMap(a);this.dragControl.setMap(a);ALKMaps.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.ModifyFeature"});ALKMaps.Control.ModifyFeature.RESHAPE=1;ALKMaps.Control.ModifyFeature.RESIZE=2;ALKMaps.Control.ModifyFeature.ROTATE=4;ALKMaps.Control.ModifyFeature.DRAG=8;ALKMaps.Format.Text=ALKMaps.Class(ALKMaps.Format,{defaultStyle:null,extractStyles:!0,initialize:function(a){a=a||{};if(!1!==a.extractStyles)a.defaultStyle={externalGraphic:ALKMaps.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5};ALKMaps.Format.prototype.initialize.apply(this,[a])},read:function(a){for(var a=a.split("\n"),b,c=[],d=0;d<a.length-1;d++){var e=a[d].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=e.charAt(0))if(b){for(var e=e.split("\t"),
f=new ALKMaps.Geometry.Point(0,0),g={},h=this.defaultStyle?ALKMaps.Util.applyDefaults({},this.defaultStyle):null,i=!1,j=0;j<e.length;j++)if(e[j])if("point"==b[j])i=e[j].split(","),f.y=parseFloat(i[0]),f.x=parseFloat(i[1]),i=!0;else if("lat"==b[j])f.y=parseFloat(e[j]),i=!0;else if("lon"==b[j])f.x=parseFloat(e[j]),i=!0;else if("title"==b[j])g.title=e[j];else if("image"==b[j]||"icon"==b[j]&&h)h.externalGraphic=e[j];else if("iconSize"==b[j]&&h){var k=e[j].split(",");h.graphicWidth=parseFloat(k[0]);h.graphicHeight=
parseFloat(k[1])}else"iconOffset"==b[j]&&h?(k=e[j].split(","),h.graphicXOffset=parseFloat(k[0]),h.graphicYOffset=parseFloat(k[1])):"description"==b[j]?g.description=e[j]:"overflow"==b[j]?g.overflow=e[j]:g[b[j]]=e[j];i&&(this.internalProjection&&this.externalProjection&&f.transform(this.externalProjection,this.internalProjection),e=new ALKMaps.Feature.Vector(f,g,h),c.push(e))}else b=e.split("\t")}return c},CLASS_NAME:"ALKMaps.Format.Text"});ALKMaps.Lang.no={panup:"Panorer opp",panleft:"Panorer til venstre",zoomworld:"Zoom verden",panright:"Panorer til h\u00f8yre",pandown:"Panorer ned",zoomin:"Zoom inn",zoomout:"Zoom ut",dragme:"Dra meg",dragToChangeRoute:"Dra for \u00e5 endre rute",drawPoints:"Tegn punkter",clkToSetPoints:"Klikk for \u00e5 sette punkter til en linje. Dobbeltklikk for \u00e5 fullf\u00f8re.",dragToDrawLine:"Dra for \u00e5 tegne en frih\u00e5ndslinje.",dragToDrawEllipse:"Dra for \u00e5 tegne en ellipse.",dragToDrawRect:"Dra for \u00e5 tegne et rektangel.",
clkToSetPolygon:"Klikk for \u00e5 sette punkter til et polygon. Dobbeltklikk for \u00e5 fullf\u00f8re.",dragToDrawPolygon:"Dra for \u00e5 tegne et frih\u00e5ndspolygon",clkShapeToResize:"Klikk p\u00e5 en form for \u00e5 endre st\u00f8rrelse eller flytte den. Plasser mark\u00f8ren n\u00e6r et hj\u00f8rne for \u00e5 rotere.",clkShapeToModify:"Klikk p\u00e5 en form for \u00e5 endre punktene til formen. Trykk p\u00e5 Delete-knappen for \u00e5 fjerne n\u00e5r du har mark\u00f8ren p\u00e5 et punkt.",showShapeInfo:"Vis infoboks for former.",
area:"Omr\u00e5de",length:"Lengde",nodes:"Noder",perimeter:"Omkrets",location:"Plassering",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Lang["nb-NO"]=ALKMaps.Lang.no;ALKMaps.Lang["nn-NO"]=ALKMaps.Lang.no;ALKMaps.Lang.nb=ALKMaps.Lang.no;ALKMaps.Control.Pan=ALKMaps.Class(ALKMaps.Control,{slideFactor:50,slideRatio:null,direction:null,type:ALKMaps.Control.TYPE_BUTTON,initialize:function(a,b){this.direction=a;this.CLASS_NAME+=this.direction;ALKMaps.Control.prototype.initialize.apply(this,[b])},trigger:function(){var a=ALKMaps.Function.bind(function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},this);switch(this.direction){case ALKMaps.Control.Pan.NORTH:this.map.pan(0,-a("h"));break;case ALKMaps.Control.Pan.SOUTH:this.map.pan(0,
a("h"));break;case ALKMaps.Control.Pan.WEST:this.map.pan(-a("w"),0);break;case ALKMaps.Control.Pan.EAST:this.map.pan(a("w"),0)}},CLASS_NAME:"ALKMaps.Control.Pan"});ALKMaps.Control.Pan.NORTH="North";ALKMaps.Control.Pan.SOUTH="South";ALKMaps.Control.Pan.EAST="East";ALKMaps.Control.Pan.WEST="West";if(!ALKMaps.Control.ALK)ALKMaps.Control.ALK={};
ALKMaps.Control.ALK.DragFeature=ALKMaps.Class(ALKMaps.Control.DragFeature,{pointHandle:null,dragStart:!1,dragEnter:!1,initialize:function(a,b){ALKMaps.Control.DragFeature.prototype.initialize.apply(this,arguments)},geometryTypes:["ALKMaps.Geometry.Point"],onComplete:function(a){this.dragEnter=this.dragStart=!1;null!=a.attributes.routeId&&(this.map.showLoading(),this.outFeature(a),this.dragComplete(a))},overFeature:function(a){var b=a;if(null!=a.attributes.routeId){var c=this.layer.getRouteOptions(a.attributes.routeId);
null!=c.routeOptions&&(!0===c.routeOptions.hubRouting?b=null:!0===c.routeOptions.useAllPoints&&!0===this.layer.disableStopDrag&&!0===this.layer.isDraggable&&null!=a.attributes&&0<=a.attributes.stopLocationIndex&&!0!=a.attributes.isViaPoint&&(b=null))}return ALKMaps.Control.DragFeature.prototype.overFeature.call(this,b)},onEnter:function(){this.dragEnter=!0},onLeave:function(){this.dragEnter=this.dragStart=!1;this.pointHandle&&this.layer.removeFeatures([this.pointHandle],{silent:!0})},onStart:function(){this.dragStart=
!0},activate:function(){if(this.active)return!1;this.map.events.register("mousemove",this,this.onMousemove);return ALKMaps.Control.DragFeature.prototype.activate.apply(this,arguments)},deactivate:function(){return this.active?(this.map.events.unregister("mousemove",this,this.onMousemove),ALKMaps.Control.DragFeature.prototype.deactivate.apply(this,arguments)):!1},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);ALKMaps.Control.DragFeature.prototype.setMap.apply(this,
arguments)},dragComplete:function(a){var b=this.layer.getGeometry(a),c=a.attributes.routeId,d=this.layer.getRouteOptions(c),e=d.routeOptions;if(null==e.region&&null!=this.map.baseLayer&&null!=this.map.baseLayer.params&&null!=this.map.baseLayer.params.REGION)e.region=this.map.baseLayer.params.REGION;var f=this;if(!0===d.routeOptions.includeVehicleRestrictedCleanupPoints||!0===d.routeOptions.useAllPoints){for(var g=this._getHandles(a),h=[],i=0;i<d.stops.length;i++){var j=d.stops[i].clone();h.push(j)}b=
new ALKMaps.LonLat(b[0],b[1]);for(i=0;i<g.length;i++)if(j=g[i],a.attributes.featureIds[0]===a.attributes.featureIds[1]){if(j.attributes.featureIds[1]===a.attributes.featureIds[1]){if(!0===d.routeOptions.useAllPoints)b=ALKMaps.StopLocation.fromLonLat(b),b.isViaPoint=!0;h.splice(i+1,0,b)}}else if(j.attributes.featureIds[0]===a.attributes.featureIds[0]&&j.attributes.featureIds[1]===a.attributes.featureIds[1])!0===d.routeOptions.useAllPoints?h[i].lonLat=b:h[i]=b;this.layer.getRouteLegPoints({stops:h,
routeOptions:d.routeOptions,reportOptions:d.reportOptions,functionOptions:d.functionOptions,interactiveOptions:{callback:function(a){f.onRouteModified(a);f.dragStart=!1}}},!1,!0)}else{var k=this.layer.getHandleAction(a),m;switch(k){case "RB":h=this.layer.getNextHandle(a);g=this.layer.getGeometry(h);g=[b,g];b=this.layer.getNodes(a);m=[b[1]];break;case "RI":g=this.layer.getPreviousHandle(a);g=this.layer.getGeometry(g);h=this.layer.getNextHandle(a);h=this.layer.getGeometry(h);g=[g,b,h];m=this.layer.getNodes(a);
break;case "RM":g=this.layer.getPreviousHandle(a);g=this.layer.getGeometry(g);h=this.layer.getNextHandle(a);h=this.layer.getGeometry(h);g=[g,b,h];b=this.layer.getNodes(a);m=[b[0]];break;default:g=this.layer.getPreviousHandle(a),g=this.layer.getGeometry(g),g=[g,b],b=this.layer.getNodes(a),m=[b[0]]}for(var l=d.reportOptions,p=d.functionOptions.style,h="",i=0;i<g.length;i++)b=new ALKMaps.LonLat(g[i][0],g[i][1]),b=b.clone().transform(this.map.getProjectionObject(),new ALKMaps.Projection("EPSG:4326")),
j=[],j.push(b.lon),j.push(b.lat),h+=j+";";var b=h.substring(0,h.length-1),n=!0;if(void 0!==d.functionOptions.showHandles)n=d.functionOptions.showHandles;ALKMaps.Services.getRoutePath({stops:b,options:e,async:d.functionOptions.async,success:function(b){function g(a){f.map.hideLoading();f.onRouteModified({routeId:c,report:a,stops:J});f.dragStart=!1}function h(a){f.map.hideLoading();if(f.onErrorRouteModification&&"function"===typeof f.onErrorRouteModification)f.onErrorRouteModification(a);else if(a.responseText){for(var b=
JSON.parse(a.responseText),c="",d=0;d<b.length;d++)c=c+b[d].Description+"\n\n";alert(a.status+" "+a.statusText+"\n\n"+c)}}var b=JSON.parse(b.responseText),b=(new ALKMaps.Format.GeoJSON({externalProjection:new ALKMaps.Projection("EPSG:4326"),internalProjection:f.map.getProjectionObject()})).read(b),i=b[0].attributes;if(!0===d.routeOptions.includeplids&&void 0!==i&&null!==i)var j=i.plids;for(var b=b[0].geometry.components,i=[],u,y=0;y<b.length;y++){var v=b[y],E,B,H,F=f.layer._getRouteSimplifyLevel();
"ALKMaps.Renderer.SVG"===f.layer.renderer.CLASS_NAME&&(E=v.clone(),B=v.simplify(0.01),H=v.simplify(0.001),0.01===F?v=B:0.001===F&&(v=H));var K=v.components[v.components.length-1];ALKMaps.Util.extend(p,{fullGeometry:E,simpleGeometry:B,mediumGeometry:H,currentSimplifyLevel:F});v=new ALKMaps.Feature.Vector(v,p);v.attributes.routeId=c;if(j&&0<j.length)v.plids=j[y];"RM"===k?(F=f.layer.getDragHandleFromNode(m[0]),0===y?(u=f.layer.addRouteDragHandle("RI",[K.x,K.y],n),u.attributes.featureIds=[],v.attributes.handleIds=
[F[y].id,u.id],F[y].attributes.featureIds[1]=v.id):(v.attributes.handleIds=[u.id,F[y].id],F[y].attributes.featureIds[0]=v.id),u.attributes.featureIds.push(v.id)):f.layer.updateNode(m[y],v);i.push(v)}f.layer.addFeatures(i);f.layer.destroyFeatures(m,{silent:!0});if(u){u.attributes.routeId=c;if(null!=d.functionOptions.handleSvg)j=d.functionOptions.handleSvg,u.attributes.svg={content:j.content,size:j.size,offset:j.offset};f.layer.addFeatures([u])}j=f.layer.features;E=[];for(B=0;B<j.length;B++)j[B].attributes.routeId===
c&&j[B].geometry instanceof ALKMaps.Geometry.Point&&E.push(j[B]);f.layer.removeFeatures(E,{silent:!0});f.layer.addFeatures(E,{silent:!0});f.layer.redraw();u="RM"===k?f.getStops(u,!0):f.getStops(a,!0);for(var J=[],j=0;j<u.length;j++)E=(new ALKMaps.Geometry.Point(u[j][0],u[j][1])).transform(new ALKMaps.Projection("EPSG:4326"),f.map.getProjectionObject()),J.push(E.clone());l?ALKMaps.Services.getReports({coords:u,options:e,reportOptions:l,success:g,failure:h}):g(null)},failure:function(a){f.map.hideLoading();
f.dragStart=!1;if(f.onErrorRouteModification&&"function"===typeof f.onErrorRouteModification)f.onErrorRouteModification(a);else alert(a.status+"\n"+a.statusText+"\n "+a.responseText)}})}},_getHandles:function(a){if(!this.layer.isStartHandle(a)){for(var b=this.layer.getPreviousHandle(a);!this.layer.isStartHandle(b);)b=this.layer.getPreviousHandle(b);a=b}b=[];b.push(a);a=this.layer.getNextHandle(a);for(b.push(a);!this.layer.isEndHandle(a);)a=this.layer.getNextHandle(a),b.push(a);return b},getStops:function(a,
b){if(!this.layer.isStartHandle(a)){for(var c=this.layer.getPreviousHandle(a);!this.layer.isStartHandle(c);)c=this.layer.getPreviousHandle(c);a=c}var c=[],d;if(!0===b){var e=this.map.getProjectionObject(),f=new ALKMaps.Projection("EPSG:4326");d=a.geometry.clone().transform(e,f);c.push([d.x,d.y]);d=this.layer.getNextHandle(a);var g=d.geometry.clone().transform(e,f);for(c.push([g.x,g.y]);!this.layer.isEndHandle(d);)d=this.layer.getNextHandle(d),g=d.geometry.clone().transform(e,f),c.push([g.x,g.y])}else{c.push([a.geometry.x,
a.geometry.y]);d=this.layer.getNextHandle(a);for(c.push([d.geometry.x,d.geometry.y]);!this.layer.isEndHandle(d);)d=this.layer.getNextHandle(d),c.push([d.geometry.x,d.geometry.y])}return c},onRouteModified:function(){},onErrorRouteModification:null,_hitTestStop:function(a,b,c){if(!0===this.layer.disableStopDrag&&!0===this.layer.isDraggable){for(var d=this.layer.features,e=null,f=0;f<d.length;f++){var g=d[f];if(null!=g.attributes&&g.attributes.routeId===c&&0<=g.attributes.stopLocationIndex&&!0!=g.attributes.isViaPoint)g=
g.geometry.distanceTo(a,{details:!0}).distance,null===e&&(e=g),g<e&&(e=g)}if(null!==e&&e<2*b)return!0}return!1},onMousemove:function(a){if(!(!0===this.dragEnter||!0===this.dragStart))for(var a=this.map.getLonLatFromPixel(a.xy),a=new ALKMaps.Geometry.Point(a.lon,a.lat),b=this.layer.features,c=0;c<b.length;c++){var d=b[c];if(!(null!=d.attributes&&!0===d.attributes.vehicleRestrictedCleanupPoints)&&!(null!=d.geometry&&null!=d.geometry.components&&0===d.geometry.components.length)){var e=d.geometry.distanceTo(a,
{details:!0}),f=e.distance,g=12*this.map.getResolution();if(f<g){this.pointHandle&&this.layer.removeFeatures([this.pointHandle],{silent:!0});var f=d.attributes.routeId,h=this.layer.getRouteOptions(f);if(null!=h.routeOptions&&(!0===h.routeOptions.hubRouting||!0===d.attributes.vehicleRestrictedCleanupPoints))break;e=new ALKMaps.Geometry.Point(e.x0,e.y0);if(!1===this._hitTestStop(e,g,f)){this.pointHandle=new ALKMaps.Feature.Vector(e,{routeId:f},{pointRadius:6,fillOpacity:1,fillColor:"#00ffff",strokeOpacity:1,
strokeColor:"#000000",strokeWidth:1,labelXOffset:0,labelYOffset:-20,label:ALKMaps.i18n("dragToChangeRoute")});this.pointHandle.attributes.featureIds=[d.id,d.id];this.layer.addFeatures([this.pointHandle]);break}}else!1===this.dragStart&&this.pointHandle&&this.layer.removeFeatures([this.pointHandle],{silent:!0})}}},CLASS_NAME:"ALKMaps.Control.ALK.DragFeature"});ALKMaps.Control.CacheWrite=ALKMaps.Class(ALKMaps.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,cacheBlackImage:!0,setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0<=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.cache,scope:this})},removeLayer:function(a){a.layer.events.un({tileloadstart:this.makeSameOrigin,
tileloaded:this.cache,scope:this})},makeSameOrigin:function(a){if(this.active&&(a=a.tile,a instanceof ALKMaps.Tile.Image&&!a.crossOriginKeyword&&"data:"!==a.url.substr(0,5))){var b=ALKMaps.Request.makeSameOrigin(a.url,ALKMaps.ProxyHost);ALKMaps.Control.CacheWrite.urlMap[b]=a.url;a.url=b}},isBlackImageTile:function(a,b){for(var c=a.getImageData(0,0,b.size.w,b.size.h),d=!0,e=0;e<c.data.length;e++)0!==c.data[e]&&(d=!1);return d},cache:function(a){if(this.active&&window.localStorage&&(a=a.tile,a instanceof
ALKMaps.Tile.Image&&"data:"!==a.url.substr(0,5)))try{var b=a.getCanvasContext();if(b){var c=!0;!1===this.cacheBlackImage&&!0===this.isBlackImageTile(b,a)&&(c=!1);if(!0===c){var d=ALKMaps.Control.CacheWrite.urlMap;window.localStorage.setItem("olCache_"+(d[a.url]||a.url),b.canvas.toDataURL(this.imageFormat));delete d[a.url]}}}catch(e){(b=e.name||e.message)&&this.quotaRegEx.test(b)?this.events.triggerEvent("cachefull",{tile:a}):ALKMaps.Console.error(e.toString())}},destroy:function(){if(this.layers||
this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0<=a;--a)this.removeLayer({layer:b[a]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});ALKMaps.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.CacheWrite"});ALKMaps.Control.CacheWrite.clearCache=function(){if(window.localStorage){var a,b;for(a=window.localStorage.length-1;0<=a;--a)b=window.localStorage.key(a),"olCache_"===b.substr(0,8)&&window.localStorage.removeItem(b)}};
ALKMaps.Control.CacheWrite.urlMap={};ALKMaps.Kinetic=ALKMaps.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(a){ALKMaps.Util.extend(this,a)},begin:function(){ALKMaps.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(a){for(var b,c=(new Date).getTime(),d=0,e=this.points.length,f;d<e;d++){f=this.points[d];if(c-f.tick>this.delay)break;
b=f}if(b&&(d=(new Date).getTime()-b.tick,c=Math.sqrt(Math.pow(a.x-b.xy.x,2)+Math.pow(a.y-b.xy.y,2)),d=c/d,!(0==d||d<this.threshold)))return c=Math.asin((a.y-b.xy.y)/c),b.xy.x<=a.x&&(c=Math.PI-c),{speed:d,theta:c}},move:function(a,b){var c=a.speed,d=Math.cos(a.theta),e=-Math.sin(a.theta),f=(new Date).getTime(),g=0,h=0;this.timerId=ALKMaps.Animation.start(ALKMaps.Function.bind(function(){if(null!=this.timerId){var a=(new Date).getTime()-f,j=-this.deceleration*Math.pow(a,2)/2+c*a,k=j*d,j=j*e,m,l;m=!1;
if(0>=-this.deceleration*a+c)ALKMaps.Animation.stop(this.timerId),this.timerId=null,m=!0;a=k-g;l=j-h;g=k;h=j;b(a,l,m)}},this))},CLASS_NAME:"ALKMaps.Kinetic"});(function(a){a.WeatherAlertColor=a.WeatherAlertColor||{"911 Telephone Outage":"#C0C0C0","Administrative Message":"#FFFFFF","Air Quality Alert":"#808080","Air Stagnation Advisory":"#808080","Arroyo and Small Stream Flood Advisory":"#00FF7F","Ashfall Advisory":"#696969","Ashfall Warning":"#A9A9A9","Avalanche Advisory":"#CD853F","Avalanche Warning":"#1E90FF","Avalanche Watch":"#F4A460","Beach Hazards Statement":"#40E0D0","Blizzard Warning":"#FF4500","Blizzard Watch":"#ADFF2F","Blowing Dust Advisory":"#BDB76B",
"Brisk Wind Advisory":"#D8BFD8","Child Abduction Emergency":"#FFD700","Civil Danger Warning":"#FFB6C1","Civil Emergency Message":"#FFB6C1","Coastal Flood Advisory":"#7CFC00","Coastal Flood Statement":"#6B8E23","Coastal Flood Warning":"#228B22","Coastal Flood Watch":"#66CDAA","Dense Fog Advisory":"#708090","Dense Smoke Advisory":"#F0E68C","Dust Storm Warning":"#FFE4C4","Earthquake Warning":"#8B4513","Evacuation - Immediate":"#7FFF00","Excessive Heat Warning":"#C71585","Excessive Heat Watch":"#800000",
"Extreme Cold Warning":"#0000FF","Extreme Cold Watch":"#0000FF","Extreme Fire Danger":"#E9967A","Extreme Wind Warning":"#FF8C00","Fire Warning":"#A0522D","Fire Weather Watch":"#FFDEAD","Flash Flood Statement":"#8B0000","Flash Flood Warning":"#8B0000","Flash Flood Watch":"#2E8B57","Flood Advisory":"#00FF7F","Flood Statement":"#00FF00","Flood Warning":"#00FF00","Flood Watch":"#2E8B57","Freeze Warning":"#00FFFF","Freeze Watch":"#041690","Freezing Fog Advisory":"#008080","Freezing Rain Advisory":"#DA70D6",
"Freezing Spray Advisory":"#00BFFF","Frost Advisory":"#6495ED","Gale Warning":"#DDA0DD","Gale Watch":"#FFC0CB","Hard Freeze Warning":"#9400D3","Hard Freeze Watch":"#4169E1","Hazardous Materials Warning":"#4B0082","Hazardous Seas Warning":"#D8BFD8","Hazardous Seas Watch":"#483D8B","Hazardous Weather Outlook":"#EEE8AA","Heat Advisory":"#FF7F50","Heavy Freezing Spray Warning":"#00BFFF","Heavy Freezing Spray Watch":"#BC8F8F","High Surf Advisory":"#BA55D3","High Surf Warning":"#228B22","High Wind Warning":"#DAA520",
"High Wind Watch":"#B8860B","Hurricane Force Wind Warning":"#CD5C5C","Hurricane Force Wind Watch":"#9932CC","Hurricane Local Statement":"#FFE4B5","Hurricane Warning":"#DC143C","Hurricane Watch":"#FF00FF","Hydrologic Advisory":"#00FF7F","Hydrologic Outlook":"#90EE90","Ice Storm Warning":"#8B008B","Lake Effect Snow Advisory":"#48D1CC","Lake Effect Snow Warning":"#008B8B","Lake Effect Snow Watch":"#87CEFA","Lake Wind Advisory":"#D2B48C","Lakeshore Flood Advisory":"#7CFC00","Lakeshore Flood Statement":"#6B8E23",
"Lakeshore Flood Warning":"#228B22","Lakeshore Flood Watch":"#66CDAA","Law Enforcement Warning":"#C0C0C0","Local Area Emergency":"#C0C0C0","Low Water Advisory":"#A52A2A","Marine Weather Statement":"#FFDAB9","Nuclear Power Plant Warning":"#4B0082","Radiological Hazard Warning":"#4B0082","Red Flag Warning":"#FF1493","Rip Current Statement":"#40E0D0","Severe Thunderstorm Warning":"#FFA500","Severe Thunderstorm Watch":"#DB7093","Severe Weather Statement":"#00FFFF","Shelter In Place Warning":"#FA8072",
"Short Term Forecast":"#98FB98","Small Craft Advisory":"#D8BFD8","Small Craft Advisory For Hazardous Seas":"#D8BFD8","Small Craft Advisory For Rough Bar":"#D8BFD8","Small Craft Advisory For Winds":"#D8BFD8","Small Stream Flood Advisory":"#00FF7F","Special Marine Warning":"#FFA500","Special Weather Statement":"#FFE4B5","Storm Warning":"#9400D3","Storm Watch":"#FFE4B5",Test:"#F0FFFF","Tornado Warning":"#FF0000","Tornado Watch":"#FFFF00","Tropical Depression Local Statement":"#FFE4B5","Tropical Storm Local Statement":"#FFE4B5",
"Tropical Storm Warning":"#B22222","Tropical Storm Watch":"#F08080","Tsunami Advisory":"#D2691E","Tsunami Warning":"#FD6347","Tsunami Watch":"#FF00FF","Typhoon Local Statement":"#FFE4B5","Typhoon Warning":"#DC143C","Typhoon Watch":"#FF00FF","Urban and Small Stream Flood Advisory":"#00FF7F","Volcano Warning":"#2F4F4F","Wind Advisory":"#D2B48C","Wind Chill Advisory":"#AFEEEE","Wind Chill Warning":"#B0C4DE","Wind Chill Watch":"#5F9EA0","Winter Storm Warning":"#FF69B4","Winter Storm Watch":"#4682B4",
"Winter Weather Advisory":"#7B68EE","Storm Surge Warning":"#DC143C","Storm Surge Watch":"#FF00FF","blowing snow":"#008B8B",blizzard:"#FF4500",dustStorm:"#BDB76B",freezeRain:"#DA70D6","freezing drizzle":"#DA70D6",frost:"#6495ED",heat:"#FF7F50",hurricane:"#DC143C",rainfall:"#8B0000",snowfall:"#48D1CC","Test Message":"#F0FFFF",thunderstorm:"#FFA500",tornado:"#FF0000","tropical storm":"#B22222",weather:"#FFE4B5",wind:"#D2B48C",windchill:"#AFEEEE",winterStorm:"#FF69B4","Storm Surge":"#DC143C"}})(ALKMaps);(function(a){if(a){var b=a.ALKMaps.Control;b.WeatherAlertLegend=a.Control.extend({_allAlerts:[],_timeoutId:null,_onChkBoxClick:function(){null!=this._timeoutId&&window.clearTimeout(this._timeoutId);var b=this;b._timeoutId=window.setTimeout(function(){for(var d=[],e=0;e<b._allAlerts.length;e++){var f=b._allAlerts[e];!0===a.DomUtil.get("legendItemCheckbox_"+f.event).checked&&d.push(f.event)}e=b.options.layer.getAlertFilters();e.eventNames=d;b.options.layer.setAlertFilters(e);b.options.layer.redraw()},
1E3)},_tickCheckBox:function(a){var b=this.options.layer.getAlertFilters().eventNames,e="";if(0===b.length)e="checked";else{for(var f=!1,g=0;g<b.length;g++)if(b[g].toUpperCase()===a.toUpperCase()){f=!0;break}!0===f&&(e="checked")}return e},_weatherAlertsAdded:function(b,d){this._allAlerts=b.alerts||[];for(var e=0;e<b.alerts.length;e++){var f=b.alerts[e],g=a.DomUtil.create("div","",d);g.id="legendItem_"+f.event;var h=a.DomUtil.create("input","",g);h.type="checkbox";h.name=f.event;h.checked=this._tickCheckBox(f.event);
h.value=f.color;h.id="legendItemCheckbox_"+f.event;a.DomUtil.create("label","",g).innerHTML=f.event;a.DomEvent.on(h,"click",this._onChkBoxClick,this)}},_updateLegendStyle:function(b){if(0<this._allAlerts.length){for(var d=[],e=0;e<this._allAlerts.length;e++){var f=!1;if(0<b.length)for(var g=0;g<b.length;g++)if(b[g].event===this._allAlerts[e].event){f=!0;break}d.push(f)}for(b=0;b<this._allAlerts.length;b++)e=this._allAlerts[b],f=a.DomUtil.get("legendItem_"+e.event),g=a.ALKMaps.Util.hexToRgb(e.color),
!0===d[b]?(f.style.borderColor=e.color,f.style.backgroundColor="rgba("+g.r+","+g.g+","+g.b+",0.2)"):(f.style.borderColor="rgba("+g.r+","+g.g+","+g.b+",0)",f.style.backgroundColor="rgba("+g.r+","+g.g+","+g.b+",0)")}},onAdd:function(b){this._map=b;var d=a.DomUtil.create("div","alkmaps-controlWeatherAlertLegend"),e=a.DomUtil.create("div","alkmaps-controlWeatherAlertLegend-header",d);a.DomUtil.create("h3","title",e).innerText="NWS Alerts";var f=a.DomUtil.create("div","alkmaps-controlWeatherAlertLegend-body",
d);d.style.display="none";a.DomEvent.on(d,"click",function(){});a.DomEvent.disableClickPropagation(d);if(null!=this.options.layer){var g=this;this.options.layer.on("weatherAlertsAdded",function(a){f.innerHTML="";g._weatherAlertsAdded(a,f);a=g.options.layer.getAlerts();g._updateLegendStyle(a);d.style.display=""});this.options.layer.on("weatherAlertsRedrawn",function(a){g._updateLegendStyle(a.alerts)});b.on("moveend",function(){var a=g.options.layer.getAlerts();g._updateLegendStyle(a)})}return d},onRemove:function(){},
CLASS_NAME:"ALKMaps.Control.WeatherAlertLegend"});b.weatherAlertLegend=function(a){return new b.WeatherAlertLegend(a)}}})("undefined"===typeof L?null:L);ALKMaps.Filter.Function=ALKMaps.Class(ALKMaps.Filter,{name:null,params:null,CLASS_NAME:"ALKMaps.Filter.Function"});ALKMaps.Layer.PointGrid=ALKMaps.Class(ALKMaps.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(a){a=a||{};ALKMaps.Layer.Vector.prototype.initialize.apply(this,[a.name,a])},setMap:function(a){ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments);a.events.register("moveend",this,this.onMoveEnd)},removeMap:function(a){a.events.unregister("moveend",this,this.onMoveEnd);ALKMaps.Layer.Vector.prototype.removeMap.apply(this,arguments)},
setRatio:function(a){this.ratio=a;this.updateGrid(!0)},setMaxFeatures:function(a){this.maxFeatures=a;this.updateGrid(!0)},setSpacing:function(a,b){this.dx=a;this.dy=b||a;this.updateGrid(!0)},setOrigin:function(a){this.origin=a;this.updateGrid(!0)},getOrigin:function(){if(!this.origin)this.origin=this.map.getExtent().getCenterLonLat();return this.origin},setRotation:function(a){this.rotation=a;this.updateGrid(!0)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var a=this.map.getExtent();
if(this.rotation){var b=this.getOrigin(),b=new ALKMaps.Geometry.Point(b.lon,b.lat),a=a.toGeometry();a.rotate(-this.rotation,b);a=a.getBounds()}return a},updateGrid:function(a){if(a||this.invalidBounds()){var b=this.getViewBounds(),c=this.getOrigin(),a=new ALKMaps.Geometry.Point(c.lon,c.lat),d=b.getWidth(),e=b.getHeight(),f=d/e,g=Math.sqrt(this.dx*this.dy*this.maxFeatures/f),d=Math.min(d*this.ratio,g*f),e=Math.min(e*this.ratio,g),b=b.getCenterLonLat();this.gridBounds=new ALKMaps.Bounds(b.lon-d/2,b.lat-
e/2,b.lon+d/2,b.lat+e/2);for(var b=Math.floor(e/this.dy),d=Math.floor(d/this.dx),e=c.lon+this.dx*Math.ceil((this.gridBounds.left-c.lon)/this.dx),c=c.lat+this.dy*Math.ceil((this.gridBounds.bottom-c.lat)/this.dy),g=Array(b*d),h,i=0;i<d;++i)for(var f=e+i*this.dx,j=0;j<b;++j)h=c+j*this.dy,h=new ALKMaps.Geometry.Point(f,h),this.rotation&&h.rotate(this.rotation,a),g[i*b+j]=new ALKMaps.Feature.Vector(h);this.destroyFeatures(this.features,{silent:!0});this.addFeatures(g,{silent:!0})}},invalidBounds:function(){return!this.gridBounds||
!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"ALKMaps.Layer.PointGrid"});ALKMaps.Lang.fr=ALKMaps.Util.applyDefaults({unhandledRequest:"Requ\u00eate non g\u00e9r\u00e9e, retournant ${statusText}",Permalink:"Permalien",Overlays:"Calques","Base Layer":"Calque de base",readNotImplemented:"Lecture non impl\u00e9ment\u00e9e.",writeNotImplemented:"Ecriture non impl\u00e9ment\u00e9e.",noFID:"Impossible de mettre \u00e0 jour un objet sans identifiant (fid).",errorLoadingGML:"Erreur au chargement du fichier GML ${url}",browserNotSupported:"Votre navigateur ne supporte pas le rendu vectoriel. Les renderers actuellement support\u00e9s sont : \n${renderers}",
componentShouldBe:"addFeatures : le composant devrait \u00eatre de type ${geomType}",getFeatureError:"getFeatureFromEvent a \u00e9t\u00e9 appel\u00e9 sur un calque sans renderer. Cela signifie g\u00e9n\u00e9ralement que vous avez d\u00e9truit cette couche, mais que vous avez conserv\u00e9 un handler qui lui \u00e9tait associ\u00e9.",minZoomLevelError:"La propri\u00e9t\u00e9 minZoomLevel doit seulement \u00eatre utilis\u00e9e pour des couches FixedZoomLevels-descendent. Le fait que cette couche WFS v\u00e9rifie la pr\u00e9sence de minZoomLevel est une relique du pass\u00e9. Nous ne pouvons toutefois la supprimer sans casser des applications qui pourraient en d\u00e9pendre. C'est pourquoi nous la d\u00e9pr\u00e9cions -- la v\u00e9rification du minZoomLevel sera supprim\u00e9e en version 3.0. A la place, merci d'utiliser les param\u00e8tres de r\u00e9solutions min/max tel que d\u00e9crit sur : http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"Transaction WFS : SUCCES ${response}",commitFailed:"Transaction WFS : ECHEC ${response}",googleWarning:"La couche Google n'a pas \u00e9t\u00e9 en mesure de se charger correctement.<br><br>Pour supprimer ce message, choisissez une nouvelle BaseLayer dans le s\u00e9lecteur de couche en haut \u00e0 droite.<br><br>Cela est possiblement caus\u00e9 par la non-inclusion de la librairie Google Maps, ou alors parce que la cl\u00e9 de l'API ne correspond pas \u00e0 votre site.<br><br>D\u00e9veloppeurs : pour savoir comment corriger ceci, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>cliquez ici</a>",
getLayerWarning:"La couche ${layerType} n'est pas en mesure de se charger correctement.<br><br>Pour supprimer ce message, choisissez une nouvelle BaseLayer dans le s\u00e9lecteur de couche en haut \u00e0 droite.<br><br>Cela est possiblement caus\u00e9 par la non-inclusion de la librairie ${layerLib}.<br><br>D\u00e9veloppeurs : pour savoir comment corriger ceci, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>cliquez ici</a>","Scale = 1 : ${scaleDenom}":"Echelle ~ 1 : ${scaleDenom}",
W:"O",E:"E",N:"N",S:"S",layerAlreadyAdded:"Vous avez essay\u00e9 d'ajouter \u00e0 la carte le calque : ${layerName}, mais il est d\u00e9j\u00e0 pr\u00e9sent",reprojectDeprecated:"Vous utilisez l'option 'reproject' sur la couche ${layerName}. Cette option est d\u00e9pr\u00e9ci\u00e9e : Son usage permettait d'afficher des donn\u00e9es au dessus de couches raster commerciales.Cette fonctionalit\u00e9 est maintenant support\u00e9e en utilisant le support de la projection Mercator Sph\u00e9rique. Plus d'information est disponible sur http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"Cette m\u00e9thode est d\u00e9pr\u00e9ci\u00e9e, et sera supprim\u00e9e \u00e0 la version 3.0. Merci d'utiliser ${newMethod} \u00e0 la place.",boundsAddError:"Vous devez passer les deux valeurs x et y \u00e0 la fonction add.",lonlatAddError:"Vous devez passer les deux valeurs lon et lat \u00e0 la fonction add.",pixelAddError:"Vous devez passer les deux valeurs x et y \u00e0 la fonction add.",unsupportedGeometryType:"Type de g\u00e9om\u00e9trie non support\u00e9 : ${geomType}",filterEvaluateNotImplemented:"\u00e9valuer n'a pas encore \u00e9t\u00e9 impl\u00e9ment\u00e9 pour ce type de filtre.",
proxyNeeded:"Vous avez tr\u00e8s probablement besoin de renseigner ALKMaps.ProxyHost pour acc\u00e9der \u00e0 ${url}. Voir http://trac.osgeo.org/openlayers/wiki/FrequentlyAskedQuestions#ProxyHost",panup:"Panoramique vers le haut",panleft:"Panoramique \u00e0 gauche",zoomworld:"Zoom monde",panright:"Panoramique \u00e0 droite",pandown:"Panormaique vers le bas",zoomin:"Zoom avant",zoomout:"Zoom arri\u00e8re",dragme:"Me glisser-d\u00e9placer",dragToChangeRoute:"Glisser-d\u00e9placer pour changer la route",
drawPoints:"Tracer des points",clkToSetPoints:"Cliquer pour d\u00e9finir des points pour une ligne. Double-cliquer pour terminer.",dragToDrawLine:"Glisser-d\u00e9placer pour tracer une ligne \u00e0 main lev\u00e9e.",dragToDrawEllipse:"Glisser-d\u00e9placer pour tracer un ellipse.",dragToDrawRect:"Glisser-d\u00e9placer pour tracer un rectangle.",clkToSetPolygon:"Cliquer pour d\u00e9finir des points pour une ligne. Double-cliquer pour terminer.",dragToDrawPolygon:"D\u00e9placer pour tracer un polygone \u00e0 main lev\u00e9e.",
clkShapeToResize:"Cliquer sur une forme pour redimensionner ou d\u00e9placer. Positionner le curseur pr\u00e8s d'un coint pour pivoter.",clkShapeToModify:"Cliquer sur une forme pour modifier les points de forme. Avec le curseur sur un point appuyer sur la touche Supprimer pour supprimer.",showShapeInfo:"Afficher la case d'info de forme.",area:"Superficie",length:"Longueur",nodes:"Noeuds",perimeter:"P\u00e9rim\u00e8tre",location:"Position",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",
prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Tile=ALKMaps.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,b,c,d,e,f){this.layer=a;this.position=b.clone();this.setBounds(c);this.url=d;if(e)this.size=e.clone();this.id=ALKMaps.Util.createUniqueID("Tile_");ALKMaps.Util.extend(this,f);this.events=new ALKMaps.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)},unload:function(){if(this.isLoading)this.isLoading=!1,
this.events.triggerEvent("unload")},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var b=this.shouldDraw();b&&!a&&(b=!1!==this.events.triggerEvent("beforedraw"));return b},shouldDraw:function(){var a=!1,b=this.layer.maxExtent;if(b){var c=this.layer.map,c=c.baseLayer.wrapDateLine&&c.getMaxExtent();this.bounds.intersectsBounds(b,
{inclusive:!1,worldBounds:c})&&(a=!0)}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine)var b=this.layer.map.getMaxExtent(),c=this.layer.map.getResolution(),a=a.wrapDateLine(b,{leftTolerance:c,rightTolerance:c});this.bounds=a},moveTo:function(a,b,c){null==c&&(c=!0);this.setBounds(a);this.position=b.clone();c&&this.draw()},clear:function(){},CLASS_NAME:"ALKMaps.Tile"});ALKMaps.Tile.Image=ALKMaps.Class(ALKMaps.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,b,c,d,e,f){ALKMaps.Tile.prototype.initialize.apply(this,arguments);this.url=d;this.layerAlphaHack=this.layer.alpha&&ALKMaps.Util.alphaHack();if(null!=this.maxGetUrlLength||this.layer.gutter||
this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden";null!=this.maxGetUrlLength&&ALKMaps.Util.extend(this,ALKMaps.Tile.Image.IFrame)},destroy:function(){if(this.imgDiv)this.clear(),this.frame=this.imgDiv=null;this.asyncRequestId=null;ALKMaps.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=ALKMaps.Tile.prototype.draw.apply(this,arguments);if(a){if(this.layer!=this.layer.map.baseLayer&&this.layer.reproject)this.bounds=
this.getBoundsFromBaseLayer(this.position);this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart");this.positionTile();this.renderTile()}else this.unload();return a},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(b){if(a==this.asyncRequestId)this.url=b,this.initImage()},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},
positionTile:function(){var a=this.getTile().style,b=this.frame?this.size:this.layer.getImageSize(this.bounds);a.left=this.position.x+"%";a.top=this.position.y+"%";a.width=b.w+"%";a.height=b.h+"%"},clear:function(){ALKMaps.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){ALKMaps.Event.stopObservingElement(a);var b=this.getTile();b.parentNode===this.layer.div&&this.layer.div.removeChild(b);this.setImgSrc();if(!0===this.layerAlphaHack)a.style.filter="";ALKMaps.Element.removeClass(a,
"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img");this.imgDiv.className="olTileImage";this.imgDiv.galleryImg="no";var a=this.imgDiv.style;if(this.frame){var b=0,c=0;this.layer.gutter&&(b=100*(this.layer.gutter/this.layer.tileSize.w),c=100*(this.layer.gutter/this.layer.tileSize.h));a.left=-b+"%";a.top=-c+"%";a.width=2*b+100+"%";a.height=2*c+100+"%"}a.visibility="hidden";a.opacity=0;if(1>this.layer.opacity)a.filter="alpha(opacity="+
100*this.layer.opacity+")";a.position="absolute";if(this.layerAlphaHack)a.paddingTop=a.height,a.height="0",a.width="100%";this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var a=this.getImage();if(this.url&&a.getAttribute("src")==this.url)this.onImageLoad();else{var b=ALKMaps.Function.bind(function(){ALKMaps.Event.stopObservingElement(a);ALKMaps.Event.observe(a,"load",ALKMaps.Function.bind(this.onImageLoad,this));ALKMaps.Event.observe(a,
"error",ALKMaps.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)},this);a.getAttribute("src")==this.blankImageUrl?b():(ALKMaps.Event.observe(a,"load",b),ALKMaps.Event.observe(a,"error",b),this.crossOriginKeyword&&a.removeAttribute("crossorigin"),a.src=this.blankImageUrl)}},setImgSrc:function(a){var b=this.imgDiv;b.style.visibility="hidden";b.style.opacity=0;if(a)this.crossOriginKeyword&&("data:"!==a.substr(0,5)?b.setAttribute("crossorigin",this.crossOriginKeyword):
b.removeAttribute("crossorigin")),b.src=a},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var a;this.frame?(a=this.frame.cloneNode(!1),a.appendChild(this.imgDiv)):a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;ALKMaps.Event.stopObservingElement(a);a.style.visibility="inherit";a.style.opacity=this.layer.opacity;this.isLoading=!1;this.canvasContext=null;this.events.triggerEvent("loadend");
if(7>parseFloat(navigator.appVersion.split("MSIE")[1])&&this.layer&&this.layer.div){var b=document.createElement("span");b.style.display="none";var c=this.layer.div;c.appendChild(b);window.setTimeout(function(){b.parentNode===c&&b.parentNode.removeChild(b)},0)}if(!0===this.layerAlphaHack)a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')"},onImageError:function(){var a=this.imgDiv;null!=a.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=
ALKMaps.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(ALKMaps.Element.addClass(a,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},getCanvasContext:function(){if(ALKMaps.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"ALKMaps.Tile.Image"});ALKMaps.Control.TransformFeature=ALKMaps.Class(ALKMaps.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,[b]);this.layer=a;if(!this.rotationHandleSymbolizer)this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0,
cursor:"pointer"};this.createBox();this.createControl()},activate:function(){var a=!1;ALKMaps.Control.prototype.activate.apply(this,arguments)&&(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&&this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),a=!0);return a},deactivate:function(){var a=!1;ALKMaps.Control.prototype.deactivate.apply(this,arguments)&&(this.layer.removeFeatures(this.handles),this.rotate&&this.layer.removeFeatures(this.rotationHandles),
this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),a=!0);return a},setMap:function(a){this.dragControl.setMap(a);ALKMaps.Control.prototype.setMap.apply(this,arguments)},setFeature:function(a,b){var b=ALKMaps.Util.applyDefaults(b,{rotation:0,scale:1,ratio:1}),c=this.rotation,d=this.center;ALKMaps.Util.extend(this,b);if(!1!==this.events.triggerEvent("beforesetfeature",{feature:a})){this.feature=a;this.activate();this._setfeature=!0;var e=this.feature.geometry.getBounds();this.box.move(e.getCenterLonLat());
this.box.geometry.rotate(-c,d);this._angle=0;this.rotation?(c=a.geometry.clone(),c.rotate(-this.rotation,this.center),c=new ALKMaps.Feature.Vector(c.getBounds().toGeometry()),c.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(c.geometry.getBounds().getCenterLonLat()),c=c.geometry.components[0].components[0].getBounds().getCenterLonLat()):c=new ALKMaps.LonLat(e.left,e.bottom);this.handles[0].move(c);delete this._setfeature;this.events.triggerEvent("setfeature",
{feature:a})}},unsetFeature:function(){this.active?this.deactivate():(this.feature=null,this.rotation=0,this.ratio=this.scale=1)},createBox:function(){var a=this;this.center=new ALKMaps.Geometry.Point(0,0);this.box=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.LineString([new ALKMaps.Geometry.Point(-1,-1),new ALKMaps.Geometry.Point(0,-1),new ALKMaps.Geometry.Point(1,-1),new ALKMaps.Geometry.Point(1,0),new ALKMaps.Geometry.Point(1,1),new ALKMaps.Geometry.Point(0,1),new ALKMaps.Geometry.Point(-1,
1),new ALKMaps.Geometry.Point(-1,0),new ALKMaps.Geometry.Point(-1,-1)]),null,"string"==typeof this.renderIntent?null:this.renderIntent);this.box.geometry.move=function(b,c){a._moving=!0;ALKMaps.Geometry.LineString.prototype.move.apply(this,arguments);a.center.move(b,c);delete a._moving};for(var b=function(a,b){ALKMaps.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.move(a,b);this._handle.geometry.move(a,b)},c=function(a,b,c){ALKMaps.Geometry.Point.prototype.resize.apply(this,
arguments);this._rotationHandle&&this._rotationHandle.geometry.resize(a,b,c);this._handle.geometry.resize(a,b,c)},d=function(a,b){ALKMaps.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.rotate(a,b);this._handle.geometry.rotate(a,b)},e=function(b,c){var d=this.x,e=this.y;ALKMaps.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,g=!(!a._setfeature&&a.preserveAspectRatio)&&!(f&&f.shiftKey),h=new ALKMaps.Geometry.Point(d,
e),f=a.center;this.rotate(-a.rotation,f);h.rotate(-a.rotation,f);var i=this.x-f.x,j=this.y-f.y,k=i-(this.x-h.x),l=j-(this.y-h.y);a.irregular&&!a._setfeature&&(i-=(this.x-h.x)/2,j-=(this.y-h.y)/2);this.x=d;this.y=e;h=1;g?(j=1.0E-5>Math.abs(l)?1:j/l,h=(1.0E-5>Math.abs(k)?1:i/k)/j):(k=Math.sqrt(k*k+l*l),j=Math.sqrt(i*i+j*j)/k);a._moving=!0;a.box.geometry.rotate(-a.rotation,f);delete a._moving;a.box.geometry.resize(j,f,h);a.box.geometry.rotate(a.rotation,f);a.transformFeature({scale:j,ratio:h});a.irregular&&
!a._setfeature&&(i=f.clone(),i.x+=1.0E-5>Math.abs(d-f.x)?0:this.x-d,i.y+=1.0E-5>Math.abs(e-f.y)?0:this.y-e,a.box.geometry.move(this.x-d,this.y-e),a.transformFeature({center:i}))}},f=function(b,c){var d=this.x,e=this.y;ALKMaps.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,f=f&&f.shiftKey?45:1,g=a.center,h=this.x-g.x,i=this.y-g.y;this.x=d;this.y=e;d=Math.atan2(i-c,h-b);d=Math.atan2(i,h)-d;d*=180/Math.PI;a._angle=(a._angle+d)%360;d=a.rotation%f;if(Math.abs(a._angle)>=
f||0!==d)d=Math.round(a._angle/f)*f-d,a._angle=0,a.box.geometry.rotate(d,g),a.transformFeature({rotation:d})}},g=Array(8),h=Array(4),i,j,k,m="sw,s,se,e,ne,n,nw,w".split(","),l=0;8>l;++l){i=this.box.geometry.components[l];j=new ALKMaps.Feature.Vector(i.clone(),{role:m[l]+"-resize"},"string"==typeof this.renderIntent?null:this.renderIntent);if(0==l%2)k=new ALKMaps.Feature.Vector(i.clone(),{role:m[l]+"-rotate"},"string"==typeof this.rotationHandleSymbolizer?null:this.rotationHandleSymbolizer),k.geometry.move=
f,i._rotationHandle=k,h[l/2]=k;i.move=b;i.resize=c;i.rotate=d;j.geometry.move=e;i._handle=j;g[l]=j}this.rotationHandles=h;this.handles=g},createControl:function(){var a=this;this.dragControl=new ALKMaps.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(b){if(this.feature===a.feature)this.feature=a.box;ALKMaps.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(b){b===a.box&&a.transformFeature({center:a.center})},onStart:function(b){var c=!a.geometryTypes||
-1!==ALKMaps.Util.indexOf(a.geometryTypes,b.geometry.CLASS_NAME),d=ALKMaps.Util.indexOf(a.handles,b),d=d+ALKMaps.Util.indexOf(a.rotationHandles,b);b!==a.feature&&b!==a.box&&-2==d&&c&&a.setFeature(b)},onComplete:function(){a.events.triggerEvent("transformcomplete",{feature:a.feature})}})},drawHandles:function(){for(var a=this.layer,b=0;8>b;++b)this.rotate&&0===b%2&&a.drawFeature(this.rotationHandles[b/2],this.rotationHandleSymbolizer),a.drawFeature(this.handles[b],this.renderIntent)},transformFeature:function(a){if(!this._setfeature){this.scale*=
a.scale||1;this.ratio*=a.ratio||1;var b=this.rotation;this.rotation=(this.rotation+(a.rotation||0))%360;if(!1!==this.events.triggerEvent("beforetransform",a)){var c=this.feature,d=c.geometry,e=this.center;d.rotate(-b,e);a.scale||a.ratio?d.resize(a.scale,e,a.ratio):a.center&&c.move(a.center.getBounds().getCenterLonLat());d.rotate(this.rotation,e);this.layer.drawFeature(c);c.toState(ALKMaps.State.UPDATE);this.events.triggerEvent("transform",a)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},
destroy:function(){for(var a,b=0;8>b;++b)a=this.box.geometry.components[b],a._handle.destroy(),a._handle=null,a._rotationHandle&&a._rotationHandle.destroy(),a._rotationHandle=null;this.rotationHandles=this.rotationHandleSymbolizer=this.handles=this.feature=this.center=null;this.box.destroy();this.layer=this.box=null;this.dragControl.destroy();this.dragControl=null;ALKMaps.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.TransformFeature"});ALKMaps.Lang.hu=ALKMaps.Util.applyDefaults({unhandledRequest:"Nem kezelt k\u00e9r\u00e9s visszat\u00e9r\u00e9se ${statusText}",Permalink:"Permalink",Overlays:"R\u00e1vet\u00edt\u00e9sek","Base Layer":"Alapr\u00e9teg",readNotImplemented:"Olvas\u00e1s nincs v\u00e9grehajtva.",writeNotImplemented:"\u00cdr\u00e1s nincs v\u00e9grehajtva.",noFID:"Nem friss\u00edthet\u0151 olyan jellemz\u0151, amely nem rendelkezik FID-del.",errorLoadingGML:"Hiba GML-f\u00e1jl bet\u00f6lt\u00e9sekor ${url}",browserNotSupported:"A b\u00f6ng\u00e9sz\u0151je nem t\u00e1mogatja a vektoros renderel\u00e9st. A jelenleg t\u00e1mogatott renderel\u0151k:\n${renderers}",
componentShouldBe:"addFeatures : az \u00f6sszetev\u0151nek ilyen t\u00edpus\u00fanak kell lennie: ${geomType}",getFeatureError:"getFeatureFromEvent r\u00e9teget h\u00edvott meg renderel\u0151 n\u00e9lk\u00fcl. Ez rendszerint azt jelenti, hogy megsemmis\u00edtett egy f\u00f3li\u00e1t, de n\u00e9h\u00e1ny ahhoz t\u00e1rs\u00edtott kezel\u0151t nem.",minZoomLevelError:"A minZoomLevel tulajdons\u00e1got csak a k\u00f6vetkez\u0151vel val\u00f3 haszn\u00e1latra sz\u00e1nt\u00e1k: FixedZoomLevels-lesz\u00e1rmazott f\u00f3li\u00e1k. Ez azt jelenti, hogy a minZoomLevel wfs f\u00f3lia jel\u00f6l\u0151n\u00e9gyzetei m\u00e1r a m\u00falt\u00e9. Mi azonban nem t\u00e1vol\u00edthatjuk el annak a vesz\u00e9lye n\u00e9lk\u00fcl, hogy az esetlegesen ett\u0151l f\u00fcgg\u0151 OL alap\u00fa alkalmaz\u00e1sokat t\u00f6nkretenn\u00e9nk. Ez\u00e9rt ezt \u00e9rv\u00e9nytelen\u00edtj\u00fck -- a minZoomLevel az alul lev\u0151 jel\u00f6l\u0151n\u00e9gyzet a 3.0-s verzi\u00f3b\u00f3l el lesz t\u00e1vol\u00edtva. K\u00e9rj\u00fck, helyette haszn\u00e1lja a  min/max felbont\u00e1s be\u00e1ll\u00edt\u00e1st, amelyr\u0151l az al\u00e1bbi helyen tal\u00e1l le\u00edr\u00e1st: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS tranzakci\u00f3: SIKERES ${response}",commitFailed:"WFS tranzakci\u00f3: SIKERTELEN ${response}",googleWarning:"A Google f\u00f3lia bet\u00f6lt\u00e9se sikertelen.<br><br>Ahhoz, hogy ez az \u00fczenet elt\u0171nj\u00f6n, v\u00e1lasszon egy \u00faj BaseLayer f\u00f3li\u00e1t a jobb fels\u0151 sarokban tal\u00e1lhat\u00f3 f\u00f3liakapcsol\u00f3 seg\u00edts\u00e9g\u00e9vel.<br><br>Nagy val\u00f3sz\u00edn\u0171s\u00e9ggel ez az\u00e9rt van, mert a Google Maps k\u00f6nyvt\u00e1r parancsf\u00e1jlja nem tal\u00e1lhat\u00f3, vagy nem tartalmazza az \u00d6n oldal\u00e1hoz tartoz\u00f3 megfelel\u0151 API-kulcsot.<br><br>Fejleszt\u0151knek: A helyes m\u0171k\u00f6dtet\u00e9sre vonatkoz\u00f3 seg\u00edts\u00e9g az al\u00e1bbi helyen \u00e9rhet\u0151 el, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>kattintson ide</a>",
getLayerWarning:"A(z) ${layerType} f\u00f3lia nem t\u00f6lt\u0151d\u00f6tt be helyesen.<br><br>Ahhoz, hogy ez az \u00fczenet elt\u0171nj\u00f6n, v\u00e1lasszon egy \u00faj BaseLayer f\u00f3li\u00e1t a jobb fels\u0151 sarokban tal\u00e1lhat\u00f3 f\u00f3liakapcsol\u00f3 seg\u00edts\u00e9g\u00e9vel.<br><br>Nagy val\u00f3sz\u00edn\u0171s\u00e9ggel ez az\u00e9rt van, mert a(z) ${layerLib} k\u00f6nyvt\u00e1r parancsf\u00e1jlja helytelen.<br><br>Fejleszt\u0151knek: A helyes m\u0171k\u00f6dtet\u00e9sre vonatkoz\u00f3 seg\u00edts\u00e9g az al\u00e1bbi helyen \u00e9rhet\u0151 el, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>kattintson ide</a>",
"Scale = 1 : ${scaleDenom}":"L\u00e9pt\u00e9k = 1 : ${scaleDenom}",W:"Ny",E:"K",N:"\u00c9",S:"D",layerAlreadyAdded:"Megpr\u00f3b\u00e1lta hozz\u00e1adni a(z) ${layerName} f\u00f3li\u00e1t a t\u00e9rk\u00e9phez, de az m\u00e1r hozz\u00e1 van adva",reprojectDeprecated:"\u00d6n a 'reproject' be\u00e1ll\u00edt\u00e1st haszn\u00e1lja a(z) ${layerName} f\u00f3li\u00e1n. Ez a be\u00e1ll\u00edt\u00e1s \u00e9rv\u00e9nytelen: haszn\u00e1lata az \u00fczleti alapt\u00e9rk\u00e9pek f\u00f6l\u00f6tti adatok megjelen\u00edt\u00e9s\u00e9nek t\u00e1mogat\u00e1s\u00e1ra szolg\u00e1lt, de ezt a funkci\u00f3 ezent\u00fal a G\u00f6mbi Mercator haszn\u00e1lat\u00e1val \u00e9rhet\u0151 el. Tov\u00e1bbi inform\u00e1ci\u00f3 az al\u00e1bbi helyen \u00e9rhet\u0151 el: http://trac.openlayers.org/wiki/SphericalMercator",
methodDeprecated:"Ez a m\u00f3dszer \u00e9rv\u00e9nytelen\u00edtve lett \u00e9s a 3.0-s verzi\u00f3b\u00f3l el lesz t\u00e1vol\u00edtva. Haszn\u00e1lja a(z) ${newMethod} m\u00f3dszert helyette.",boundsAddError:"Az x \u00e9s y \u00e9rt\u00e9keknek egyar\u00e1nt meg kell felelnie, hogy a funkci\u00f3t hozz\u00e1adhassa.",lonlatAddError:"A hossz. \u00e9s sz\u00e9l. \u00e9rt\u00e9keknek egyar\u00e1nt meg kell felelnie, hogy a funkci\u00f3t hozz\u00e1adhassa.",pixelAddError:"Az x \u00e9s y \u00e9rt\u00e9keknek egyar\u00e1nt meg kell felelnie, hogy a funkci\u00f3t hozz\u00e1adhassa.",
unsupportedGeometryType:"Nem t\u00e1mogatott geometriat\u00edpus: ${geomType}",filterEvaluateNotImplemented:"enn\u00e9l a sz\u0171r\u0151t\u00edpusn\u00e1l ki\u00e9rt\u00e9kel\u00e9s nem hajt\u00f3dik v\u00e9gre.",panup:"P\u00e1szt\u00e1z\u00e1s fel",panleft:"P\u00e1szt\u00e1z\u00e1s balra",zoomworld:"K\u00f6zel\u00edt\u00e9s/T\u00e1vol\u00edt\u00e1s",panright:"P\u00e1szt\u00e1z\u00e1s jobbra",pandown:"P\u00e1szt\u00e1z\u00e1s le",zoomin:"K\u00f6zel\u00edt\u00e9s",zoomout:"T\u00e1vol\u00edt\u00e1s",
dragme:"Elh\u00faz\u00e1s",dragToChangeRoute:"Elh\u00faz\u00e1s \u00fatvonalv\u00e1lt\u00e1shoz",drawPoints:"Pontrajzol\u00e1s",clkToSetPoints:"Kattint\u00e1ssal vonal pontjait \u00e1ll\u00edthatja be. Kattintson k\u00e9tszer a befejez\u00e9shez.",dragToDrawLine:"H\u00fazza szabadk\u00e9zi vonal rajzol\u00e1s\u00e1hoz.",dragToDrawEllipse:"H\u00fazza ellipszis rajzol\u00e1s\u00e1hoz.",dragToDrawRect:"H\u00fazza n\u00e9gysz\u00f6g rajzol\u00e1s\u00e1hoz.",clkToSetPolygon:"Kattint\u00e1ssal soksz\u00f6g pontjait \u00e1ll\u00edthatja be. Kattintson k\u00e9tszer a befejez\u00e9shez.",
dragToDrawPolygon:"H\u00fazza szabadk\u00e9zi soksz\u00f6g rajzol\u00e1s\u00e1hoz.",clkShapeToResize:"Alakzatokat kattint\u00e1ssal m\u00e9retezhet \u00e1t, vagy helyezhet \u00e1t. Vigye a kurzort egy sarokhoz, \u00edgy elforgathatja.",clkShapeToModify:"Kattintson egy alakzatra, hogy az alakzat pontjait m\u00f3dos\u00edtsa. A kurzort \u00e1ll\u00edtsa egy pont f\u00f6l\u00e9, nyomja le a T\u00f6rl\u00e9s gombot, \u00edgy elt\u00e1vol\u00edthatja.",showShapeInfo:"Alakzat tulajdons\u00e1gai sz\u00f6vegdoboz megmutat\u00e1sa.",
area:"Ter\u00fclet",length:"Hossz\u00fas\u00e1g",nodes:"Metsz\u00e9spontok",perimeter:"Ker\u00fclet",location:"Hely",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Lang.sv=ALKMaps.Util.applyDefaults({unhandledRequest:"Ej hanterad fr\u00e5ga retur ${statusText}",Permalink:"Permal\u00e4nk",Overlays:"Kartlager","Base Layer":"Bakgrundskarta",readNotImplemented:"L\u00e4sning ej implementerad.",writeNotImplemented:"Skrivning ej implementerad.",noFID:"Kan ej uppdatera feature (objekt) f\u00f6r vilket FID saknas.",errorLoadingGML:"Fel i laddning av GML-fil ${url}",browserNotSupported:"Din webbl\u00e4sare st\u00f6der inte vektorvisning. F\u00f6r n\u00e4rvarande st\u00f6ds f\u00f6ljande visning:\n${renderers}",
componentShouldBe:"addFeatures : komponenten skall vara en ${geomType}",getFeatureError:"getFeatureFromEvent anropad f\u00f6r lager utan utritning. Detta betyder oftast att man raderat ett lager, men inte en hanterare som \u00e4r knuten till lagret.",minZoomLevelError:"Egenskapen minZoomLevel \u00e4r endast avsedd att anv\u00e4ndas med lager med FixedZoomLevels. Att detta WFS-lager kontrollerar minZoomLevel \u00e4r en relik fr\u00e5n \u00e4ldre versioner. Vi kan dock inte ta bort det utan att riskera att OL-baserade till\u00e4mpningar som anv\u00e4nder detta slutar fungera. D\u00e4rf\u00f6r \u00e4r det satt som deprecated, minZoomLevel kommer att tas bort i version 3.0. Anv\u00e4nd i st\u00e4llet inst\u00e4llning av min/max resolution som beskrivs h\u00e4r: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS-transaktion: LYCKADES ${response}",commitFailed:"WFS-transaktion: MISSLYCKADES ${response}",googleWarning:"Google-lagret kunde inte laddas korrekt.<br><br>F\u00f6r att slippa detta meddelande, v\u00e4lj en annan bakgrundskarta i lagerv\u00e4ljaren i \u00f6vre h\u00f6gra h\u00f6rnet.<br><br>Sannolikt beror felet p\u00e5 att Google Maps-biblioteket inte \u00e4r inkluderat p\u00e5 webbsidan eller p\u00e5 att sidan inte anger korrekt API-nyckel f\u00f6r webbplatsen.<br><br>Utvecklare: hj\u00e4lp f\u00f6r att \u00e5tg\u00e4rda detta, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>klicka h\u00e4r</a>.",
getLayerWarning:"${layerType}-lagret kunde inte laddas korrekt.<br><br>F\u00f6r att slippa detta meddelande, v\u00e4lj en annan bakgrundskarta i lagerv\u00e4ljaren i \u00f6vre h\u00f6gra h\u00f6rnet.<br><br>Sannolikt beror felet p\u00e5 att ${layerLib}-biblioteket inte \u00e4r inkluderat p\u00e5 webbsidan.<br><br>Utvecklare: hj\u00e4lp f\u00f6r att \u00e5tg\u00e4rda detta, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>klicka h\u00e4r</a>.","Scale = 1 : ${scaleDenom}":"<strong>Skala</strong> 1 : ${scaleDenom}",
layerAlreadyAdded:"Du f\u00f6rs\u00f6kte l\u00e4gga till lagret: ${layerName} p\u00e5 kartan, men det har lagts till tidigare",reprojectDeprecated:"Du anv\u00e4nder inst\u00e4llningen 'reproject' p\u00e5 lagret ${layerName}. Denna inst\u00e4llning markerad som deprecated: den var avsedd att anv\u00e4ndas f\u00f6r att st\u00f6dja visning av kartdata p\u00e5 kommersiella bakgrundskartor, men nu b\u00f6r man i st\u00e4llet anv\u00e4nda Spherical Mercator-st\u00f6d f\u00f6r den funktionaliteten. Mer information finns p\u00e5 http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"Denna metod \u00e4r markerad som deprecated och kommer att tas bort i 3.0. Anv\u00e4nd ${newMethod} i st\u00e4llet.",boundsAddError:"Du m\u00e5ste skicka b\u00e5de x- och y-v\u00e4rde till funktionen add.",lonlatAddError:"Du m\u00e5ste skicka b\u00e5de lon- och lat-v\u00e4rde till funktionen add.",pixelAddError:"Du m\u00e5ste skicka b\u00e5de x- och y-v\u00e4rde till funktionen add.",unsupportedGeometryType:"St\u00f6d saknas f\u00f6r geometritypen: ${geomType}",filterEvaluateNotImplemented:"evaluering har ej implementerats f\u00f6r denna typ av filter.",
panup:"Panorera upp",panleft:"Panorera v\u00e4nster",zoomworld:"Zooma v\u00e4rlden",panright:"Panorera h\u00f6ger",pandown:"Panorera ner",zoomin:"Zooma in",zoomout:"Zooma ut",dragme:"Dra mig",dragToChangeRoute:"Dra f\u00f6r att \u00e4ndra rutt",drawPoints:"Rita punkter",clkToSetPoints:"Klicka f\u00f6r att s\u00e4tta ut punkter f\u00f6r en linje. Avsluta med att dubbelklicka.",dragToDrawLine:"Dra f\u00f6r att rita en frihandslinje.",dragToDrawEllipse:"Dra f\u00f6r att rita en ellips.",dragToDrawRect:"Dra f\u00f6r att rita en rektangel.",
clkToSetPolygon:"Klicka f\u00f6r att s\u00e4tta punkter f\u00f6r en polygon. Avsluta med att dubbelklicka.",dragToDrawPolygon:"Dra f\u00f6r att rita en frihandspolygon.",clkShapeToResize:"Klicka p\u00e5 en form att \u00e4ndra storlek p\u00e5 eller att flytta. Rotera genom att placera mark\u00f6ren n\u00e4ra en kant.",clkShapeToModify:"Klicka p\u00e5 en form f\u00f6r att \u00e4ndra formpunkterna. S\u00e4tt mark\u00f6ren \u00f6ver en punkt och tryck p\u00e5 Delete f\u00f6r att ta bort den.",showShapeInfo:"Visa forminformationsrutan.",
area:"Omr\u00e5de",length:"L\u00e4ngd",nodes:"Noder",perimeter:"Perimeter",location:"L\u00e4ge",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Lang["sv-SE"]=ALKMaps.Lang.sv;ALKMaps.Control.Scale=ALKMaps.Class(ALKMaps.Control,{element:null,geodesic:!0,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,[b]);this.element=ALKMaps.Util.getElement(a)},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.element)this.element=document.createElement("div"),this.div.appendChild(this.element);this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var a;if(!0===this.geodesic){if(!this.map.getUnits())return;
a=ALKMaps.INCHES_PER_UNIT;a=(this.map.getGeodesicPixelSize().w||1.0E-6)*a.km*ALKMaps.DOTS_PER_INCH}else a=this.map.getScale();if(a)a=9500<=a&&95E4>=a?Math.round(a/1E3)+"K":95E4<=a?Math.round(a/1E6)+"M":Math.round(a),this.element.innerHTML=ALKMaps.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:a})},CLASS_NAME:"ALKMaps.Control.Scale"});ALKMaps.Handler.MouseWheel=ALKMaps.Class(ALKMaps.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(a,b,c){ALKMaps.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=ALKMaps.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){ALKMaps.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){for(var b=!1,c=!1,d=!1,e=ALKMaps.Event.element(a);null!=
e&&!d&&!b;){if(!b)try{var f=e.currentStyle?e.currentStyle.overflow:document.defaultView.getComputedStyle(e,null).getPropertyValue("overflow"),b=f&&"auto"==f||"scroll"==f}catch(g){}if(!c){for(var d=0,h=this.map.layers.length;d<h;d++)if(e==this.map.layers[d].div||e==this.map.layers[d].pane){c=!0;break}if(!c)for(d=e;d.parentNode;){if(!0===d.parentNode.safeScroll){c=!0;break}d=d.parentNode}}d=e==this.map.div;e=e.parentNode}if(!b&&d){if(c){b=0;if(!a)a=window.event;a.wheelDelta?(b=a.wheelDelta/120,window.opera&&
9.2>window.opera.version()&&(b=-b)):a.detail&&(b=-a.detail/3);this.delta+=b;this.interval?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(ALKMaps.Function.bind(function(){this.wheelZoom(a)},this),this.interval)):this.wheelZoom(a)}ALKMaps.Event.stop(a)}}},wheelZoom:function(a){var b=this.delta;this.delta=0;if(b){if(this.mousePosition)a.xy=this.mousePosition;if(!a.xy)a.xy=this.map.getPixelFromLonLat(this.map.getCenter());0>b?this.callback("down",[a,this.cumulative?b:-1]):this.callback("up",
[a,this.cumulative?b:1])}},mousemove:function(a){this.mousePosition=a.xy},activate:function(a){if(ALKMaps.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;ALKMaps.Event.observe(window,"DOMMouseScroll",b);ALKMaps.Event.observe(window,"mousewheel",b);ALKMaps.Event.observe(document,"mousewheel",b);return!0}return!1},deactivate:function(a){if(ALKMaps.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;ALKMaps.Event.stopObserving(window,"DOMMouseScroll",
b);ALKMaps.Event.stopObserving(window,"mousewheel",b);ALKMaps.Event.stopObserving(document,"mousewheel",b);return!0}return!1},CLASS_NAME:"ALKMaps.Handler.MouseWheel"});ALKMaps.Handler.Click=ALKMaps.Class(ALKMaps.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,alwaysTrigger:!1,touchstart:function(a){if(!this.touch)this.unregisterMouseListeners(),this.touch=!0;this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},touchmove:function(a){this.last=this.getEventInfo(a);return!0},touchend:function(a){if(this.down)a.xy=
this.last.xy,a.lastTouches=this.last.touches,this.handleSingle(a),this.down=null;return!0},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},mouseup:function(a){var b=!0;this.checkModifiers(a)&&this.control.handleRightClicks&&ALKMaps.Event.isRightClick(a)&&(b=this.rightclick(a));return b},rightclick:function(a){if(this.passesTolerance(a)){if(null!=
this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[a]),!this.stopDouble;a=this["double"]?ALKMaps.Util.extend({},a):this.callback("rightclick",[a]);a=ALKMaps.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&&this.callback("rightclick",[a])},click:function(a){if(!this.last)this.last=this.getEventInfo(a);this.handleSingle(a);return!this.stopSingle},
dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){this.passesDblclickTolerance(a)&&(this["double"]&&this.callback("dblclick",[a]),this.clearTimer())},handleSingle:function(a){if(this.passesTolerance(a))null!=this.timerId?(this.last.touches&&1===this.last.touches.length&&(this["double"]&&ALKMaps.Event.stop(a),this.handleDouble(a)),(!this.last.touches||2!==this.last.touches.length)&&this.clearTimer()):(this.first=this.getEventInfo(a),this.queuePotentialClick(this.single?
ALKMaps.Util.extend({},a):null))},queuePotentialClick:function(a){this.timerId=window.setTimeout(ALKMaps.Function.bind(this.delayedCall,this,a),this.delay)},passesTolerance:function(a){var b=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(b=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&&this.touch&&this.down.touches.length===this.last.touches.length)for(var a=0,c=this.down.touches.length;a<c;++a)if(this.getTouchDistance(this.down.touches[a],this.last.touches[a])>this.pixelTolerance){b=
!1;break}return b},getTouchDistance:function(a,b){return Math.sqrt(Math.pow(a.clientX-b.clientX,2)+Math.pow(a.clientY-b.clientY,2))},passesDblclickTolerance:function(){var a=!0;this.down&&this.first&&(a=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance);return a},clearTimer:function(){if(null!=this.timerId)window.clearTimeout(this.timerId),this.timerId=null;if(null!=this.rightclickTimerId)window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null},delayedCall:function(a){this.timerId=
null;a&&this.callback("click",[a])},getEventInfo:function(a){var b;if(a.touches){var c=a.touches.length;b=Array(c);for(var d,e=0;e<c;e++)d=a.touches[e],b[e]={clientX:d.clientX,clientY:d.clientY}}return{xy:a.xy,touches:b}},deactivate:function(){var a=!1;if(ALKMaps.Handler.prototype.deactivate.apply(this,arguments))this.clearTimer(),this.last=this.first=this.down=null,this.touch=!1,a=!0;return a},register:function(a,b){!0===this.alwaysTrigger?(this.map.events.register(a,this,b,{always:!0}),this.map.events.register(a,
this,this.setEvent,{always:!0})):ALKMaps.Handler.prototype.register.apply(this,arguments)},CLASS_NAME:"ALKMaps.Handler.Click"});ALKMaps.Control.Navigation=ALKMaps.Class(ALKMaps.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:ALKMaps.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={};a=a||{};a.title=a.title||ALKMaps.i18n("dragPan");ALKMaps.Control.prototype.initialize.apply(this,[a])},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();
this.dragPan=null;this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;ALKMaps.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&
this.pinchZoom.deactivate();this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks)this.map.viewPortDiv.oncontextmenu=ALKMaps.Function.False;this.handlers.click=new ALKMaps.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":!0,stopDouble:!0});this.dragPan=
new ALKMaps.Control.DragPan(ALKMaps.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new ALKMaps.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new ALKMaps.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions);if(ALKMaps.Control.PinchZoom)this.pinchZoom=new ALKMaps.Control.PinchZoom(ALKMaps.Util.extend({map:this.map},this.pinchZoomOptions))},zoomOnPoint:function(a,
b){var c=this.map.getZoom(),d;d=Math.max(c+b,0);d=Math.min(d,this.map.getNumZoomLevels());if(d!==c){var e=this.map.getSize(),c=e.w/2-a.x,e=a.y-e.h/2,f=this.map.baseLayer.getResolutionForZoom(d),g=this.map.getLonLatFromPixel(a);this.map.setCenter(new ALKMaps.LonLat(g.lon+c*f,g.lat+e*f),d)}},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.zoomOnPoint(a.xy,1)},defaultDblRightClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),
this.map.zoom-1)},wheelChange:function(a,b){this.zoomOnPoint(a.xy,b)},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0;this.active&&this.handlers.wheel.activate()},
CLASS_NAME:"ALKMaps.Control.Navigation"});ALKMaps.Handler.Point=ALKMaps.Class(ALKMaps.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,touch:!1,lastTouchPx:null,initialize:function(a,b,c){if(!c||!c.layerOptions||!c.layerOptions.styleMap)this.style=ALKMaps.Util.extend(ALKMaps.Feature.Vector.style["default"],{});ALKMaps.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!ALKMaps.Handler.prototype.activate.apply(this,
arguments))return!1;var a=ALKMaps.Util.extend({displayInLayerSwitcher:!1,calculateInRange:ALKMaps.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new ALKMaps.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return!0},createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new ALKMaps.Geometry.Point(a.lon,a.lat);this.point=new ALKMaps.Feature.Vector(a);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],
{silent:!0})},deactivate:function(){if(!ALKMaps.Handler.prototype.deactivate.apply(this,arguments))return!1;this.cancel();null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1));this.layer=null;this.touch=!1;return!0},destroyFeature:function(a){this.layer&&(a||!this.persist)&&this.layer.destroyFeatures();this.point=null},destroyPersistedFeature:function(){var a=this.layer;a&&1<a.features.length&&this.layer.features[0].destroy()},finalize:function(a){this.mouseDown=!1;this.lastTouchPx=
this.lastUp=this.lastDown=null;this.callback(a?"cancel":"done",[this.geometryClone()]);this.destroyFeature(a)},cancel:function(){this.finalize(!0)},click:function(a){ALKMaps.Event.stop(a);return!1},dblclick:function(a){ALKMaps.Event.stop(a);return!1},modifyFeature:function(a){this.point||this.createFeature(a);a=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.callback("modify",[this.point.geometry,this.point,!1]);this.point.geometry.clearBounds();
this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;a&&this.multi&&(a=new ALKMaps.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){return this.down(a)},touchstart:function(a){if(!this.touch)this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,
scope:this});this.lastTouchPx=a.xy;return this.down(a)},mousemove:function(a){return this.move(a)},touchmove:function(a){this.lastTouchPx=a.xy;return this.move(a)},mouseup:function(a){return this.up(a)},touchend:function(a){a.xy=this.lastTouchPx;return this.up(a)},down:function(a){this.mouseDown=!0;this.lastDown=a.xy;this.touch||this.modifyFeature(a.xy);this.stoppedDown=this.stopDown;return!this.stopDown},move:function(a){!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy);
return!0},up:function(a){this.mouseDown=!1;this.stoppedDown=this.stopDown;return this.checkModifiers(a)&&(!this.lastUp||!this.lastUp.equals(a.xy))&&this.lastDown&&this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(a.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=a.xy,this.finalize(),!this.stopUp):!0},mouseout:function(a){if(ALKMaps.Util.mouseLeft(a,this.map.viewPortDiv))this.stoppedDown=this.stopDown,this.mouseDown=!1},passesTolerance:function(a,
b,c){var d=!0;null!=c&&a&&b&&a.distanceTo(b)>c&&(d=!1);return d},CLASS_NAME:"ALKMaps.Handler.Point"});ALKMaps.Handler.Path=ALKMaps.Class(ALKMaps.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new ALKMaps.Geometry.Point(a.lon,a.lat);this.point=new ALKMaps.Feature.Vector(a);this.line=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();
this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(a){ALKMaps.Handler.Point.prototype.destroyFeature.call(this,a);this.line=null},destroyPersistedFeature:function(){var a=this.layer;a&&2<a.features.length&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);a=this.layer.getLonLatFromViewPortPx(a);this.point=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.Point(a.lon,
a.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(a,b){this.line.geometry.addComponent(new ALKMaps.Geometry.Point(a,b),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(a,b){var c=this.line.geometry.components[this.getCurrentPointIndex()-
1];c&&!isNaN(c.x)&&!isNaN(c.y)&&this.insertXY(c.x+a,c.y+b)},insertDirectionLength:function(a,b){var a=a*(Math.PI/180),c=b*Math.cos(a),d=b*Math.sin(a);this.insertDeltaXY(c,d)},insertDeflectionLength:function(a,b){var c=this.getCurrentPointIndex()-1;if(0<c){var d=this.line.geometry.components[c],c=this.line.geometry.components[c-1];this.insertDirectionLength(180*Math.atan2(d.y-c.y,d.x-c.x)/Math.PI+a,b)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var a=
this.line.geometry,b=a.components,c=this.getCurrentPointIndex()-1,b=b[c];if(a=a.removeComponent(b)){if(!this.redoStack)this.redoStack=[];this.redoStack.push(b);this.drawFeature()}return a},redo:function(){var a=this.redoStack&&this.redoStack.pop();a&&(this.line.geometry.addComponent(a,this.getCurrentPointIndex()),this.drawFeature());return!!a},freehandMode:function(a){return this.freehandToggle&&a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a,b){this.line||this.createFeature(a);
var c=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=c.lon;this.point.geometry.y=c.lat;this.callback("modify",[this.point.geometry,this.getSketch(),b]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=this.line&&this.line.geometry;a&&this.multi&&(a=new ALKMaps.Geometry.MultiLineString([a]));return a},
touchstart:function(a){if(this.timerId&&this.passesTolerance(this.lastTouchPx,a.xy,this.doubleTouchTolerance))return this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1;if(this.timerId)window.clearTimeout(this.timerId),this.timerId=null;this.timerId=window.setTimeout(ALKMaps.Function.bind(function(){this.timerId=null},this),300);return ALKMaps.Handler.Point.prototype.touchstart.call(this,a)},down:function(a){var b=this.stopDown;this.freehandMode(a)&&(b=!0,this.touch&&(this.modifyFeature(a.xy,
!!this.lastUp),ALKMaps.Event.stop(a)));!this.touch&&(!this.lastDown||!this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))&&this.modifyFeature(a.xy,!!this.lastUp);this.mouseDown=!0;this.lastDown=a.xy;this.stoppedDown=b;return!b},move:function(a){if(this.stoppedDown&&this.freehandMode(a))return this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(a.xy),!1;!this.touch&&
(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy,!!this.lastUp);return!0},up:function(a){if(this.mouseDown&&(!this.lastUp||!this.lastUp.equals(a.xy)))if(this.stoppedDown&&this.freehandMode(a))this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize();else if(this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))this.touch&&this.modifyFeature(a.xy),null==this.lastUp&&this.persist&&this.destroyPersistedFeature(),this.addPoint(a.xy),this.lastUp=a.xy,this.line.geometry.components.length===
this.maxVertices+1&&this.finishGeometry();this.stoppedDown=this.stopDown;this.mouseDown=!1;return!this.stopUp},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-1]);this.removePoint();this.finalize()},dblclick:function(a){this.freehandMode(a)||this.finishGeometry();return!1},CLASS_NAME:"ALKMaps.Handler.Path"});ALKMaps.Handler.Polygon=ALKMaps.Class(ALKMaps.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new ALKMaps.Geometry.Point(a.lon,a.lat);this.point=new ALKMaps.Feature.Vector(a);this.line=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.LinearRing([this.point.geometry]));this.polygon=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);
this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(a){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var b=this.point.geometry,c=this.control.layer.features,d,e=c.length-1;0<=e;--e)if(d=c[e].geometry,(d instanceof ALKMaps.Geometry.Polygon||d instanceof ALKMaps.Geometry.MultiPolygon)&&d.intersects(b)){b=c[e];this.control.layer.removeFeatures([b],{silent:!0});this.control.layer.events.registerPriority("sketchcomplete",
this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);b.geometry.addComponent(this.line.geometry);this.polygon=b;this.drawingHole=!0;break}ALKMaps.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(a){var a=a.vertex,b=this.line.geometry.components;if(!this.polygon.geometry.intersects(a))b=b[b.length-3],a.x=b.x,a.y=b.y},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-
2]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var a=this.line.geometry,b=0!==a.getArea();if(b){for(var c=this.polygon.geometry.components,d=c.length-2;0<=d;--d)if(a.intersects(c[d])){b=!1;break}if(b){d=c.length-2;a:for(;0<d;--d)for(var e=c[d].components,f=0,g=e.length;f<g;++f)if(a.containsPoint(e[f])){b=!1;break a}}}if(b){if(this.polygon.state!==ALKMaps.State.INSERT)this.polygon.state=ALKMaps.State.UPDATE}else this.polygon.geometry.removeComponent(a);this.restoreFeature();
return!1},cancel:function(){this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0));return ALKMaps.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(a){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:!0});this.control.layer.addFeatures([this.polygon],{silent:!0});
this.drawingHole=!1;a||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(a){ALKMaps.Handler.Path.prototype.destroyFeature.call(this,a);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&&this.polygon.geometry;a&&this.multi&&(a=new ALKMaps.Geometry.MultiPolygon([a]));return a},
CLASS_NAME:"ALKMaps.Handler.Polygon"});ALKMaps.Control.EditingToolbar=ALKMaps.Class(ALKMaps.Control.Panel,{citeCompliant:!1,initialize:function(a,b){ALKMaps.Control.Panel.prototype.initialize.apply(this,[b]);this.addControls([new ALKMaps.Control.Navigation]);this.addControls([new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Path,{displayClass:"olControlDrawFeaturePath",handlerOptions:{citeCompliant:this.citeCompliant}}),
new ALKMaps.Control.DrawFeature(a,ALKMaps.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})])},draw:function(){var a=ALKMaps.Control.Panel.prototype.draw.apply(this,arguments);if(null===this.defaultControl)this.defaultControl=this.controls[0];return a},CLASS_NAME:"ALKMaps.Control.EditingToolbar"});ALKMaps.Format.XML=ALKMaps.Class(ALKMaps.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){if(window.ActiveXObject)this.xmldom=new ActiveXObject("Microsoft.XMLDOM");ALKMaps.Format.prototype.initialize.apply(this,[a]);this.namespaces=ALKMaps.Util.extend({},this.namespaces);this.namespaceAlias={};for(var b in this.namespaces)this.namespaceAlias[this.namespaces[b]]=b},destroy:function(){this.xmldom=null;ALKMaps.Format.prototype.destroy.apply(this,
arguments)},setNamespace:function(a,b){this.namespaces[a]=b;this.namespaceAlias[b]=a},read:function(a){var b=a.indexOf("<");0<b&&(a=a.substring(b));b=ALKMaps.Util.Try(ALKMaps.Function.bind(function(){var b;b=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom;b.loadXML(a);return b},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1);b.overrideMimeType&&
b.overrideMimeType("text/xml");b.send(null);return b.responseXML});if(this.keepData)this.data=b;return b},write:function(a){if(this.xmldom)a=a.xml;else{var b=new XMLSerializer;if(1==a.nodeType){var c=document.implementation.createDocument("","",null);c.importNode&&(a=c.importNode(a,!0));c.appendChild(a);a=b.serializeToString(c)}else a=b.serializeToString(a)}return a},createElementNS:function(a,b){return this.xmldom?"string"==typeof a?this.xmldom.createNode(1,b,a):this.xmldom.createNode(1,b,""):document.createElementNS(a,
b)},createTextNode:function(a){"string"!==typeof a&&(a=""+a);return this.xmldom?this.xmldom.createTextNode(a):document.createTextNode(a)},getElementsByTagNameNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else for(var a=a.getElementsByTagName("*"),e,f,g=0,h=a.length;g<h;++g)if(e=a[g],f=e.prefix?e.prefix+":"+c:c,"*"==c||f==e.nodeName)("*"==b||b==e.namespaceURI)&&d.push(e);return d},getAttributeNodeNS:function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,
c);else for(var a=a.attributes,e,f,g=0,h=a.length;g<h;++g)if(e=a[g],e.namespaceURI==b&&(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}return d},getAttributeNS:function(a,b,c){var d="";if(a.getAttributeNS)d=a.getAttributeNS(b,c)||"";else if(a=this.getAttributeNodeNS(a,b,c))d=a.nodeValue;return d},getChildValue:function(a,b){var c=b||"";if(a)for(var d=a.firstChild;d;d=d.nextSibling)switch(d.nodeType){case 3:case 4:c+=d.nodeValue}return c},isSimpleContent:function(a){for(var b=!0,a=a.firstChild;a;a=
a.nextSibling)if(1===a.nodeType){b=!1;break}return b},contentType:function(a){for(var b=!1,c=!1,d=ALKMaps.Format.XML.CONTENT_TYPE.EMPTY,a=a.firstChild;a;a=a.nextSibling){switch(a.nodeType){case 1:c=!0;break;case 8:break;default:b=!0}if(c&&b)break}if(c&&b)d=ALKMaps.Format.XML.CONTENT_TYPE.MIXED;else{if(c)return ALKMaps.Format.XML.CONTENT_TYPE.COMPLEX;if(b)return ALKMaps.Format.XML.CONTENT_TYPE.SIMPLE}return d},hasAttributeNS:function(a,b,c){var d=!1;return d=a.hasAttributeNS?a.hasAttributeNS(b,c):
!!this.getAttributeNodeNS(a,b,c)},setAttributeNS:function(a,b,c,d){if(a.setAttributeNS)a.setAttributeNS(b,c,d);else if(this.xmldom)b?(b=a.ownerDocument.createNode(2,c,b),b.nodeValue=d,a.setAttributeNode(b)):a.setAttribute(c,d);else throw"setAttributeNS not implemented";},createElementNSPlus:function(a,b){var b=b||{},c=b.uri||this.namespaces[b.prefix];c||(c=a.indexOf(":"),c=this.namespaces[a.substring(0,c)]);c||(c=this.namespaces[this.defaultPrefix]);c=this.createElementNS(c,a);b.attributes&&this.setAttributes(c,
b.attributes);var d=b.value;null!=d&&c.appendChild(this.createTextNode(d));return c},setAttributes:function(a,b){var c,d,e;for(e in b)null!=b[e]&&b[e].toString&&(c=b[e].toString(),d=this.namespaces[e.substring(0,e.indexOf(":"))]||null,this.setAttributeNS(a,d,e,c))},readNode:function(a,b){b||(b={});var c=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(c){var d=a.localName||a.nodeName.split(":").pop();(c=c[d]||c["*"])&&c.apply(this,[a,b])}return b},readChildNodes:function(a,
b){b||(b={});for(var c=a.childNodes,d,e=0,f=c.length;e<f;++e)d=c[e],1==d.nodeType&&this.readNode(d,b);return b},writeNode:function(a,b,c){var d,e=a.indexOf(":");0<e?(d=a.substring(0,e),a=a.substring(e+1)):d=c?this.namespaceAlias[c.namespaceURI]:this.defaultPrefix;b=this.writers[d][a].apply(this,[b]);c&&c.appendChild(b);return b},getChildEl:function(a,b,c){return a&&this.getThisOrNextEl(a.firstChild,b,c)},getNextEl:function(a,b,c){return a&&this.getThisOrNextEl(a.nextSibling,b,c)},getThisOrNextEl:function(a,
b,c){a:for(;a;a=a.nextSibling)switch(a.nodeType){case 1:if((!b||b===(a.localName||a.nodeName.split(":").pop()))&&(!c||c===a.namespaceURI))break a;a=null;break a;case 3:if(/^\s*$/.test(a.nodeValue))break;case 4:case 6:case 12:case 10:case 11:a=null;break a}return a||null},lookupNamespaceURI:function(a,b){var c=null;if(a)if(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);else a:switch(a.nodeType){case 1:if(null!==a.namespaceURI&&a.prefix===b){c=a.namespaceURI;break a}if(c=a.attributes.length)for(var d,
e=0;e<c;++e)if(d=a.attributes[e],"xmlns"===d.prefix&&d.name==="xmlns:"+b){c=d.value||null;break a}else if("xmlns"===d.name&&null===b){c=d.value||null;break a}c=this.lookupNamespaceURI(a.parentNode,b);break a;case 2:c=this.lookupNamespaceURI(a.ownerElement,b);break a;case 9:c=this.lookupNamespaceURI(a.documentElement,b);break a;case 6:case 12:case 10:case 11:break a;default:c=this.lookupNamespaceURI(a.parentNode,b)}return c},getXMLDoc:function(){if(!ALKMaps.Format.XML.document&&!this.xmldom)if(document.implementation&&
document.implementation.createDocument)ALKMaps.Format.XML.document=document.implementation.createDocument("","",null);else if(!this.xmldom&&window.ActiveXObject)this.xmldom=new ActiveXObject("Microsoft.XMLDOM");return ALKMaps.Format.XML.document||this.xmldom},CLASS_NAME:"ALKMaps.Format.XML"});ALKMaps.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};ALKMaps.Format.XML.lookupNamespaceURI=ALKMaps.Function.bind(ALKMaps.Format.XML.prototype.lookupNamespaceURI,ALKMaps.Format.XML.prototype);
ALKMaps.Format.XML.document=null;ALKMaps.Control.Button=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"ALKMaps.Control.Button"});ALKMaps.Strategy.Filter=ALKMaps.Class(ALKMaps.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var a=ALKMaps.Strategy.prototype.activate.apply(this,arguments);if(a)this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this});return a},deactivate:function(){this.cache=null;this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this});return ALKMaps.Strategy.prototype.deactivate.apply(this,
arguments)},handleAdd:function(a){if(!this.caching&&this.filter){var b=a.features;a.features=[];for(var c,d=0,e=b.length;d<e;++d)c=b[d],this.filter.evaluate(c)?a.features.push(c):this.cache.push(c)}},handleRemove:function(){if(!this.caching)this.cache=[]},setFilter:function(a){this.filter=a;a=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});if(0<this.cache.length)this.caching=!0,this.layer.removeFeatures(this.cache.slice()),this.caching=!1;if(0<a.length&&(a={features:a},this.handleAdd(a),
0<a.features.length))this.caching=!0,this.layer.addFeatures(a.features),this.caching=!1},CLASS_NAME:"ALKMaps.Strategy.Filter"});ALKMaps.Control.PanZoom=ALKMaps.Class(ALKMaps.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new ALKMaps.Pixel(ALKMaps.Control.PanZoom.X,ALKMaps.Control.PanZoom.Y);ALKMaps.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);this.removeButtons();this.position=this.buttons=null;ALKMaps.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,
arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(a){ALKMaps.Control.prototype.draw.apply(this,arguments);a=this.position;this.buttons=[];var b={w:18,h:18},c=new ALKMaps.Pixel(a.x+b.w/2,a.y);this._addButton("panup","north-mini.png",c,b,ALKMaps.i18n("panup"));a.y=c.y+b.h;this._addButton("panleft","west-mini.png",a,b,ALKMaps.i18n("panleft"));this._addButton("panright","east-mini.png",a.add(b.w,0),b,ALKMaps.i18n("panright"));this._addButton("pandown","south-mini.png",
c.add(0,2*b.h),b,ALKMaps.i18n("pandown"));this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b,ALKMaps.i18n("zoomin"));this._addButton("zoomworld","zoom-world-mini.png",c.add(0,4*b.h+5),b,ALKMaps.i18n("zoomworld"));this._addButton("zoomout","zoom-minus-mini.png",c.add(0,5*b.h+5),b,ALKMaps.i18n("zoomout"));return this.div},_addButton:function(a,b,c,d,e){b=ALKMaps.Util.getImageLocation(b);c=ALKMaps.Util.createAlphaImageDiv(this.id+"_"+a,c,d,b,"absolute");c.style.cursor="pointer";c.title=
e;this.div.appendChild(c);c.action=a;c.className="olButton";this.buttons.push(c);return c},_removeButton:function(a){this.div.removeChild(a);ALKMaps.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;0<=a;--a)this._removeButton(this.buttons[a])},onButtonClick:function(a){switch(a.buttonElement.action){case "panup":this.map.pan(0,-this.getSlideFactor("h"));break;case "pandown":this.map.pan(0,this.getSlideFactor("h"));break;case "panleft":this.map.pan(-this.getSlideFactor("w"),
0);break;case "panright":this.map.pan(this.getSlideFactor("w"),0);break;case "zoomin":this.map.zoomIn();break;case "zoomout":this.map.zoomOut();break;case "zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},CLASS_NAME:"ALKMaps.Control.PanZoom"});ALKMaps.Control.PanZoom.X=4;ALKMaps.Control.PanZoom.Y=4;ALKMaps.Lang.bg=ALKMaps.Util.applyDefaults({Permalink:"\u041f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u0430 \u043f\u0440\u0435\u043f\u0440\u0430\u0442\u043a\u0430","Base Layer":"\u041e\u0441\u043d\u043e\u0432\u0435\u043d \u0441\u043b\u043e\u0439",errorLoadingGML:"\u0413\u0440\u0435\u0448\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0440\u0435\u0436\u0434\u0430\u043d\u0435 \u043d\u0430 GML \u0444\u0430\u0439\u043b ${url}","Scale = 1 : ${scaleDenom}":"\u041c\u0430\u0449\u0430\u0431 = 1 : ${scaleDenom}",
layerAlreadyAdded:"\u041e\u043f\u0438\u0442\u0430\u0445\u0442\u0435 \u0434\u0430 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u0435 \u0441\u043b\u043e\u0439 ${layerName} \u0432 \u043a\u0430\u0440\u0442\u0430\u0442\u0430, \u043d\u043e \u0442\u043e\u0439 \u0432\u0435\u0447\u0435 \u0435 \u0434\u043e\u0431\u0430\u0432\u0435\u043d",methodDeprecated:"\u0422\u043e\u0437\u0438 \u043c\u0435\u0442\u043e\u0434 \u0435 \u043e\u0441\u0442\u0430\u0440\u044f\u043b \u0438 \u0449\u0435 \u0431\u044a\u0434\u0435 \u043f\u0440\u0435\u043c\u0430\u0445\u0432\u0430\u0442 \u0432 3.0. \u0412\u043c\u0435\u0441\u0442\u043e \u043d\u0435\u0433\u043e \u0438\u0437\u043f\u043e\u043b\u0437\u0432\u0430\u0439\u0442\u0435 ${newMethod}.",
panup:"\u041e\u0442\u043c\u0435\u0441\u0442\u0432\u0430\u043d\u0435 \u043d\u0430\u0433\u043e\u0440\u0435",panleft:"\u041e\u0442\u043c\u0435\u0441\u0442\u0432\u0430\u043d\u0435 \u043d\u0430\u043b\u044f\u0432\u043e",zoomworld:"\u041c\u0430\u0449\u0430\u0431\u0438\u0440\u0430\u043d\u0435 \u0441\u0432\u044f\u0442",panright:"\u041e\u0442\u043c\u0435\u0441\u0442\u0432\u0430\u043d\u0435 \u043d\u0430\u0434\u044f\u0441\u043d\u043e",pandown:"\u041e\u0442\u043c\u0435\u0441\u0442\u0432\u0430\u043d\u0435 \u043d\u0430\u0434\u043e\u043b\u0443",
zoomin:"\u0423\u0432\u0435\u043b\u0438\u0447\u0430\u0432\u0430\u043d\u0435",zoomout:"\u041d\u0430\u043c\u0430\u043b\u044f\u0432\u0430\u043d\u0435",dragme:"\u041f\u043b\u044a\u0437\u043d\u0438 \u043c\u0435",dragToChangeRoute:"\u041f\u043b\u044a\u0437\u043d\u0438 \u0437\u0430 \u043f\u0440\u043e\u043c\u044f\u043d\u0430 \u043d\u0430 \u043f\u043e\u0441\u043e\u043a\u0430\u0442\u0430",drawPoints:"\u0418\u0437\u0447\u0435\u0440\u0442\u0430\u0432\u0430\u043d\u0435 \u043d\u0430 \u0442\u043e\u0447\u043a\u0438",
clkToSetPoints:"\u0429\u0440\u0430\u043a\u043d\u0438, \u0437\u0430 \u0434\u0430 \u043c\u0430\u0440\u043a\u0438\u0440\u0430\u0448 \u0442\u043e\u0447\u043a\u0438 \u043e\u0442 \u043b\u0438\u043d\u0438\u044f. \u0429\u0440\u0430\u043a\u043d\u0438 \u0434\u0432\u0430 \u043f\u044a\u0442\u0438 \u0437\u0430 \u043a\u0440\u0430\u0439.",dragToDrawLine:"\u041f\u043b\u044a\u0437\u043d\u0438, \u0437\u0430 \u0434\u0430 \u043d\u0430\u0440\u0438\u0441\u0443\u0432\u0430\u0448 \u043b\u0438\u043d\u0438\u044f \u043d\u0430 \u0440\u044a\u043a\u0430.",
dragToDrawEllipse:"\u041f\u043b\u044a\u0437\u043d\u0438, \u0437\u0430 \u0434\u0430 \u043d\u0430\u0440\u0438\u0441\u0443\u0432\u0430\u0448 \u0435\u043b\u0438\u043f\u0441\u0430.",dragToDrawRect:"\u041f\u043b\u044a\u0437\u043d\u0438, \u0437\u0430 \u0434\u0430 \u043d\u0430\u0440\u0438\u0441\u0443\u0432\u0430\u0448 \u043f\u0440\u0430\u0432\u043e\u044a\u0433\u044a\u043b\u043d\u0438\u043a.",clkToSetPolygon:"\u0429\u0440\u0430\u043a\u043d\u0438, \u0437\u0430 \u0434\u0430 \u043c\u0430\u0440\u043a\u0438\u0440\u0430\u0448 \u0442\u043e\u0447\u043a\u0438 \u0437\u0430 \u043c\u043d\u043e\u0433\u043e\u044a\u0433\u044a\u043b\u043d\u0438\u043a. \u0429\u0440\u0430\u043a\u043d\u0438 \u0434\u0432\u0430 \u043f\u044a\u0442\u0438 \u0437\u0430 \u043a\u0440\u0430\u0439.",
dragToDrawPolygon:"\u0429\u0440\u0430\u043a\u043d\u0438, \u0437\u0430 \u0434\u0430 \u043d\u0430\u0440\u0438\u0441\u0443\u0432\u0430\u0448 \u043c\u043d\u043e\u0433\u043e\u044a\u0433\u044a\u043b\u043d\u0438\u043a \u043d\u0430 \u0440\u044a\u043a\u0430.",clkShapeToResize:"\u0429\u0440\u0430\u043a\u043d\u0438 \u0437\u0430 \u043f\u0440\u0435\u043c\u0430\u0449\u0430\u0431\u0438\u0440\u0430\u043d\u0435 \u0438\u043b\u0438 \u043f\u0440\u0435\u043c\u0435\u0441\u0442\u0432\u0430\u043d\u0435 \u043d\u0430 \u0444\u043e\u0440\u043c\u0430. \u041f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u0438\u0440\u0430\u0439 \u043a\u0443\u0440\u0441\u043e\u0440\u0430 \u0431\u043b\u0438\u0437\u043e \u0434\u043e \u044a\u0433\u044a\u043b \u043d\u0430 \u0432\u044a\u0440\u0442\u0435\u043d\u0435.",
clkShapeToModify:"\u0429\u0440\u0430\u043a\u043d\u0438 \u0432\u044a\u0440\u0445\u0443 \u0444\u043e\u0440\u043c\u0430, \u0437\u0430 \u0434\u0430 \u043f\u0440\u043e\u043c\u0435\u043d\u0438\u0448 \u0442\u043e\u0447\u043a\u0438\u0442\u0435 \u043d\u0430 \u0444\u043e\u0440\u043c\u0430\u0442\u0430. \u0414\u043e\u043a\u0430\u0442\u043e \u0434\u044a\u0440\u0436\u0438\u0448 \u043a\u0443\u0440\u0441\u043e\u0440\u0430 \u043d\u0430\u0434 \u0442\u043e\u0447\u043a\u0430\u0442\u0430, \u043d\u0430\u0442\u0438\u0441\u043d\u0438 \u043a\u043b\u0430\u0432\u0438\u0448\u0430 \u0418\u0437\u0442\u0440\u0438\u0432\u0430\u043d\u0435 \u0437\u0430 \u043f\u0440\u0435\u043c\u0430\u0445\u0432\u0430\u043d\u0435.",
showShapeInfo:"\u041f\u043e\u043a\u0430\u0436\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e \u043f\u043e\u043b\u0435 \u043d\u0430 \u0444\u043e\u0440\u043c\u0430.",area:"\u0417\u043e\u043d\u0430",length:"\u0414\u044a\u043b\u0436\u0438\u043d\u0430",nodes:"\u0412\u044a\u0437\u043b\u0438",perimeter:"\u041f\u0435\u0440\u0438\u043c\u0435\u0442\u044a\u0440",location:"\u041c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435",dragPan:"Drag the map to pan",
boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Spherical=ALKMaps.Spherical||{};ALKMaps.Spherical.DEFAULT_RADIUS=6378137;ALKMaps.Spherical.computeDistanceBetween=function(a,b,c){var c=c||ALKMaps.Spherical.DEFAULT_RADIUS,d=Math.sin(Math.PI*(b.lon-a.lon)/360),e=Math.sin(Math.PI*(b.lat-a.lat)/360),a=e*e+d*d*Math.cos(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180);return 2*c*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))};
ALKMaps.Spherical.computeHeading=function(a,b){var c=Math.sin(Math.PI*(a.lon-b.lon)/180)*Math.cos(Math.PI*b.lat/180),d=Math.cos(Math.PI*a.lat/180)*Math.sin(Math.PI*b.lat/180)-Math.sin(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180)*Math.cos(Math.PI*(a.lon-b.lon)/180);return 180*Math.atan2(c,d)/Math.PI};ALKMaps.Marker2.Anchored=ALKMaps.Class(ALKMaps.Marker2,{fixedRelativePosition:!1,relativePosition:null,anchor:null,initialize:function(a,b,c,d,e,f,g){this.anchor=null!=e?e:{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(0,0)};if(null!=g&&null==g.anchor)g.anchor=this.anchor;ALKMaps.Marker2.prototype.initialize.apply(this,[a,b,c,d,f,g])},destroy:function(){this.relativePosition=this.anchor=null;ALKMaps.Marker2.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();ALKMaps.Marker2.prototype.show.apply(this,
arguments)},moveTo:function(a){var b=this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);a=this.calculateNewPx(a);ALKMaps.Marker2.prototype.moveTo.apply(this,Array(a));this.relativePosition!==b&&this.updateRelativePosition()},setSize:function(a){ALKMaps.Marker2.prototype.setSize.apply(this,arguments);this.lonlat&&this.map&&this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))},calculateRelativePosition:function(a){if(this.fixedRelativePosition)return this.relativePosition;
a=this.map.getLonLatFromLayerPx(a);a=this.map.getExtent().determineQuadrant(a);return ALKMaps.Bounds.oppositeQuadrant(a)},updateRelativePosition:function(){},calculateNewPx:function(a){var a=a.offset(this.anchor.offset),b=this.size||this.contentSize,c="t"===this.relativePosition.charAt(0);a.y+=c?-b.h:this.anchor.size.h;c="l"===this.relativePosition.charAt(1);a.x+=c?-b.w:this.anchor.size.w;return a},CLASS_NAME:"ALKMaps.Marker2.Anchored"});
ALKMaps.Marker2.Anchored.topright=function(a,b,c,d,e,f,g){a=new ALKMaps.Marker2.Anchored(a,b,c,d,e,f,g);a.relativePosition="tr";a.fixedRelativePosition=!0;return a};ALKMaps.Marker2.Anchored.topleft=function(a,b,c,d,e,f,g){a=new ALKMaps.Marker2.Anchored(a,b,c,d,e,f,g);a.relativePosition="tl";a.fixedRelativePosition=!0;return a};ALKMaps.Marker2.Anchored.bottomright=function(a,b,c,d,e,f,g){a=new ALKMaps.Marker2.Anchored(a,b,c,d,e,f,g);a.relativePosition="br";a.fixedRelativePosition=!0;return a};
ALKMaps.Marker2.Anchored.bottomleft=function(a,b,c,d,e,f,g){a=new ALKMaps.Marker2.Anchored(a,b,c,d,e,f,g);a.relativePosition="bl";a.fixedRelativePosition=!0;return a};ALKMaps.Lang.de=ALKMaps.Util.applyDefaults({unhandledRequest:"Unbehandelte Anfrager\u00fcckmeldung ${statusText}",Permalink:"Permalink",Overlays:"Overlays","Base Layer":"Grundkarte",readNotImplemented:"Lesen nicht implementiert.",writeNotImplemented:"Schreiben nicht implementiert.",noFID:"Ein Feature, f\u00fcr das keine FID existiert, kann nicht aktualisiert werden.",errorLoadingGML:"Fehler beim Laden der GML-Datei ${url}",browserNotSupported:"Ihr Browser unterst\u00fctzt keine Vektordarstellung. Aktuell unterst\u00fctzte Renderer:\n${renderers}",
componentShouldBe:"addFeatures: Komponente muss vom Typ ${geomType} sein",getFeatureError:"getFeatureFromEvent wurde vom einem Layer ohne Renderer aufgerufen. Dies bedeutet normalerweise, dass ein Layer entfernt wurde, aber nicht Handler, die auf ihn verweisen.",minZoomLevelError:"Die <code>minZoomLevel</code>-Eigenschaft ist nur f\u00fcr die Verwendung mit <code>FixedZoomLevels</code>-untergeordneten Layers vorgesehen. Das dieser <tt>wfs</tt>-Layer die <code>minZoomLevel</code>-Eigenschaft \u00fcberpr\u00fcft ist ein Relikt der Vergangenheit. Wir k\u00f6nnen diese \u00dcberpr\u00fcfung nicht entfernen, ohne das OL basierende Applikationen nicht mehr funktionieren. Daher markieren wir es als veraltet - die <code>minZoomLevel</code>-\u00dcberpr\u00fcfung wird in Version 3.0 entfernt werden. Bitte verwenden Sie stattdessen die Min-/Max-L\u00f6sung, wie sie unter http://trac.openlayers.org/wiki/SettingZoomLevels beschrieben ist.",
commitSuccess:"WFS-Transaktion: Erfolgreich ${response}",commitFailed:"WFS-Transaktion: Fehlgeschlagen ${response}",googleWarning:"Der Google-Layer konnte nicht korrekt geladen werden.<br><br>Um diese Meldung nicht mehr zu erhalten, w\u00e4hlen Sie einen anderen Hintergrundlayer aus dem LayerSwitcher in der rechten oberen Ecke.<br><br>Sehr wahrscheinlich tritt dieser Fehler auf, weil das Skript der Google-Maps-Bibliothek nicht eingebunden wurde oder keinen g\u00fcltigen API-Schl\u00fcssel f\u00fcr Ihre URL enth\u00e4lt.<br><br>Entwickler: Besuche <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>das Wiki</a> f\u00fcr Hilfe zum korrekten Einbinden des Google-Layers",
getLayerWarning:"Der ${layerType}-Layer konnte nicht korrekt geladen werden.<br><br>Um diese Meldung nicht mehr zu erhalten, w\u00e4hlen Sie einen anderen Hintergrundlayer aus dem LayerSwitcher in der rechten oberen Ecke.<br><br>Sehr wahrscheinlich tritt dieser Fehler auf, weil das Skript der '${layerLib}'-Bibliothek nicht eingebunden wurde.<br><br>Entwickler: Besuche <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>das Wiki</a> f\u00fcr Hilfe zum korrekten Einbinden von Layern",
"Scale = 1 : ${scaleDenom}":"Ma\u00dfstab = 1 : ${scaleDenom}",W:"W",E:"O",N:"N",S:"S",layerAlreadyAdded:"Sie versuchen den Layer \u201e${layerName}\u201c zur Karte hinzuzuf\u00fcgen, er wurde aber bereits hinzugef\u00fcgt",reprojectDeprecated:"Sie verwenden die \u201eReproject\u201c-Option des Layers ${layerName}. Diese Option ist veraltet: Sie wurde entwickelt um die Anzeige von Daten auf kommerziellen Basiskarten zu unterst\u00fctzen, aber diese Funktion sollte jetzt durch Unterst\u00fctzung der \u201eSpherical Mercator\u201c erreicht werden. Weitere Informationen sind unter http://trac.openlayers.org/wiki/SphericalMercator verf\u00fcgbar.",
methodDeprecated:"Die Methode ist veraltet und wird in 3.0 entfernt. Bitte verwende stattdessen ${newMethod}.",boundsAddError:"Beide Werte (x und y) m\u00fcssen der add-Funktion \u00fcbergeben werden.",lonlatAddError:"Beide Werte (lon und lat) m\u00fcssen der add-Funktion \u00fcbergeben werden.",pixelAddError:"Beide Werte (x und y) m\u00fcssen der add-Funktion \u00fcbergeben werden.",unsupportedGeometryType:"Nicht unterst\u00fctzter Geometrie-Typ: ${geomType}",filterEvaluateNotImplemented:"\u201eevaluate\u201c ist f\u00fcr diesen Filter-Typ nicht implementiert.",
panup:"Nach oben schwenken",panleft:"Nach links schwenken",zoomworld:"Weltkarte",panright:"Nach rechts schwenken",pandown:"Nach unten schwenken",zoomin:"Vergr\u00f6\u00dfern",zoomout:"Verkleinern",dragme:"Hier ziehen",dragToChangeRoute:"Zum \u00c4ndern der Route ziehen",drawPoints:"Punkte zeichnen",clkToSetPoints:"Klicken, um Punkte f\u00fcr eine Linie festzulegen. Zum Fertigstellen doppelklicken.",dragToDrawLine:"Zum Zeichnen einer Freihandlinie ziehen",dragToDrawEllipse:"Zum Zeichnen einer Ellipse ziehen.",
dragToDrawRect:"Zum Zeichnen eines Polygons ziehen.",clkToSetPolygon:"Klicken, um Punkte f\u00fcr ein Polygon festzulegen. Zum Fertigstellen doppelklicken.",dragToDrawPolygon:"Zum Zeichnen eines Freihandpolygons ziehen",clkShapeToResize:"Auf Form klicken, um ihre Gr\u00f6\u00dfe zu \u00e4ndern oder sie zu verschieben. Zum Drehen den Cursor bei einer Ecke platzieren.",clkShapeToModify:"Auf Form klicken, um die Punkte der Form zu \u00e4ndern. Zum L\u00f6schen mit Cursor auf einen Punkt zeigen und L\u00f6schtaste dr\u00fccken.",
showShapeInfo:"Infofeld f\u00fcr die Form anzeigen.",area:"Fl\u00e4che",length:"L\u00e4nge",nodes:"Knoten",perimeter:"Umfang",location:"Standort",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Layer.Boxes=ALKMaps.Class(ALKMaps.Layer.Markers,{drawMarker:function(a){var b=this.map.getLayerPxFromLonLat({lon:a.bounds.left,lat:a.bounds.top}),c=this.map.getLayerPxFromLonLat({lon:a.bounds.right,lat:a.bounds.bottom});if(null==c||null==b)a.display(!1);else if(b=a.draw(b,{w:Math.max(1,c.x-b.x),h:Math.max(1,c.y-b.y)}),!a.drawn)this.div.appendChild(b),a.drawn=!0},removeMarker:function(a){ALKMaps.Util.removeItem(this.markers,a);null!=a.div&&a.div.parentNode==this.div&&this.div.removeChild(a.div)},
CLASS_NAME:"ALKMaps.Layer.Boxes"});ALKMaps.Queue=ALKMaps.Class({maxSize:100,data:null,currentPosition:-1,initialize:function(a){if(null!=a)this.maxSize=a;this.data=[]},clone:function(){var a=new ALKMaps.Queue(this.maxSize);a.currentPosition=this.currentPosition;for(var b=0;b<this.data.length;b++)a.data.push(this.data[b]);return a},current:function(){return 0>this.currentPosition||this.currentPosition>this.data.length-1?null:this.data[this.currentPosition]},first:function(){return this.data[0]},last:function(){return 2>this.data.length?
this.first():this.data[this.data.length-1]},size:function(){return this.data.length},add:function(a){0<this.currentPosition&&this.shiftRange(this.currentPosition);this.data.unshift(a);this.size()>this.maxSize&&this.remove();this.currentPosition=0},remove:function(){return this.data.pop()},shiftRange:function(a){if(null!=a){a>this.size()&&(a=this.size());for(var b=0;b<a;)this.data.shift(),b++}},clear:function(){this.data=[];this.currentPosition=-1},destroy:function(){this.data=null;this.currentPosition=
-1},CLASS_NAME:"ALKMaps.Queue"});ALKMaps.Lang.en={unhandledRequest:"Unhandled request return ${statusText}",Permalink:"Permalink",Overlays:"Overlays","Base Layer":"Base Layer",readNotImplemented:"Read not implemented.",writeNotImplemented:"Write not implemented.",noFID:"Can't update a feature for which there is no FID.",errorLoadingGML:"Error in loading GML file ${url}",browserNotSupported:"Your browser does not support vector rendering. Currently supported renderers are:\n${renderers}",componentShouldBe:"addFeatures : component should be an ${geomType}",
getFeatureError:"getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.",minZoomLevelError:"The minZoomLevel property is only intended for use with the FixedZoomLevels-descendent layers. That this wfs layer checks for minZoomLevel is a relic of thepast. We cannot, however, remove it without possibly breaking OL based applications that may depend on it. Therefore we are deprecating it -- the minZoomLevel check below will be removed at 3.0. Please instead use min/max resolution setting as described here: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS Transaction: SUCCESS ${response}",commitFailed:"WFS Transaction: FAILED ${response}",googleWarning:"The Google Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the Google Maps library script was either not included, or does not contain the correct API key for your site.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>click here</a>",
getLayerWarning:"The ${layerType} Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the ${layerLib} library script was not correctly included.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>","Scale = 1 : ${scaleDenom}":"Scale = 1 : ${scaleDenom}",W:"W",E:"E",N:"N",S:"S",Graticule:"Graticule",
layerAlreadyAdded:"You tried to add the layer: ${layerName} to the map, but it has already been added",reprojectDeprecated:"You are using the 'reproject' option on the ${layerName} layer. This option is deprecated: its use was designed to support displaying data over commercial basemaps, but that functionality should now be achieved by using Spherical Mercator support. More information is available from http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"This method has been deprecated and will be removed in 3.0. Please use ${newMethod} instead.",
boundsAddError:"You must pass both x and y values to the add function.",lonlatAddError:"You must pass both lon and lat values to the add function.",pixelAddError:"You must pass both x and y values to the add function.",unsupportedGeometryType:"Unsupported geometry type: ${geomType}",filterEvaluateNotImplemented:"evaluate is not implemented for this filter type.",proxyNeeded:"You probably need to set ALKMaps.ProxyHost to access ${url}.See http://trac.osgeo.org/openlayers/wiki/FrequentlyAskedQuestions#ProxyHost",
end:"",panup:"Pan up",panleft:"Pan left",zoomworld:"Zoom world",panright:"Pan right",pandown:"Pan down",zoomin:"Zoom in",zoomout:"Zoom out",dragme:"Drag me",dragToChangeRoute:"Drag to change route",drawPoints:"Draw points",clkToSetPoints:"Click to set points for a line. Double-click to finish.",dragToDrawLine:"Drag to draw a freehand line.",dragToDrawEllipse:"Drag to draw an ellipse.",dragToDrawRect:"Drag to draw a rectangle.",clkToSetPolygon:"Click to set points for a polygon. Double-click to finish.",
dragToDrawPolygon:"Drag to draw a freehand polygon.",clkShapeToResize:"Click a shape to resize or move. Position the cursor near a corner to rotate.",clkShapeToModify:"Click a shape to modify the shape points. With the cursor over a point press the Delete key to remove.",showShapeInfo:"Show shape info box.",area:"Area",length:"Length",nodes:"Nodes",perimeter:"Perimeter",location:"Location",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Protocol=ALKMaps.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{};ALKMaps.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(a){return a&&this.defaultFilter?new ALKMaps.Filter.Logical({type:ALKMaps.Filter.Logical.AND,filters:[this.defaultFilter,a]}):a||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},update:function(){},
"delete":function(){},commit:function(){},abort:function(){},createCallback:function(a,b,c){return ALKMaps.Function.bind(function(){a.apply(this,[b,c])},this)},CLASS_NAME:"ALKMaps.Protocol"});ALKMaps.Protocol.Response=ALKMaps.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(a){ALKMaps.Util.extend(this,a)},success:function(){return 0<this.code},CLASS_NAME:"ALKMaps.Protocol.Response"});ALKMaps.Protocol.Response.SUCCESS=1;
ALKMaps.Protocol.Response.FAILURE=0;ALKMaps.Date={toISOString:function(){if("toISOString"in Date.prototype)return function(a){return a.toISOString()};var a=function(a,c){for(var d=a+"";d.length<c;)d="0"+d;return d};return function(b){return isNaN(b.getTime())?"Invalid Date":b.getUTCFullYear()+"-"+a(b.getUTCMonth()+1,2)+"-"+a(b.getUTCDate(),2)+"T"+a(b.getUTCHours(),2)+":"+a(b.getUTCMinutes(),2)+":"+a(b.getUTCSeconds(),2)+"."+a(b.getUTCMilliseconds(),3)+"Z"}}(),parse:function(a){var b;if((a=a.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/))&&
(a[1]||a[7])){b=parseInt(a[1],10)||0;var c=parseInt(a[2],10)-1||0,d=parseInt(a[3],10)||1;b=new Date(Date.UTC(b,c,d));if(c=a[7]){var d=parseInt(a[4],10),e=parseInt(a[5],10),f=parseFloat(a[6]),g=f|0,f=Math.round(1E3*(f-g));b.setUTCHours(d,e,g,f);"Z"!==c&&(c=parseInt(c,10),a=parseInt(a[8],10)||0,b=new Date(b.getTime()+-1E3*(60*60*c+60*a)))}}else b=new Date("invalid");return b}};(function(){function a(){this._object=function(){if("withCredentials"in new XMLHttpRequest)return new f;if(window.XDomainRequest){var a=new window.XDomainRequest;a.onload=function(){this.readyState=ALKMaps.Request.XMLHttpRequest.DONE;this.status=200;this.statusText="OK";this.onreadystatechange()};a.onerror=function(){this.status=777;this.statusText="Unknown Error"};a.ontimeout=function(){this.status=888;this.statusText="Timeout"};return a}return new window.ActiveXObject("Microsoft.XMLHTTP")}();this._listeners=
[]}function b(){return new a}function c(a){b.onreadystatechange&&b.onreadystatechange.apply(a);a.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function d(a){try{a.responseText=a._object.responseText}catch(b){}try{var c=a._object,d=c.responseXML,e=c.responseText;if(h&&e&&d&&!d.documentElement&&c.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))d=new window.ActiveXObject("Microsoft.XMLDOM"),d.async=!1,d.validateOnParse=!1,d.loadXML(e);a.responseXML=
d&&(h&&0!=d.parseError||!d.documentElement||d.documentElement&&"parsererror"==d.documentElement.tagName)?null:d}catch(f){}try{a.status=a._object.status}catch(g){}try{a.statusText=a._object.statusText}catch(q){}}function e(a){a._object.onreadystatechange=new window.Function}var f=window.XMLHttpRequest,g=!!window.controllers,h=window.document.all&&!window.opera;b.prototype=a.prototype;if(g&&f.wrapped)b.wrapped=f.wrapped;b.UNSENT=0;b.OPENED=1;b.HEADERS_RECEIVED=2;b.LOADING=3;b.DONE=4;b.prototype.readyState=
b.UNSENT;b.prototype.responseText="";b.prototype.responseXML=null;b.prototype.status=0;b.prototype.statusText="";b.prototype.priority="NORMAL";b.prototype.onreadystatechange=null;b.onreadystatechange=null;b.onopen=null;b.onsend=null;b.onabort=null;b.prototype.open=function(a,f,k,m,l){delete this._headers;if(!("withCredentials"in new XMLHttpRequest)&&!1===k)alert("Synchronous requests are not supported by this browser. Change your code to use an asynchronous call.");else{3>arguments.length&&(k=!0);
this._async=k;var p=this,n=this.readyState,q;h&&k&&(q=function(){n!=b.DONE&&(e(p),p.abort())},window.attachEvent("onunload",q));b.onopen&&b.onopen.apply(this,arguments);4<arguments.length?this._object.open(a,f,k,m,l):3<arguments.length?this._object.open(a,f,k,m):this._object.open(a,f,k);this.readyState=b.OPENED;c(this);this._object.onreadystatechange=function(){if(!g||k)p.readyState=p._object.readyState,d(p),p._aborted?p.readyState=b.UNSENT:(p.readyState==b.DONE&&(delete p._data,e(p),h&&k&&window.detachEvent("onunload",
q)),n!=p.readyState&&c(p),n=p.readyState)}}};b.prototype.send=function(a){b.onsend&&b.onsend.apply(this,arguments);arguments.length||(a=null);a&&a.nodeType&&(a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml"));this._data=a;this._object.send(this._data);if(g&&!this._async){this.readyState=b.OPENED;for(d(this);this.readyState<b.DONE&&!(this.readyState++,c(this),this._aborted););}};
b.prototype.abort=function(){b.onabort&&b.onabort.apply(this,arguments);if(this.readyState>b.UNSENT)this._aborted=!0;this._object.abort();e(this);this.readyState=b.UNSENT;delete this._data};b.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};b.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};b.prototype.setRequestHeader=function(a,b){if(!this._headers)this._headers={};this._headers[a]=b;return this._object.setRequestHeader(a,b)};
b.prototype.setWithCredentials=function(a){this._object.withCredentials=a};b.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)return;this._listeners.push([a,b,c])};b.prototype.removeEventListener=function(a,b,c){for(var d=0,e;(e=this._listeners[d])&&!(e[0]==a&&e[1]==b&&e[2]==c);d++);e&&this._listeners.splice(d,1)};b.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,
timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};"readystatechange"==a.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var b=0,c;c=this._listeners[b];b++)c[0]==a.type&&!c[2]&&(c[1].handleEvent||c[1]).apply(this,[a])};b.prototype.toString=function(){return"[object XMLHttpRequest]"};b.toString=function(){return"[XMLHttpRequest]"};if(!window.Function.prototype.apply)window.Function.prototype.apply=
function(a,b){b||(b=[]);a.__func=this;a.__func(b[0],b[1],b[2],b[3],b[4]);delete a.__func};ALKMaps.Request.XMLHttpRequest=b})();ALKMaps.Format.KML=ALKMaps.Class(ALKMaps.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"ALKMaps export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,
removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g};this.externalProjection=new ALKMaps.Projection("EPSG:4326");ALKMaps.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[];this.styles={};this.fetched={};return this.parseData(a,{depth:0,styleBaseUrl:this.styleBaseUrl})},parseData:function(a,b){"string"==typeof a&&(a=ALKMaps.Format.XML.prototype.read.apply(this,
[a]));for(var c=["Link","NetworkLink","Style","StyleMap","Placemark"],d=0,e=c.length;d<e;++d){var f=c[d],g=this.getElementsByTagNameNS(a,"*",f);if(0!=g.length)switch(f.toLowerCase()){case "link":case "networklink":this.parseLinks(g,b);break;case "style":this.extractStyles&&this.parseStyles(g,b);break;case "stylemap":this.extractStyles&&this.parseStyleMaps(g,b);break;case "placemark":this.parseFeatures(g,b)}}return this.features},parseLinks:function(a,b){if(b.depth>=this.maxDepth)return!1;var c=ALKMaps.Util.extend({},
b);c.depth++;for(var d=0,e=a.length;d<e;d++){var f=this.parseProperty(a[d],"*","href");f&&!this.fetched[f]&&(this.fetched[f]=!0,(f=this.fetchLink(f))&&this.parseData(f,c))}},fetchLink:function(a){if(a=ALKMaps.Request.GET({url:a,async:!1}))return a.responseText},parseStyles:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=this.parseStyle(a[c]);e&&(this.styles[(b.styleBaseUrl||"")+"#"+e.id]=e)}},parseKmlColor:function(a){var b=null;a&&(a=a.match(this.regExes.kmlColor))&&(b={color:"#"+a[4]+a[3]+a[2],
opacity:parseInt(a[1],16)/255});return b},parseStyle:function(a){for(var b={},c=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],d,e,f=0,g=c.length;f<g;++f)if(d=c[f],e=this.getElementsByTagNameNS(a,"*",d)[0])switch(d.toLowerCase()){case "linestyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.strokeColor=d.color,b.strokeOpacity=d.opacity;(d=this.parseProperty(e,"*","width"))&&(b.strokeWidth=d);break;case "polystyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.fillOpacity=
d.opacity,b.fillColor=d.color;"0"==this.parseProperty(e,"*","fill")&&(b.fillColor="none");"0"==this.parseProperty(e,"*","outline")&&(b.strokeWidth="0");break;case "iconstyle":var h=parseFloat(this.parseProperty(e,"*","scale")||1);d=32*h;var i=32*h,j=this.getElementsByTagNameNS(e,"*","Icon")[0];if(j){var k=this.parseProperty(j,"*","href");if(k){var m=this.parseProperty(j,"*","w"),l=this.parseProperty(j,"*","h");ALKMaps.String.startsWith(k,"http://maps.google.com/mapfiles/kml")&&!m&&!l&&(l=m=64,h/=
2);m=m||l;l=l||m;m&&(d=parseInt(m)*h);l&&(i=parseInt(l)*h);if(l=k.match(this.regExes.kmlIconPalette))m=l[1],l=l[2],k=this.parseProperty(j,"*","x"),j=this.parseProperty(j,"*","y"),k="http://maps.google.com/mapfiles/kml/pal"+m+"/icon"+(8*(j?7-j/32:7)+(k?k/32:0))+l;b.graphicOpacity=1;b.externalGraphic=k}}if(e=this.getElementsByTagNameNS(e,"*","hotSpot")[0])k=parseFloat(e.getAttribute("x")),j=parseFloat(e.getAttribute("y")),m=e.getAttribute("xunits"),"pixels"==m?b.graphicXOffset=-k*h:"insetPixels"==m?
b.graphicXOffset=-d+k*h:"fraction"==m&&(b.graphicXOffset=-d*k),e=e.getAttribute("yunits"),"pixels"==e?b.graphicYOffset=-i+j*h+1:"insetPixels"==e?b.graphicYOffset=-(j*h)+1:"fraction"==e&&(b.graphicYOffset=-i*(1-j)+1);b.graphicWidth=d;b.graphicHeight=i;break;case "balloonstyle":(e=ALKMaps.Util.getXmlNodeValue(e))&&(b.balloonStyle=e.replace(this.regExes.straightBracket,"${$1}"));break;case "labelstyle":if(d=this.parseProperty(e,"*","color"),d=this.parseKmlColor(d))b.fontColor=d.color,b.fontOpacity=d.opacity}!b.strokeColor&&
b.fillColor&&(b.strokeColor=b.fillColor);if((a=a.getAttribute("id"))&&b)b.id=a;return b},parseStyleMaps:function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=this.getElementsByTagNameNS(e,"*","Pair"),e=e.getAttribute("id"),g=0,h=f.length;g<h;g++){var i=f[g],j=this.parseProperty(i,"*","key");(i=this.parseProperty(i,"*","styleUrl"))&&"normal"==j&&(this.styles[(b.styleBaseUrl||"")+"#"+e]=this.styles[(b.styleBaseUrl||"")+i])}},parseFeatures:function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=
a[d],g=this.parseFeature.apply(this,[f]);if(g){if(this.extractStyles&&g.attributes&&g.attributes.styleUrl)g.style=this.getStyle(g.attributes.styleUrl,b);if(this.extractStyles){var h=this.getElementsByTagNameNS(f,"*","Style")[0];if(h&&(h=this.parseStyle(h)))g.style=ALKMaps.Util.extend(g.style,h)}if(this.extractTracks){if((f=this.getElementsByTagNameNS(f,this.namespaces.gx,"Track"))&&0<f.length)g={features:[],feature:g},this.readNode(f[0],g),0<g.features.length&&c.push.apply(c,g.features)}else c.push(g)}else throw"Bad Placemark: "+
d;}this.features=this.features.concat(c)},readers:{kml:{when:function(a,b){b.whens.push(ALKMaps.Date.parse(this.getChildValue(a)))},_trackPointAttribute:function(a,b){var c=a.nodeName.split(":").pop();b.attributes[c].push(this.getChildValue(a))}},gx:{Track:function(a,b){var c={whens:[],points:[],angles:[]};if(this.trackAttributes){var d;c.attributes={};for(var e=0,f=this.trackAttributes.length;e<f;++e)if(d=this.trackAttributes[e],c.attributes[d]=[],!(d in this.readers.kml))this.readers.kml[d]=this.readers.kml._trackPointAttribute}this.readChildNodes(a,
c);if(c.whens.length!==c.points.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:coord ("+c.points.length+") elements.");var g=0<c.angles.length;if(g&&c.whens.length!==c.angles.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:angles ("+c.angles.length+") elements.");for(var h,i,e=0,f=c.whens.length;e<f;++e){h=b.feature.clone();h.fid=b.feature.fid||b.feature.id;i=c.points[e];h.geometry=i;if("z"in i)h.attributes.altitude=i.z;this.internalProjection&&
this.externalProjection&&h.geometry.transform(this.externalProjection,this.internalProjection);if(this.trackAttributes){i=0;for(var j=this.trackAttributes.length;i<j;++i)h.attributes[d]=c.attributes[this.trackAttributes[i]][e]}h.attributes.when=c.whens[e];h.attributes.trackId=b.feature.id;if(g)i=c.angles[e],h.attributes.heading=parseFloat(i[0]),h.attributes.tilt=parseFloat(i[1]),h.attributes.roll=parseFloat(i[2]);b.features.push(h)}},coord:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,
"").split(/\s+/),d=new ALKMaps.Geometry.Point(c[0],c[1]);if(2<c.length)d.z=parseFloat(c[2]);b.points.push(d)},angles:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/);b.angles.push(c)}}},parseFeature:function(a){for(var b=["MultiGeometry","Polygon","LineString","Point"],c,d,e,f=0,g=b.length;f<g;++f)if(c=b[f],this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns,d=this.getElementsByTagNameNS(a,this.internalns,c),0<d.length){if(b=this.parseGeometry[c.toLowerCase()])e=
b.apply(this,[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var h;this.extractAttributes&&(h=this.parseAttributes(a));c=new ALKMaps.Feature.Vector(e,h);a=a.getAttribute("id")||a.getAttribute("name");if(null!=a)c.fid=a;return c},getStyle:function(a,b){var c=ALKMaps.Util.removeTail(a),d=ALKMaps.Util.extend({},b);d.depth++;d.styleBaseUrl=c;!this.styles[a]&&!ALKMaps.String.startsWith(a,
"#")&&d.depth<=this.maxDepth&&!this.fetched[c]&&(c=this.fetchLink(c))&&this.parseData(c,d);return ALKMaps.Util.extend({},this.styles[a])},parseGeometry:{point:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),a=[];if(0<b.length)var c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.removeSpace,""),a=c.split(",");b=null;if(1<a.length)2==a.length&&(a[2]=null),b=new ALKMaps.Geometry.Point(a[0],a[1],a[2]);else throw"Bad coordinate string: "+c;return b},linestring:function(a,
b){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),d=null;if(0<c.length){for(var c=this.getChildValue(c[0]),c=c.replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),d=c.split(this.regExes.splitSpace),e=d.length,f=Array(e),g,h,i=0;i<e;++i)if(g=d[i].split(","),h=g.length,1<h)2==g.length&&(g[2]=null),f[i]=new ALKMaps.Geometry.Point(g[0],g[1],g[2]);else throw"Bad LineString point coordinates: "+d[i];if(e)d=b?new ALKMaps.Geometry.LinearRing(f):new ALKMaps.Geometry.LineString(f);
else throw"Bad LineString coordinates: "+c;}return d},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.internalns,"LinearRing"),b=a.length,c=Array(b);if(0<b)for(var d=0,e=a.length;d<e;++d)if(b=this.parseGeometry.linestring.apply(this,[a[d],!0]))c[d]=b;else throw"Bad LinearRing geometry: "+d;return new ALKMaps.Geometry.Polygon(c)},multigeometry:function(a){for(var b,c=[],d=a.childNodes,e=0,f=d.length;e<f;++e)a=d[e],1==a.nodeType&&(b=this.parseGeometry[(a.prefix?a.nodeName.split(":")[1]:
a.nodeName).toLowerCase()])&&c.push(b.apply(this,[a]));return new ALKMaps.Geometry.Collection(c)}},parseAttributes:function(a){var b={},c=a.getElementsByTagName("ExtendedData");c.length&&(b=this.parseExtendedData(c[0]));for(var d,e,f,a=a.childNodes,c=0,g=a.length;c<g;++c)if(d=a[c],1==d.nodeType&&(e=d.childNodes,1<=e.length&&3>=e.length)){switch(e.length){case 1:f=e[0];break;case 2:f=e[0];e=e[1];f=3==f.nodeType||4==f.nodeType?f:e;break;default:f=e[1]}if(3==f.nodeType||4==f.nodeType)if(d=d.prefix?d.nodeName.split(":")[1]:
d.nodeName,f=ALKMaps.Util.getXmlNodeValue(f))f=f.replace(this.regExes.trimSpace,""),b[d]=f}return b},parseExtendedData:function(a){var b={},c,d,e,f,g=a.getElementsByTagName("Data");for(c=0,d=g.length;c<d;c++){e=g[c];f=e.getAttribute("name");var h={},i=e.getElementsByTagName("value");i.length&&(h.value=this.getChildValue(i[0]));this.kvpAttributes?b[f]=h.value:(e=e.getElementsByTagName("displayName"),e.length&&(h.displayName=this.getChildValue(e[0])),b[f]=h)}a=a.getElementsByTagName("SimpleData");for(c=
0,d=a.length;c<d;c++)h={},e=a[c],f=e.getAttribute("name"),h.value=this.getChildValue(e),this.kvpAttributes?b[f]=h.value:(h.displayName=f,b[f]=h);return b},parseProperty:function(a,b,c){var d,a=this.getElementsByTagNameNS(a,b,c);try{d=ALKMaps.Util.getXmlNodeValue(a[0])}catch(e){d=null}return d},write:function(a){ALKMaps.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS(this.kmlns,"kml"),c=this.createFolderXML(),d=0,e=a.length;d<e;++d)c.appendChild(this.createPlacemarkXML(a[d]));b.appendChild(c);
return ALKMaps.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var b=this.createElementNS(this.kmlns,"name"),c=this.createTextNode(this.foldersName);b.appendChild(c);a.appendChild(b)}this.foldersDesc&&(b=this.createElementNS(this.kmlns,"description"),c=this.createTextNode(this.foldersDesc),b.appendChild(c),a.appendChild(b));return a},createPlacemarkXML:function(a){var b=this.createElementNS(this.kmlns,"name");
b.appendChild(this.createTextNode(a.style&&a.style.label?a.style.label:a.attributes.name||a.id));var c=this.createElementNS(this.kmlns,"description");c.appendChild(this.createTextNode(a.attributes.description||this.placemarksDesc));var d=this.createElementNS(this.kmlns,"Placemark");null!=a.fid&&d.setAttribute("id",a.fid);d.appendChild(b);d.appendChild(c);b=this.buildGeometryNode(a.geometry);d.appendChild(b);a.attributes&&(a=this.buildExtendedData(a.attributes))&&d.appendChild(a);return d},buildGeometryNode:function(a){var b=
a.CLASS_NAME,b=this.buildGeometry[b.substring(b.lastIndexOf(".")+1).toLowerCase()],c=null;b&&(c=b.apply(this,[a]));return c},buildGeometry:{point:function(a){var b=this.createElementNS(this.kmlns,"Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(a){var b=this.createElementNS(this.kmlns,"LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){return this.buildGeometry.collection.apply(this,
[a])},linearring:function(a){var b=this.createElementNS(this.kmlns,"LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){for(var b=this.createElementNS(this.kmlns,"Polygon"),a=a.components,c,d,e=0,f=a.length;e<f;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.kmlns,c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},
collection:function(a){for(var b=this.createElementNS(this.kmlns,"MultiGeometry"),c,d=0,e=a.components.length;d<e;++d)(c=this.buildGeometryNode.apply(this,[a.components[d]]))&&b.appendChild(c);return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.kmlns,"coordinates"),c;if(c=a.components){for(var d=c.length,e=Array(d),f=0;f<d;++f)a=c[f],e[f]=this.buildCoordinates(a);c=e.join(" ")}else c=this.buildCoordinates(a);c=this.createTextNode(c);b.appendChild(c);return b},buildCoordinates:function(a){this.internalProjection&&
this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return a.x+","+a.y},buildExtendedData:function(a){var b=this.createElementNS(this.kmlns,"ExtendedData"),c;for(c in a)if(a[c]&&"name"!=c&&"description"!=c&&"styleUrl"!=c){var d=this.createElementNS(this.kmlns,"Data");d.setAttribute("name",c);var e=this.createElementNS(this.kmlns,"value");if("object"==typeof a[c]){if(a[c].value&&e.appendChild(this.createTextNode(a[c].value)),a[c].displayName){var f=this.createElementNS(this.kmlns,
"displayName");f.appendChild(this.getXMLDoc().createCDATASection(a[c].displayName));d.appendChild(f)}}else e.appendChild(this.createTextNode(a[c]));d.appendChild(e);b.appendChild(d)}return this.isSimpleContent(b)?null:b},CLASS_NAME:"ALKMaps.Format.KML"});ALKMaps.Protocol.CustomPlaces=ALKMaps.Class(ALKMaps.Protocol,{format:null,initialize:function(a){a=a||{};this.format=a.format?a.format:new ALKMaps.Format.KML({extractStyles:!0,extractAttributes:!0});ALKMaps.Protocol.prototype.initialize.apply(this,arguments)},destroy:function(){ALKMaps.Protocol.prototype.destroy.apply(this)},handleResponse:function(a,b){if(b.callback){if(a.code===ALKMaps.Protocol.Response.SUCCESS&&a.data&&0<a.data.length)a.features=this.parseFeatures(a.data);b.callback.call(b.scope,
{id:a.tileId,features:a.features,code:a.code})}},parseFeatures:function(a){function b(a){var b=a.format,c=a.v,a=b.createElementNS("",a.tag);a.appendChild(b.createTextNode(c));return a}function c(a){var c=a.format,d=a.nameText,e=a.idVal,a=c.createElementNS("",a.tag);e&&c.setAttributeNS(a,"","id",e);d&&(c=b({format:c,tag:"name",v:d}),a.appendChild(c));return a}function d(a){for(var c=a.format,d=a.tags,e=a.vs,a=c.createElementNS("",a.ptag),f=0;f<d.length;f++){var g=b({format:c,tag:d[f],v:e[f]});a.appendChild(g)}return a}
function e(a){var d=a.format,e=a.despText,f=a.styleUrlText,g=a.coordinatesText,a=c({format:d,tag:"Placemark",nameText:a.nameText});a.appendChild(b({format:d,tag:"description",v:e}));a.appendChild(b({format:d,tag:"styleUrl",v:f}));e=d.createElementNS("","Point");e.appendChild(b({format:d,tag:"coordinates",v:g}));a.appendChild(e);return a}var f=new ALKMaps.Format.XML,g=c({format:f,tag:"Document",nameText:"Custom places"}),h=c({format:f,tag:"Style",idVal:"normalStyle"});h.appendChild(function(a){var c=
a.format,a=c.createElementNS("","hotSpot");c.setAttributeNS(a,"","x","0.5");c.setAttributeNS(a,"","y","0.5");c.setAttributeNS(a,"","xunits","fraction");c.setAttributeNS(a,"","yunits","fraction");var d=b({format:c,tag:"scale",v:0.4}),e=ALKMaps.Util.getImageLocation("fav.png"),f=b({format:c,tag:"href",v:e}),e=c.createElementNS("","Icon");e.appendChild(f);c=c.createElementNS("","IconStyle");c.appendChild(a);c.appendChild(d);c.appendChild(e);return c}({format:f}));h.appendChild(d({format:f,ptag:"LabelStyle",
tags:["color"],vs:["ff00aaff"]}));g.appendChild(h);h=c({format:f,tag:"StyleMap",idVal:"styleMap"});h.appendChild(d({format:f,ptag:"Pair",tags:["key","styleUrl"],vs:["normal","#normalStyle"]}));g.appendChild(h);for(var h=c({format:f,tag:"Folder",nameText:"Custom places folder"}),i=0;i<a.length;i++)for(var j=a[i].CustomPlaces,k=0;k<j.length;k++){var m=j[k].Coords,m=e({format:f,nameText:"",despText:"Custom Places: "+k+" * "+i,styleUrlText:"#styleMap",coordinatesText:m.Lon+","+m.Lat+",0"});h.appendChild(m)}g.appendChild(h);
a=f.read('<?xml version="1.0" encoding="UTF-8"?><kml xmlns="http://www.opengis.net/kml/2.2"></kml>');a.documentElement.appendChild(g);f=f.write(a);f=f.replace('<Document xmlns="">',"<Document>");return this.format.read(f)},readTile:function(a,b){var c=new ALKMaps.Protocol.Response({tileId:a.id});ALKMaps.Services.getCustomPlaces({id:a.custPlaceSetId,tag:a.custPlaceTag,bounds:a.bounds,placeName:a.placeName,catId:a.catId,catName:a.catName,success:function(a){c.code=ALKMaps.Protocol.Response.SUCCESS;
c.data=a;b.scope.handleResponse(c,b)},failure:function(){c.code=ALKMaps.Protocol.Response.FAILURE;b.scope.handleResponse(c,b)}})},readTiles:function(a,b){for(var b=ALKMaps.Util.applyDefaults(b,this.options),c=function(a){b.callback.call(b.scope,a)},d=0;d<a.length;d++)this.readTile(a[d],ALKMaps.Util.applyDefaults({callback:c,scope:this,tileId:a[d].id},b))},CLASS_NAME:"ALKMaps.Protocol.CustomPlaces"});ALKMaps.Layer.Text=ALKMaps.Class(ALKMaps.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(a,b){ALKMaps.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=[]},destroy:function(){ALKMaps.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){if(!this.loaded&&null!=this.location)this.events.triggerEvent("loadstart"),ALKMaps.Request.GET({url:this.location,success:this.parseData,
failure:function(){this.events.triggerEvent("loadend")},scope:this}),this.loaded=!0},moveTo:function(a,b,c){ALKMaps.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&&!this.loaded&&this.loadText()},parseData:function(a){var a=a.responseText,b={};ALKMaps.Util.extend(b,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject()))b.externalProjection=this.projection,b.internalProjection=this.map.getProjectionObject();for(var a=(new ALKMaps.Format.Text(b)).read(a),
b=0,c=a.length;b<c;b++){var d={},e=a[b],f,g,h;f=new ALKMaps.LonLat(e.geometry.x,e.geometry.y);e.style.graphicWidth&&e.style.graphicHeight&&(g=new ALKMaps.Size(e.style.graphicWidth,e.style.graphicHeight));void 0!==e.style.graphicXOffset&&void 0!==e.style.graphicYOffset&&(h=new ALKMaps.Pixel(e.style.graphicXOffset,e.style.graphicYOffset));null!=e.style.externalGraphic?d.icon=new ALKMaps.Icon(e.style.externalGraphic,g,h):(d.icon=ALKMaps.Marker.defaultIcon(),null!=g&&d.icon.setSize(g));null!=e.attributes.title&&
null!=e.attributes.description&&(d.popupContentHTML="<h2>"+e.attributes.title+"</h2><p>"+e.attributes.description+"</p>");d.overflow=e.attributes.overflow||"auto";d=new ALKMaps.Feature(this,f,d);this.features.push(d);f=d.createMarker();null!=e.attributes.title&&null!=e.attributes.description&&f.events.register("click",d,this.markerClick);this.addMarker(f)}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=!b?this:null;for(var c=
0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||this.layer.map.addPopup(this.createPopup());ALKMaps.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0<this.features.length;){var a=this.features[0];ALKMaps.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"ALKMaps.Layer.Text"});ALKMaps.Control.FeatureEvent=ALKMaps.Class(ALKMaps.Control.SelectFeature,{handleRightClicks:!0,featureAttributesFilter:null,documentDrag:!1,dragCallbacks:{},initialize:function(a,b){b=b||{};ALKMaps.Control.SelectFeature.prototype.initialize.apply(this,arguments);if(null!=b)this.callbacks=ALKMaps.Util.extend({click:this.clickFeature,rightclick:this.rightClickFeature,clickout:this.clickoutFeature,rightclickout:this.rightClickoutFeature,over:this.overFeature,out:this.outFeature},this.callbacks),this.handlers=
{feature:new ALKMaps.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes,featureAttributesFilter:b.featureAttributesFilter,alwaysTrigger:!0}),drag:new ALKMaps.Handler.Drag(this,ALKMaps.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag,lockMapPanning:!1})},this.featureAttributesFilter=b.featureAttributesFilter},deactivate:function(){this.handlers.drag.deactivate();this.lastPixel=
null;ALKMaps.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");return ALKMaps.Control.SelectFeature.prototype.deactivate.apply(this,arguments)},clickFeature:function(a){var b=a.layer,c=b.map.getLonLatFromViewPortPx(this.lastPixel);if(!1!==b.events.triggerEvent("featureclicked",{feature:a,lastPixel:this.lastPixel,lastLonLat:c}))this.renderIntent="select",ALKMaps.Control.SelectFeature.prototype.clickFeature.apply(this,arguments)},rightClickFeature:function(a){!1!==a.layer.events.triggerEvent("featurerightclicked",
{feature:a})&&this.map.disableContextMenu()},clickoutFeature:function(a){this.handlers.drag.stopDown=!0;!1!==a.layer.events.triggerEvent("featureclickedout",{feature:a})&&ALKMaps.Control.SelectFeature.prototype.clickoutFeature.apply(this,arguments)},rightClickoutFeature:function(a){!1!==a.layer.events.triggerEvent("featurerightclickedout",{feature:a})&&this.map.enableContextMenu()},overFeature:function(a){if(!this.handlers.drag.dragging)this.handlers.drag.activate(),this.over=!0,!1!==a.layer.events.triggerEvent("overFeature",
{feature:a})&&ALKMaps.Control.SelectFeature.prototype.overFeature.apply(this,arguments)},downFeature:function(a){this.lastPixel=a;this.handlers.drag.stopDown=!1},moveFeature:function(a){if(!0===this.handlers.drag.panLock)this.map.pan(1*(this.lastPixel.x-a.x),1*(this.lastPixel.y-a.y),{dragging:!0,animate:!1}),this.lastPixel=a},upFeature:function(a){this.over||this.handlers.drag.deactivate();if(!0===this.handlers.drag.panLock)this.map.pan(1*(this.lastPixel.x-a.x),1*(this.lastPixel.y-a.y),{dragging:!1,
animate:!1}),this.lastPixel=a},doneDragging:function(){},outFeature:function(a){if(!this.handlers.drag.dragging)this.over=!1,this.handlers.drag.deactivate(),!1!==a.layer.events.triggerEvent("outFeature",{feature:a})&&ALKMaps.Control.SelectFeature.prototype.outFeature.apply(this,arguments)},setMap:function(a){this.handlers.drag.setMap(a);ALKMaps.Control.SelectFeature.prototype.setMap.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.FeatureEvent"});ALKMaps.Layer.HTTPRequest=ALKMaps.Class(ALKMaps.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,b,c,d){ALKMaps.Layer.prototype.initialize.apply(this,[a,d]);this.url=b;if(!this.params)this.params=ALKMaps.Util.extend({},c)},destroy:function(){this.params=this.url=null;ALKMaps.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new ALKMaps.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions()));return a=ALKMaps.Layer.prototype.clone.apply(this,
[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=ALKMaps.Util.extend(this.params,a);a=this.redraw();null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):ALKMaps.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){for(var c=1,d=0,e=a.length;d<e;d++)c*=a.charCodeAt(d)*this.URL_HASH_FACTOR,c-=Math.floor(c);return b[Math.floor(c*b.length)]},getFullRequestString:function(a,
b){var c=b||this.url,d=ALKMaps.Util.extend({},this.params),d=ALKMaps.Util.extend(d,a),e=ALKMaps.Util.getParameterString(d);ALKMaps.Util.isArray(c)&&(c=this.selectUrl(e,c));var e=ALKMaps.Util.upperCaseObject(ALKMaps.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&&delete d[f];e=ALKMaps.Util.getParameterString(d);return ALKMaps.Util.urlAppend(c,e)},CLASS_NAME:"ALKMaps.Layer.HTTPRequest"});ALKMaps.Layer.Grid=ALKMaps.Class(ALKMaps.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:ALKMaps.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,
className:null,initialize:function(a,b,c,d){ALKMaps.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this.tileQueue=[];if(null===this.removeBackBufferDelay)this.removeBackBufferDelay=this.singleTile?0:2500;if(null===this.className)this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid";if(!ALKMaps.Animation.isNative)this.deferMoveGriddedTiles=ALKMaps.Function.bind(function(){this.moveGriddedTiles(!0);this.moveTimerId=null},this)},setMap:function(a){ALKMaps.Layer.HTTPRequest.prototype.setMap.call(this,
a);ALKMaps.Element.addClass(this.div,this.className)},removeMap:function(){if(null!==this.moveTimerId)window.clearTimeout(this.moveTimerId),this.moveTimerId=null;this.clearTileQueue();if(null!==this.backBufferTimerId)window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;ALKMaps.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var a=
0,b=this.grid.length;a<b;a++)for(var c=this.grid[a],d=0,e=c.length;d<e;d++)this.destroyTile(c[d]);this.grid=[];this.gridResolution=null}},clone:function(a){null==a&&(a=new ALKMaps.Layer.Grid(this.name,this.url,this.params,this.getOptions()));a=ALKMaps.Layer.HTTPRequest.prototype.clone.apply(this,[a]);if(null!=this.tileSize)a.tileSize=this.tileSize.clone();a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.tileQueue=[];a.tileQueueId=null;a.loading=!1;a.moveTimerId=null;return a},
moveTo:function(a,b,c){ALKMaps.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(null!=a){var d=!this.grid.length||b,e=this.getTilesBounds(),f=this.map.getResolution(),g=this.getServerResolution(f);if(this.singleTile){if(d||!c&&!e.containsBounds(a))b&&"resize"!==this.transitionEffect&&this.removeBackBuffer(),(!b||"resize"===this.transitionEffect)&&this.applyBackBuffer(g),this.initSingleTile(a)}else d=d||!e.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&&
this.map.getMaxExtent()}),f!==g?(a=this.map.calculateBounds(null,g),d&&this.transformDiv(g/f)):(this.div.style.width="100%",this.div.style.height="100%",this.div.style.left="0%",this.div.style.top="0%"),d?(b&&"resize"===this.transitionEffect&&this.applyBackBuffer(g),this.initGriddedTiles(a)):this.moveGriddedTiles()}},getTileData:function(a){var b=null,c=a.lon,d=a.lat,e=this.grid.length;if(this.map&&e){var f=this.map.getResolution(),a=this.tileSize.w,g=this.tileSize.h,h=this.grid[0][0].bounds,i=h.left,
h=h.top;if(c<i&&this.map.baseLayer.wrapDateLine)var j=this.map.getMaxExtent().getWidth(),k=Math.ceil((i-c)/j),c=c+j*k;c=(c-i)/(f*a);d=(h-d)/(f*g);f=Math.floor(c);i=Math.floor(d);0<=i&&i<e&&(e=this.grid[i][f])&&(b={tile:e,i:Math.floor((c-f)*a),j:Math.floor((d-i)*g)})}return b},queueTileDraw:function(a){a=a.object;~ALKMaps.Util.indexOf(this.tileQueue,a)||this.tileQueue.push(a);if(!this.tileQueueId)this.tileQueueId=ALKMaps.Animation.start(ALKMaps.Function.bind(this.drawTileFromQueue,this),null,this.div);
return!1},drawTileFromQueue:function(){0===this.tileQueue.length?this.clearTileQueue():this.tileQueue.shift().draw(!0)},clearTileQueue:function(){ALKMaps.Animation.stop(this.tileQueueId);this.tileQueueId=null;this.tileQueue=[]},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){a=a||this.map.getResolution();if(this.serverResolutions&&-1===ALKMaps.Util.indexOf(this.serverResolutions,a)){var b,c;for(b=this.serverResolutions.length-1;0<=b;b--)if(c=
this.serverResolutions[b],c>a){a=c;break}if(-1===b)throw"no appropriate resolution in serverResolutions";}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?ALKMaps.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},transformDiv:function(a){this.div.style.width=100*a+"%";this.div.style.height=100*a+"%";var b=this.map.getSize(),c=parseInt(this.map.layerContainerDiv.style.left,10),d=(parseInt(this.map.layerContainerDiv.style.top,
10)-b.h/2)*(a-1);this.div.style.left=(c-b.w/2)*(a-1)+"%";this.div.style.top=d+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(a){null!==this.backBufferTimerId&&this.removeBackBuffer();var b=this.gridResolution/a;if(!(512<b||b<1/512)){var c=this.backBuffer;if(!c){c=this.createBackBuffer();if(!c)return;this.div.insertBefore(c,this.div.firstChild);this.backBuffer=c;b=this.grid[0][0].bounds;this.backBufferLonLat={lon:b.left,lat:b.top};this.backBufferResolution=
this.gridResolution}var d=c.style,b=this.backBufferResolution/a;d.width=100*b+"%";d.height=100*b+"%";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);b=parseInt(this.map.layerContainerDiv.style.left,10);d=parseInt(this.map.layerContainerDiv.style.top,10);c.style.left=Math.round(a.x-b)+"%";c.style.top=Math.round(a.y-d)+"%"}},createBackBuffer:function(){var a;if(0<this.grid.length){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";a.style.width=
"100%";a.style.height="100%";for(var b=0,c=this.grid.length;b<c;b++)for(var d=0,e=this.grid[b].length;d<e;d++){var f=this.grid[b][d].createBackBuffer();if(f)f.style.top=b*this.tileSize.h+"%",f.style.left=d*this.tileSize.w+"%",a.appendChild(f)}}return a},removeBackBuffer:function(){if(this.backBuffer&&(this.div.removeChild(this.backBuffer),this.backBufferResolution=this.backBuffer=null,null!==this.backBufferTimerId))window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null},moveByPx:function(){this.singleTile||
this.moveGriddedTiles()},setTileSize:function(a){if(this.singleTile)a=this.map.getSize(),a.h=parseInt(a.h*this.ratio),a.w=parseInt(a.w*this.ratio);ALKMaps.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a=null,b=this.grid.length;if(b)var a=this.grid[b-1][0].bounds,b=this.grid[0].length*a.getWidth(),c=this.grid.length*a.getHeight(),a=new ALKMaps.Bounds(a.left,a.bottom,a.left+b,a.bottom+c);return a},initSingleTile:function(a){this.clearTileQueue();var b=a.getCenterLonLat(),
c=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio,b=new ALKMaps.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2),c=this.map.getLayerPxFromLonLat({lon:b.left,lat:b.top});this.grid.length||(this.grid[0]=[]);(a=this.grid[0][0])?a.moveTo(b,c):(a=this.addTile(b,c),this.addTileMonitoringHooks(a),a.draw(),this.grid[0][0]=a);this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,c=c*this.tileSize.h,e=a.left-b.lon,f=Math.floor(e/
d)-this.buffer,e=-(e/d-f)*this.tileSize.w,f=b.lon+f*d,a=a.top-(b.lat+c),g=Math.ceil(a/c)+this.buffer;return{tilelon:d,tilelat:c,tileoffsetlon:f,tileoffsetlat:b.lat+g*c,tileoffsetx:e,tileoffsety:-(g-a/c)*this.tileSize.h}},getTileOrigin:function(){var a=this.tileOrigin;if(!a)var a=this.getMaxExtent(),b={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],a=new ALKMaps.LonLat(a[b[0]],a[b[1]]);return a},initGriddedTiles:function(a){this.clearTileQueue();
var b=this.map.getSize(),c=Math.ceil(b.h/this.tileSize.h)+Math.max(1,2*this.buffer),b=Math.ceil(b.w/this.tileSize.w)+Math.max(1,2*this.buffer),d=this.getTileOrigin(),e=this.getServerResolution(),d=this.calculateGridLayout(a,d,e),e=Math.round(d.tileoffsetx),f=Math.round(d.tileoffsety),g=d.tileoffsetlon,h=d.tileoffsetlat,i=d.tilelon,j=d.tilelat,k=e,m=g,l=0,p=parseInt(this.map.layerContainerDiv.style.left),n=parseInt(this.map.layerContainerDiv.style.top),d=[],q=this.map.getCenter();do{var o=this.grid[l++];
o||(o=[],this.grid.push(o));var e=k,r=0;do{r||(g=m);var t=new ALKMaps.Bounds(g,h,g+i,h+j),s=e,s=s-p,u=f,u=u-n,u=new ALKMaps.Pixel(s,u);(s=o[r++])?s.moveTo(t,u,!1):(s=this.addTile(t,u),this.addTileMonitoringHooks(s),o.push(s));t=t.getCenterLonLat();d.push({tile:s,distance:Math.pow(t.lon-q.lon,2)+Math.pow(t.lat-q.lat,2)});g+=i;e+=this.tileSize.w}while(g<=a.right+i*this.buffer||r<b);h-=j;f+=this.tileSize.h}while(h>=a.bottom-j*this.buffer||l<c);this.removeExcessTiles(l,r);this.gridResolution=this.getServerResolution();
d.sort(function(a,b){return a.distance-b.distance});a=0;for(c=d.length;a<c;++a)d[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,b){var c=new this.tileClass(this,b,a,null,this.tileSize,this.tileOptions);c.events.register("beforedraw",this,this.queueTileDraw);return c},addTileMonitoringHooks:function(a){a.onLoadStart=function(){if(!1===this.loading)this.loading=!0,this.events.triggerEvent("loadstart");this.events.triggerEvent("tileloadstart",{tile:a});this.numLoadingTiles++};
a.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded",{tile:a});if(0===this.tileQueue.length&&0===this.numLoadingTiles&&(this.loading=!1,this.events.triggerEvent("loadend"),this.backBuffer))this.backBufferTimerId=window.setTimeout(ALKMaps.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)};a.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,
scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(a){if(!a&&!ALKMaps.Animation.isNative)null!=this.moveTimerId&&window.clearTimeout(this.moveTimerId),this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay);else for(var a=this.buffer||1,b=this.getResolutionScale();;){var c=this.grid[0][0].position.x*b+parseInt(this.div.style.left,
10)+parseInt(this.map.layerContainerDiv.style.left),d=this.grid[0][0].position.y*b+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top),e=this.tileSize.w*b,f=this.tileSize.h*b;if(c>-e*(a-1))this.shiftColumn(!0);else if(c<-e*a)this.shiftColumn(!1);else if(d>-f*(a-1))this.shiftRow(!0);else if(d<-f*a)this.shiftRow(!1);else break}},shiftRow:function(a){for(var b=this.grid,c=b[a?0:this.grid.length-1],d=this.getServerResolution(),e=a?-this.tileSize.h:this.tileSize.h,d=d*-e,f=a?
b.pop():b.shift(),g=0,h=c.length;g<h;g++){var i=c[g],j=i.bounds.clone(),i=i.position.clone();j.bottom+=d;j.top+=d;i.y+=e;f[g].moveTo(j,i)}a?b.unshift(f):b.push(f)},shiftColumn:function(a){for(var b=a?-this.tileSize.w:this.tileSize.w,c=this.getServerResolution()*b,d=0,e=this.grid.length;d<e;d++){var f=this.grid[d],g=f[a?0:f.length-1],h=g.bounds.clone(),g=g.position.clone();h.left+=c;h.right+=c;g.x+=b;var i=a?this.grid[d].pop():this.grid[d].shift();i.moveTo(h,g);a?f.unshift(i):f.push(i)}},removeExcessTiles:function(a,
b){for(var c,d;this.grid.length>a;){var e=this.grid.pop();for(c=0,d=e.length;c<d;c++){var f=e[c];this.destroyTile(f)}}for(c=0,d=this.grid.length;c<d;c++)for(;this.grid[c].length>b;)e=this.grid[c],f=e.pop(),this.destroyTile(f)},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),d=c*this.tileSize.w,c=c*this.tileSize.h,e=this.getLonLatFromViewPortPx(a),a=b.left+d*Math.floor((e.lon-b.left)/d),b=b.bottom+
c*Math.floor((e.lat-b.bottom)/c);return new ALKMaps.Bounds(a,b,a+d,b+c)},CLASS_NAME:"ALKMaps.Layer.Grid"});ALKMaps.Layer.WeatherRadar=ALKMaps.Class(ALKMaps.Layer.Grid,{DEFAULT_PARAMS:{display:"radar"},reproject:!1,isBaseLayer:!1,singleTile:!1,sphericalMercator:!0,disableCache:!1,weatherImageType:0,initialize:function(a,b,c){c=c||{};this.disableCache=b.disableCache||!1;c.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME});this.isBaseLayer=!1;if(void 0===c.opacity||null===c.opacity)c.opacity=0.5;if(void 0!==b.display){if("satellite"===b.display)this.weatherImageType=1;if("satellite-infrared-color"===
b.display)this.weatherImageType=2;if("tropical-cyclones-names"===b.display)this.weatherImageType=3;if("stormcells"===b.display)this.weatherImageType=4;if("lightning-strikes"===b.display)this.weatherImageType=5;if("ftemperatures"===b.display)this.weatherImageType=6;if("ftemperatures-max"===b.display)this.weatherImageType=7;if("ftemperatures-min"===b.display)this.weatherImageType=8;if("fqsf-accum"===b.display)this.weatherImageType=9;if("fwind-speeds"===b.display)this.weatherImageType=10;if("wind-speeds"===
b.display)this.weatherImageType=11;if("wind-dir"===b.display)this.weatherImageType=12;if("road-conditions-index"===b.display)this.weatherImageType=13;if("froad-conditions-index"===b.display)this.weatherImageType=14}for(var b=[],d=0;d<ALKMaps.WeatherImgContentServiceURL.length;d++)b.push(ALKMaps.WeatherImgContentServiceURL[d]+"WeatherImageTile");c=ALKMaps.Util.extend({projection:"EPSG:900913",numZoomLevels:20},c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,[a,b,{},c])},clone:function(a){null==
a&&(a=new ALKMaps.Layer.WeatherRadar(this.name,this.params,this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.getXYZ(a),b={AUTHTOKEN:ALKMaps.Util.getApiKey(!0),weatherDisplay:this.weatherImageType};ALKMaps.Util.applyDefaults(b,{x:a.x,y:a.y,z:a.z});return this.getFullRequestString(b)},getXYZ:function(a){var b=this.getServerResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(b*
this.tileSize.h)),b=this.getServerZoom();if(this.wrapDateLine)var d=Math.pow(2,b),c=(c%d+d)%d;return{x:c,y:a,z:b}},setMap:function(a){ALKMaps.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin)this.tileOrigin=new ALKMaps.LonLat(this.maxExtent.left,this.maxExtent.bottom)},CLASS_NAME:"ALKMaps.Layer.WeatherRadar"});(function(a){a.IMAGE=a.IMAGE||{LOAD_BLUE:a.Util.getImageLocation("load_blue.png"),LOAD_RED:a.Util.getImageLocation("load_red.png"),LOAD_GREEN:a.Util.getImageLocation("load_green.png"),LOAD_GRAY:a.Util.getImageLocation("load_gray.png"),TRUCK_BLUE:a.Util.getImageLocation("truck_blue.png"),TRUCK_RED:a.Util.getImageLocation("truck_red.png"),TRUCK_GREEN:a.Util.getImageLocation("truck_green.png"),TRUCK_GRAY:a.Util.getImageLocation("truck_gray.png"),MARKER:a.Util.getImageLocation("marker.png"),MARKER_BLUE:a.Util.getImageLocation("marker_blue.png"),
MARKER_GOLD:a.Util.getImageLocation("marker_gold.png"),MARKER_GREEN:a.Util.getImageLocation("marker_green.png"),ADDRESS:a.Util.getImageLocation("address.png"),AIRPORT:a.Util.getImageLocation("airport.png"),ALLOW_ROAD:a.Util.getImageLocation("allow_road.png"),ATM:a.Util.getImageLocation("atm.png"),ATTRACTION:a.Util.getImageLocation("attraction.png"),AUTO_DEALER:a.Util.getImageLocation("auto_dealer.png"),AUTO_RENTAL:a.Util.getImageLocation("auto_rental.png"),AUTO_REPAIR:a.Util.getImageLocation("auto_repair.png"),
AVOID_ROAD:a.Util.getImageLocation("avoid_road.png"),BANK:a.Util.getImageLocation("bank.png"),BORDER_CROSSING:a.Util.getImageLocation("border_crossing.png"),BUS_STOP:a.Util.getImageLocation("bus_stop.png"),CAT_SCALE:a.Util.getImageLocation("cat_scale.png"),COMMUTER_RAIL:a.Util.getImageLocation("commuter_rail.png"),DIESEL_EXHAUST_FLUID:a.Util.getImageLocation("def.png"),ENTERTAINMENT:a.Util.getImageLocation("entertainment.png"),FAVORITE:a.Util.getImageLocation("fav.png"),FERRY:a.Util.getImageLocation("ferry.png"),
FLAG_END:a.Util.getImageLocation("flag_end.png"),FLAG_START:a.Util.getImageLocation("flag_start.png"),FLAG_STOP:a.Util.getImageLocation("flag_stop.png"),FLAG_WAYPOINT:a.Util.getImageLocation("flag_waypoint.png"),FUEL:a.Util.getImageLocation("fuel.png"),BLANK:a.Util.getImageLocation("generic_result.png"),GATE_ENTRY:a.Util.getImageLocation("entry.png"),GATE_ENTRY_EXIT:a.Util.getImageLocation("entry_exit.png"),GATE_EXIT:a.Util.getImageLocation("exit.png"),GROCERY:a.Util.getImageLocation("grocery.png"),
GROUP:a.Util.getImageLocation("group.png"),HAZMAT_CAUSTIC:a.Util.getImageLocation("hazmat_caustic.png"),HAZMAT_EXPLOSIVE:a.Util.getImageLocation("hazmat_explosive.png"),HAZMAT_FLAMMABLE:a.Util.getImageLocation("hazmat_flammable.png"),HAZMAT_INHALANTS:a.Util.getImageLocation("hazmat_inhalants.png"),HAZMAT_RADIOACTIVE:a.Util.getImageLocation("hazmat_radioactive.png"),HAZMAT_GENERIC_EU:a.Util.getImageLocation("hazmat_restr_eu.png"),HAZMAT_GENERIC_US:a.Util.getImageLocation("hazmat_restr_na.png"),HAZMAT_WATER:a.Util.getImageLocation("hazmat_water.png"),
NO:a.Util.getImageLocation("hide_poi.png"),HOME:a.Util.getImageLocation("home.png"),HOTEL:a.Util.getImageLocation("hotel.png"),REDX:a.Util.getImageLocation("icon_delete.png"),ROUTE:a.Util.getImageLocation("icon_edit_trip.png"),CHECK:a.Util.getImageLocation("icon_fav_saved.png"),HELP:a.Util.getImageLocation("icon_help.png"),INFO_SMALL:a.Util.getImageLocation("icon_info_sml.png"),WEATHER:a.Util.getImageLocation("icon_weather.png"),MARINA:a.Util.getImageLocation("marina.png"),MEDICAL:a.Util.getImageLocation("medical.png"),
MOTORCYCLE_DEALER:a.Util.getImageLocation("motorcycle_dealer.png"),MUNICIPAL:a.Util.getImageLocation("municipal.png"),OIL_GAS:a.Util.getImageLocation("oil_gas.png"),OTHER:a.Util.getImageLocation("other.png"),OTHER_AIRPORT:a.Util.getImageLocation("other_airport.png"),OTHER_LODGING:a.Util.getImageLocation("other_lodging.png"),PARKING:a.Util.getImageLocation("parking.png"),PIN_GREEN:a.Util.getImageLocation("pin_green.png"),PIN_RED:a.Util.getImageLocation("pin_red.png"),PLACE_OF_WORSHIP:a.Util.getImageLocation("place_of_worship.png"),
POI_OTHER:a.Util.getImageLocation("poi_other.png"),PUBLIC_VENUE:a.Util.getImageLocation("public_venue.png"),RECENT:a.Util.getImageLocation("recent.png"),RECREATION:a.Util.getImageLocation("recreation.png"),RESTAURANT:a.Util.getImageLocation("restaurant.png"),REST_AREA:a.Util.getImageLocation("rest_area.png"),RETAIL:a.Util.getImageLocation("retail.png"),RV:a.Util.getImageLocation("rv.png"),SAFETYCAM:a.Util.getImageLocation("safetycam.png"),SCHOOL:a.Util.getImageLocation("school.png"),TRAFFIC_MAP_ACCIDENT:a.Util.getImageLocation("traffic_map_accident.png"),
TRAFFIC_MAP_CONSTRUCTION:a.Util.getImageLocation("traffic_map_construction.png"),TRAFFIC_MAP_INCIDENT:a.Util.getImageLocation("traffic_map_incident.png"),TRAFFIC_MAP_TRAFFICJAM:a.Util.getImageLocation("traffic_map_trafficjam.png"),TRAFFIC_MAP_WEATHER:a.Util.getImageLocation("traffic_map_weather.png"),TRAFFIC_SEVERITY_1:a.Util.getImageLocation("traffic_severity_1.png"),TRAFFIC_SEVERITY_2:a.Util.getImageLocation("traffic_severity_2.png"),TRAFFIC_SEVERITY_3:a.Util.getImageLocation("traffic_severity_3.png"),
TRAIN_STATION:a.Util.getImageLocation("train_station.png"),TRUCK_RESTR_HEIGHT_EU:a.Util.getImageLocation("truck_restr_height_eu.png"),TRUCK_RESTR_HEIGHT_NA:a.Util.getImageLocation("truck_restr_height_na.png"),TRUCK_RESTR_LENGTH_EU:a.Util.getImageLocation("truck_restr_length_eu.png"),TRUCK_RESTR_LENGTH_NA:a.Util.getImageLocation("truck_restr_length_na.png"),TRUCK_RESTR_MULTI_EU:a.Util.getImageLocation("truck_restr_multi_eu.png"),TRUCK_RESTR_MULTI_NA:a.Util.getImageLocation("truck_restr_multi_na.png"),
TRUCK_RESTR_NOTRUCK_EU:a.Util.getImageLocation("truck_restr_notruck_eu.png"),TRUCK_RESTR_NOTRUCK_NA:a.Util.getImageLocation("truck_restr_notruck_na.png"),TRUCK_RESTR_WEIGHT_EU:a.Util.getImageLocation("truck_restr_weight_eu.png"),TRUCK_RESTR_WEIGHT_NA:a.Util.getImageLocation("truck_restr_weight_na.png"),TRUCK_RESTR_WEIGHT_PER_AXLE_EU:a.Util.getImageLocation("truck_restr_weight_per_axle_eu.png"),TRUCK_RESTR_WEIGHT_PER_AXLE_NA:a.Util.getImageLocation("truck_restr_weight_per_axle_na.png"),TRUCK_RESTR_WIDTH_EU:a.Util.getImageLocation("truck_restr_width_eu.png"),
TRUCK_RESTR_WIDTH_NA:a.Util.getImageLocation("truck_restr_width_na.png"),TRUCK_RESTR_DIMENSION:a.Util.getImageLocation("truck-restrictions-dimension.png"),TRUCK_RESTR_GENERAL:a.Util.getImageLocation("truck-restrictions-general.png"),TRUCK_RESTR_HAZMAT:a.Util.getImageLocation("truck-restrictions-hazmat.png"),TRUCK_RESTR_MULTIPLE:a.Util.getImageLocation("truck-restrictions-multiple.png"),TRUCK_STOP:a.Util.getImageLocation("truck_stop.png"),WEBSEARCH:a.Util.getImageLocation("web_result.png"),WIKIPEDIA:a.Util.getImageLocation("wikipedia.png"),
WORK:a.Util.getImageLocation("work.png")}})(ALKMaps);ALKMaps.Strategy.Paging=ALKMaps.Class(ALKMaps.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this});return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this}));return a},cacheFeatures:function(a){if(!this.paging)this.clearCache(),
this.features=a.features,this.pageNext(a)},clearCache:function(){if(this.features)for(var a=0;a<this.features.length;++a)this.features[a].destroy();this.num=this.features=null},pageCount:function(){return Math.ceil((this.features?this.features.length:0)/this.length)},pageNum:function(){return this.num},pageLength:function(a){if(a&&0<a)this.length=a;return this.length},pageNext:function(a){var b=!1;if(this.features){if(null===this.num)this.num=-1;b=this.page((this.num+1)*this.length,a)}return b},pagePrevious:function(){var a=
!1;if(this.features){if(null===this.num)this.num=this.pageCount();a=this.page((this.num-1)*this.length)}return a},page:function(a,b){var c=!1;if(this.features&&0<=a&&a<this.features.length){var d=Math.floor(a/this.length);if(d!=this.num)this.paging=!0,c=this.features.slice(a,a+this.length),this.layer.removeFeatures(this.layer.features),this.num=d,b&&b.features?b.features=c:this.layer.addFeatures(c),this.paging=!1,c=!0}return c},CLASS_NAME:"ALKMaps.Strategy.Paging"});(function(a){if(a){var b=a.ALKMaps.Layer;b.TruckRestrictions=a.GeoJSON.extend({_cacheStrategy:null,_layersDrawn:[],_rbush:null,options:{region:"NA",language:"en",units:0,dataset:"Current",minZoom:16,maxZoom:20,markerOptions:{hazMatMarkerOptions:{icon:a.icon({iconUrl:ALKMaps.IMAGE.TRUCK_RESTR_HAZMAT})},generalMarkerOptions:{icon:a.icon({iconUrl:ALKMaps.IMAGE.TRUCK_RESTR_GENERAL})},dimensionMarkerOptions:{icon:a.icon({iconUrl:ALKMaps.IMAGE.TRUCK_RESTR_DIMENSION})},multiMarkerOptions:{icon:a.icon({iconUrl:ALKMaps.IMAGE.TRUCK_RESTR_MULTIPLE})}},
markerSizes:[[17,[16,16]],[19,[20,20]],[20,[26,26]]],offsets:[[17,[-30,-30,30,30]],[19,[-26,-26,26,26]],[20,[-26,-26,26,26]]]},_describeTruckRestriction:function(a){if(this.options.describeTruckRestrictionPopup&&"function"===typeof this.options.describeTruckRestrictionPopup)return this.options.describeTruckRestrictionPopup(a);for(var b="",e=0;e<a.properties.length;e++)for(var f=a.properties[e],g=0;g<f.descriptions.length;g++)b=b+f.descriptions[g]+"</br>";return b},_drawLayerGroup:function(b,d){if("undefined"!==
typeof rbush)this._rbush=rbush();var e=d._getOffset(),f=a.geoJSON(b,{pointToLayer:function(a,b){if(!(!a||!a.properties||!0===d._collision(a,e))&&Array.isArray(a.properties)){var c=d.options.markerOptions.generalMarkerOptions;if(1<a.properties.length)c=d.options.markerOptions.multiMarkerOptions;else switch((a.properties[0].category||"").toLowerCase()){case "dimensions":c=d.options.markerOptions.dimensionMarkerOptions;break;case "hazmat":c=d.options.markerOptions.hazMatMarkerOptions;break;case "general":c=
d.options.markerOptions.generalMarkerOptions}return L.marker(b,c)}},onEachFeature:function(a,b){if(a&&a.properties){var c=d._describeTruckRestriction(a);null!=c&&("object"===typeof c?b.bindPopup(c.content,c.options):b.bindPopup(c))}}});f.addTo(this._map);return f},_clearLayerGroup:function(a,b){if(b._layersDrawn)for(var e=b._layersDrawn.length-1;0<=e;e--)if(null==a||a===b._layersDrawn[e].qKey)b._layersDrawn[e].custData.clearLayers(),b._layersDrawn.splice(e,1)},_collision:function(b,d){var e=!1;if("Point"===
b.geometry.type){var f=b.geometry.coordinates,f=this._map.latLngToLayerPoint(a.latLng(f[1],f[0])),f={minX:f.x+d[0],minY:f.y+d[1],maxX:f.x+d[2],maxY:f.y+d[3]};null!=this._rbush&&((e=this._rbush.collides(f))||this._rbush.load([f]))}return e},_getOffset:function(){for(var a=this._map.getZoom(),b=this.options.offsets[0][1],e=0;e<this.options.offsets.length;e++){var f=this.options.offsets[e];f[0]<=a&&(b=f[1])}return b},_successCB:function(a,b,e){null!=a&&(!0===e&&b._cacheStrategy.updateVirtualTile(a.requestId,
a),b.options.successCB&&!1===b.options.successCB(a,b)||(b._clearLayerGroup(a.requestId,b),e=b._drawLayerGroup(a.featureCollection.features,b),b._layersDrawn.push({qKey:a.requestId,custData:e})))},_failureCB:function(a,b){if(b.options.failureCB)return b.options.failureCB(a,b)},_getMapBounds:function(){var a=this._map.getBounds(),b=this._normalizeBounds([a._southWest.lng,a._southWest.lat,a._northEast.lng,a._northEast.lat]);a._southWest.lng=b[0];a._southWest.lat=b[1];a._northEast.lng=b[2];a._northEast.lat=
b[3];return a},_drawFromCachedData:function(a){for(var a=this._cacheStrategy.getCachedTileQkeys(a),b=[],e=0;e<this._layersDrawn.length;e++)b.push(this._layersDrawn[e].qKey);for(e=0;e<a.length;e++)this._successCB(this._cacheStrategy.getCachedVirtualTile(a[e]).data,this,!1)},_drawFromServiceData:function(b){for(var d=this,b=this._cacheStrategy.getVirtualBounds(b),e=0;e<b.length;e++){var f=b[e],g=f.bounds;a.ALKMaps.Services.getTruckRestrictions({requestId:f.qKey,bbox:[g._southWest.lng,g._southWest.lat,
g._northEast.lng,g._northEast.lat],language:d.options.language,units:d.options.units,dataset:d.options.dataset,success:function(a){d._successCB(a,d,!0)},failure:function(a){d._failureCB(a,d)}})}},_update:function(){if(this._map){var b=this._map.getZoom();if(b<this.options.minZoom||b>this.options.maxZoom)this._clearLayerGroup(null,this);else{this._updateIconSize(b);var d=this._getMapBounds();this._cacheStrategy.expireVirtualTiles();b=a.ALKMaps.Util.getQkeysFromBounds({right:d._northEast.lng,top:d._northEast.lat,
left:d._southWest.lng,bottom:d._southWest.lat},b,this._cacheStrategy.options.detailLevel);this._drawFromCachedData(b);this._drawFromServiceData(b)}}},_updateProgressBar:function(){},initialize:function(b){if(null!=b&&16>b.minZoom)b.minZoom=16,console.log("options.minZoom can't be less than 16. Set 16 for you.");null!=b&&null!=b.markerSizes&&!0===Array.isArray(b.markerSizes)&&b.markerSizes.sort(function(a,b){return a[0]-b[0]});null!=b&&null!=b.offsets&&!0===Array.isArray(b.offsets)&&b.offsets.sort(function(a,
b){return a[0]-b[0]});a.setOptions(this,b);this._cacheStrategy=a.ALKMaps.Util.virtualTile({detailLevel:16,cacheInterval:2});this._layersDrawn=[];this._rbush=null},onAdd:function(b){a.GeoJSON.prototype.onAdd.call(this,b);this._update();b.on("zoomend",this._update,this);b.on("moveend",this._update,this)},onRemove:function(b){b.off("zoomend",this._update,this);b.off("moveend",this._update,this);this._clearLayerGroup(null,this);a.GeoJSON.prototype.onRemove.call(this,b)},_normalizeLongitude:function(a){var b=
a%180,e=Math.floor(a/180);-180>a&&0===e%2&&(b+=180);180<a&&0!==e%2&&(b-=180);return b},_goesBack:function(a,b){var e=a;if(-1>b||0<b)e=0===b%2?a+180*b:a+180*(b+1);return e},_normalizeBounds:function(b){b[0]=a.ALKMaps.Util.wrapLongitude(b[0]);b[2]=a.ALKMaps.Util.wrapLongitude(b[2]);return b},_updateIconSize:function(a){for(var b=this.options.markerSizes[0][1],e=0;e<this.options.markerSizes.length;e++){var f=this.options.markerSizes[e];f[0]<=a&&(b=f[1])}this.options.markerOptions.hazMatMarkerOptions.icon.options.iconSize=
b;this.options.markerOptions.generalMarkerOptions.icon.options.iconSize=b;this.options.markerOptions.dimensionMarkerOptions.icon.options.iconSize=b;this.options.markerOptions.multiMarkerOptions.icon.options.iconSize=b;a=[0,-(b[1]/2)];this.options.markerOptions.hazMatMarkerOptions.icon.options.popupAnchor=a;this.options.markerOptions.generalMarkerOptions.icon.options.popupAnchor=a;this.options.markerOptions.dimensionMarkerOptions.icon.options.popupAnchor=a;this.options.markerOptions.multiMarkerOptions.icon.options.popupAnchor=
a},CLASS_NAME:"ALKMaps.Layer.TruckRestrictions"});b.truckRestrictions=function(a){return new b.TruckRestrictions(a)}}})("undefined"===typeof L?null:L);ALKMaps.Filter.Spatial=ALKMaps.Class(ALKMaps.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(a){var b=!1;switch(this.type){case ALKMaps.Filter.Spatial.BBOX:case ALKMaps.Filter.Spatial.INTERSECTS:if(a.geometry){var c=this.value;"ALKMaps.Bounds"==this.value.CLASS_NAME&&(c=this.value.toGeometry());a.geometry.intersects(c)&&(b=!0)}break;default:throw Error("evaluate is not implemented for this filter type.");}return b},clone:function(){var a=ALKMaps.Util.applyDefaults({value:this.value&&
this.value.clone&&this.value.clone()},this);return new ALKMaps.Filter.Spatial(a)},CLASS_NAME:"ALKMaps.Filter.Spatial"});ALKMaps.Filter.Spatial.BBOX="BBOX";ALKMaps.Filter.Spatial.INTERSECTS="INTERSECTS";ALKMaps.Filter.Spatial.DWITHIN="DWITHIN";ALKMaps.Filter.Spatial.WITHIN="WITHIN";ALKMaps.Filter.Spatial.CONTAINS="CONTAINS";ALKMaps.Icon=ALKMaps.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,c,d){this.url=a;this.size=b||{w:20,h:20};this.offset=c||{x:-(this.size.w/2),y:-(this.size.h/2)};this.calculateOffset=d;a=ALKMaps.Util.createUniqueID("OL_Icon_");this.imageDiv=ALKMaps.Util.createAlphaImageDiv(a)},destroy:function(){this.erase();ALKMaps.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new ALKMaps.Icon(this.url,
this.size,this.offset,this.calculateOffset)},setSize:function(a){if(null!=a)this.size=a;this.draw()},setUrl:function(a){if(null!=a)this.url=a;this.draw()},draw:function(a){ALKMaps.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(a);return this.imageDiv},erase:function(){null!=this.imageDiv&&null!=this.imageDiv.parentNode&&ALKMaps.Element.remove(this.imageDiv)},setOpacity:function(a){ALKMaps.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,
null,null,a)},moveTo:function(a){if(null!=a)this.px=a;if(null!=this.imageDiv)if(null==this.px)this.display(!1);else{if(this.calculateOffset)this.offset=this.calculateOffset(this.size);ALKMaps.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})}},display:function(a){this.imageDiv.style.display=a?"":"none"},isDrawn:function(){return this.imageDiv&&this.imageDiv.parentNode&&11!=this.imageDiv.parentNode.nodeType},CLASS_NAME:"ALKMaps.Icon"});ALKMaps.Marker=ALKMaps.Class({icon:null,lonlat:null,map:null,labelDiv:null,label:null,mouseOver:!0,labelClass:"alkMarkerLabel",displayClass:"",events:null,eventListeners:null,div:null,labelOffset:"10px",offset:null,initialize:function(a,b,c,d){this.displayClass=this.CLASS_NAME.replace("ALKMaps.","ol").replace(/\./g,"");ALKMaps.Util.extend(this,d);this.lonlat=a;a=b?b:ALKMaps.Marker.defaultIcon();null==this.icon?this.icon=a:(this.icon.url=a.url,this.icon.size=a.size,this.icon.offset=a.offset,this.icon.calculateOffset=
a.calculateOffset);this.events=new ALKMaps.Events(this,this.icon.imageDiv);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);this.label=c;this.labelDiv=ALKMaps.Util.createDiv(this.icon.imageDiv.id+"_Text",null,null);this.labelDiv.className=this.labelClass;this.labelDiv.innerHTML=c;this.labelDiv.style.marginTop=this.labelOffset;if(this.offset&&this.offset.y)this.labelDiv.style.marginTop=this.offset.y+"px";c=ALKMaps.Util.getTextWidth(c,this.labelClass);this.labelDiv.style.marginLeft=
parseInt(c/-2)+"px";if(this.offset&&this.offset.x)this.labelDiv.style.marginLeft=this.offset.x+"px";(null===this.label||!0===this.mouseOver)&&this.setLabelVisibility(!1)},destroy:function(){this.labelDiv=this.label=null;this.erase();this.map=null;this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null;if(null!=this.icon)this.icon.destroy(),this.icon=null},draw:function(a){this.div=this.icon.draw(a);this.div.appendChild(this.labelDiv,
this.div.firstChild);this.div.className=this.displayClass;this.events.register("mouseover",this,this.onmouseover);this.events.register("mouseout",this,this.onmouseout);ALKMaps.isTouch?this.events.register("touchend",this,this.onmouseclick):this.events.register("click",this,this.onmouseclick);return this.div},erase:function(){null!=this.icon&&this.icon.erase()},moveTo:function(a){null!=a&&null!=this.icon&&this.icon.moveTo(a);this.lonlat=this.map.getLonLatFromLayerPx(a)},isDrawn:function(){return this.icon&&
this.icon.isDrawn()},onScreen:function(){var a=!1;this.map&&(a=this.map.getExtent().containsLonLat(this.lonlat));return a},inflate:function(a){this.icon&&this.icon.setSize({w:this.icon.size.w*a,h:this.icon.size.h*a})},setOpacity:function(a){this.icon.setOpacity(a)},setUrl:function(a){this.icon.setUrl(a)},display:function(a){this.icon.display(a)},onmouseover:function(a){if(!1!==this.events.triggerEvent("markerover",{evt:a}))if(null===this.label)this.setLabelVisibility(!1);else if(!0===this.mouseOver){if(!this.mouseovered)this.setLabelVisibility(!0),
this.mouseovered=!0;if(50>this.map.getSize().w-this.map.getPixelFromLonLat(this.lonlat).x)this.labelDiv.style.marginLeft=-10-this.icon.size.w+"px";if(50>this.map.getSize().h-this.map.getPixelFromLonLat(this.lonlat).y)this.labelDiv.style.marginTop=-10-this.icon.size.h+"px";if(this.offset&&this.offset.y)this.labelDiv.style.marginTop=this.offset.y+"px";if(this.offset&&this.offset.x)this.labelDiv.style.marginLeft=this.offset.x+"px";ALKMaps.Event.stop(a,!0)}else this.setLabelVisibility(!0)},onmouseout:function(a){if(!1!==
this.events.triggerEvent("markerout",{evt:a}))if(null===this.label)this.setLabelVisibility(!1);else if(!0===this.mouseOver){this.mouseovered=!1;this.setLabelVisibility(!1);this.labelDiv.style.marginLeft=this.labelOffset;this.labelDiv.style.marginTop=this.labelOffset;if(this.offset&&this.offset.y)this.labelDiv.style.marginTop=this.offset.y+"px";if(this.offset&&this.offset.x)this.labelDiv.style.marginLeft=this.offset.x+"px";ALKMaps.Event.stop(a,!0)}else this.setLabelVisibility(!0)},onmouseclick:function(a){this.events.triggerEvent("markerclick",
{evt:a})},setLabel:function(a){this.label=a;this.labelDiv.innerHTML=a},setLabelVisibility:function(a){this.labelDiv.style.display=a?"block":"none"},getLabelVisibility:function(){return"none"==this.labelDiv.style?!1:!0},CLASS_NAME:"ALKMaps.Marker"});ALKMaps.Marker.defaultIcon=function(){return new ALKMaps.Icon(ALKMaps.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})};ALKMaps.Layer.BaseMap=ALKMaps.Class(ALKMaps.Layer.Grid,{DEFAULT_PARAMS:{style:ALKMaps.STYLE.TRANSPORTATION,format:"image/png",drawergroups:ALKMaps.CONTENT.DEFAULT,region:null,dataset:"Current",authToken:""},reproject:!1,isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,wrapDateLine:!1,displayOutsideMaxExtent:!1,singleTile:!1,tileOrigin:new ALKMaps.LonLat(2.003750834E7,-2.003750834E7),zoomOffset:0,sphericalMercator:!0,projection:"EPSG:900913",transparentOverlayLayer:null,satelliteOnly:!1,localLanguage:!1,restrictedMaxZoom:null,
defaultCopyright:"",tileCacheService:function(a,b){return b},satImageUrls:[],satImageTileUrls:[],initialize:function(a,b,c){this.satImageUrls=[];this.satImageTileUrls=[];for(var d=0;d<ALKMaps.SatImgContentServiceURL.length;d++)this.satImageUrls.push(ALKMaps.SatImgContentServiceURL[d]+"SatImage"),this.satImageTileUrls.push(ALKMaps.SatImgContentServiceURL[d]+"SatImageTile");c=c||{};c.attrUseHyperlink=!1===c.attrUseHyperlink?!1:!0;this.defaultCopyright=!0===c.attrUseHyperlink?ALKMaps.Copyright:ALKMaps.CopyrightWithoutHyperlink;
if(null!=c.attribution)this.defaultCopyright=this.defaultCopyright+" "+c.attribution;c.attribution=this.defaultCopyright;if((c&&!1===c.sphericalMercator||!this.sphericalMercator)&&b){if(ALKMaps.STYLE.compare(b.style,ALKMaps.STYLE.SATELLITE))throw Error("Satellite map only works with Spherical Mercator projection.");if(ALKMaps.STYLE.compare(b.style,ALKMaps.STYLE.TERRAIN))throw Error("Terrain map only works with Spherical Mercator projection.");}this.satelliteOnly=c.satelliteOnly||!1;var e=c.custMaxZoomLevels,
f=20,d=ALKMaps.MapServiceURL+"tile";if(ALKMaps.Util.isArray(ALKMaps.MapServiceURL))for(var d=[],g=0;g<ALKMaps.MapServiceURL.length;g++)d.push(ALKMaps.MapServiceURL[g]+"tile");e&&"number"===typeof e&&0<e&&(f=e);g=156543.03390625;if(c&&!1===c.sphericalMercator||!this.sphericalMercator)g=1.40625;for(var e=[],h=0;h<=f;h++)e.push(g),g/=2;g=0;if(null!=c.zoomOffset)g=c.zoomOffset;0<g&&g<f&&e.splice(0,g);!0===c.singleTile?(d=ALKMaps.MapServiceURL,ALKMaps.Util.isArray(ALKMaps.MapServiceURL)&&(d=ALKMaps.MapServiceURL[0]),
c=c&&!1===c.sphericalMercator||!this.sphericalMercator?ALKMaps.Util.extend({projection:"EPSG:4326",tileOrigin:new ALKMaps.LonLat(-180,90),resolutions:e,singleTile:!0},c):ALKMaps.Util.extend({projection:"EPSG:900913",tileOrigin:new ALKMaps.LonLat(2.003750834E7,-2.003750834E7),resolutions:e,singleTile:!0},c)):c=c&&!1===c.sphericalMercator||!this.sphericalMercator?ALKMaps.Util.extend({projection:"EPSG:4326",tileOrigin:new ALKMaps.LonLat(-180,90),resolutions:e,zoomOffset:g},c):ALKMaps.Util.extend({projection:"EPSG:900913",
tileOrigin:new ALKMaps.LonLat(2.003750834E7,-2.003750834E7),resolutions:e},c);f=[];if(null!=b){e=b.region;if("WW"===e||"ww"===e||"Ww"===e||"wW"===e)b.region=3;if(null!=b.region||null!=b.REGION){g=b.region||b.REGION;if(null!=b.region)b.region=ALKMaps.Util.getRegion(g);else if(null!=b.REGION)b.REGION=ALKMaps.Util.getRegion(g);4!==b.region&&4!==b.REGION&&(c.attribution+=ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:b.region||b.REGION,imgOption:null,useHyperlink:c.attrUseHyperlink}))}null!=
b.dataset?b.dataset=ALKMaps.Util.getDataSet(b.dataset):null!=b.DATASET?b.DATASET=ALKMaps.Util.getDataSet(b.DATASET):b.dataset="WW"===e||"ww"===e||"Ww"===e||"wW"===e?"Current":ALKMaps.Util.getDatasetFromRegion(b.region||b.REGION);if(null!=b.style)b.style=ALKMaps.STYLE.legacyCheck(b.style);else if(null!=b.STYLE)b.STYLE=ALKMaps.STYLE.legacyCheck(b.STYLE)}b=ALKMaps.Util.upperCaseObject(b);f.push(a,d,b,c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,f);ALKMaps.Util.applyDefaults(this.params,ALKMaps.Util.upperCaseObject(this.DEFAULT_PARAMS));
if(ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE))this.params.IMGOPTION="Background"},setMap:function(a){if(!0!==this.singleTile)a.fractionalZoom=!1;a.resolutions=this.resolutions;ALKMaps.Layer.Grid.prototype.setMap.call(this,a);this.attributionCtrl=this.map.getControlsByClass("ALKMaps.Control.Attribution")[0];if(null==this.attributionCtrl)this.attributionCtrl=new ALKMaps.Control.Attribution,this.map.addControl(this.attributionCtrl);a.events.register("zoomend",this,this.updateAttributions)},
destroy:function(){null!=this.map&&this.map.events.unregister("zoomend",this,this.updateAttributions);ALKMaps.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){var b=ALKMaps.Util.applyDefaults({},this.params);null==a&&(a=new ALKMaps.Layer.BaseMap(this.name,b,this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){return!!this.yx[this.map.getProjectionObject().getCode()]},getBlankImage:function(a,b){var c=["_no_image.png","_land.png",
"_water.png"],d=c[0];if(1===a||2===a)d=c[a];switch(b){case ALKMaps.STYLE.CLASSIC:case ALKMaps.STYLE.MONOCHROME:case ALKMaps.STYLE.ROADATLAS:case ALKMaps.STYLE.NIGHT:case ALKMaps.STYLE.SATELLITE:case ALKMaps.STYLE.LIGHTNESS:case ALKMaps.STYLE.SMOOTH:case ALKMaps.STYLE.TERRAIN:case ALKMaps.STYLE.CONTEMPORARY:break;default:b=ALKMaps.STYLE.DEFAULT}return ALKMaps.Util.getImageLocation(b+d)},getURL:function(a){var b={DRAWERGROUPS:ALKMaps.Util.getDrawerGroupFlags(this.params.DRAWERGROUPS)};if(!0===this.localLanguage)b.LANGUAGE=
ALKMaps.Lang.code;if(b.INIT=ALKMaps.IsInitMap)ALKMaps.IsInitMap=!1;a=this.adjustBounds(a);b.IMGSRC=null!=this.params.IMGSRC&&ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&"Background"===this.params.IMGOPTION?this.params.IMGSRC:null;var c="";if(!0===this.satelliteOnly&&ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&"Background"!==this.params.IMGOPTION)c=ALKMaps.Util.getImageLocation("blank.gif");else if(!0===this.singleTile){var c=this.map.getProjectionObject(),
d=new ALKMaps.Projection("EPSG:4326"),e=this.map.getMaxExtent(),a=a.wrapDateLine(e),a=a.transform(c,d);b.PT1=a.left+","+a.top;b.PT2=a.right+","+a.bottom;c=this.getImageSize();b.WIDTH=c.w;b.HEIGHT=c.h;ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&"Background"===this.params.IMGOPTION?(b={lat1:a.top,lon1:a.left,lat2:a.bottom,lon2:a.right,width:c.w,height:c.h,proj:"EPSG:900913",authToken:ALKMaps.Util.getApiKey(b.INIT),provider:ALKMaps.Util.getSatelliteProvider(this.params.IMGSRC)},
b=ALKMaps.Util.getParameterString(b),a=this.selectUrl(b,this.satImageUrls),c=ALKMaps.Util.urlAppend(a,b)):c=this.getFullRequestString(b)}else{b.WIDTH=this.tileSize.h;b.HEIGHT=this.tileSize.w;var f=this.getTileXYZ(a);0>f.y||f.y>=Math.pow(2,f.z)?c=!0===this.wrapDateLine?0>f.y?this.getBlankImage(2,this.params.STYLE):this.getBlankImage(1,this.params.STYLE):this.getBlankImage(0,this.params.STYLE):20<f.z&&ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&"Background"===this.params.IMGOPTION?
c=this.getBlankImage(0,ALKMaps.STYLE.SATELLITE):20<f.z?c=this.getBlankImage(0,this.params.STYLE):(ALKMaps.Util.applyDefaults(b,{x:f.x,y:f.y,z:f.z}),ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&"Background"===this.params.IMGOPTION?(b={x:f.x,y:f.y,z:f.z,provider:ALKMaps.Util.getSatelliteProvider(this.params.IMGSRC),proj:"EPSG:900913",authToken:ALKMaps.Util.getApiKey(b.INIT)},b=ALKMaps.Util.getParameterString(b),a=this.selectUrl(b,this.satImageTileUrls),c=ALKMaps.Util.urlAppend(a,
b)):c=this.getFullRequestString(b))}return c=this.tileCacheService(f,c)},getTileXYZ:function(a){var b=this.getServerZoom(),c=this.getServerResolution(),d=Math.round((a.left-this.maxExtent.left)/(c*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h));this.wrapDateLine&&(c=Math.pow(2,b),d=(d%c+c)%c);return{x:d,y:a,z:b}},mergeNewParams:function(a){a=[ALKMaps.Util.upperCaseObject(a)];return ALKMaps.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,
b){var c=this.map.getProjectionObject(),c=this.projection&&this.projection.equals(c)?this.projection.getCode():c.getCode();this.params.SRS="none"===c?null:c;this.params.AUTHTOKEN=ALKMaps.Util.getApiKey(a.INIT);return ALKMaps.Layer.Grid.prototype.getFullRequestString.apply(this,arguments).replace("STYLE=","VECTORSTYLE=")},changeStyle:function(a){if(ALKMaps.STYLE.compare(a,this.params.STYLE))ALKMaps.STYLE.compare(a,ALKMaps.STYLE.SATELLITE)&&this.setSatelliteOnly(null);else{if(null!=this.transparentOverlayLayer)this.map.removeLayer(this.transparentOverlayLayer,
!1),this.transparentOverlayLayer=null;if(this.options&&!1===this.options.sphericalMercator||!this.sphericalMercator){if(ALKMaps.STYLE.compare(a,ALKMaps.STYLE.SATELLITE))throw Error("Satellite map only works with Spherical Mercator projection.");if(ALKMaps.STYLE.compare(a,ALKMaps.STYLE.TERRAIN))throw Error("Terrain map only works with Spherical Mercator projection.");}if(ALKMaps.STYLE.compare(a,ALKMaps.STYLE.SATELLITE)||ALKMaps.STYLE.compare(a,ALKMaps.STYLE.TERRAIN))if(this.params.IMGOPTION="Background",
this.map){var b=this.cloneOverlayLayer(a);b.params.STYLE=a;b.satelliteOnly=this.satelliteOnly;this.transparentOverlayLayer=b;this.transparentOverlayLayer.transitionEffect=null;this.map.addLayer(b);this.map.setLayerIndex(b,this.map.getLayerIndex(this)+1);b.isBaseLayer=!0;this.map.setLayerZIndex(b,this.map.getLayerIndex(this)+1);b.isBaseLayer=!1}this.params.STYLE=ALKMaps.STYLE.legacyCheck(a);this.updateAttributions();a=this.map.getZoom();null!=this.restrictedMaxZoom&&a>this.restrictedMaxZoom?this.map.setCenter(this.map.getCenter(),
this.restrictedMaxZoom):this.redraw()}},setVisibility:function(a){ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&null!==this.transparentOverlayLayer&&this.transparentOverlayLayer.setVisibility(a);return ALKMaps.Layer.Grid.prototype.setVisibility.apply(this,arguments)},afterAdd:function(){if(ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&!0===this.isBaseLayer&&this.map)this.transparentOverlayLayer=this.cloneOverlayLayer(this.params.STYLE),this.transparentOverlayLayer.transitionEffect=
null,this.map.addLayer(this.transparentOverlayLayer),this.updateAttributions(),this.transparentOverlayLayer.isBaseLayer=!0,this.map.setLayerZIndex(this.transparentOverlayLayer,this.map.getLayerIndex(this.transparentOverlayLayer)),this.transparentOverlayLayer.isBaseLayer=!1;return ALKMaps.Layer.Grid.prototype.afterAdd.apply(this,arguments)},cloneOverlayLayer:function(a){var b=this.clone();b.name=this.id+"_"+a+"_overlay";b.displayInLayerSwitcher=!1;b.isBaseLayer=!1;b.visibility=this.visibility;if(ALKMaps.STYLE.compare(a,
ALKMaps.STYLE.SATELLITE))b.params.IMGOPTION="Foreground";return b},setContent:function(a){this.params.DRAWERGROUPS="";this.addContent(a)},addContent:function(a){a=ALKMaps.Util.convertToStringArray(a);a=a.concat(this.params.DRAWERGROUPS.split(","));ALKMaps.Util.removeDuplicates(a);this.params.DRAWERGROUPS=a.join(",")},removeContent:function(a){var b=ALKMaps.Util.convertToStringArray(a),a=this.params.DRAWERGROUPS.split(","),a=a.filter(function(a){return-1===b.indexOf(a)});this.params.DRAWERGROUPS=a.join(",")},
setSatelliteOnly:function(a){this.satelliteOnly="boolean"===typeof a?a:this.satelliteOnly;if(ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&null!=this.transparentOverlayLayer)this.transparentOverlayLayer.satelliteOnly=this.satelliteOnly,this.transparentOverlayLayer.redraw()},setSatelliteImageSource:function(a){this.params.IMGSRC=a;ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&(this.updateAttributions(),this.redraw())},updateInfoWarning:function(){var a=this.getServerZoom();
this.infoWarning="";if(19<a&&ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE))this.infoWarning="";else if(20<a)this.infoWarning="Map unavailable";for(var a=this.map.getControlsByClass("ALKMaps.Control.InfoWarning"),b=0;b<a.length;b++)a[b].updateInfoWarning()},updateAttributions:function(){if(!0===this.isBaseLayer){var a={className:this.CLASS_NAME,region:this.params.REGION,style:this.params.STYLE,imgOption:this.params.IMGOPTION,useHyperlink:this.options.attrUseHyperlink},b=ALKMaps.Services.getAttribution(a)||
"";if(this.attribution!==this.defaultCopyright+b)this.attribution=this.defaultCopyright+b,this.attributionCtrl.updateAttribution();if((ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)||ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.TERRAIN))&&null!=this.transparentOverlayLayer){a.imgOption=this.transparentOverlayLayer.params.IMGOPTION;if(ALKMaps.STYLE.compare(this.params.STYLE,ALKMaps.STYLE.SATELLITE)&&null!=this.params.IMGSRC)a.imgSrc=this.params.IMGSRC;a=ALKMaps.Services.getAttribution(a);
if(this.transparentOverlayLayer.attribution!==a)this.transparentOverlayLayer.attribution=a,this.attributionCtrl.updateAttribution()}}},CLASS_NAME:"ALKMaps.Layer.BaseMap"});ALKMaps.Layer.VSSBaseMap=ALKMaps.Class(ALKMaps.Layer.BaseMap,{wrapDateLine:!0,displayOutsideMaxExtent:!0,singleTile:!1,sphericalMercator:!0,projection:"EPSG:900913",initialize:function(a,b,c){var c=c||{},d=!0===(!1===c.attrUseHyperlink?!1:!0)?ALKMaps.Copyright:ALKMaps.CopyrightWithoutHyperlink;c.attribution=null!=c.attribution?d+" "+c.attribution:d;this.defaultCopyright=c.attribution;d=ALKMaps.MapServiceURL;ALKMaps.Util.isArray(ALKMaps.MapServiceURL)&&(d=ALKMaps.MapServiceURL[0]);var e=c.custMaxZoomLevels,
f=18;e&&"number"===typeof e&&0<e&&(f=e);for(var e=156543.03390625,g=[],h=0;h<=f;h++)g.push(e),e/=2;c=ALKMaps.Util.extend({projection:"EPSG:900913",tileOrigin:new ALKMaps.LonLat(2.003750834E7,-2.003750834E7),resolutions:g},c);f=[];b=ALKMaps.Util.upperCaseObject(b);f.push(a,d,b,c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,f)},getURL:function(a){var a=this.adjustBounds(a),b="",a=this.getTileXYZ(a),c=ALKMaps.MapServiceURL;ALKMaps.Util.isArray(ALKMaps.MapServiceURL)&&(c=ALKMaps.MapServiceURL[0]);
b=c+a.z+"/"+a.z+"-"+a.x+"-"+a.y+".png";0>a.y||a.y>=Math.pow(2,a.z)?b=0>a.y?ALKMaps.Util.getImageLocation("default_water.png"):ALKMaps.Util.getImageLocation("default_land.png"):6<a.z&&18>a.z?(b=Math.pow(2,a.z-5),b=c+a.z+"/R"+Math.floor(a.y/b)+"/C"+Math.floor(a.x/b)+"/"+a.z+"-"+a.x+"-"+a.y+".png"):18<=a.z&&(b=ALKMaps.Util.getImageLocation("default_no_image.png"));return b},afterAdd:function(){for(var a=0,b=this.map.layers.length;a<b;a++){var c=this.map.layers[a];if("ALKMaps.Layer.BaseMap"===c.CLASS_NAME&&
c.name===this.map.id+"_ALKMaps.Layer.BaseMap"){this.map.removeLayer(c);break}}return ALKMaps.Layer.BaseMap.prototype.afterAdd.apply(this,arguments)},updateInfoWarning:function(){var a=this.getServerZoom();this.infoWarning="";if(18<=a)this.infoWarning="VSS map unavailable";for(var a=this.map.getControlsByClass("ALKMaps.Control.InfoWarning"),b=0;b<a.length;b++)a[b].updateInfoWarning()},updateAttributions:function(){},CLASS_NAME:"ALKMaps.Layer.VSSBaseMap"});ALKMaps.Format.WKT=ALKMaps.Class(ALKMaps.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};ALKMaps.Format.prototype.initialize.apply(this,[a])},read:function(a){var b,c,a=a.replace(/[\n\r]/g," ");if(c=this.regExes.typeStr.exec(a))if(a=c[1].toLowerCase(),c=c[2],this.parse[a]&&(b=this.parse[a].apply(this,[c])),this.internalProjection&&this.externalProjection)if(b&&
"ALKMaps.Feature.Vector"==b.CLASS_NAME)b.geometry.transform(this.externalProjection,this.internalProjection);else if(b&&"geometrycollection"!=a&&"object"==typeof b){a=0;for(c=b.length;a<c;a++)b[a].geometry.transform(this.externalProjection,this.internalProjection)}return b},write:function(a){var b,c;a.constructor==Array?c=!0:(a=[a],c=!1);var d=[];c&&d.push("GEOMETRYCOLLECTION(");for(var e=0,f=a.length;e<f;++e)c&&0<e&&d.push(","),b=a[e].geometry,d.push(this.extractGeometry(b));c&&d.push(")");return d.join("")},
extractGeometry:function(a){var b=a.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[b])return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return("collection"==b?"GEOMETRYCOLLECTION":b.toUpperCase())+"("+this.extract[b].apply(this,[a])+")"},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.point.apply(this,[a.components[c]])+
")");return b.join(",")},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},multipolygon:function(a){for(var b=
[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.polygon.apply(this,[a.components[c]])+")");return b.join(",")},collection:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extractGeometry.apply(this,[a.components[c]]));return b.join(",")}},parse:{point:function(a){a=ALKMaps.String.trim(a).split(this.regExes.spaces);return new ALKMaps.Feature.Vector(new ALKMaps.Geometry.Point(a[0],a[1]))},multipoint:function(a){for(var b=ALKMaps.String.trim(a).split(","),c=[],d=0,
e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.point.apply(this,[a]).geometry);return new ALKMaps.Feature.Vector(new ALKMaps.Geometry.MultiPoint(c))},linestring:function(a){for(var a=ALKMaps.String.trim(a).split(","),b=[],c=0,d=a.length;c<d;++c)b.push(this.parse.point.apply(this,[a[c]]).geometry);return new ALKMaps.Feature.Vector(new ALKMaps.Geometry.LineString(b))},multilinestring:function(a){for(var b=ALKMaps.String.trim(a).split(this.regExes.parenComma),c=[],
d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.linestring.apply(this,[a]).geometry);return new ALKMaps.Feature.Vector(new ALKMaps.Geometry.MultiLineString(c))},polygon:function(a){for(var b,a=ALKMaps.String.trim(a).split(this.regExes.parenComma),c=[],d=0,e=a.length;d<e;++d)b=a[d].replace(this.regExes.trimParens,"$1"),b=this.parse.linestring.apply(this,[b]).geometry,b=new ALKMaps.Geometry.LinearRing(b.components),c.push(b);return new ALKMaps.Feature.Vector(new ALKMaps.Geometry.Polygon(c))},
multipolygon:function(a){for(var b=ALKMaps.String.trim(a).split(this.regExes.doubleParenComma),c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.polygon.apply(this,[a]).geometry);return new ALKMaps.Feature.Vector(new ALKMaps.Geometry.MultiPolygon(c))},geometrycollection:function(a){for(var a=a.replace(/,\s*([A-Za-z])/g,"|$1"),a=ALKMaps.String.trim(a).split("|"),b=[],c=0,d=a.length;c<d;++c)b.push(ALKMaps.Format.WKT.prototype.read.apply(this,[a[c]]));return b}},
CLASS_NAME:"ALKMaps.Format.WKT"});ALKMaps.Protocol.WeatherAlerts=ALKMaps.Class(ALKMaps.Protocol,{format:null,visitedCounties:[],initialize:function(a){a=a||{};this.format=a.format?a.format:new ALKMaps.Format.WKT;ALKMaps.Protocol.prototype.initialize.apply(this,arguments)},destroy:function(){ALKMaps.Protocol.prototype.destroy.apply(this)},handleResponse:function(a,b){if(b.callback&&"function"===typeof b.callback)if(a.code===ALKMaps.Protocol.Response.SUCCESS){if(a.data&&0<a.data.length)a.features=this.parseFeatures(a.data);b.callback.call(b.scope,
{code:a.code,data:a.data,features:a.features})}else b.callback.call(b.scope,{code:a.code,data:a.data})},parseFeatures:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d.Polygon&&0<d.Polygon.length){var e=this.format.read(d.Polygon);if(ALKMaps.Util.isArray(e)){var f;for(f=0;f<e.length;f++){var g=e[f];g.attributes.weatherAlertEvent={ID:d.ID,AlertEvent:d.AlertEvent};b.push(g)}}else e.attributes.weatherAlertEvent={ID:d.ID,AlertEvent:d.AlertEvent},b.push(e)}d.Polygon="";if(d.FipsCodes&&0<d.FipsCodes.length){e=
d.FipsCodes.split(" ");for(f=0;f<e.length;f++)for(var g=e[f],h=0;h<this.visitedCounties.length;h++)if(g===this.visitedCounties[h].Code){g=this.format.read(this.visitedCounties[h].Polygon);g.attributes.weatherAlertEvent={ID:d.ID,AlertEvent:d.AlertEvent};b.push(g);break}}}return b},readWeatherAlerts:function(a,b,c){var c=ALKMaps.Util.applyDefaults(c,this.options),d=new ALKMaps.Protocol.Response,e=this,f=function(a){d.code=ALKMaps.Protocol.Response.FAILURE;d.data=a;e.handleResponse(d,c)};ALKMaps.Services.weatherAlerts({bounds:a,
options:b,success:function(a){for(var b=[],i=0;i<a.length;i++)if(a[i].FipsCodes&&0<a[i].FipsCodes.length)for(var j=a[i].FipsCodes.split(" "),b=b.concat(j),j=0;j<b.length;++j)for(var k=j+1;k<b.length;++k)b[j]===b[k]&&b.splice(k--,1);for(i=0;i<e.visitedCounties.length;++i)for(j=0;j<b.length;++j)e.visitedCounties[i].code===b[j]&&b.splice(j--,1);if(0<b.length){i=[];if(200<b.length){j=(b.length-b.length%200)/200;for(k=0;k<j;k++)i.push(b.splice(0,200))}i.push(b);var m=function(b,h){if(0===b.length)e.visitedCounties=
e.visitedCounties.concat(h),d.code=ALKMaps.Protocol.Response.SUCCESS,d.data=a,e.handleResponse(d,c);else{var i=b.splice(0,1).toString();ALKMaps.Services.countyPolygons({codes:i,success:function(a){h=h.concat(a);m(b,h)},failure:f})}};m(i,[])}else d.code=ALKMaps.Protocol.Response.SUCCESS,d.data=a,e.handleResponse(d,c)},failure:f})},CLASS_NAME:"ALKMaps.Protocol.WeatherAlerts"});ALKMaps.Strategy.WeatherAlerts=ALKMaps.Class(ALKMaps.Strategy,{onSuccessCallback:null,onErrorCallback:null,initialize:function(a){a=a||{};ALKMaps.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,scope:this}),this.layer.events.on({refresh:this.update,scope:this}),!0===this.layer.visibility&&this.update());return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);
a&&(this.layer.events.un({moveend:this.update,scope:this}),this.layer.events.un({refresh:this.update,scope:this}));return a},update:function(a){null!=a&&"refresh"===a.type?this.triggerRead():!0===this.layer.getNewAlerts()?this.triggerRead():this.layer.legendControl.redrawWithoutGetNewOnes()},triggerRead:function(){var a=this.layer.bbox||this.layer.map.getExtent();if(null!=a){var b=this.layer.map;null!=b&&"function"===typeof b.showLoading&&b.showLoading();var b=new ALKMaps.Projection("EPSG:4326"),
c=this.layer.map.getProjectionObject();c.equals(b)||(a=a.clone().transform(c,b));this.layer.protocol.readWeatherAlerts(a,this.layer.alertFilters,{callback:this.drawAlerts,scope:this})}},drawAlerts:function(a){this.layer.lastUpdated=new Date;this.layer.destroyFeatures();var b=this.layer.map;null!=b&&"function"===typeof b.hideLoading&&b.hideLoading();b=a.features;if(a.code===ALKMaps.Protocol.Response.SUCCESS){this.layer.weatherAlertEvents=a.data;if(null!=b&&0<b.length){var c=new ALKMaps.Projection("EPSG:4326"),
d=this.layer.map.getProjectionObject();if(!d.equals(c))for(var e,f=0,g=b.length;f<g;++f)(e=b[f].geometry)&&e.transform(c,d);this.layer.addFeatures(b)}this.layer.legendControl.redraw();if(this.onSuccessCallback&&"function"===typeof this.onSuccessCallback)this.onSuccessCallback(a)}else if(this.onErrorCallback&&"function"===typeof this.onErrorCallback)this.onErrorCallback(a.data);else alert("Status: "+a.data.status+"\nStatus Text: "+a.data.statusText+"\n\n"+a.data.responseText+'\n\nTo handle this issue without showing the popup window, add a handler like below:\nnew ALKMaps.Layer.WeatherAlerts("layer name", { onErrorCallback: function(err){  ... handle error here. ..    } } );')},
CLASS_NAME:"ALKMaps.Strategy.WeatherAlerts"});ALKMaps.Layer.CustomPlaces=ALKMaps.Class(ALKMaps.Layer.Vector,{custPlaceSetId:null,custPlaceTag:null,custPlaceName:null,custCatId:null,custCatName:null,initialize:function(a,b){b=b||{};b.strategies=b.strategies?b.strategies:[new ALKMaps.Strategy.CustomPlaces({resFactor:1,ratio:1})];b.protocol=b.protocol?b.protocol:new ALKMaps.Protocol.CustomPlaces({format:new ALKMaps.Format.KML({extractStyles:!0,extractAttributes:!0,internalProjection:new ALKMaps.Projection("EPSG:900913")})});ALKMaps.Layer.Vector.prototype.initialize.apply(this,
arguments)},setMap:function(a){this.projection=a.getProjectionObject();ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments)},CLASS_NAME:"ALKMaps.Layer.CustomPlaces"});ALKMaps.Handler.Pinch=ALKMaps.Class(ALKMaps.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,singleTouchPanMap:!0,touchstart:function(a){var b=!0;this.pinching=!1;ALKMaps.Event.isMultiTouch(a)?(this.started=!0,this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1},this.callback("start",[a,this.start]),b=!this.stopDown,ALKMaps.Event.stop(a)):(this.started=!1,this.last=this.start=null,!1===this.singleTouchPanMap?b=!1:ALKMaps.Event.stop(a));return b},touchmove:function(a){if(this.started&&
ALKMaps.Event.isMultiTouch(a)){this.pinching=!0;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;ALKMaps.Event.stop(a)}return!0},touchend:function(a){if(this.started)this.pinching=this.started=!1,this.callback("done",[a,this.start,this.last]),this.last=this.start=null;return!0},activate:function(){var a=!1;if(ALKMaps.Handler.prototype.activate.apply(this,arguments))this.pinching=!1,a=!0;return a},deactivate:function(){var a=!1;if(ALKMaps.Handler.prototype.deactivate.apply(this,arguments))this.pinching=
this.started=!1,this.last=this.start=null,a=!0;return a},getDistance:function(a){var b=a[0],a=a[1];return Math.sqrt(Math.pow(b.clientX-a.clientX,2)+Math.pow(b.clientY-a.clientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"ALKMaps.Handler.Pinch"});ALKMaps.Control.PinchZoom=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_TOOL,containerCenter:null,pinchOrigin:null,currentCenter:null,autoActivate:!0,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,arguments);this.handler=new ALKMaps.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},activate:function(){var a=ALKMaps.Control.prototype.activate.apply(this,arguments);a&&(this.map.events.on({moveend:this.updateContainerCenter,
scope:this}),this.updateContainerCenter());return a},deactivate:function(){var a=ALKMaps.Control.prototype.deactivate.apply(this,arguments);this.map&&this.map.events&&this.map.events.un({moveend:this.updateContainerCenter,scope:this});return a},updateContainerCenter:function(){var a=this.map.layerContainerDiv;this.containerCenter={x:parseInt(a.style.left,10)+50,y:parseInt(a.style.top,10)+50}},pinchStart:function(a){this.currentCenter=this.pinchOrigin=a.xy},pinchMove:function(a,b){var c=b.scale,d=
this.containerCenter,e=this.pinchOrigin,f=a.xy,g=Math.round(f.x-e.x+(c-1)*(d.x-e.x)),d=Math.round(f.y-e.y+(c-1)*(d.y-e.y));this.applyTransform("translate("+g+"px, "+d+"px) scale("+c+")");this.currentCenter=f},applyTransform:function(a){var b=this.map.layerContainerDiv.style;b["-webkit-transform"]=a;b["-moz-transform"]=a},pinchDone:function(a,b,c){this.applyTransform("");a=this.map.getZoomForResolution(this.map.getResolution()/c.scale,!0);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var b=
this.map.getResolutionForZoom(a),c=this.map.getLonLatFromPixel(this.pinchOrigin),d=this.currentCenter,e=this.map.getSize();c.lon+=b*(e.w/2-d.x);c.lat-=b*(e.h/2-d.y);console.warn("Reflow clientWidth "+this.map.div.clientWidth);this.map.setCenter(c,a)}},CLASS_NAME:"ALKMaps.Control.PinchZoom"});ALKMaps.Control.TouchNavigation=ALKMaps.Class(ALKMaps.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(a){this.handlers={};ALKMaps.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom);ALKMaps.Control.prototype.destroy.apply(this,arguments)},
activate:function(){return ALKMaps.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return ALKMaps.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},b=ALKMaps.Util.extend({"double":!0,stopDouble:!0,pixelTolerance:2},
this.clickHandlerOptions);this.handlers.click=new ALKMaps.Handler.Click(this,a,b);this.dragPan=new ALKMaps.Control.DragPan(ALKMaps.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new ALKMaps.Control.PinchZoom(ALKMaps.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),
this.map.zoom+1)},CLASS_NAME:"ALKMaps.Control.TouchNavigation"});ALKMaps.Control.Zoom=ALKMaps.Class(ALKMaps.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"-",zoomOutId:"olZoomOutLink",draw:function(){var a=ALKMaps.Control.prototype.draw.apply(this),b=this.getOrCreateLinks(a),c=b.zoomIn,b=b.zoomOut,d=this.map.events;if(b.parentNode!==a)d=this.events,d.attachToElement(b.parentNode);d.register("buttonclick",this,this.onZoomClick);this.zoomInLink=c;this.zoomOutLink=b;return a},getOrCreateLinks:function(a){var b=document.getElementById(this.zoomInId),
c=document.getElementById(this.zoomOutId);if(!b)b=document.createElement("a"),b.href="#zoomIn",b.appendChild(document.createTextNode(this.zoomInText)),b.className="olControlZoomIn",a.appendChild(b);ALKMaps.Element.addClass(b,"olButton");if(!c)c=document.createElement("a"),c.href="#zoomOut",c.appendChild(document.createTextNode(this.zoomOutText)),c.className="olControlZoomOut",a.appendChild(c);ALKMaps.Element.addClass(c,"olButton");return{zoomIn:b,zoomOut:c}},onZoomClick:function(a){a=a.buttonElement;
a===this.zoomInLink?this.map.zoomIn():a===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;ALKMaps.Control.prototype.destroy.apply(this)},CLASS_NAME:"ALKMaps.Control.Zoom"});ALKMaps.Layer.RoadSurface=ALKMaps.Class(ALKMaps.Layer.Grid,{isBaseLayer:!1,projection:"EPSG:900913",hourOffset:0,provider:"RC1",disableCache:!1,initialize:function(a,b,c){b=b||{};c=c||{};this.hourOffset=b.hourOffset||0;this.disableCache=b.disableCache||!1;this.isBaseLayer=!1;if(void 0===c.opacity)c.opacity=0.5;for(var d=new ALKMaps.LonLat(2.003750834E7,-2.003750834E7),e=156543.03390625,f=[],g=0;20>=g;g++)f.push(e),e/=2;c=ALKMaps.Util.extend({projection:"EPSG:900913",tileOrigin:d,resolutions:f},c);
d=[];for(e=0;e<ALKMaps.WeatherImgContentServiceURL.length;e++)d.push(ALKMaps.WeatherImgContentServiceURL[e]+"RoadSurfaceImageTile");e=[];b=ALKMaps.Util.upperCaseObject(b);e.push(a,d,b,c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,e)},setMap:function(a){ALKMaps.Layer.Grid.prototype.setMap.apply(this,arguments);this.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME,provider:this.provider})},clone:function(a){null==a&&(a=new ALKMaps.Layer.RoadSurface(this.name,this.params,
this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),b={},a=this.getTileXYZ(a.clone());ALKMaps.Util.applyDefaults(b,{x:a.x,y:a.y,z:a.z});b.AUTHTOKEN=ALKMaps.Util.getApiKey(!0);b.HOUROFFSET=this.hourOffset;b.PROVIDER=this.provider;if(!0===this.disableCache)b.TIMESTAMP=(new Date).getTime();return this.getFullRequestString(b)},getTileXYZ:function(a){var b=this.getServerZoom(),c=this.getServerResolution(),d=Math.round((a.left-this.maxExtent.left)/
(c*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h));this.wrapDateLine&&(c=Math.pow(2,b),d=(d%c+c)%c);return{x:d,y:a,z:b}},getFullRequestString:function(a,b){return ALKMaps.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},updateInfoWarning:function(){var a=this.getServerZoom();this.infoWarning="";if(8<a)this.infoWarning="RoadSurface condition map unavailable";for(var a=this.map.getControlsByClass("ALKMaps.Control.InfoWarning"),b=0;b<a.length;b++)a[b].updateInfoWarning()},
CLASS_NAME:"ALKMaps.Layer.RoadSurface"});ALKMaps.Control.Attribution=ALKMaps.Class(ALKMaps.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});ALKMaps.Control.prototype.destroy.apply(this,arguments)},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,
addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var a=[],b=!1;if(this.map&&this.map.layers){for(var c=0,d=this.map.layers.length;c<d;c++){var e=this.map.layers[c];e.attribution&&e.getVisibility()&&-1===ALKMaps.Util.indexOf(a,e.attribution)&&(null!=e.params&&"satellite"===e.params.STYLE&&"BaseMapOnly"===e.params.SATOPTION&&"ALKMaps.Layer.BaseMap"===e.CLASS_NAME&&(b=!0),a.push(e.attribution))}this.div.innerHTML=
ALKMaps.String.format(this.template,{layers:a.join(this.separator)});!0===b?ALKMaps.Element.addClass(this.div,"satellite"):ALKMaps.Element.removeClass(this.div,"satellite")}},CLASS_NAME:"ALKMaps.Control.Attribution"});ALKMaps.Layer.RoadSurfaceRoute=ALKMaps.Class(ALKMaps.Layer.Vector,{routeLookup:null,provider:"RC1",initialize:function(a,b,c){b=b||{};c=c||{};this.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME,provider:this.provider});var d=new ALKMaps.StyleMap({"default":new ALKMaps.Style({strokeColor:"${color}",strokeOpacity:1,strokeWidth:"${strokeWidth}"},{context:{color:function(a){return 8<a.attributes.condition?ALKMaps.Layer.RoadSurfaceRoute.CONDITION_CODE[0].code:ALKMaps.Layer.RoadSurfaceRoute.CONDITION_CODE[a.attributes.condition].code},
strokeWidth:function(a){a=a.layer.map.getZoom();return 4>a?2*a:a+4}}})});this.styleMap=b.styleMap?b.styleMap:d;ALKMaps.Layer.Vector.prototype.initialize.apply(this,arguments)},onStartCallback:function(){},onAddedCallback:function(){},onErrorCallback:function(a){alert("Route Id: "+a.routeId+"\n"+a.response.status+"\n"+a.response.statusText+"\n "+a.response.responseText)},addRoutePath:function(a,b,c){var c=c||0,d=this;d.onStartCallback({routeId:a});for(var b=b.routelegs,e=[],f=0;f<b.length;f++)for(var g=
b[f].geometry.components,h=0;h<g.length;h++){var i=g[h].clone();e.push(i)}b=new ALKMaps.Projection("EPSG:4326");f=d.map.getProjectionObject();b=ALKMaps.Geometry.Point.transformArray(e,f,b);f=[];for(g=0;g<b.length;g++)h=b[g],f.push([h.x,h.y]);if(null==d.routeLookup)d.routeLookup=[];ALKMaps.Services.getRoadSurfaceRoute({routePath:f,routeDuration:c,provider:d.provider,success:function(b){for(var c=[],f,g,h=0;h<b.length;h++){var i=b[h],q=e[h];0===h?(f=i,g={points:[q],condition:i}):i==f?g.points.push(q):
(g.points.push(q),c.push(g),f=i,g={points:[q],condition:i})}c.push(g);for(b=0;b<c.length;b++)f=c[b].condition,f=new ALKMaps.Feature.Vector(new ALKMaps.Geometry.LineString(c[b].points),{routeId:a,condition:f}),d.addFeatures(f);d.routeLookup.push({routeId:a});d.onAddedCallback({routeId:a})},failure:function(b){d.onErrorCallback({routeId:a,response:b})}})},visualizeRoutes:function(a,b){for(var b=b||[{}],c=a.routeHandleLookup,d=0;d<c.length;d++){for(var e=c[d].routeId,f=a.getRouteElements(e),g=0,h=0;h<
b.length;h++){var i=b[h];if(i.routeId===e){g=i.duration||0;break}}this.addRoutePath(e,f,g)}},CLASS_NAME:"ALKMaps.Layer.RoadSurfaceRoute"});
ALKMaps.Layer.RoadSurfaceRoute.CONDITION_CODE=[{code:"#000000",id:99,label:"Not in range"},{code:"#777777",id:1,label:"Dry road"},{code:"#00ff00",id:2,label:"Wet road"},{code:"#ff0000",id:3,label:"Ice/snow"},{code:"#0000ff",id:4,label:"Mix water/snow"},{code:"#777777",id:5,label:"Dew"},{code:"#00ff00",id:6,label:"Melting snow"},{code:"#ff0000",id:7,label:"Frost"},{code:"#ff0000",id:8,label:"Icing rain"}];ALKMaps.Tile.Image.IFrame={useIFrame:null,clear:function(){if(this.useIFrame){if(this.imgDiv){var a=this.imgDiv.firstChild;ALKMaps.Event.stopObservingElement(a);this.imgDiv.removeChild(a)}}else ALKMaps.Tile.Image.prototype.clear.apply(this,arguments)},renderTile:function(){if(ALKMaps.Tile.Image.prototype.renderTile.apply(this,arguments)&&this.useIFrame){var a=this.createRequestForm();this.imgDiv.appendChild(a);a.submit();this.imgDiv.removeChild(a)}return!0},initImgDiv:function(){this.useIFrame=null!==
this.maxGetUrlLength&&!this.layer.async&&this.url.length>this.maxGetUrlLength;if(null!=this.imgDiv){var a=this.imgDiv.nodeName.toLowerCase();if(this.useIFrame&&"img"==a||!this.useIFrame&&"div"==a)this.removeImgDiv(),this.imgDiv=null}if(this.useIFrame){if(null==this.imgDiv){a=document.createElement("div");if("msie"==ALKMaps.BROWSER_NAME)a.style.backgroundColor="#FFFFFF",a.style.filter="chroma(color=#FFFFFF)";ALKMaps.Util.modifyDOMElement(a,null,new ALKMaps.Pixel(0,0),this.layer.getImageSize(),"absolute");
this.imgDiv=document.createElement("div");this.imgDiv.appendChild(a);ALKMaps.Util.modifyDOMElement(this.imgDiv,this.id,null,this.layer.getImageSize(),"relative");this.imgDiv.className="olTileImage";this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);null!=this.layer.opacity&&ALKMaps.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity);this.imgDiv.map=this.layer.map}this.imgDiv.viewRequestID=this.layer.map.viewRequestID}else ALKMaps.Tile.Image.prototype.initImgDiv.apply(this,
arguments)},createIFrame:function(){var a=this.id+"_iFrame",b;"msie"==ALKMaps.BROWSER_NAME?(b=document.createElement('<iframe name="'+a+'">'),b.style.backgroundColor="#FFFFFF",b.style.filter="chroma(color=#FFFFFF)"):(b=document.createElement("iframe"),b.style.backgroundColor="transparent",b.name=a);b.id=a;b.scrolling="no";b.marginWidth="0px";b.marginHeight="0px";b.frameBorder="0";ALKMaps.Util.modifyDOMElement(b,a,new ALKMaps.Pixel(0,0),this.layer.getImageSize(),"absolute");ALKMaps.Event.observe(b,
"load",ALKMaps.Function.bind(function(){if(this.isLoading)this.isLoading=!1,this.events.triggerEvent("loadend")},this));return b},createRequestForm:function(){var a=document.createElement("form");a.method="POST";var b=this.layer.params._OLSALT,b=(b?b+"_":"")+this.bounds.toBBOX();a.action=ALKMaps.Util.urlAppend(this.layer.url,b);this.imgDiv.insertBefore(this.createIFrame(),this.imgDiv.firstChild);a.target=this.id+"_iFrame";this.layer.getImageSize();var b=ALKMaps.Util.getParameters(this.url),c;for(c in b){var d=
document.createElement("input");d.type="hidden";d.name=c;d.value=b[c];a.appendChild(d)}return a}};ALKMaps.Control.WeatherAlertOption=ALKMaps.Class(ALKMaps.Control,{header:null,body:null,bodyEvents:[],layerId:null,visible:!0,ddlElements:[{id:"severity",label:"Severity",texts:"All,Extreme,Severe,Moderate,Minor,Unknown".split(","),values:"All,Extreme,Severe,Moderate,Minor,Unknown".split(",")},{id:"urgency",label:"Urgency",texts:"All,Immediate,Expected,Future,Past,Unknown".split(","),values:"All,Immediate,Expected,Future,Past,Unknown".split(",")},{id:"certainty",label:"Certainty",texts:"All,Observed,Likely (>50%),Possible (<=50%),Unlikely (0),Unknown".split(","),
values:"All,Observed,Likely,Possible,Unlikely,Unknown".split(",")}],destroy:function(){if(!this.outsideViewport){for(var a=0;a<this.bodyEvents.length;a++){var b=this.bodyEvents[a];b.un({mousedown:this.mouseDownHandler});b.destroy()}this.bodyEvents=[]}ALKMaps.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):
this.map.events.register("buttonclick",this,this.onButtonClick)},mouseDownHandler:function(){},draw:function(){ALKMaps.Control.prototype.draw.apply(this);if(!this.header){this.header=document.createElement("div");this.header.className=this.displayClass+"-header";this.div.appendChild(this.header);var a=document.createElement("h3");a.className="title";a.innerHTML="Options";this.header.appendChild(a)}if(!this.body){this.body=document.createElement("div");this.body.className=this.displayClass+"-body";
this.div.appendChild(this.body);for(var a=this.map.getLayer(this.layerId),b=0;b<this.ddlElements.length;b++){var c=this.ddlElements[b],d=document.createElement("div"),e=ALKMaps.Util.buildLabelElement({text:c.label}),c=ALKMaps.Util.buildSelectElement({id:this.id+"_sel"+c.id,optTexts:c.texts,optValues:c.values,selectedValue:a.alertFilters[c.id]});d.appendChild(e);d.appendChild(c);this.body.appendChild(d);this.outsideViewport||(d=new ALKMaps.Events(this,c),d.on({mousedown:this.mouseDownHandler}),this.bodyEvents.push(d))}a=
document.createElement("span");a.setAttribute("id","progress");b=document.createElement("div");b.setAttribute("class","olProgress");b.appendChild(a);this.body.appendChild(b);a=document.createElement("input");a.setAttribute("type","button");a.setAttribute("value","Get Alerts");a.setAttribute("id",this.id+"_btnGetAlerts");a.className="olButton";b=document.createElement("div");b.setAttribute("class","olDiv");b.appendChild(a);this.body.appendChild(b)}this.changeVisibility(!0);return this.div},onButtonClick:function(a){var b=
this.map.getLayer(this.layerId),a=a.buttonElement;if(null!=b&&a.id===this.id+"_btnGetAlerts"){for(a=0;a<this.ddlElements.length;a++){var c=this.ddlElements[a],d=document.getElementById(this.id+"_sel"+c.id).value;b.alertFilters[c.id]=d;b.options.alertFilters[c.id]=d}b.events.triggerEvent("refresh")}},changeVisibility:function(a){this.div.style.visibility="hidden";if(!0===this.visible&&!0===a)this.div.style.visibility=""},CLASS_NAME:"ALKMaps.Control.WeatherAlertOption"});ALKMaps.Control.ContextMenu=ALKMaps.Class(ALKMaps.Control,{handleRightClicks:!0,autoActivate:!0,ctxMenuItems:null,menuItems:null,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,arguments);if(null!=a&&null==a.ctxMenuItems)this.menuItems=a;this.callbacks=this.callbacks||{};this.callbacks.rightclick=function(a){this.showMenu([a.xy.x,a.xy.y])};this.callbacks.click=function(a){this.hideMenu();if(null!=this.ctxMenuItems){for(var b=a.target||a.srcElement,e=-1,f=0;f<this.ctxMenuItems.length;f++)if(b.id===
this.ctxMenuItems[f].id){e=f;break}if(-1<e&&"function"===typeof this.ctxMenuItems[e].onclick)this.ctxMenuItems[e].onclick(a)}};this.handler=new ALKMaps.Handler.Click(this,this.callbacks,{single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1,alwaysTrigger:!0})},destroy:function(){this.deactivate();return ALKMaps.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.handler.activate();this.active||this.map.disableContextMenu();return ALKMaps.Control.prototype.activate.apply(this,
arguments)},deactivate:function(){this.handler.deactivate();this.hideMenu();this.active&&this.map.enableContextMenu();return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},setMap:function(a){var b=this;ALKMaps.Control.prototype.setMap.apply(this,arguments);a.events.register("move",a,function(){b.hideMenu()})},draw:function(){var a=ALKMaps.Control.prototype.draw.apply(this,arguments);if(null!=this.menuItems||null!=this.ctxMenuItems){var b=document.createElement("ul");if(null!=this.ctxMenuItems)for(var c=
0;c<this.ctxMenuItems.length;c++){var d=this.ctxMenuItems[c],e=document.createElement("li");if(!0===d.separator)e.className="separator";else{var f=document.createElement("a");f.innerHTML=d.text;f.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_item_");this.ctxMenuItems[c].id=f.id;f.className="olButton";e.appendChild(f)}b.appendChild(e)}else for(c in this.menuItems){d=document.createElement("li");if("separator"===c&&!0===this.menuItems[c])d.className="separator";else if("string"===typeof this.menuItems[c])d.innerHTML=
'<a onclick="'+this.menuItems[c]+'">'+c+"</a>";b.appendChild(d)}a.appendChild(b)}a.style.display="none";return a},showMenu:function(a){this.moveTo(new ALKMaps.Pixel(a[0],a[1]));this.div.style.display="block"},hideMenu:function(){this.div.style.display="none"},CLASS_NAME:"ALKMaps.Control.ContextMenu"});ALKMaps.Marker.Box=ALKMaps.Class(ALKMaps.Marker,{bounds:null,div:null,initialize:function(a,b,c){this.bounds=a;this.div=ALKMaps.Util.createDiv();this.div.style.overflow="hidden";this.events=new ALKMaps.Events(this,this.div);this.setBorder(b,c)},destroy:function(){this.div=this.bounds=null;ALKMaps.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(a,b){a||(a="red");b||(b=2);this.div.style.border=b+"px solid "+a},draw:function(a,b){ALKMaps.Util.modifyDOMElement(this.div,null,a,b);return this.div},
onScreen:function(){var a=!1;this.map&&(a=this.map.getExtent().containsBounds(this.bounds,!0,!0));return a},display:function(a){this.div.style.display=a?"":"none"},CLASS_NAME:"ALKMaps.Marker.Box"});ALKMaps.Layer.Routing=ALKMaps.Class(ALKMaps.Layer.Vector,{routeHandleLookup:null,routeArrowLookup:null,routeDragQueueLookup:null,routeRestrictedPointsLookup:null,dragControl:null,isDraggable:!1,dragQueueMaxSize:0,originURL:null,destinationURL:null,waypointURL:null,_currentStyleId:-1,_routeStyles:[{strokeOpacity:0.6,strokeColor:"#00ff06"},{strokeOpacity:0.6,strokeColor:"#fe9300"},{strokeOpacity:0.6,strokeColor:"#027ffb"},{strokeOpacity:0.6,strokeColor:"#a55fff"},{strokeOpacity:0.6,strokeColor:"#2448ff"},
{strokeOpacity:0.6,strokeColor:"#fc5800"},{strokeOpacity:0.6,strokeColor:"#02d4cf"},{strokeOpacity:0.6,strokeColor:"#ce4871"}],_currentSimplifyLevel:0.01,initialize:function(a,b){ALKMaps.Layer.Vector.prototype.initialize.apply(this,arguments);var c=this;if(null!=b&&null!=b.originURL)this.originURL=b.originURL;if(null!=b&&null!=b.destinationURL)this.destinationURL=b.destinationURL;if(null!=b&&null!=b.waypointURL)this.waypointURL=b.waypointURL;this.styleMap=null!=b&&void 0!==b.options&&b.options.styleMap?
b.options.styleMap:null!=b&&null!=b.styleMap?b.styleMap:new ALKMaps.StyleMap({"default":new ALKMaps.Style({strokeColor:"${strokeColor}",strokeOpacity:"${strokeOpacity}",strokeWidth:"${strokeWidth}",strokeLinecap:"${strokeLinecap}",strokeDashstyle:"${strokeDashstyle}",display:"${display}",zIndex:10,arrows:"${arrows}",arrowGraphicName:"${arrowGraphicName}",arrowRotation:"${arrowRotation}",arrowSpacing:"${arrowSpacing}",arrowStrokeColor:"${arrowStrokeColor}",arrowStrokeWidth:"${arrowStrokeWidth}",arrowFillColor:"${arrowFillColor}",
arrowStrokeOpacity:"${arrowStrokeOpacity}",arrowFillOpacity:"${arrowFillOpacity}",arrowSize:"${arrowSize}"},{context:{strokeWidth:function(a){if(null!=a&&null!=a.attributes&&null!=a.attributes.strokeWidth&&!1===isNaN(a.attributes.strokeWidth))return a.attributes.strokeWidth;a=c.map.getZoom();4>a&&(a*=1.5);return a},arrowSize:function(a){if(null!=a&&null!=a.attributes&&null!=a.attributes.arrowSize){var b=a.attributes.arrowSize;if("string"===typeof b){var f=b.indexOf("%");-1<f?(a=a.attributes.strokeWidth,
null==a&&(a=c.map.getZoom()),a/=1.75,b=parseInt(b.substring(0,f)),b=a*(b/100)):b=parseInt(b)}return b}return c.map.getZoom()/1.75}}})});if(null!=b&&null!=b.dragQueueMaxSize)this.dragQueueMaxSize=b.dragQueueMaxSize},setMap:function(){ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments);this.dragControl=new ALKMaps.Control.ALK.DragFeature(this);this.map.addControl(this.dragControl);this.isDraggable&&this.dragControl.activate();this.dragControl.onRouteModified=this._routeModified;this.dragControl.onErrorRouteModification=
this._routeModifiedError;this.map.events.register("moveend",this,this._onLayerMove)},destroy:function(){this.map.events.unregister("moveend",this,this._onLayerMove);ALKMaps.Layer.Vector.prototype.destroy.apply(this,arguments)},addRouteDragHandle:function(a,b,c,d){b=new ALKMaps.Geometry.Point(b[0],b[1]);switch(a){case "RB":if(null==d){if(a=ALKMaps.Util.getImagesLocation()+"flag_start.png",null!=this.originURL)a=this.originURL}else a=d;a=new ALKMaps.Feature.Vector(b,{},{externalGraphic:a,graphicHeight:26,
graphicWidth:26,graphicXOffset:-10,graphicYOffset:-26,graphicZIndex:10,graphicTitle:"Origin",zIndex:100});break;case "RE":if(null==d){if(a=ALKMaps.Util.getImagesLocation()+"flag_end.png",null!=this.destinationURL)a=this.destinationURL}else a=d;a=new ALKMaps.Feature.Vector(b,{},{externalGraphic:a,graphicHeight:26,graphicWidth:26,graphicXOffset:-10,graphicYOffset:-26,graphicZIndex:10,graphicTitle:"Destination",zIndex:100});break;default:if(null==d){if(a=ALKMaps.Util.getImagesLocation()+"flag_waypoint.png",
null!=this.waypointURL)a=this.waypointURL}else a=d;a=new ALKMaps.Feature.Vector(b,{},{externalGraphic:a,graphicHeight:26,graphicWidth:26,graphicXOffset:-10,graphicYOffset:-26,graphicZIndex:10,graphicTitle:"Waypoint",zIndex:100})}if(!c)a.style.graphic=!1;return a},_hasVehicleRestrictedCleanupPoints:function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d][0],f=e.geometry.components[0],g=e.geometry.components[e.geometry.components.length-1];(0.1>Math.abs(a.x-g.x)&&0.1>Math.abs(a.y-g.y)||0.1>Math.abs(a.x-
f.x)&&0.1>Math.abs(a.y-f.y))&&c.push(e.id)}return c},getRouteLegPoints:function(a,b,c){function d(d){if(!0===c){for(var e=[],j=0;j<s.routeDragQueueLookup.length;j++){var k=s.routeDragQueueLookup[j];e.push({routeId:k.routeId,queue:k.queue.clone()})}s.removeRoute(f);s.routeDragQueueLookup=e}var m;m=!0===a.routeOptions.useAllPoints?d:JSON.parse(d.responseText);d=new ALKMaps.Format.GeoJSON({externalProjection:new ALKMaps.Projection("EPSG:4326"),internalProjection:s.map.getProjectionObject()});k=d.read(m);
e=k[0].geometry;k=k[0].attributes;if(!0===a.routeOptions.includeplids&&void 0!==k&&null!==k)var l=k.plids;k=[];if(!0===a.routeOptions.includeVehicleRestrictedCleanupPoints&&(null!=m.vehicleRestrictedCleanupGeometry||null!=m.vehiclerestrictedcleanupgeometry))for(var p=(m.vehicleRestrictedCleanupGeometry||m.vehiclerestrictedcleanupgeometry).coordinates,j=0;j<p.length;j++){var n=d.read({type:m.type,geometry:{type:"LineString",coordinates:p[j]},properties:{vehicleRestrictedCleanupPoints:a.routeOptions.includeVehicleRestrictedCleanupPoints,
routeId:f,strokeColor:o.strokeColor,strokeWidth:6,strokeOpacity:o.strokeOpacity,strokeLinecap:"round",strokeDashstyle:"dot"}});null!=n&&0<n.length&&(k.push(n),s.routeRestrictedPointsLookup.push({routeId:f,lines:n}),s.addFeatures(n))}j=e.components;d=[];e=[];for(p=0;p<j.length;p++){var n=j[p],w,x,C,z=s._getRouteSimplifyLevel();"ALKMaps.Renderer.SVG"===s.renderer.CLASS_NAME&&(w=n.clone(),x=n.simplify(0.01),C=n.simplify(0.001),0.01===z?n=x:0.001===z&&(n=C));var D=!0===v||!0===a.routeOptions.includeVehicleRestrictedCleanupPoints?
[a.stops[p].lon,a.stops[p].lat]:[n.components[0].x,n.components[0].y];ALKMaps.Util.extend(o,{fullGeometry:w,simpleGeometry:x,mediumGeometry:C,currentSimplifyLevel:z});if(0<n.components.length){z=new ALKMaps.Feature.Vector(n,o);if(l&&0<l.length)z.plids=l[p];d.push(z)}z=null;q.length===j.length+1&&(z=q[p]);0===p?(D=s.addRouteDragHandle("RB",D,u,z),s.routeHandleLookup.push({routeId:f,handleId:D.id,args:a})):D=s.addRouteDragHandle(!0===v?"RE":"RI",D,u,z);D.attributes.routeId=f;if(!0===a.routeOptions.includeVehicleRestrictedCleanupPoints)D.attributes.vRCPointsFeatureIds=
s._hasVehicleRestrictedCleanupPoints(D.geometry,k);e.push(D);if(p===j.length-1){z=q[q.length-1];n=s.addRouteDragHandle("RE",!0!==v?[n.components[n.components.length-1].x,n.components[n.components.length-1].y]:[a.stops[a.stops.length-1].lon,a.stops[a.stops.length-1].lat],u,z);n.attributes.routeId=f;if(!0===a.routeOptions.includeVehicleRestrictedCleanupPoints)n.attributes.vRCPointsFeatureIds=s._hasVehicleRestrictedCleanupPoints(n.geometry,k);e.push(n)}}("line"===o.arrows||"end"===o.arrows||"line"===
s.styleMap.styles["default"].defaultStyle.arrows||"end"===s.styleMap.styles["default"].defaultStyle.arrows)&&s.routeArrowLookup.push({routeId:f,arrows:[]});for(l=0;l<d.length;l++){w=d[l];x=e[l];C=e[l+1];if(null!=a.functionOptions.handleSvg&&(k=a.functionOptions.handleSvg,x.attributes.svg={content:k.content,size:k.size,offset:k.offset},l===d.length-1))C.attributes.svg={content:k.content,size:k.size,offset:k.offset};w.attributes.handleIds=!0===v?[e[0].id,C.id]:[x.id,C.id];w.attributes.routeId=f;if(0===
l){if(x.attributes.featureIds=[null,w.id],1===d.length)C.attributes.featureIds=[w.id,null]}else{k=d[l-1];x.attributes.featureIds=[k.id,w.id];if(!0===v)e[0].attributes.featureIds.push(w.id),x.attributes.featureIds=[k.id,null];if(l===d.length-1)C.attributes.featureIds=[w.id,null]}}for(var I=[],G=[],j=0;j<e.length;j++){l=e[j];if(!0===a.routeOptions.useAllPoints)l.attributes.isViaPoint=a.stops[j].isViaPoint,l.attributes.stopLocationIndex=j,l.style.graphicTitle="";w=l.geometry.clone();G.push(w);l=l.geometry.clone().transform(s.map.getProjectionObject(),
new ALKMaps.Projection("EPSG:4326"));I.push([l.x,l.y])}s.addFeatures(d);s.addFeatures(e);var l=new ALKMaps.Bounds,A;for(A in d)d.hasOwnProperty(A)&&l.extend(d[A].geometry.bounds);if(!0!==c&&y&&(s.map.zoomToExtent(l),s.map.fractionalZoom))A=s.map.zoom,1<A&&(A-=0.5),s.map.zoomTo(A);A=function(b){s.map.hideLoading();if(r&&"function"===typeof r){b={routeId:f,report:b,stops:G};if(!0===a.routeOptions.useAllPoints){for(var c=[],d=0;d<G.length;d++){var e=I[d],g=a.stops[d].clone(),g=ALKMaps.WS_StopLocation.fromStopLocation(g);
g.Coords.Lon=""+e[0];g.Coords.Lat=""+e[1];c.push(g)}b.wsStopLocations=c;b.routePath={type:m.type,geometry:m.geometry}}r(b)}};l=function(b){s.map.hideLoading();if(t&&"function"===typeof t)t(b);else if(!0===a.routeOptions.useAllPoints)alert(b.status+" "+b.statusText);else if(b.responseText){for(var c=JSON.parse(b.responseText),d="",e=0;e<c.length;e++)d=d+c[e].Description+"\n\n";alert(b.status+" "+b.statusText+"\n\n"+d)}};if(i){if(!0!==b)if(!0===a.routeOptions.useAllPoints){d=[{__type:"MileageReportType:http://pcmiler.alk.com/APIs/v1.0"}];
w=i.type||[];for(x=0;x<w.length;x++)"Detail"===w[x]&&d.push({__type:"DetailReportType:http://pcmiler.alk.com/APIs/v1.0"}),"State"===w[x]&&d.push({__type:"StateReportType:http://pcmiler.alk.com/APIs/v1.0"}),"Directions"===w[x]&&d.push({__type:"DirectionsReportType:http://pcmiler.alk.com/APIs/v1.0",CondenseDirections:!1});ALKMaps.Services.postReports({request:{ReportRoutes:[{ReportingOptions:{reportFmt:void 0!==i.format?i.format:i.Format,UseTollData:void 0!==i.useTollData?i.useTollData:i.UseTollData,
FuelUnits:void 0!==i.fuelUnits?i.fuelUnits:i.FuelUnits,RouteCosts:{FuelEconomyLoaded:void 0!==i.fuelEconomyLoaded?i.fuelEconomyLoaded:i.FuelEconomyLoaded,FuelEconomyEmpty:void 0!==i.fuelEconomyEmpty?i.fuelEconomyEmpty:i.FuelEconomyEmpty,PricePerFuelUnit:void 0!==i.pricePerFuelUnit?i.pricePerFuelUnit:i.PricePerFuelUnit,TruckStyle:void 0!==i.truckStyle?i.truckStyle:i.TruckStyle,GreenHouseGas:void 0!==i.greenHouseGas?i.greenHouseGas:i.GreenHouseGas,OtherCostPerDistUnitLoaded:void 0!==i.otherCostPerDistUnitLoaded?
i.otherCostPerDistUnitLoaded:i.OtherCostPerDistUnitLoaded,OtherCostPerDistanceUnitEmpty:void 0!==i.otherCostPerDistanceUnitEmpty?i.otherCostPerDistanceUnitEmpty:i.OtherCostPerDistanceUnitEmpty,CostTimeLoaded:void 0!==i.costTimeLoaded?i.costTimeLoaded:i.CostTimeLoaded,CostTimeEmpty:void 0!==i.costTimeEmpty?i.costTimeEmpty:i.CostTimeEmpty},TimeCosts:{DepartTime:void 0!==i.departTime?i.departTime:i.DepartTime,BreakInterval:void 0!==i.breakInterval?i.breakInterval:i.BreakInterval,BreakLength:void 0!==
i.breakLength?i.breakLength:i.BreakLength,BorderWait:void 0!==i.borderWait?i.borderWait:i.BorderWait,RemainingHoursOfService:void 0!==i.remainingHoursOfService?i.remainingHoursOfService:i.RemainingHoursOfService},TollCurrency:void 0!==i.tollCurrency?i.tollCurrency:i.TollCurrency,ExchangeRate:void 0!==i.exchangeRate?i.exchangeRate:i.ExchangeRate,TollDiscount:void 0!==i.tollDiscount?i.tollDiscount:i.TollDiscount,IncludeFerryDistance:void 0!==i.includeFerryDistance?i.includeFerryDistance:i.IncludeFerryDistance,
UseCustomRoadSpeeds:void 0!==i.useCustomRoadSpeeds?i.useCustomRoadSpeeds:i.UseCustomRoadSpeeds,Language:void 0!==i.language?i.language:i.Language,EstimatedTimeOptions:void 0!==i.estimatedTimeOptions?i.estimatedTimeOptions:i.EstimatedTimeOptions,UseTraffic:void 0!==i.UseTraffic?i.UseTraffic:i.UseTraffic,TruckStyle:void 0!==i.truckStyle?i.truckStyle:i.TruckStyle},ReportTypes:d,RouteId:f,Stops:h,Options:g.option,ExtendedOptions:g.extendOption,FuelOptions:void 0!==i.fuelOptions?i.fuelOptions:i.FuelOptions}]},
dataVersion:i.dataVersion,success:A,failure:l})}else ALKMaps.Services.getReports({coords:I,stopCosts:a.stopCosts,options:g,reportOptions:i,success:A,failure:l})}else A(null);s.redraw();if(!0===s.isDraggable&&null!=a.routeOptions&&!0===a.routeOptions.includeVehicleRestrictedCleanupPoints&&null!=a.interactiveOptions&&"function"===typeof a.interactiveOptions.callback)a.interactiveOptions.callback({routeId:f,report:null,stops:G}),a.interactiveOptions=null}var e=a.functionOptions.async,f=a.functionOptions.routeId,
g=a.routeOptions,h,i=a.reportOptions;if(null!=i&&null==i.dataVersion&&null!=this.map.baseLayer&&null!=this.map.baseLayer.params&&null!=this.map.baseLayer.params.DATASET)i.dataVersion=this.map.baseLayer.params.DATASET;if(!0===b)h=a.stops;else{for(var j=a.stops,k="",m=[],l=0;l<j.length;l++)if(!0===a.routeOptions.useAllPoints){var p=j[l],n=p.lonLat,n=(new ALKMaps.LonLat(n.lon,n.lat)).transform(this.map.getProjectionObject(),new ALKMaps.Projection("EPSG:4326")),n=ALKMaps.WS_Coordinates.fromLonLat(n),
p=ALKMaps.WS_StopLocation.fromStopLocation(p);p.Coords=n;m.push(p)}else p=(new ALKMaps.LonLat(j[l].lon,j[l].lat)).transform(this.map.getProjectionObject(),new ALKMaps.Projection("EPSG:4326")),n=[],n.push(p.lon),n.push(p.lat),k+=n+";";h=!0===a.routeOptions.useAllPoints?m:k.substring(0,k.length-1);if(null==g.region&&null!=this.map.baseLayer&&null!=this.map.baseLayer.params&&null!=this.map.baseLayer.params.REGION)g.region=this.map.baseLayer.params.REGION;if(null==g.dataset&&null!=i&&null!=i.dataVersion)if(!0===
/^PCM[0-9]{2}$/.test(i.dataVersion)){if(22<Number(i.dataVersion.substring(3)))g.dataset=i.dataVersion}else g.dataset=i.dataVersion;if(null==g.dataset&&null!=this.map.baseLayer&&null!=this.map.baseLayer.params&&null!=this.map.baseLayer.params.DATASET)g.dataset=this.map.baseLayer.params.DATASET;!0===a.routeOptions.useAllPoints&&(g=this._convertToPostRouteOption(g))}var q;q=void 0===a.externalImages||null===a.externalImages?[]:a.externalImages.images;(j=a.functionOptions.style)||(j=this._getNextRouteStyle());
var o={strokeColor:"#00C000",strokeOpacity:0.6,strokeLinecap:"round",strokeDashstyle:"solid",arrowStrokeColor:"black",arrowStrokeWidth:1,arrowStrokeOpacity:1,arrowFillColor:"white",arrowFillOpacity:1,display:""};ALKMaps.Util.extend(o,j);a.functionOptions.style=o;var r=a.functionOptions.callback||a.functionOptions.success,t=a.functionOptions.failure,s=this,u=!0;if(void 0!==a.functionOptions.showHandles)u=a.functionOptions.showHandles;var y=!0;if(void 0!==a.functionOptions.frameRoute)y=a.functionOptions.frameRoute;
var v=null!=a.routeOptions&&"boolean"===typeof a.routeOptions.hubRouting?a.routeOptions.hubRouting:!1,j=function(b){s.map.hideLoading();t&&"function"===typeof t?t(b):!0===a.routeOptions.useAllPoints?alert(b.status+"\n"+b.statusText):alert(b.status+"\n"+b.statusText+"\n "+b.responseText)};s.map.showLoading();!0===b?ALKMaps.Services.postRailRoutePath({stops:h,options:g,async:e,success:d,failure:j}):!0===a.routeOptions.useAllPoints?ALKMaps.Services.postRoutePath({request:{Route:{Stops:h,Options:g.option,
ExtendedOptions:g.extendOption},IncludePLIDs:g.includeplids},dataset:g.dataset,success:d,failure:j}):ALKMaps.Services.getRoutePath({stops:h,options:g,async:e,success:d,failure:j})},_convertToPostRouteOption:function(a){var b=void 0!==a.truckConfig?a.truckConfig:a.TruckConfig;return{option:{VehicleType:void 0!==a.vehicleType?a.vehicleType:a.VehicleType,RoutingType:void 0!==a.routingType?a.routingType:a.RoutingType,HighwayOnly:void 0!==a.highwayOnly?a.highwayOnly:a.HighwayOnly,UseAvoidsAndFavors:void 0!==
a.useAvoidFavors?a.useAvoidFavors:a.UseAvoidFavors,ClassOverrides:void 0!==a.classOverrides?a.classOverrides:a.ClassOverrides,DistanceUnits:void 0!==a.distanceUnits?a.distanceUnits:a.DistanceUnits,TollDiscourage:void 0!==a.tollDiscourage?a.tollDiscourage:a.TollDiscourage,BordersOpen:void 0!==a.bordersOpen?a.bordersOpen:a.BordersOpen,OverrideRestrict:void 0!==a.overrideRestrict?a.overrideRestrict:a.OverrideRestrict,HazMatType:void 0!==a.hazMatType?a.hazMatType:a.HazMatType,HazMatTypes:void 0!==a.hazMatTypes?
a.hazMatTypes:a.HazMatTypes,TunnelCategory:void 0!==a.tunnelCategory?a.tunnelCategory:a.TunnelCategory,TunnelCategories:void 0!==a.tunnelCategories?a.tunnelCategories:a.TunnelCategories,RouteOptimization:void 0!==a.routeOptimization?a.routeOptimization:a.RouteOptimization,HubRouting:void 0!==a.hubRouting?a.hubRouting:a.HubRouting,TruckCfg:void 0!==b?b:{Axles:void 0!==a.trkAxles?a.trkAxles:a.TrkAxles,Height:void 0!==a.trkHeigh?a.trkHeigh:a.TrkHeigh,LCV:void 0!==a.trkLCV?a.trkLCV:a.TrkLCV,Length:void 0!==
a.trkLength?a.trkLength:a.TrkLength,Units:void 0!==a.trkUnits?a.trkUnits:a.TrkUnits,Weight:void 0!==a.trkWeight?a.trkWeight:a.TrkWeight,Width:void 0!==a.trkWidth?a.trkWidth:a.TrkWidth},ElevLimit:void 0!==a.elevLimit?a.elevLimit:a.ElevLimit,FerryDiscourage:void 0!==a.ferryDiscourage?a.ferryDiscourage:a.FerryDiscourage,AFSetIDs:void 0!==a.afSetIDs?a.afSetIDs:a.AFSetIDs,GovernorSpeedLimit:void 0!==a.governorSpeedLimit?a.governorSpeedLimit:a.GovernorSpeedLimit,SideOfStreetAdherence:void 0!==a.sideOfStreetAdherence?
a.sideOfStreetAdherence:a.SideOfStreetAdherence,UseSites:void 0!==a.useSites?a.useSites:a.UseSites,VehicleProfile:void 0!==a.vehicleProfile?a.vehicleProfile:a.VehicleProfile,AvoidState:void 0!==a.avoidState?a.avoidState:a.AvoidState,AvoidCountry:void 0!==a.avoidCountry?a.avoidCountry:a.AvoidCountry,FavorState:void 0!==a.favorState?a.favorState:a.FavorState,FavorCountry:void 0!==a.favorCountry?a.favorCountry:a.FavorCountry,TollRoads:void 0!==a.tollRoads?a.tollRoads:a.TollRoads,AssetID:void 0!=a.assetID?
a.assetID:a.AssetID,MaintainHeading:void 0!=a.maintainHeading?a.maintainHeading:a.MaintainHeading},extendOption:{IncludeVehicleRestrictedCleanupPoints:void 0!==a.includeVehicleRestrictedCleanupPoints?a.includeVehicleRestrictedCleanupPoints:a.IncludeVehicleRestrictedCleanupPoints,EstimatedTimeOptions:void 0!==a.estimatedTimeOpts?a.estimatedTimeOpts:a.EstimatedTimeOpts,UseTraffic:void 0!==a.useTraffic?a.useTraffic:a.UseTraffic},dataset:a.dataset||a.dataSet||a.DataSet,includeplids:void 0!==a.includeplids?
a.includeplids:a.Includeplids}},addRoute:function(a){if(void 0===this.routeHandleLookup||null===this.routeHandleLookup)this.routeHandleLookup=[];if(null==this.routeArrowLookup)this.routeArrowLookup=[];if(null==this.routeDragQueueLookup)this.routeDragQueueLookup=[];if(null==this.routeRestrictedPointsLookup)this.routeRestrictedPointsLookup=[];if(null===a.functionOptions||null===a.functionOptions.routeId)throw"Route cannot be added. Unique route id is required.";for(var b=new ALKMaps.Queue(this.dragQueueMaxSize),
c=[],d=0;d<a.stops.length;d++)c.push(a.stops[d].clone());b.add({stops:c});this.routeDragQueueLookup.push({routeId:a.functionOptions.routeId,queue:b});this.getRouteLegPoints(a,!1,!1)},removeRoute:function(a){var b=this.getRouteOptions(a);if(null!=b&&null!=b.routeOptions&&!0===b.routeOptions.hubRouting){for(var b=[],c=0;c<this.features.length;c++)this.features[c].attributes.routeId===a&&b.push(this.features[c]);this.destroyFeatures(b);b=[];for(c=0;c<this.routeHandleLookup.length;c++)this.routeHandleLookup[c].routeId!==
a&&b.push(this.routeHandleLookup[c]),this.routeHandleLookup=b}else if(!(void 0===this.routeHandleLookup||null===this.routeHandleLookup)){b=[];for(c=0;c<this.routeHandleLookup.length;c++){var d=this.routeHandleLookup[c].handleId;if(this.routeHandleLookup[c].routeId===a){var e=[],f=[],d=this.getFeatureById(d);e.push(d);d=this.getNextHandle(d);for(e.push(d);!this.isEndHandle(d);)d=this.getNextHandle(d),e.push(d);for(d=0;d<e.length-1;d++){var g=this.getNodes(e[d]);f.push(g[1])}this.destroyFeatures(e,
{silent:!0});this.destroyFeatures(f,{silent:!0})}else b.push(this.routeHandleLookup[c])}this.routeHandleLookup=b;if(null!=this.routeArrowLookup)for(b=0;b<this.routeArrowLookup.length;b++)if(this.routeArrowLookup[b].routeId===a){c=this.routeArrowLookup[b].arrows;this.routeArrowLookup.splice(b,1);this.destroyFeatures(c,{silent:!0});break}if(null!=this.routeDragQueueLookup)for(b=0;b<this.routeDragQueueLookup.length;b++)if(this.routeDragQueueLookup[b].routeId===a){c=this.routeDragQueueLookup[b].queue;
null!=c&&c.destroy();this.routeDragQueueLookup.splice(b,1);break}if(null!=this.routeRestrictedPointsLookup)for(b=this.routeRestrictedPointsLookup.length-1;0<=b;b--)if(this.routeRestrictedPointsLookup[b].routeId===a)c=this.routeRestrictedPointsLookup[b].lines,this.routeRestrictedPointsLookup.splice(b,1),this.destroyFeatures(c,{silent:!0})}},updateRoute:function(a){for(var b=a.functionOptions.routeId,c=0;c<this.routeHandleLookup.length;c++)if(this.routeHandleLookup[c].routeId===b){if(null==a.stops)a.stops=
this.routeHandleLookup[c].args.stops;if(null==a.routeOptions)a.routeOptions=this.routeHandleLookup[c].args.routeOptions;if(null==a.reportOptions)a.reportOptions=this.routeHandleLookup[c].args.reportOptions;if(null==a.functionOptions)a.functionOptions=this.routeHandleLookup[c].args.functionOptions;if(null==a.externalImages)a.externalImages=this.routeHandleLookup[c].args.externalImages;break}this.removeRoute(b);this.addRoute(a)},getRouteElements:function(a){var b=[],c=[],d=this.getRouteOptions(a);if(null!=
this.routeHandleLookup)for(var e=0;e<this.routeHandleLookup.length;e++){var f=this.routeHandleLookup[e].handleId;if(this.routeHandleLookup[e].routeId===a){a=this.getFeatureById(f);b.push(a);if(null!=d&&null!=d.routeOptions&&!0===d.routeOptions.hubRouting)for(d=1;d<a.attributes.featureIds.length;d++)e=this.getFeatureById(a.attributes.featureIds[d]),f=this.getFeatureById(e.attributes.handleIds[1]),c.push(e),b.push(f);else{d=this.getNextHandle(a);if(null!=d)for(b.push(d);!this.isEndHandle(d);)d=this.getNextHandle(d),
b.push(d);for(d=0;d<b.length-1;d++)a=this.getNodes(b[d]),c.push(a[1])}break}}return{stops:b,routelegs:c}},getRouteOptions:function(a){var b=null;if(null!=this.routeHandleLookup)for(var c=0;c<this.routeHandleLookup.length;c++)if(this.routeHandleLookup[c].routeId===a){b=this.routeHandleLookup[c].args;break}return b},updateNode:function(a,b){var c=this.getRouteOptions(a.attributes.routeId),d=this.getDragHandleFromNode(a);d[1].attributes.featureIds[0]=b.id;if(null!=c&&null!=c.routeOptions&&!0===c.routeOptions.hubRouting)for(var c=
d[0].attributes.featureIds,e=1;e<c.length;e++){if(c[e]===a.id)c[e]=b.id}else d[0].attributes.featureIds[1]=b.id;b.attributes.handleIds=[d[0].id,d[1].id]},getGeometry:function(a){return[a.geometry.x,a.geometry.y]},getPreviousHandle:function(a){return this.isStartHandle(a)?null:this.getDragHandleFromNode(this.getNodes(a)[0])[0]},getNextHandle:function(a){return this.isEndHandle(a)?null:this.getDragHandleFromNode(this.getNodes(a)[1])[1]},getNodes:function(a){for(var a=a.attributes.featureIds,b=[],c=
0;c<a.length;c++)if(null===a[c])b.push(null);else{var d=this.getFeatureById(a[c]);b.push(d)}return b},getDragHandleFromNode:function(a){for(var a=a.attributes.handleIds,b=[],c=0;c<a.length;c++){var d=this.getFeatureById(a[c]);b.push(d)}return b},isStartHandle:function(a){return null===a.attributes.featureIds[0]?!0:!1},isEndHandle:function(a){return null===a.attributes.featureIds[1]?!0:!1},getHandleAction:function(a){var b=["RB","RI","RM","RE"];return this.isStartHandle(a)?b[0]:this.isEndHandle(a)?
b[3]:a.attributes.featureIds[0]===a.attributes.featureIds[1]?b[2]:b[1]},setDraggable:function(a){(this.isDraggable=a)?this.dragControl.activate():this.dragControl.deactivate()},setRouteHandleVisibility:function(a,b){this._setHandlesVisibility(a,b);var c=this.getRouteOptions(a);if(null!==c)c.functionOptions.showHandles=b;this.redraw()},setRouteHandle:function(a,b,c){function d(a,b){b=b||{};a.style=ALKMaps.Util.extend(a.style,b)}var e=this.getRouteElements(a).stops;if(0===e.length)throw"Invalid routeId. '"+
a+"' does not exist on layer '"+this.name+"'.";if("string"===typeof b)switch(b.toUpperCase()){case "W":for(a=e.length-2;1<=a;a--)d(e[a],c);break;case "O":d(e[0],c);break;case "D":d(e[e.length-1],c);break;case "A":for(a=0;a<e.length;a++)d(e[a],c)}else if("number"===typeof b){if(0>b||b>e.length-1)throw"Index is out of range. Indexes for '"+a+"' must be between 0 and "+(e.length-1);d(e[b],c)}this.redraw()},setRouteVisibility:function(a,b){for(var c=this.getRouteElements(a),d=0;d<c.routelegs.length;d++)c.routelegs[d].attributes.display=
!0===b?"":"none";var c=!1,d=this.getRouteOptions(a),e=d.functionOptions.style||{};if(null!=this.routeArrowLookup){for(var f=0;f<this.routeArrowLookup.length;f++)if(this.routeArrowLookup[f].routeId===a){var c=!0,g=this.routeArrowLookup[f].arrows;!1===b&&(this.routeArrowLookup.splice(f,1),this.removeFeatures(g));break}!1===c&&!0===b&&("line"===e.arrows||"end"===e.arrows||"line"===this.styleMap.styles["default"].defaultStyle.arrows||"end"===this.styleMap.styles["default"].defaultStyle.arrows)&&this.routeArrowLookup.push({routeId:a,
arrows:[]})}!1!==d.functionOptions.showHandles&&this._setHandlesVisibility(a,b);if(null!=this.routeRestrictedPointsLookup)for(c=0;c<this.routeRestrictedPointsLookup.length;c++)if(this.routeRestrictedPointsLookup[c].routeId===a&&(d=this.routeRestrictedPointsLookup[c].lines,null!=d))for(e=0;e<d.length;e++)d[e].attributes.display=!0===b?"":"none";this.redraw()},onRouteModified:function(){},onErrorRouteModification:null,canUndo:function(a){a=this._findQueue(a);return null==a||0===a.size()||a.currentPosition===
a.size()-1?!1:!0},canRedo:function(a){a=this._findQueue(a);return null==a||0===a.size()||0===a.currentPosition?!1:!0},undoDrag:function(a){this._undoRedo(a,1)},redoDrag:function(a){this._undoRedo(a,-1)},clearDragQueue:function(a){a=this._findQueue(a);null!=a&&a.clear()},_undoRedo:function(a,b){var c=this._findQueue(a);if(!(null==c||0===c.size())){c.currentPosition+=b;var d=c.current();if(null==d)c.currentPosition-=b;else{for(var c={},e=0;e<this.routeHandleLookup.length;e++)if(this.routeHandleLookup[e].routeId===
a){c=this.routeHandleLookup[e].args;break}c.stops=d.stops;this.getRouteLegPoints(c,!1,!0)}}},_findQueue:function(a){var b=null;if(null!=this.routeDragQueueLookup)for(var c=0;c<this.routeDragQueueLookup.length;c++)if(this.routeDragQueueLookup[c].routeId===a){b=this.routeDragQueueLookup[c].queue;break}return b},_addToQueue:function(a){var b=this._findQueue(a.routeId);if(null!=b){for(var a=a.stops,c=[],d=0;d<a.length;d++){var e=new ALKMaps.LonLat(a[d].x,a[d].y);c.push(e)}b.add({stops:c})}},_routeModified:function(a){this.layer._addToQueue(a);
if(this.layer.onRouteModified&&"function"===typeof this.layer.onRouteModified)this.layer.onRouteModified(a)},_routeModifiedError:function(a){if(this.layer.onErrorRouteModification&&"function"===typeof this.layer.onErrorRouteModification)this.layer.onErrorRouteModification(a)},_getNextRouteStyle:function(){this._currentStyleId++;if(this._currentStyleId>=this._routeStyles.length)this._currentStyleId=0;return this._routeStyles[this._currentStyleId]},_onLayerMove:function(){var a=this._getRouteSimplifyLevel();
if(a!==this._currentSimplifyLevel)this._currentSimplifyLevel=a;if("ALKMaps.Renderer.SVG"===this.renderer.CLASS_NAME&&(a=this.routeHandleLookup)){for(var b=0;b<a.length;b++)for(var c=this.getRouteElements(a[b].routeId).routelegs,d=0;d<c.length;d++){var e=c[d],f=this._currentSimplifyLevel;if(e.onScreen()&&e.attributes.currentSimplifyLevel!==f){var g;g=0.01===f?e.attributes.simpleGeometry.clone():0.001===f?e.attributes.mediumGeometry.clone():e.attributes.fullGeometry.clone();e.attributes.currentSimplifyLevel=
f;e.geometry.components=[];e.geometry.addComponents(g.components)}}this.redraw()}},_getRouteSimplifyLevel:function(){var a=this.map.zoom,b=0.01;11<a?b=1.0E-6:6<a&&(b=0.001);return b},_setHandlesVisibility:function(a,b){if("string"!==typeof a)throw"Invalid routeId. '"+a+"' does not exist on layer '"+this.name+"'.";var c=this.getRouteElements(a);if(null!==c.stops)for(var d=c.stops.length-1;0<=d;d--){var e=c.stops[d];e.style=e.style||{};e.style.graphic=b}},redraw:function(){ALKMaps.Layer.prototype.redraw.apply(this,
arguments);if(null!=this.routeArrowLookup){for(var a=0;a<this.routeArrowLookup.length;a++)this.drawArrows(this.routeArrowLookup[a]);if(null!=this.routeHandleLookup)for(a=0;a<this.routeHandleLookup.length;a++)for(var b=this.getRouteElements(this.routeHandleLookup[a].routeId),c=0;c<b.stops.length;c++){var d=b.stops[c];this.removeFeatures([d]);this.addFeatures([d])}}},drawArrows:function(a){if(null!=a.arrows&&0<a.arrows.length)this.removeFeatures(a.arrows),a.arrows=[];for(var b=this.getRouteElements(a.routeId).routelegs,
c=this.getRouteOptions(a.routeId).functionOptions.style,d=0,e=null!=c.arrowSpacing?c.arrowSpacing:100,f,g,h=[],i=this.map.baseLayer.getExtent(),j=0;j<b.length;j++){var k=b[j].geometry;if("line"===c.arrows||"line"===this.styleMap.styles["default"].defaultStyle.arrows)for(var m=null,l=null,p=1;p<k.components.length;p++){f=k.components[p-1];var n=k.components[p];f=new ALKMaps.LonLat(f.x,f.y);n=new ALKMaps.LonLat(n.x,n.y);null!=m&&(f=m.clone(),m=null);null!=l&&(n=l.clone());var q=this.map.getViewPortPxFromLonLat(f),
o=this.map.getViewPortPxFromLonLat(n);if(i.containsLonLat(f)&&i.containsLonLat(n)){f=o.x-q.x;g=o.y-q.y;var r=Math.sqrt(f*f+g*g),d=d+r;d>=e?(n=n.clone(),100!==Math.floor(d)&&(m=r-(d-e),d=(o.y-q.y)/(o.x-q.x),m=0<o.x-q.x?q.x+m/Math.sqrt(1+d*d):q.x-m/Math.sqrt(1+d*d),n=this.map.getLonLatFromViewPortPx(new ALKMaps.Pixel(m,d*(m-q.x)+q.y)),m=n.clone(),p--),d=0,f=Math.atan2(g,f),f*=180/Math.PI,f+=90,n=this.createArrow(new ALKMaps.Geometry.Point(n.lon,n.lat),c,f,a.routeId),h.push(n)):null!=l&&(l=null)}else if(q=
i.toGeometry(),g=new ALKMaps.Geometry.LineString([new ALKMaps.Geometry.Point(f.lon,f.lat),new ALKMaps.Geometry.Point(n.lon,n.lat)]),q.intersects(g)){for(var o=q.getVertices(),t,q=[],r={x1:f.lon,y1:f.lat,x2:n.lon,y2:n.lat},s=0;s<o.length;s++)t=s<o.length-1?{x1:o[s].x,y1:o[s].y,x2:o[s+1].x,y2:o[s+1].y}:{x1:o[s].x,y1:o[s].y,x2:o[0].x,y2:o[0].y},t=ALKMaps.Geometry.segmentsIntersect(r,t,{point:!0,tolerance:0}),null!=t&&t instanceof ALKMaps.Geometry.Point&&q.push(t);2===q.length?(l=g.components[0].distanceTo(q[0]),
m=g.components[0].distanceTo(q[1]),l<=m?(m=new ALKMaps.LonLat(q[0].x,q[0].y),l=new ALKMaps.LonLat(q[1].x,q[1].y)):(m=new ALKMaps.LonLat(q[1].x,q[1].y),l=new ALKMaps.LonLat(q[0].x,q[0].y))):1===q.length&&(i.containsLonLat(n)?(m=new ALKMaps.LonLat(q[0].x,q[0].y),p--):i.containsLonLat(f)&&(l=new ALKMaps.LonLat(q[0].x,q[0].y),p--))}}else if("end"===c.arrows||"end"===this.styleMap.styles["default"].defaultStyle.arrows)p=b[b.length-1].geometry,k=p.components[p.components.length-1],l=p.components[p.components.length-
2],p=new ALKMaps.LonLat(k.x,k.y),l=new ALKMaps.LonLat(l.x,l.y),p=this.map.getViewPortPxFromLonLat(p),l=this.map.getViewPortPxFromLonLat(l),f=p.x-l.x,g=p.y-l.y,f=Math.atan2(g,f),f*=180/Math.PI,f+=90,k=this.createArrow(k,c,f,a.routeId),h.push(k)}if(0<h.length)this.addFeatures(h),a.arrows=h},createArrow:function(a,b,c,d){var e=null;if(null!=b.arrows){e={arrows:"line",arrowGraphicName:"chevron",arrowRotation:c,arrowStrokeColor:b.arrowStrokeColor,arrowStrokeWidth:b.arrowStrokeWidth,arrowStrokeOpacity:b.arrowStrokeOpacity,
arrowFillOpacity:b.arrowFillOpacity,arrowFillColor:b.arrowFillColor};if(null!=b.arrowSize)e.arrowSize=b.arrowSize;if(null!=b.strokeWidth)e.strokeWidth=b.strokeWidth}a=new ALKMaps.Feature.Vector(a,e);a.attributes.routeId=d;a.attributes.rotation=c;a.attributes.isArrow=!0;return a},CLASS_NAME:"ALKMaps.Layer.Routing"});ALKMaps.Control.ContextMenuFeature=ALKMaps.Class(ALKMaps.Control,{handleRightClicks:!0,autoActivate:!0,ctxMenuItems:null,featureCallbacks:{},geometryTypes:null,rightClickedItem:null,filter:null,layer:null,initialize:function(a,b){ALKMaps.Control.prototype.initialize.apply(this,arguments);if(null!=b)this.filter=b.filter,this.layer=b.layer;this.handler=new ALKMaps.Handler.Click(this,ALKMaps.Util.extend({click:function(a){this.hideMenu();if(null!=this.ctxMenuItems){for(var b=a.target||a.srcElement,e=
-1,f=0;f<this.ctxMenuItems.length;f++)if(b.id===this.ctxMenuItems[f].id){e=f;break}if(-1<e&&"function"===typeof this.ctxMenuItems[e].onclick)this.ctxMenuItems[e].onclick(a),this.rightClickedItem=null}}},this.callbacks),{single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1,alwaysTrigger:!0});this.featureHandler=new ALKMaps.Handler.Feature(this,b.layer,ALKMaps.Util.extend({rightclick:function(a){this.rightClickedItem=a;if(!(null!=this.filter&&!0!==this.filter.evaluate(a)))a=a.geometry,
a=this.map.getViewPortPxFromLonLat(new ALKMaps.LonLat(a.x,a.y)),this.showMenu([a.x,a.y])}},this.featureCallbacks),{geometryTypes:this.geometryTypes})},destroy:function(){this.deactivate();return ALKMaps.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.featureHandler.activate();this.active||this.map.disableContextMenu();return ALKMaps.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.hideMenu();this.featureHandler.deactivate();this.active&&this.map.enableContextMenu();
return ALKMaps.Control.prototype.deactivate.apply(this,arguments)},setMap:function(a){this.featureHandler.setMap(a);var b=this;ALKMaps.Control.prototype.setMap.apply(this,arguments);a.events.register("move",a,function(){b.hideMenu()})},draw:function(){for(var a=ALKMaps.Control.prototype.draw.apply(this,arguments),b=document.createElement("ul"),c=0;c<this.ctxMenuItems.length;c++){var d=this.ctxMenuItems[c],e=document.createElement("li");if(!0===d.separator)e.className="separator";else{var f=document.createElement("a");
f.innerHTML=d.text;f.id=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_item_");this.ctxMenuItems[c].id=f.id;f.className="olButton";e.appendChild(f)}b.appendChild(e)}a.appendChild(b);a.style.display="none";return a},showMenu:function(a){this.handler.activate();this.moveTo(new ALKMaps.Pixel(a[0],a[1]));this.div.style.display="block"},hideMenu:function(){this.div.style.display="none";this.handler.deactivate()},CLASS_NAME:"ALKMaps.Control.ContextMenuFeature"});ALKMaps.Control.ViewportInfo=ALKMaps.Class(ALKMaps.Control,{autoActivate:!0,element:null,emptyString:null,destroy:function(){this.deactivate();ALKMaps.Control.prototype.destroy.apply(this,arguments)},activate:function(){return ALKMaps.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("zoomend",this,this.redraw),this.map.events.register("moveend",this,this.redraw),this.map.events.register("mouseout",this,this.reset),this.redraw(),
!0):!1},deactivate:function(){return ALKMaps.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("zoomend",this,this.redraw),this.map.events.unregister("moveend",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.element)this.div.left="",this.div.top="",this.element=this.div;this.div.innerHTML=
"ALK Technologies Inc.";return this.div},redraw:function(){var a=this.map.getExtent(),b=this.map.getCenter();if(null!=a&&null!=b)a=a.clone().transform(this.map.getProjectionObject(),null==this.displayProjection?new ALKMaps.Projection("EPSG:4326"):this.displayProjection),b=b.clone().transform(this.map.getProjectionObject(),null==this.displayProjection?new ALKMaps.Projection("EPSG:4326"):this.displayProjection),this.element.innerHTML="Upper Left: "+a.top.toFixed(6)+", "+a.left.toFixed(6)+"<br/>Lower Right: "+
a.bottom.toFixed(6)+", "+a.right.toFixed(6)+"<br/>Center: "+b.lat.toFixed(6)+", "+b.lon.toFixed(6)+"<br/>Zoom: "+this.map.getZoom()},reset:function(){if(null!=this.emptyString)this.element.innerHTML=this.emptyString},CLASS_NAME:"ALKMaps.Control.ViewportInfo"});ALKMaps.Control.PointMenu=ALKMaps.Class(ALKMaps.Control.Panel,{autoActivate:!1,layer:null,pointName:"circle",pointSize:6,initialize:function(a,b){ALKMaps.Control.Panel.prototype.initialize.apply(this,[b]);var c=this;this.layer=a;for(var d=function(b){c.pointSize=b.object.pointRad;c.pointName=b.object.pointType;a.styleMap.styles.temporary.defaultStyle.graphicName=b.object.pointType;a.styleMap.styles.temporary.defaultStyle.pointRadius=b.object.pointRad},e=[{displayClass:"alkPointCircle",pointType:"circle",
pointRad:6},{displayClass:"alkPointSquare",pointType:"square",pointRad:5},{displayClass:"alkPointTriangle",pointType:"triangle",pointRad:5},{displayClass:"alkPointStar",pointType:"star",pointRad:8},{displayClass:"alkPointPlus",pointType:"cross",pointRad:7},{displayClass:"alkPointEx",pointType:"x",pointRad:7},{displayClass:"alkPointTruck",pointType:"truck",pointRad:12}],f=[],g=0;g<e.length;g++)f.push(new ALKMaps.Control.Button({displayClass:e[g].displayClass,pointType:e[g].pointType,pointRad:e[g].pointRad,
type:ALKMaps.Control.TYPE_TOOL,eventListeners:{activate:d}}));this.addControls(f)},draw:function(){var a=ALKMaps.Control.Panel.prototype.draw.apply(this,arguments);if(null===this.defaultControl)this.defaultControl=this.controls[0];a.className="olControlALKPanel "+a.className;return a},deactivate:function(){ALKMaps.Control.Panel.prototype.deactivate.apply(this,arguments);this.layer.styleMap.styles.temporary.defaultStyle.graphicName="circle";this.layer.styleMap.styles.temporary.defaultStyle.pointRadius=
6},CLASS_NAME:"ALKMaps.Control.PointMenu"});ALKMaps.Strategy.Save=ALKMaps.Class(ALKMaps.Strategy,{events:null,auto:!1,timer:null,initialize:function(a){ALKMaps.Strategy.prototype.initialize.apply(this,[a]);this.events=new ALKMaps.Events(this)},activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);if(a&&this.auto)if("number"===typeof this.auto)this.timer=window.setInterval(ALKMaps.Function.bind(this.save,this),1E3*this.auto);else this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this});
return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&this.auto&&("number"===typeof this.auto?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this}));return a},triggerSave:function(a){var b=a.feature;(b.state===ALKMaps.State.INSERT||b.state===ALKMaps.State.UPDATE||b.state===ALKMaps.State.DELETE)&&this.save([a.feature])},save:function(a){if(!a)a=this.layer.features;this.events.triggerEvent("start",
{features:a});var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b)){for(var d=a.length,e=Array(d),f,g,h=0;h<d;++h){f=a[h];g=f.clone();g.fid=f.fid;g.state=f.state;if(f.url)g.url=f.url;g._original=f;g.geometry.transform(c,b);e[h]=g}a=e}this.layer.protocol.commit(a,{callback:this.onCommit,scope:this})},onCommit:function(a){var b={response:a};if(a.success()){for(var c=a.reqFeatures,d,e=[],f=a.insertIds||[],g=0,h=0,i=c.length;h<i;++h)if(d=c[h],d=d._original||d,a=d.state){if(a==
ALKMaps.State.DELETE)e.push(d);else if(a==ALKMaps.State.INSERT)d.fid=f[g],++g;d.state=null}0<e.length&&this.layer.destroyFeatures(e);this.events.triggerEvent("success",b)}else this.events.triggerEvent("fail",b)},CLASS_NAME:"ALKMaps.Strategy.Save"});ALKMaps.Layer.WeatherRadarEU=ALKMaps.Class(ALKMaps.Layer.Grid,{DEFAULT_PARAMS:{display:"radar"},satKey:"",reproject:!1,isBaseLayer:!1,singleTile:!0,sphericalMercator:!0,projection:"EPSG:900913",disableCache:!1,initialize:function(a,b,c){c=c||{};this.disableCache=b.disableCache||!1;c.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME});this.isBaseLayer=!1;if(void 0===c.opacity)c.opacity=0.5;if(c&&!1===c.sphericalMercator||!this.sphericalMercator)c=ALKMaps.Util.extend({projection:"EPSG:4326"},
c);var d="sat_ir4";void 0!==b.visiblesat&&b.visiblesat&&(d="sat_vis");if(void 0!==b.display)"satellite"===b.display?this.satKey=d:b.display="radar";var d=ALKMaps.RestServiceURL+"weather",e=[],b=ALKMaps.Util.upperCaseObject(b);e.push(a,d,b,c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,e);ALKMaps.Util.applyDefaults(this.params,ALKMaps.Util.upperCaseObject(this.DEFAULT_PARAMS))},destroy:function(){ALKMaps.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new ALKMaps.Layer.WeatherRadar(this.name,
this.url,this.params,this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);if(!0===this.sphericalMercator)var b=this.map.getProjectionObject(),c=new ALKMaps.Projection("EPSG:4326"),a=a.transform(b,c);if(-180>a.left)a.left=(a.left%180+180)%180;if(180<a.left)a.left=(a.left%-180-180)%-180;if(-180>a.right)a.right=(a.right%180+180)%180;if(180<a.right)a.right=(a.right%-180-180)%-180;b=this.getImageSize();c={};c.WIDTH=b.w;c.HEIGHT=b.h;
c.PT1=a.left+","+a.top;c.PT2=a.right+","+a.bottom;c.AUTHTOKEN=ALKMaps.Util.getApiKey();if(""!==this.satKey)c.KEY=this.satKey;if(!0===this.disableCache)c.TIMESTAMP=(new Date).getTime();return this.getFullRequestString(c)},getFullRequestString:function(a,b){this.params.SRS=this.projection.getCode();return ALKMaps.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"ALKMaps.Layer.WeatherRadarEU"});ALKMaps.Control.CacheRead=ALKMaps.Class(ALKMaps.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0<=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(a){a.layer.events.unregister(this.fetchEvent,
this,this.fetch)},fetch:function(a){if(this.active&&window.localStorage&&a.tile instanceof ALKMaps.Tile.Image){var b=a.tile,c=b.url;!b.layer.crossOriginKeyword&&ALKMaps.ProxyHost&&0===c.indexOf(ALKMaps.ProxyHost)&&(c=ALKMaps.Control.CacheWrite.urlMap[c]);if(c=window.localStorage.getItem("olCache_"+c))b.url=c,"tileerror"===a.type&&b.setImgSrc(c)}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0<=a;--a)this.removeLayer({layer:b[a]})}this.map&&this.map.events.un({addlayer:this.addLayer,
removeLayer:this.removeLayer,scope:this});ALKMaps.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"ALKMaps.Control.CacheRead"});ALKMaps.Control.KeyboardDefaults=ALKMaps.Class(ALKMaps.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){this.handler=new ALKMaps.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:this.observeElement||document})},defaultKeyPress:function(a){var b,c=!0;switch(a.keyCode){case ALKMaps.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case ALKMaps.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case ALKMaps.Event.KEY_UP:this.map.pan(0,-this.slideFactor);
break;case ALKMaps.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:b=this.map.getSize();this.map.pan(0,-0.75*b.h);break;case 34:b=this.map.getSize();this.map.pan(0,0.75*b.h);break;case 35:b=this.map.getSize();this.map.pan(0.75*b.w,0);break;case 36:b=this.map.getSize();this.map.pan(-0.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:c=!1}c&&ALKMaps.Event.stop(a)},CLASS_NAME:"ALKMaps.Control.KeyboardDefaults"});ALKMaps.Geometry.Rectangle=ALKMaps.Class(ALKMaps.Geometry,{x:null,y:null,width:null,height:null,initialize:function(a,b,c,d){ALKMaps.Geometry.prototype.initialize.apply(this,arguments);this.x=a;this.y=b;this.width=c;this.height=d},calculateBounds:function(){this.bounds=new ALKMaps.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)},getLength:function(){return 2*this.width+2*this.height},getArea:function(){return this.width*this.height},CLASS_NAME:"ALKMaps.Geometry.Rectangle"});ALKMaps.Layer.XYZ=ALKMaps.Class(ALKMaps.Layer.Grid,{isBaseLayer:!1,sphericalMercator:!0,zoomOffset:0,serverResolutions:null,initialize:function(a,b,c){if(c&&c.sphericalMercator||this.sphericalMercator)c=ALKMaps.Util.extend({projection:"EPSG:900913",numZoomLevels:19},c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,[a||this.name,b||this.url,{},c])},clone:function(a){null==a&&(a=new ALKMaps.Layer.XYZ(this.name,this.url,this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,
[a])},updateURL:function(){},getURL:function(a){var a=this.getXYZ(a),b=this.updateURL()||this.url;ALKMaps.Util.isArray(b)&&(b=this.selectUrl(""+a.x+a.y+a.z,b));return ALKMaps.String.format(b,a)},getXYZ:function(a){var b=this.getServerResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h)),b=this.getServerZoom();if(this.wrapDateLine)var d=Math.pow(2,b),c=(c%d+d)%d;return{x:c,y:a,z:b}},setMap:function(a){ALKMaps.Layer.Grid.prototype.setMap.apply(this,
arguments);if(!this.tileOrigin)this.tileOrigin=new ALKMaps.LonLat(this.maxExtent.left,this.maxExtent.bottom)},CLASS_NAME:"ALKMaps.Layer.XYZ"});ALKMaps.Lang.th={panup:"\u0e41\u0e1e\u0e19\u0e02\u0e36\u0e49\u0e19",panleft:"\u0e41\u0e1e\u0e19\u0e44\u0e1b\u0e17\u0e32\u0e07\u0e0b\u0e49\u0e32\u0e22",zoomworld:"\u0e0b\u0e39\u0e21\u0e42\u0e25\u0e01",panright:"\u0e41\u0e1e\u0e19\u0e44\u0e1b\u0e17\u0e32\u0e07\u0e02\u0e27\u0e32",pandown:"\u0e41\u0e1e\u0e19\u0e25\u0e07",zoomin:"\u0e0b\u0e39\u0e21\u0e40\u0e02\u0e49\u0e32",zoomout:"\u0e0b\u0e39\u0e21\u0e2d\u0e2d\u0e01",dragme:"\u0e25\u0e32\u0e01",dragToChangeRoute:"\u0e25\u0e32\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e1b\u0e25\u0e35\u0e48\u0e22\u0e19\u0e40\u0e2a\u0e49\u0e19\u0e17\u0e32\u0e07",
drawPoints:"\u0e27\u0e32\u0e14\u0e08\u0e38\u0e14",clkToSetPoints:"\u0e04\u0e25\u0e34\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e01\u0e33\u0e2b\u0e19\u0e14\u0e08\u0e38\u0e14\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e27\u0e32\u0e14\u0e40\u0e2a\u0e49\u0e19 \u0e04\u0e25\u0e34\u0e01\u0e2a\u0e2d\u0e07\u0e04\u0e23\u0e31\u0e49\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e2a\u0e34\u0e49\u0e19\u0e2a\u0e38\u0e14",dragToDrawLine:"\u0e25\u0e32\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e27\u0e32\u0e14\u0e40\u0e2a\u0e49\u0e19\u0e15\u0e32\u0e21\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23",
dragToDrawEllipse:"\u0e25\u0e32\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e27\u0e32\u0e14\u0e23\u0e39\u0e1b\u0e27\u0e07\u0e23\u0e35",dragToDrawRect:"\u0e25\u0e32\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e27\u0e32\u0e14\u0e23\u0e39\u0e1b\u0e2a\u0e35\u0e48\u0e40\u0e2b\u0e25\u0e35\u0e48\u0e22\u0e21",clkToSetPolygon:"\u0e04\u0e25\u0e34\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e01\u0e33\u0e2b\u0e19\u0e14\u0e08\u0e38\u0e14\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e27\u0e32\u0e14\u0e23\u0e39\u0e1b\u0e2b\u0e25\u0e32\u0e22\u0e40\u0e2b\u0e25\u0e35\u0e48\u0e22\u0e21 \u0e04\u0e25\u0e34\u0e01\u0e2a\u0e2d\u0e07\u0e04\u0e23\u0e31\u0e49\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e2a\u0e34\u0e49\u0e19\u0e2a\u0e38\u0e14",
dragToDrawPolygon:"\u0e25\u0e32\u0e01\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e27\u0e32\u0e14\u0e23\u0e39\u0e1b\u0e2b\u0e25\u0e32\u0e22\u0e40\u0e2b\u0e25\u0e35\u0e48\u0e22\u0e21\u0e15\u0e32\u0e21\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23",clkShapeToResize:"\u0e04\u0e25\u0e34\u0e01\u0e17\u0e35\u0e48\u0e23\u0e39\u0e1b\u0e23\u0e48\u0e32\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e1b\u0e23\u0e31\u0e1a\u0e02\u0e19\u0e32\u0e14\u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e25\u0e37\u0e48\u0e2d\u0e19 \u0e27\u0e32\u0e07\u0e40\u0e04\u0e2d\u0e23\u0e4c\u0e40\u0e0b\u0e2d\u0e23\u0e4c\u0e44\u0e27\u0e49\u0e43\u0e01\u0e25\u0e49\u0e01\u0e31\u0e1a\u0e21\u0e38\u0e21\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e2b\u0e21\u0e38\u0e19",
clkShapeToModify:"\u0e04\u0e25\u0e34\u0e01\u0e17\u0e35\u0e48\u0e23\u0e39\u0e1b\u0e23\u0e48\u0e32\u0e07\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e41\u0e01\u0e49\u0e44\u0e02\u0e08\u0e38\u0e14\u0e1a\u0e19\u0e23\u0e39\u0e1b \u0e40\u0e21\u0e37\u0e48\u0e2d\u0e27\u0e32\u0e07\u0e40\u0e04\u0e2d\u0e23\u0e4c\u0e40\u0e0b\u0e2d\u0e23\u0e4c\u0e44\u0e27\u0e49\u0e40\u0e2b\u0e19\u0e37\u0e2d\u0e08\u0e38\u0e14 \u0e01\u0e14\u0e1b\u0e38\u0e48\u0e21 \u0e25\u0e1a \u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e25\u0e1a\u0e08\u0e38\u0e14\u0e2d\u0e2d\u0e01",
showShapeInfo:"\u0e41\u0e2a\u0e14\u0e07\u0e01\u0e25\u0e48\u0e2d\u0e07\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e23\u0e39\u0e1b\u0e23\u0e48\u0e32\u0e07",area:"\u0e1e\u0e37\u0e49\u0e19\u0e17\u0e35\u0e48",length:"\u0e04\u0e27\u0e32\u0e21\u0e22\u0e32\u0e27",nodes:"\u0e42\u0e2b\u0e19\u0e14",perimeter:"\u0e40\u0e2a\u0e49\u0e19\u0e23\u0e2d\u0e1a\u0e23\u0e39\u0e1b",location:"\u0e15\u0e33\u0e41\u0e2b\u0e19\u0e48\u0e07",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",
nextMapView:"Next map view"};ALKMaps.Lang["da-DK"]={unhandledRequest:"En ikke h\u00e5ndteret foresp\u00f8rgsel returnerede ${statusText}",Permalink:"Permalink",Overlays:"Kortlag","Base Layer":"Baggrundslag",readNotImplemented:"L\u00e6sning er ikke implementeret.",writeNotImplemented:"Skrivning er ikke implementeret.",noFID:"Kan ikke opdateret en feature (et objekt) der ikke har et FID.",errorLoadingGML:"Fejlede under indl\u00e6sning af GML fil ${url}",browserNotSupported:"Din browser underst\u00f8tter ikke vektor visning. F\u00f8lgende vektor visninger underst\u00f8ttes:\n${renderers}",
componentShouldBe:"addFeatures : komponenten skal v\u00e6re en ${geomType}",getFeatureError:"getFeatureFromEvent blev kaldt p\u00e5 et lag uden en visning. Dette betyder som regel at du har destrueret et lag, men ikke de h\u00e5ndteringer der var tilknyttet.",minZoomLevelError:"Egenskaben minZoomLevel er kun beregnet til brug med FixedZoomLevels. At dette WFS lag kontrollerer minZoomLevel egenskaben, er et levn fra en tidligere version. Vi kan desv\u00e6rre ikke fjerne dette uden at risikere at \u00f8del\u00e6gge eksisterende OL baserede programmer der  benytter denne funktionalitet. Egenskaben b\u00f8r derfor ikke anvendes, og minZoomLevel kontrollen herunder vil blive fjernet i version 3.0. Benyt istedet min/max opl\u00f8snings indstillingerne, som er beskrevet her: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS transaktion: LYKKEDES ${response}",commitFailed:"WFS transaktion: MISLYKKEDES ${response}",googleWarning:"Google laget kunne ikke indl\u00e6ses.<br><br>For at fjerne denne besked, v\u00e6lg et nyt bagrundskort i lagskifteren i \u00f8verste h\u00f8jre hj\u00f8rne.<br><br>Fejlen skyldes formentlig at Google Maps bibliotekts scriptet ikke er inkluderet, eller ikke indeholder den korrkte API n\u00f8gle for dit site.<br><br>Udviklere: For hj\u00e6lp til at f\u00e5 dette til at fungere, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>klik her</a>",
getLayerWarning:"${layerType}-laget kunne ikke indl\u00e6ses.<br><br>For at fjerne denne besked, v\u00e6lg et nyt bagrundskort i lagskifteren i \u00f8verste h\u00f8jre hj\u00f8rne.<br><br>Fejlen skyldes formentlig at ${layerLib} bibliotekts scriptet ikke er inkluderet.<br><br>Udviklere: For hj\u00e6lp til at f\u00e5 dette til at fungere, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>klik her</a>","Scale = 1 : ${scaleDenom}":"M\u00e5lforhold = 1 : ${scaleDenom}",layerAlreadyAdded:"Du har fors\u00f8gt at tilf\u00f8je laget: ${layerName} til kortet, men det er allerede tilf\u00f8jet",
reprojectDeprecated:"Du anvender indstillingen 'reproject' p\u00e5 laget ${layerName}.Denne indstilling b\u00f8r ikke l\u00e6ngere anvendes. Den var beregnet til at vise data ovenp\u00e5 kommercielle grundkort, men den funktionalitet b\u00f8r nu opn\u00e5s ved at anvende Spherical Mercator underst\u00f8ttelsen. Mere information er tilg\u00e6ngelig her: http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Denne funktion b\u00f8r ikke l\u00e6ngere anvendes, og vil blive fjernet i version 3.0. Anvend venligst funktionen ${newMethod} istedet.",
boundsAddError:"Du skal angive b\u00e5de x og y v\u00e6rdier i kaldet til add funktionen.",lonlatAddError:"Du skal angive b\u00e5de lon og lat v\u00e6rdier i kaldet til add funktionen.",pixelAddError:"Du skal angive b\u00e5de x og y v\u00e6rdier i kaldet til add funktionen.",unsupportedGeometryType:"Geometri typen: ${geomType} er ikke underst\u00f8ttet.",filterEvaluateNotImplemented:"evaluering er ikke implementeret for denne filter type.",panup:"Panorer op",panleft:"Panorer mod venstre",zoomworld:"Zoom verden",
panright:"Panorer mod h\u00f8jre",pandown:"Panorer ned",zoomin:"Zoom ind",zoomout:"Zoom ud",dragme:"Tr\u00e6k mig",dragToChangeRoute:"Tr\u00e6k for at \u00e6ndre ruten",drawPoints:"Tegn punkter",clkToSetPoints:"Klik for at fastl\u00e6gge punkter p\u00e5 en linje. Dobbeltklik for at afslutte.",dragToDrawLine:"Tr\u00e6k for at tegne en linje med fri h\u00e5nd.",dragToDrawEllipse:"Tr\u00e6k for at tegne en elipse.",dragToDrawRect:"Tr\u00e6k for at tegne en firkant.",clkToSetPolygon:"Klik for at fastl\u00e6gge punkter i et polygon. Dobbeltklik for at afslutte.",
dragToDrawPolygon:"Tr\u00e6k for at tegne et polygon med fri h\u00e5nd.",clkShapeToResize:"Klik p\u00e5 en form for at \u00e6ndre st\u00f8rrelsen eller flytte den. Hold mark\u00f8ren over et punkt, og tryk p\u00e5 slettetasten for at fjerne den.",clkShapeToModify:"Klik p\u00e5 en form for at \u00e6ndre formens punkter. Hold mark\u00f8ren over et punkt, og tryk p\u00e5 slettetasten for at fjerne den.",showShapeInfo:"Vis dialogboks med formoplysninger.",area:"Areal",length:"L\u00e6ngde",nodes:"Knuder",
perimeter:"Omkreds",location:"Placering",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Lang.da=ALKMaps.Lang["da-DK"];ALKMaps.Control.PanZoomBar=ALKMaps.Class(ALKMaps.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,zoomWorldIcon:!1,panIcons:!0,forceFixedZoomLevel:!1,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removeZoomBar();this.map.events.un({changebaselayer:this.redraw,scope:this});ALKMaps.Control.PanZoom.prototype.destroy.apply(this,arguments);delete this.mouseDragStart;delete this.zoomStart},setMap:function(a){ALKMaps.Control.PanZoom.prototype.setMap.apply(this,
arguments);this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){null!=this.div&&(this.removeButtons(),this._removeZoomBar());this.draw()},draw:function(a){ALKMaps.Control.prototype.draw.apply(this,arguments);a=this.position.clone();this.buttons=[];var b={w:18,h:18};if(this.panIcons){var c=new ALKMaps.Pixel(a.x+b.w/2,a.y),d=b.w;this.zoomWorldIcon&&(c=new ALKMaps.Pixel(a.x+b.w,a.y));this._addButton("panup","north-mini.png",c,b,ALKMaps.i18n("panup"));a.y=c.y+b.h;this._addButton("panleft",
"west-mini.png",a,b,ALKMaps.i18n("panleft"));this.zoomWorldIcon&&(this._addButton("zoomworld","zoom-world-mini.png",a.add(b.w,0),b,ALKMaps.i18n("zoomworld")),d*=2);this._addButton("panright","east-mini.png",a.add(d,0),b,ALKMaps.i18n("panright"));this._addButton("pandown","south-mini.png",c.add(0,2*b.h),b,ALKMaps.i18n("pandown"));this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b,ALKMaps.i18n("zoomin"));c=this._addZoomBar(c.add(0,4*b.h+5));this._addButton("zoomout","zoom-minus-mini.png",
c,b,ALKMaps.i18n("zoomout"))}else this._addButton("zoomin","zoom-plus-mini.png",a,b,ALKMaps.i18n("zoomin")),c=this._addZoomBar(a.add(0,b.h)),this._addButton("zoomout","zoom-minus-mini.png",c,b,ALKMaps.i18n("zoomout")),this.zoomWorldIcon&&(c=c.add(0,b.h+3),this._addButton("zoomworld","zoom-world-mini.png",c,b,ALKMaps.i18n("zoomworld")));return this.div},_addZoomBar:function(a){var b=ALKMaps.Util.getImageLocation("slider.png"),c=this.id+"_"+this.map.id,d=this.map.getNumZoomLevels()-1-this.map.getZoom(),
d=ALKMaps.Util.createAlphaImageDiv(c,a.add(-1,d*this.zoomStopHeight),{w:20,h:9},b,"absolute");d.style.cursor="move";this.slider=d;this.sliderEvents=new ALKMaps.Events(this,d,null,!0,{includeXY:!0});this.sliderEvents.on({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});var e={w:this.zoomStopWidth,h:this.zoomStopHeight*this.map.getNumZoomLevels()},b=ALKMaps.Util.getImageLocation("zoombar.png"),
c=null;ALKMaps.Util.alphaHack()?(c=this.id+"_"+this.map.id,c=ALKMaps.Util.createAlphaImageDiv(c,a,{w:e.w,h:this.zoomStopHeight},b,"absolute",null,"crop"),c.style.height=e.h+"px"):c=ALKMaps.Util.createDiv("ALKMaps_Control_PanZoomBar_Zoombar"+this.map.id,a,e,b);c.style.cursor="pointer";c.style.backgroundRepeat="repeat-y";c.className="olButton";this.zoombarDiv=c;this.div.appendChild(c);this.startTop=parseInt(c.style.top);this.div.appendChild(d);this.map.events.register("zoomend",this,this.moveZoomBar);
return a=a.add(0,this.zoomStopHeight*this.map.getNumZoomLevels())},_removeZoomBar:function(){this.sliderEvents.un({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});this.sliderEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},onButtonClick:function(a){ALKMaps.Control.PanZoom.prototype.onButtonClick.apply(this,
arguments);if(a.buttonElement===this.zoombarDiv){var b=a.buttonXY.y/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom)b=Math.floor(b);b=this.map.getNumZoomLevels()-1-b;b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(b)}},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},zoomBarDown:function(a){if(ALKMaps.Event.isLeftClick(a)||ALKMaps.Event.isSingleTouch(a))this.map.events.on({touchmove:this.passEventToSlider,mousemove:this.passEventToSlider,
mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=a.xy.clone(),this.zoomStart=a.xy.clone(),this.div.style.cursor="move",this.zoombarDiv.offsets=null,ALKMaps.Event.stop(a)},zoomBarDrag:function(a){if(null!=this.mouseDragStart){var b=this.mouseDragStart.y-a.xy.y,c=ALKMaps.Util.pagePosition(this.zoombarDiv);if(0<a.clientY-c[1]&&a.clientY-c[1]<parseInt(this.zoombarDiv.style.height)-2)this.slider.style.top=parseInt(this.slider.style.top)-b+"px",this.mouseDragStart=a.xy.clone();this.deltaY=
this.zoomStart.y-a.xy.y;ALKMaps.Event.stop(a)}},zoomBarUp:function(a){if((ALKMaps.Event.isLeftClick(a)||"touchend"===a.type)&&this.mouseDragStart){this.div.style.cursor="";this.map.events.un({touchmove:this.passEventToSlider,mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var b=this.map.zoom;!this.forceFixedZoomLevel&&this.map.fractionalZoom?(b+=this.deltaY/this.zoomStopHeight,b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1)):(b+=this.deltaY/this.zoomStopHeight,
b=Math.max(Math.round(b),0),b=Math.min(this.map.getNumZoomLevels()-1,b));this.map.zoomTo(b);this.zoomStart=this.mouseDragStart=null;this.deltaY=0;(this.map.getNumZoomLevels()-1===b||0===b)&&this.moveZoomBar();ALKMaps.Event.stop(a)}},moveZoomBar:function(){this.slider.style.top=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1+"px"},CLASS_NAME:"ALKMaps.Control.PanZoomBar"});ALKMaps.Geometry.Surface=ALKMaps.Class(ALKMaps.Geometry,{initialize:function(){ALKMaps.Geometry.prototype.initialize.apply(this,arguments)},CLASS_NAME:"ALKMaps.Geometry.Surface"});ALKMaps.Lang.ko={panup:"\uc704\ub85c",panleft:"\uc67c\ucabd\uc73c\ub85c",zoomworld:"\uc9c0\uad6c \ubcf4\uae30",panright:"\uc624\ub978\ucabd\uc73c\ub85c",pandown:"\uc544\ub798\ub85c",zoomin:"\ud655\ub300",zoomout:"\ucd95\uc18c",dragme:"\ub04c\uae30",dragToChangeRoute:"\ub04c\uc5b4\uc11c \uacbd\ub85c \ubcc0\uacbd",drawPoints:"\uc810 \uadf8\ub9ac\uae30",clkToSetPoints:"\uc120\uc758 \uc810\uc744 \uc124\uc815\ud558\ub824\uba74 \ud074\ub9ad\ud558\uc138\uc694. \uc885\ub8cc\ud558\ub824\uba74 \ub354\ube14 \ud074\ub9ad \ud558\uc138\uc694.",
dragToDrawLine:"\ub04c\uc5b4\uc11c \uc790\uc720 \uace1\uc120\uc744 \uadf8\ub9ac\uc138\uc694.",dragToDrawEllipse:"\ub04c\uc5b4\uc11c \ud0c0\uc6d0\uc744 \uadf8\ub9ac\uc138\uc694.",dragToDrawRect:"\ub04c\uc5b4\uc11c \uc9c1\uc0ac\uac01\ud615\uc744 \uadf8\ub9ac\uc138\uc694.",clkToSetPolygon:"\ub2e4\uac01\ud615\uc758 \uc810\uc744 \uc124\uc815\ud558\ub824\uba74 \ud074\ub9ad\ud558\uc138\uc694. \uc885\ub8cc\ud558\ub824\uba74 \ub354\ube14 \ud074\ub9ad \ud558\uc138\uc694.",dragToDrawPolygon:"\ub04c\uc5b4\uc11c \uc790\uc720 \ub2e4\uac01\ud615\uc744 \uadf8\ub9ac\uc138\uc694.",
clkShapeToResize:"\ud06c\uae30 \uc870\uc815\uc774\ub098 \uc774\ub3d9\uc744 \ud558\ub824\uba74 \ub3c4\ud615\uc744 \ud074\ub9ad\ud558\uc138\uc694. \ud68c\uc804\uc2dc\ud0a4\ub824\uba74 \ucf54\ub108 \uac00\uae4c\uc774\uc5d0 \ucee4\uc11c\ub97c \ub450\uc138\uc694.",clkShapeToModify:"\ub3c4\ud615\uc810\uc744 \uc218\uc815\ud558\ub824\uba74 \ub3c4\ud615\uc744 \ud074\ub9ad\ud558\uc138\uc694. \uc810 \uc704\uc5d0 \ucee4\uc11c\ub97c \ub450\uace0 '\uc0ad\uc81c' \ud0a4\ub97c \ub204\ub974\uba74 \uc81c\uac70\ub429\ub2c8\ub2e4.",
showShapeInfo:"\ub3c4\ud615 \uc815\ubcf4 \uc0c1\uc790\ub97c \ud45c\uc2dc\ud558\uc138\uc694.",area:"\uba74\uc801",length:"\uae38\uc774",nodes:"\ub178\ub4dc",perimeter:"\ub458\ub808",location:"\uc704\uce58",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Lang["zh-CN"]={unhandledRequest:"\u672a\u5904\u7406\u7684\u8bf7\u6c42\uff0c\u8fd4\u56de\u503c\u4e3a ${statusText}",Permalink:"\u6c38\u4e45\u94fe\u63a5",Overlays:"\u53e0\u52a0\u5c42","Base Layer":"\u57fa\u7840\u56fe\u5c42",readNotImplemented:"\u8bfb\u53d6\u529f\u80fd\u6ca1\u6709\u5b9e\u73b0\u3002",writeNotImplemented:"\u5199\u5165\u529f\u80fd\u6ca1\u6709\u5b9e\u73b0\u3002",noFID:"\u65e0\u6cd5\u66f4\u65b0feature\uff0c\u7f3a\u5c11FID\u3002",errorLoadingGML:"\u52a0\u8f7dGML\u6587\u4ef6 ${url} \u51fa\u73b0\u9519\u8bef\u3002",
browserNotSupported:"\u4f60\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u77e2\u91cf\u6e32\u67d3\u3002\u5f53\u524d\u652f\u6301\u7684\u6e32\u67d3\u65b9\u5f0f\u5305\u62ec\uff1a\n${renderers}",componentShouldBe:"addFeatures : \u7ec4\u4ef6\u7c7b\u578b\u5e94\u8be5\u662f ${geomType}",getFeatureError:"getFeatureFromEvent\u65b9\u6cd5\u5728\u4e00\u4e2a\u6ca1\u6709\u6e32\u67d3\u5668\u7684\u56fe\u5c42\u4e0a\u88ab\u8c03\u7528\u3002 \u8fd9\u901a\u5e38\u610f\u5473\u7740\u60a8\u9500\u6bc1\u4e86\u4e00\u4e2a\u56fe\u5c42\uff0c\u4f46\u5e76\u672a\u9500\u6bc1\u5176\u5173\u8054\u7684handler\u3002",
minZoomLevelError:"minZoomLevel\u5c5e\u6027\u4ec5\u9002\u5408\u7528\u4e8e\u4f7f\u7528\u4e86\u56fa\u5b9a\u7f29\u653e\u7ea7\u522b\u7684\u56fe\u5c42\u3002\u8fd9\u4e2a wfs \u56fe\u5c42\u68c0\u67e5 minZoomLevel \u662f\u8fc7\u53bb\u9057\u7559\u4e0b\u6765\u7684\u3002\u7136\u800c\uff0c\u6211\u4eec\u4e0d\u80fd\u79fb\u9664\u5b83\uff0c\u800c\u7834\u574f\u4f9d\u8d56\u4e8e\u5b83\u7684\u57fa\u4e8eOL\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5e9f\u9664\u4e86\u5b83 -- minZoomLevel \u5c06\u4f1a\u57283.0\u4e2d\u88ab\u79fb\u9664\u3002\u8bf7\u6539\u7528 min/max resolution \u8bbe\u7f6e\uff0c\u53c2\u8003\uff1ahttp://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS Transaction: \u6210\u529f\u3002 ${response}",commitFailed:"WFS Transaction: \u5931\u8d25\u3002 ${response}",googleWarning:"Google\u56fe\u5c42\u4e0d\u80fd\u6b63\u786e\u52a0\u8f7d\u3002<br><br>\u8981\u6d88\u9664\u8fd9\u4e2a\u4fe1\u606f\uff0c\u8bf7\u5728\u53f3\u4e0a\u89d2\u7684\u56fe\u5c42\u63a7\u5236\u9762\u677f\u4e2d\u9009\u62e9\u5176\u4ed6\u7684\u57fa\u7840\u56fe\u5c42\u3002<br><br>\u8fd9\u79cd\u60c5\u51b5\u5f88\u53ef\u80fd\u662f\u6ca1\u6709\u6b63\u786e\u7684\u5305\u542bGoogle\u5730\u56fe\u811a\u672c\u5e93\uff0c\u6216\u8005\u662f\u6ca1\u6709\u5305\u542b\u5728\u4f60\u7684\u7ad9\u70b9\u4e0a\u4f7f\u7528\u7684\u6b63\u786e\u7684Google Maps API\u5bc6\u5319\u3002<br><br>\u5f00\u53d1\u8005\uff1a\u83b7\u53d6\u4f7f\u5176\u6b63\u786e\u5de5\u4f5c\u7684\u5e2e\u52a9\u4fe1\u606f\uff0c<a href='http://trac.openlayers.org/wiki/Google' target='_blank'>\u70b9\u51fb\u8fd9\u91cc</a>",
getLayerWarning:"${layerType} \u56fe\u5c42\u4e0d\u80fd\u6b63\u786e\u52a0\u8f7d\u3002<br><br>\u8981\u6d88\u9664\u8fd9\u4e2a\u4fe1\u606f\uff0c\u8bf7\u5728\u53f3\u4e0a\u89d2\u7684\u56fe\u5c42\u63a7\u5236\u9762\u677f\u4e2d\u9009\u62e9\u5176\u4ed6\u7684\u57fa\u7840\u56fe\u5c42\u3002<br><br>\u8fd9\u79cd\u60c5\u51b5\u5f88\u53ef\u80fd\u662f\u6ca1\u6709\u6b63\u786e\u7684\u5305\u542b${layerLib} \u811a\u672c\u5e93\u3002<br><br>\u5f00\u53d1\u8005\uff1a\u83b7\u53d6\u4f7f\u5176\u6b63\u786e\u5de5\u4f5c\u7684\u5e2e\u52a9\u4fe1\u606f\uff0c<a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>\u70b9\u51fb\u8fd9\u91cc</a>",
"Scale = 1 : ${scaleDenom}":"\u6bd4\u4f8b\u5c3a = 1 : ${scaleDenom}",layerAlreadyAdded:"\u4f60\u5c1d\u8bd5\u6dfb\u52a0\u56fe\u5c42\uff1a ${layerName} \u5230\u5730\u56fe\u4e2d\uff0c\u4f46\u662f\u5b83\u4e4b\u524d\u5c31\u5df2\u7ecf\u88ab\u6dfb\u52a0\u3002",reprojectDeprecated:"\u4f60\u6b63\u5728\u4f7f\u7528 ${layerName} \u56fe\u5c42\u4e0a\u7684'reproject'\u9009\u9879\u3002\u8fd9\u4e2a\u9009\u9879\u5df2\u7ecf\u4e0d\u518d\u4f7f\u7528\uff1a\u5b83\u662f\u88ab\u8bbe\u8ba1\u7528\u6765\u652f\u6301\u663e\u793a\u5546\u4e1a\u7684\u5730\u56fe\u6570\u636e\uff0c\u4e0d\u8fc7\u73b0\u5728\u8be5\u529f\u80fd\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528Spherical Mercator\u6765\u5b9e\u73b0\u3002\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u53c2\u9605http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"\u8be5\u65b9\u6cd5\u5df2\u7ecf\u4e0d\u518d\u88ab\u652f\u6301\uff0c\u5e76\u4e14\u5c06\u57283.0\u4e2d\u88ab\u79fb\u9664\u3002\u8bf7\u4f7f\u7528 ${newMethod} \u65b9\u6cd5\u6765\u66ff\u4ee3\u3002",boundsAddError:"\u60a8\u5fc5\u987b\u4f20\u9012 x \u548c y \u4e24\u4e2a\u53c2\u6570\u503c\u5230 add \u65b9\u6cd5\u3002",lonlatAddError:"\u60a8\u5fc5\u987b\u4f20\u9012 lon \u548c lat \u4e24\u4e2a\u53c2\u6570\u503c\u5230 add \u65b9\u6cd5\u3002",pixelAddError:"\u60a8\u5fc5\u987b\u4f20\u9012 x and y \u4e24\u4e2a\u53c2\u6570\u503c\u5230 add \u65b9\u6cd5\u3002",
unsupportedGeometryType:"\u4e0d\u652f\u6301\u7684\u51e0\u4f55\u4f53\u7c7b\u578b\uff1a ${geomType}",end:"",panup:"\u5411\u4e0a\u5e73\u79fb",panleft:"\u5411\u5de6\u5e73\u79fb",zoomworld:"\u663e\u793a\u6574\u4e2a\u5de5\u4f5c\u533a",panright:"\u5411\u53f3\u5e73\u79fb",pandown:"\u5411\u4e0b\u5e73\u79fb",zoomin:"\u653e\u5927",zoomout:"\u7f29\u5c0f",dragme:"\u62d6\u52a8\u6211",dragToChangeRoute:"\u62d6\u52a8\u6539\u53d8\u8def\u7ebf",drawPoints:"\u7ed8\u70b9",clkToSetPoints:"\u70b9\u51fb\u4e3a\u4e00\u6761\u7ebf\u8bbe\u5b9a\u70b9\u3002\u53cc\u51fb\u53ef\u7ed3\u675f\u3002",
dragToDrawLine:"\u62d6\u7ed8\u4e00\u6761\u5f92\u624b\u7ebf\u3002",dragToDrawEllipse:"\u62d6\u7ed8\u4e00\u4e2a\u692d\u5706\u3002",dragToDrawRect:"\u62d6\u7ed8\u4e00\u4e2a\u957f\u65b9\u5f62\u3002",clkToSetPolygon:"\u70b9\u51fb\u4e3a\u4e00\u4e2a\u591a\u8fb9\u5f62\u8bbe\u5b9a\u70b9\u3002\u53cc\u51fb\u53ef\u7ed3\u675f\u3002",dragToDrawPolygon:"\u62d6\u7ed8\u4e00\u4e2a\u5f92\u624b\u591a\u8fb9\u5f62\u3002",clkShapeToResize:"\u70b9\u51fb\u4e00\u4e2a\u5f62\u72b6\u8c03\u6574\u5b83\u7684\u5927\u5c0f\u6216\u5c06\u5b83\u79fb\u52a8\u3002\u628a\u5149\u6807\u653e\u5728\u4e00\u4e2a\u62d0\u89d2\u9644\u8fd1\u8fdb\u884c\u65cb\u8f6c\u3002",
clkShapeToModify:"\u70b9\u51fb\u4e00\u4e2a\u5f62\u72b6\u66f4\u6539\u8be5\u5f62\u72b6\u7684\u70b9\u3002\u628a\u5149\u6807\u653e\u5728\u4e00\u4e2a\u70b9\u4e0a\u65b9\uff0c\u6309\u201c\u5220\u9664\u201d\u952e\u8fdb\u884c\u5220\u9664\u3002",showShapeInfo:"\u663e\u793a\u5f62\u72b6\u4fe1\u606f\u6846\u3002",area:"\u9762\u79ef",length:"\u957f\u5ea6",nodes:"\u8282\u70b9",perimeter:"\u5468\u957f",location:"\u4f4d\u7f6e",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",
nextMapView:"Next map view"};ALKMaps.Lang.zh=ALKMaps.Lang["zh-CN"];ALKMaps.Layer.VirtualTile=ALKMaps.Class(ALKMaps.Layer.Vector,{cacheInterval:5,_virtualTileArray:[],wrapDateLine:!0,initialize:function(a,b){ALKMaps.Layer.Vector.prototype.initialize.apply(this,arguments);this._virtualTileArray=[]},onStartCallback:function(){},onAddedCallback:function(){},onErrorCallback:function(a){var a=a.response,b="ERROR!";null!=a.responseText&&""!==a.responseText&&(b=JSON.parse(a.responseText)[0],b="Status: "+a.status+"\nStatus Text: "+a.statusText+"\nDescription: "+b.Description);
alert(b)},_virtualTile:function(a,b,c){return{qKey:a,timeStamp:b,data:c}},expireVirtualTiles:function(){var a=6E4*this.cacheInterval,b=(new Date).getTime();if(0!==this._virtualTileArray.length)for(var c=0;c<this._virtualTileArray.length;c++)if(null!=this._virtualTileArray[c].timeStamp&&b-this._virtualTileArray[c].timeStamp>a)this._virtualTileArray[c].timeStamp=null},updateVirtualTile:function(a,b){for(var c=this._virtualTileArray.length-1;0<=c;c--)a===this._virtualTileArray[c].qkey&&this._virtualTileArray.splice(c,
1);c=(new Date).getTime();this._virtualTileArray.push(this._virtualTile(a,c,b))},getCachedVirtualTile:function(a){for(var b=0;b<this._virtualTileArray.length;b++)if(null!=this._virtualTileArray[b].timeStamp&&a===this._virtualTileArray[b].qKey)return this._virtualTileArray[b]},getExpiredVirtualTile:function(a){for(var b=0;b<this._virtualTileArray.length;b++)if(null==this._virtualTileArray[b].timeStamp&&a===this._virtualTileArray[b].qKey)return this._virtualTileArray[b]},_getVisitedQkeys:function(){for(var a=
[],b=0;b<this._virtualTileArray.length;b++)null!=this._virtualTileArray[b].timeStamp&&a.push(this._virtualTileArray[b].qKey);return a},getCachedTileQkeys:function(a){var b=this._getVisitedQkeys();return a.filter(function(a){return 0<=b.indexOf(a)})},getVirtualBounds:function(a){for(var b=[],c=this._getVisitedQkeys(),a=a.filter(function(a){return 0>c.indexOf(a)}),d=0;d<a.length;d++){var e=a[d],f=ALKMaps.Util.quadKeyToTileXYZ(e),f=ALKMaps.Util.getTileBounds(f),f=new ALKMaps.Bounds(f.left,f.bottom,f.right,
f.top);b.push({qKey:e,bounds:f})}return b},CLASS_NAME:"ALKMaps.Layer.VirtualTile"});ALKMaps.Layer.TruckRestrictions=ALKMaps.Class(ALKMaps.Layer.VirtualTile,{language:null,displayUnit:0,dataset:"Current",cacheInterval:10,minZoomLevel:16,wrapDateLine:!0,_requestCounter:0,_featuresDrawn:[],_timeoutId:null,initialize:function(a,b){b=b||{};this.language=b.language||ALKMaps.Lang.getCode();this.displayUnit=b.displayUnit||this.displayUnit;this.dataset=b.dataset||this.dataset;this.minZoomLevel=b.minZoomLevel||this.minZoomLevel;this.cacheInterval=b.cacheInterval||this.cacheInterval;var c=
new ALKMaps.Style({externalGraphic:"${graphic}",graphicWidth:"${size}",graphicHeight:"${size}"},{context:{graphic:function(a){if(a&&a.data){var b=ALKMaps.IMAGE.TRUCK_RESTR_GENERAL;if(1<a.data.length)b=ALKMaps.IMAGE.TRUCK_RESTR_MULTIPLE;else switch((a.data[0].category||"").toLowerCase()){case "dimensions":b=ALKMaps.IMAGE.TRUCK_RESTR_DIMENSION;break;case "hazmat":b=ALKMaps.IMAGE.TRUCK_RESTR_HAZMAT;break;case "general":b=ALKMaps.IMAGE.TRUCK_RESTR_GENERAL}return b}},size:function(a){var a=a.layer.map.getZoom(),
b=16;20<=a?b=26:19===a&&(b=20);return b}}}),c=new ALKMaps.StyleMap({"default":c});this.styleMap=b.styleMap?b.styleMap:c;ALKMaps.Layer.VirtualTile.prototype.initialize.apply(this,arguments);if(16>this.minZoomLevel)this.minZoomLevel=16},setMap:function(a){ALKMaps.Layer.VirtualTile.prototype.setMap.apply(this,arguments);this.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME})},_successCB:function(a,b,c){!0===b&&c.updateVirtualTile(a.requestId,a);if("function"===typeof c.onAddedCallback)c.onAddedCallback();
a=a.featureCollection;a=(new ALKMaps.Format.GeoJSON({externalProjection:new ALKMaps.Projection("EPSG:4326"),internalProjection:this.map.getProjectionObject()})).read(a);for(b=0;b<a.length;b++){var d=a[b];d.lonlat=new ALKMaps.LonLat(d.geometry.x,d.geometry.y);c._featuresDrawn.push(a[b])}},_failureCB:function(a,b){if("function"===typeof b.onErrorCallback)b.onErrorCallback({response:a})},_drawFromCachedData:function(a){for(var a=this.getCachedTileQkeys(a),b=0;b<a.length;b++){if("function"===typeof this.onStartCallback)this.onStartCallback();
++this._requestCounter;this._successCB(this.getCachedVirtualTile(a[b]).data,!1,this);--this._requestCounter}},_drawFromServiceData:function(a){for(var b=this,a=this.getVirtualBounds(a),c=0;c<a.length;c++){if("function"===typeof b.onStartCallback)b.onStartCallback();var d=a[c],e=d.bounds.toArray();++b._requestCounter;ALKMaps.Services.getTruckRestrictions({requestId:d.qKey,bbox:e,language:b.language,units:b.displayUnit,dataset:b.dataset,success:function(a){--b._requestCounter;if(0<a.featureCollection.features.length)b._successCB(a,
!0,b);else if("function"===typeof b.onAddedCallback)b.onAddedCallback()},failure:function(a){--b._requestCounter;b._failureCB(a,b)}})}},_removePopups:function(){for(var a=this.features,b=0;b<a.length;b++){var c=a[b];null!=c.clickPopup&&c.layer.map.removePopup(c.clickPopup)}},moveTo:function(a,b,c){ALKMaps.Layer.VirtualTile.prototype.moveTo.apply(this,arguments);this._requestCounter=0;this._featuresDrawn=[];null!=this._timeoutId&&window.clearTimeout(this._timeoutId);var d=this.map.getZoom();if(d<this.minZoomLevel)this._removePopups(),
this.removeAllFeatures();else{var e=this.map.getExtent();this.expireVirtualTiles();var f=this.map.getProjectionObject(),g=new ALKMaps.Projection("EPSG:4326"),e=e.transform(f,g),d=ALKMaps.Util.getQkeysFromBounds(e,d,this.minZoomLevel);this._drawFromCachedData(d);this._drawFromServiceData(d);var h=this;h._timeoutId=window.setInterval(function(){0===h._requestCounter&&(window.clearTimeout(h._timeoutId),h._removePopups(),h.removeAllFeatures(),h.addFeatures(h._featuresDrawn))},100)}},destroyFeatures:function(){null!=
this.features&&0<this.features.length&&ALKMaps.Layer.VirtualTile.prototype.destroyFeatures.apply(this,arguments)},onmouseclick:function(a){if(null!=a){for(var b=new ALKMaps.Size(180,60),c=a.cluster?a.cluster[0].lonlat:a.lonlat,d="",e=0;e<a.data.length;e++)for(var f=a.data[e],g=0;g<f.descriptions.length;g++)d=d+f.descriptions[g]+"</br>";b=new ALKMaps.Popup.SimplePopup(a.id+"_click",c,b,'<div style="font-size:12px">'+d+"</div>",null,!0);b.autoSize=!0;a.clickPopup=b;a.layer.map.addPopup(b,!0)}return!1},
CLASS_NAME:"ALKMaps.Layer.TruckRestrictions"});ALKMaps.Lang.el=ALKMaps.Util.applyDefaults({"Scale = 1 : ${scaleDenom}":"\u039a\u03bb\u03af\u03bc\u03b1\u03ba\u03b1 ~ 1 : ${scaleDenom}",panup:"\u039c\u03b5\u03c4\u03b1\u03ba\u03af\u03bd\u03b7\u03c3\u03b7 \u03c0\u03ac\u03bd\u03c9",panleft:"\u039c\u03b5\u03c4\u03b1\u03ba\u03af\u03bd\u03b7\u03c3\u03b7 \u03b1\u03c1\u03b9\u03c3\u03c4\u03b5\u03c1\u03ac",zoomworld:"\u039f \u03ba\u03cc\u03c3\u03bc\u03bf\u03c2 \u03c4\u03bf\u03c5 Zoom",panright:"\u039c\u03b5\u03c4\u03b1\u03ba\u03af\u03bd\u03b7\u03c3\u03b7 \u03b4\u03b5\u03be\u03b9\u03ac",
pandown:"\u039c\u03b5\u03c4\u03b1\u03ba\u03af\u03bd\u03b7\u03c3\u03b7 \u03ba\u03ac\u03c4\u03c9",zoomin:"\u039c\u03b5\u03b3\u03ad\u03b8\u03c5\u03bd\u03c3\u03b7",zoomout:"\u03a3\u03bc\u03af\u03ba\u03c1\u03c5\u03bd\u03c3\u03b7",dragme:"\u03a3\u03cd\u03c1\u03b5\u03c4\u03b5",dragToChangeRoute:"\u03a3\u03cd\u03c1\u03b5\u03c4\u03b5 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03b1\u03bb\u03bb\u03ac\u03be\u03b5\u03c4\u03b5 \u03b4\u03b9\u03b1\u03b4\u03c1\u03bf\u03bc\u03ae",drawPoints:"\u03a3\u03c7\u03b5\u03b4\u03b9\u03ac\u03c3\u03c4\u03b5 \u03c3\u03b7\u03bc\u03b5\u03af\u03b1",
clkToSetPoints:"\u039a\u03ac\u03bd\u03c4\u03b5 \u03ba\u03bb\u03b9\u03ba \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03bf\u03c1\u03af\u03c3\u03b5\u03c4\u03b5 \u03c3\u03b7\u03bc\u03b5\u03af\u03b1 \u03b3\u03b9\u03b1 \u03bc\u03b9\u03b1 \u03b3\u03c1\u03b1\u03bc\u03bc\u03ae. \u039a\u03ac\u03bd\u03c4\u03b5 \u03b4\u03b9\u03c0\u03bb\u03cc \u03ba\u03bb\u03b9\u03ba \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03bf\u03bb\u03bf\u03ba\u03bb\u03b7\u03c1\u03ce\u03c3\u03b5\u03c4\u03b5 \u03c4\u03b7 \u03c3\u03c7\u03b5\u03b4\u03af\u03b1\u03c3\u03b7.",
dragToDrawLine:"\u03a3\u03cd\u03c1\u03b5\u03c4\u03b5 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c3\u03c7\u03b5\u03b4\u03b9\u03ac\u03c3\u03b5\u03c4\u03b5 \u03bc\u03b9\u03b1 \u03b5\u03bb\u03b5\u03cd\u03b8\u03b5\u03c1\u03b7 \u03b3\u03c1\u03b1\u03bc\u03bc\u03ae.",dragToDrawEllipse:"\u03a3\u03cd\u03c1\u03b5\u03c4\u03b5 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c3\u03c7\u03b5\u03b4\u03b9\u03ac\u03c3\u03b5\u03c4\u03b5 \u03bc\u03b9\u03b1 \u03ad\u03bb\u03bb\u03b5\u03b9\u03c8\u03b7.",dragToDrawRect:"\u03a3\u03cd\u03c1\u03b5\u03c4\u03b5 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c3\u03c7\u03b5\u03b4\u03b9\u03ac\u03c3\u03b5\u03c4\u03b5 \u03ad\u03bd\u03b1 \u03bf\u03c1\u03b8\u03bf\u03b3\u03ce\u03bd\u03b9\u03bf.",
clkToSetPolygon:"\u039a\u03ac\u03bd\u03c4\u03b5 \u03ba\u03bb\u03b9\u03ba \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03bf\u03c1\u03af\u03c3\u03b5\u03c4\u03b5 \u03c3\u03b7\u03bc\u03b5\u03af\u03b1 \u03b3\u03b9\u03b1 \u03ad\u03bd\u03b1 \u03c0\u03bf\u03bb\u03cd\u03b3\u03c9\u03bd\u03bf. \u039a\u03ac\u03bd\u03c4\u03b5 \u03b4\u03b9\u03c0\u03bb\u03cc \u03ba\u03bb\u03b9\u03ba \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03bf\u03bb\u03bf\u03ba\u03bb\u03b7\u03c1\u03ce\u03c3\u03b5\u03c4\u03b5 \u03c4\u03b7 \u03c3\u03c7\u03b5\u03b4\u03af\u03b1\u03c3\u03b7.",
dragToDrawPolygon:"\u03a3\u03cd\u03c1\u03b5\u03c4\u03b5 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c3\u03c7\u03b5\u03b4\u03b9\u03ac\u03c3\u03b5\u03c4\u03b5 \u03ad\u03bd\u03b1 \u03c0\u03bf\u03bb\u03cd\u03b3\u03c9\u03bd\u03bf \u03b5\u03bb\u03b5\u03cd\u03b8\u03b5\u03c1\u03b7\u03c2 \u03c3\u03c7\u03b5\u03b4\u03af\u03b1\u03c3\u03b7\u03c2.",clkShapeToResize:"\u039a\u03ac\u03bd\u03c4\u03b5 \u03ba\u03bb\u03b9\u03ba \u03c3\u03b5 \u03ad\u03bd\u03b1 \u03c3\u03c7\u03ae\u03bc\u03b1 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03b1\u03bb\u03bb\u03ac\u03be\u03b5\u03c4\u03b5 \u03c4\u03bf \u03bc\u03ad\u03b3\u03b5\u03b8\u03cc\u03c2 \u03c4\u03bf\u03c5 \u03ae \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c4\u03bf \u03bc\u03b5\u03c4\u03b1\u03ba\u03b9\u03bd\u03ae\u03c3\u03b5\u03c4\u03b5. \u03a4\u03bf\u03c0\u03bf\u03b8\u03b5\u03c4\u03ae\u03c3\u03c4\u03b5 \u03c4\u03bf\u03bd \u03b4\u03c1\u03bf\u03bc\u03ad\u03b1 \u03ba\u03bf\u03bd\u03c4\u03ac \u03c3\u03b5 \u03bc\u03af\u03b1 \u03b3\u03c9\u03bd\u03af\u03b1 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c0\u03b5\u03c1\u03b9\u03c3\u03c4\u03c1\u03ad\u03c8\u03b5\u03c4\u03b5 \u03c4\u03bf \u03c3\u03c7\u03ae\u03bc\u03b1.",
clkShapeToModify:"\u039a\u03ac\u03bd\u03c4\u03b5 \u03ba\u03bb\u03b9\u03ba \u03c3\u03b5 \u03ad\u03bd\u03b1 \u03c3\u03c7\u03ae\u03bc\u03b1 \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03c4\u03c1\u03bf\u03c0\u03bf\u03c0\u03bf\u03b9\u03ae\u03c3\u03b5\u03c4\u03b5 \u03c4\u03b1 \u03c3\u03b7\u03bc\u03b5\u03af\u03b1 \u03c4\u03bf\u03c5 \u03c3\u03c7\u03ae\u03bc\u03b1\u03c4\u03bf\u03c2.  \u0388\u03c7\u03bf\u03bd\u03c4\u03b1\u03c2 \u03c4\u03bf\u03bd \u03b4\u03c1\u03bf\u03bc\u03ad\u03b1 \u03c3\u03b5 \u03ad\u03bd\u03b1 \u03c3\u03b7\u03bc\u03b5\u03af\u03bf, \u03c0\u03b1\u03c4\u03ae\u03c3\u03c4\u03b5 \u03c4\u03bf \u03c0\u03bb\u03ae\u03ba\u03c4\u03c1\u03bf Delete \u03b3\u03b9\u03b1 \u03bd\u03b1 \u03ba\u03b1\u03c4\u03b1\u03c1\u03b3\u03ae\u03c3\u03b5\u03c4\u03b5 \u03b1\u03c5\u03c4\u03cc \u03c4\u03bf \u03c3\u03b7\u03bc\u03b5\u03af\u03bf.",
showShapeInfo:"\u0395\u03bc\u03c6\u03ac\u03bd\u03b9\u03c3\u03b7 \u03c4\u03bf\u03c5 \u03c0\u03bb\u03b1\u03b9\u03c3\u03af\u03bf\u03c5 \u03c0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03b9\u03ce\u03bd \u03c3\u03c7\u03ae\u03bc\u03b1\u03c4\u03bf\u03c2.",area:"\u03a0\u03b5\u03c1\u03b9\u03bf\u03c7\u03ae",length:"\u039c\u03ae\u03ba\u03bf\u03c2",nodes:"\u039a\u03cc\u03bc\u03b2\u03bf\u03b9",perimeter:"\u03a0\u03b5\u03c1\u03af\u03bc\u03b5\u03c4\u03c1\u03bf\u03c2",location:"\u0398\u03ad\u03c3\u03b7",dragPan:"Drag the map to pan",
boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Layer.WMS=ALKMaps.Class(ALKMaps.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(a,b,c,d){var e=[],c=ALKMaps.Util.upperCaseObject(c);if(1.3<=parseFloat(c.VERSION)&&!c.EXCEPTIONS)c.EXCEPTIONS="INIMAGE";e.push(a,b,c,d);ALKMaps.Layer.Grid.prototype.initialize.apply(this,e);ALKMaps.Util.applyDefaults(this.params,ALKMaps.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&
this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()){if(null==d||!d.isBaseLayer)this.isBaseLayer=!1;if("image/jpeg"==this.params.FORMAT)this.params.FORMAT=ALKMaps.Util.alphaHack()?"image/gif":"image/png"}},clone:function(a){null==a&&(a=new ALKMaps.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){var a=this.projection.getCode();return 1.3<=parseFloat(this.params.VERSION)&&
!(!this.yx[a]&&!ALKMaps.Projection.defaults[a].yx)},getURL:function(a){var a=this.adjustBounds(a),b=this.getImageSize(),c={},d=this.reverseAxisOrder();c.BBOX=this.encodeBBOX?a.toBBOX(null,d):a.toArray(d);c.WIDTH=b.w;c.HEIGHT=b.h;return this.getFullRequestString(c)},mergeNewParams:function(a){a=[ALKMaps.Util.upperCaseObject(a)];return ALKMaps.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,b){var c=this.map.getProjectionObject(),c=this.projection&&this.projection.equals(c)?
this.projection.getCode():c.getCode(),c="none"==c?null:c;1.3<=parseFloat(this.params.VERSION)?this.params.CRS=c:this.params.SRS=c;if("boolean"==typeof this.params.TRANSPARENT)a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE";return ALKMaps.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"ALKMaps.Layer.WMS"});ALKMaps.Layer.VLDXF=ALKMaps.Class(ALKMaps.Layer.WMS,{isBaseLayer:!1,singleTile:!1,getURL:function(a){var a=this.adjustBounds(a),b=null;"EPSG:900913"===this.map.getProjectionObject().projCode&&(b=this.getTileXYZ(a));a={};if(null!==b)a.ZOOM=b.z,a.XTILE=b.x,a.YTILE=b.y;b=this.getImageSize();a.WIDTH=b.w;a.HEIGHT=b.h;return this.getFullRequestString(a)},getTileXYZ:function(a){var b=this.getServerZoom(),c=this.getServerResolution(),d=Math.round((a.left-this.maxExtent.left)/(c*this.tileSize.w)),a=Math.round((this.maxExtent.top-
a.top)/(c*this.tileSize.h));this.wrapDateLine&&(c=Math.pow(2,b),d=(d%c+c)%c);return{x:d,y:a,z:b}},CLASS_NAME:"ALKMaps.Layer.VLDXF"});ALKMaps.Control.MiniPanZoom=ALKMaps.Class(ALKMaps.Control.PanZoom,{initialize:function(a){ALKMaps.Control.PanZoom.prototype.initialize.apply(this,[a])},draw:function(){ALKMaps.Control.PanZoom.prototype.draw.apply(this,arguments);var a=this.position,b=new ALKMaps.Size(18,18),a=new ALKMaps.Pixel(a.x+b.w/2,a.y);void 0!==this.buttons&&6<this.buttons.length&&(this._removeButton(this.buttons[6]),this._removeButton(this.buttons[5]),this._removeButton(this.buttons[4]),this._addButton("zoomin","zoombar-plus-mini.png",
a.add(0,2*b.h+5),b,ALKMaps.i18n("zoomin")),this._addButton("zoomout","zoombar-minus-mini.png",a.add(0,3*b.h+5),b,ALKMaps.i18n("zoomout")));return this.div},CLASS_NAME:"ALKMaps.Control.MiniPanZoom"});ALKMaps.Control.NavPanel=ALKMaps.Class(ALKMaps.Control.Panel,{addSelectButton:!1,initialize:function(a){ALKMaps.Control.Panel.prototype.initialize.apply(this,[a])},draw:function(){var a=ALKMaps.Control.Panel.prototype.draw.apply(this,arguments),b=new ALKMaps.Control.NavigationHistory;this.map.addControls([b]);this.addControls([new ALKMaps.Control.Navigation,new ALKMaps.Control.ZoomBox,b.previous,b.next]);!0===this.addSelectButton&&this.addControls([new ALKMaps.Control.Button({displayClass:"alkSelectButtontoggle",
type:ALKMaps.Control.TYPE_TOOL})]);if(null===this.defaultControl)this.defaultControl=this.controls[0];if(null!=this.showEditPanel){var c;"ALKMaps.Layer.Vector"===this.showEditPanel.CLASS_NAME?(b=this.showEditPanel,c=new ALKMaps.Control.EditPanel(b,{autoActivate:!1})):(b=this.showEditPanel.layer,c=new ALKMaps.Control.EditPanel(b,{autoActivate:!1,controlIndex:this.showEditPanel.controls}));this.map.addControl(c);this.addControls([new ALKMaps.Control.Button({displayClass:"alkEditPaneltoggle",eventListeners:{activate:function(){c.activate()},
deactivate:function(){c.deactivate()}},type:ALKMaps.Control.TYPE_TOGGLE})])}a.className="olControlALKPanel "+a.className;return a},CLASS_NAME:"ALKMaps.Control.NavPanel"});ALKMaps.Lang["pt-BR"]=ALKMaps.Util.applyDefaults({unhandledRequest:"A requisi\u00e7\u00e3o retornou um erro n\u00e3o tratado: ${statusText}",Permalink:"Link para essa p\u00e1gina",Overlays:"Camadas de Sobreposi\u00e7\u00e3o","Base Layer":"Camada Base",readNotImplemented:"Leitura n\u00e3o implementada.",writeNotImplemented:"Escrita n\u00e3o implementada.",noFID:"N\u00e3o \u00e9 poss\u00edvel atualizar uma fei\u00e7\u00e3o que n\u00e3o tenha um FID.",errorLoadingGML:"Erro ao carregar o arquivo GML ${url}",
browserNotSupported:"Seu navegador n\u00e3o suporta renderiza\u00e7\u00e3o de vetores. Os renderizadores suportados atualmente s\u00e3o:\n${renderers}",componentShouldBe:"addFeatures: o componente deve ser do tipo ${geomType}",getFeatureError:"getFeatureFromEvent foi executado mas nenhum renderizador foi encontrado. Isso pode indicar que voc\u00ea destruiu uma camana, mas n\u00e3o o handler associado a ela.",minZoomLevelError:"A propriedade minZoomLevel \u00e9 de uso restrito das camadas descendentes de FixedZoomLevels. A verifica\u00e7\u00e3o dessa propriedade pelas camadas wfs \u00e9 um res\u00edduo do passado. N\u00e3o podemos, entretanto n\u00e3o \u00e9 poss\u00edvel remov\u00ea-la sem poss\u00edvelmente quebrar o funcionamento de aplica\u00e7\u00f5es OL que possuem dep\u00eancia com ela. Portanto estamos tornando seu uso obsoleto -- a verifica\u00e7\u00e3o desse atributo ser\u00e1 removida na vers\u00e3o 3.0. Ao inv\u00e9s, use as op\u00e7\u00f5es de resolu\u00e7\u00e3o min/max como descrito em: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"Transa\u00e7\u00e3o WFS : SUCESSO ${response}",commitFailed:"Transa\u00e7\u00e3o WFS : ERRO ${response}",googleWarning:"N\u00e3o foi poss\u00edvel carregar a camada Google corretamente.<br><br>Para se livrar dessa mensagem, selecione uma nova Camada Base, na ferramenta de alterna\u00e7\u00e3o de camadas localiza\u00e7\u00e3o do canto superior direito.<br><br>Muito provavelmente, isso foi causado porque o script da biblioteca do Google Maps n\u00e3o foi inclu\u00eddo, ou porque ele n\u00e3o cont\u00e9m a chave correta da API para o seu site.<br><br>Desenvolvedores: Para obter ajuda em solucionar esse problema <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>cliquem aqui</a>",
getLayerWarning:"N\u00e3o foi poss\u00edvel carregar a camada ${layerType} corretamente.<br><br>Para se livrar dessa mensagem, selecione uma nova Camada Base, na ferramenta de alterna\u00e7\u00e3o de camadas localiza\u00e7\u00e3o do canto superior direito.<br><br>Muito provavelmente, isso foi causado porque o script da biblioteca ${layerLib} n\u00e3o foi inclu\u00eddo corretamente.<br><br>Desenvolvedores: Para obter ajuda em solucionar esse problema <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>cliquem aqui</a>",
"Scale = 1 : ${scaleDenom}":"Escala = 1 : ${scaleDenom}",W:"O",E:"L",N:"N",S:"S",layerAlreadyAdded:"Voc\u00ea tentou adicionar a camada: ${layerName} ao mapa, mas ela j\u00e1 foi adicionada",reprojectDeprecated:"Voc\u00ea est\u00e1 usando a op\u00e7\u00e3o 'reproject' na camada ${layerName}. Essa op\u00e7\u00e3o est\u00e1 obsoleta: seu uso foi projetado para suportar a visualiza\u00e7\u00e3o de dados sobre bases de mapas comerciais, entretanto essa funcionalidade deve agora ser alcan\u00e7ada usando o suporte \u00e0 proje\u00e7\u00e3o Mercator. Mais informa\u00e7\u00e3o est\u00e1 dispon\u00edvel em: http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"Esse m\u00e9todo est\u00e1 obsoleto e ser\u00e1 removido na vers\u00e3o 3.0. Ao inv\u00e9s, por favor use ${newMethod}.",boundsAddError:"Voc\u00ea deve informar ambos os valores x e y para a fun\u00e7\u00e3o add.",lonlatAddError:"Voc\u00ea deve informar ambos os valores lon e lat para a fun\u00e7\u00e3o add.",pixelAddError:"Voc\u00ea deve informar ambos os valores x e y para a fun\u00e7\u00e3o add.",unsupportedGeometryType:"Tipo geom\u00e9trico n\u00e3o suportado: ${geomType}.",
filterEvaluateNotImplemented:"evaluete n\u00e3o est\u00e1 implementado para este tipo de filtro.",panup:"Mover Panorama Acima",panleft:"Mover panorama \u00e0 esquerda",zoomworld:"Ampliar Mundo",panright:"Mover panorama \u00e0 direita",pandown:"Mover Panorama Abaixo",zoomin:"Aproximar",zoomout:"Afastar",dragme:"Arrastar-me",dragToChangeRoute:"Arraste para alterar a rota",drawPoints:"Desenhar pontos.",clkToSetPoints:"Clique para definir pontos para uma linha. D\u00ea um clique duplo para concluir.",
dragToDrawLine:"Arraste para desenhar uma linha \u00e0 m\u00e3o livre.",dragToDrawEllipse:"Arraste para desenhar uma elipse.",dragToDrawRect:"Arraste para desenhar um ret\u00e2ngulo.",clkToSetPolygon:"Clique para definir os pontos de um pol\u00edgono. D\u00ea um clique duplo para concluir.",dragToDrawPolygon:"Arraste para desenhar um pol\u00edgono \u00e0 m\u00e3o livre.",clkShapeToResize:"Clique em uma forma para redimensionar ou mover. Posicione o cursor pr\u00f3ximo a um v\u00e9rtice para girar.",
clkShapeToModify:"Clique em uma forma para alterar os pontos que a definem. Com o cursor sobre um ponto, pressione a tecla Delete para remov\u00ea-lo.",showShapeInfo:"Exibir a caixa de informa\u00e7\u00e3o da forma.",area:"\u00c1rea",length:"Comprimento",nodes:"N\u00f3s",perimeter:"Per\u00edmetro",location:"Localiza\u00e7\u00e3o",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Lang.pt=ALKMaps.Lang["pt-BR"];ALKMaps.Control.NavToolbar=ALKMaps.Class(ALKMaps.Control.Panel,{initialize:function(a){ALKMaps.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new ALKMaps.Control.Navigation,new ALKMaps.Control.ZoomBox])},draw:function(){var a=ALKMaps.Control.Panel.prototype.draw.apply(this,arguments);if(null===this.defaultControl)this.defaultControl=this.controls[0];return a},CLASS_NAME:"ALKMaps.Control.NavToolbar"});ALKMaps.Handler.Hover=ALKMaps.Class(ALKMaps.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(a){if(this.passesTolerance(a.xy))this.clearTimer(),this.callback("move",[a]),this.px=a.xy,a=ALKMaps.Util.extend({},a),this.timerId=window.setTimeout(ALKMaps.Function.bind(this.delayedCall,this,a),this.delay);return!this.stopMove},mouseout:function(a){ALKMaps.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[a]));return!0},passesTolerance:function(a){var b=
!0;this.pixelTolerance&&this.px&&Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2))<this.pixelTolerance&&(b=!1);return b},clearTimer:function(){if(null!=this.timerId)window.clearTimeout(this.timerId),this.timerId=null},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=!1;ALKMaps.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),a=!0);return a},CLASS_NAME:"ALKMaps.Handler.Hover"});ALKMaps.Layer.Image=ALKMaps.Class(ALKMaps.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b;this.maxExtent=this.extent=c;this.size=d;ALKMaps.Layer.prototype.initialize.apply(this,[a,e]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile)this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null;ALKMaps.Layer.prototype.destroy.apply(this,
arguments)},clone:function(a){null==a&&(a=new ALKMaps.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions()));return a=ALKMaps.Layer.prototype.clone.apply(this,[a])},setMap:function(a){if(null==this.options.maxResolution)this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w;ALKMaps.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){ALKMaps.Layer.prototype.moveTo.apply(this,arguments);var d=null==this.tile;if(b||d){this.setTileSize();var e=
this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});d?(this.tile=new ALKMaps.Tile.Image(this,e,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=e.clone());this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new ALKMaps.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart=function(){this.events.triggerEvent("loadstart")};
a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"ALKMaps.Layer.Image"});ALKMaps.Lang.tr={panup:"Yukar\u0131ya Kayd\u0131r",panleft:"A\u015fa\u011f\u0131ya Kayd\u0131r",zoomworld:"D\u00fcnyay\u0131 b\u00fcy\u00fct",panright:"Sa\u011fa Kayd\u0131r",pandown:"Sola Kayd\u0131r",zoomin:"Yakla\u015ft\u0131r",zoomout:"Uzakla\u015ft\u0131r",dragme:"Beni s\u00fcr\u00fckle",dragToChangeRoute:"Rotay\u0131 de\u011fi\u015ftirmek i\u00e7in s\u00fcr\u00fckle",drawPoints:"Noktalar \u00e7iz",clkToSetPoints:"Bir \u00e7izgi \u00fczerindeki noktalar\u0131 belirlemek i\u00e7in t\u0131kla. Bitirmek i\u00e7in \u00e7ift t\u0131kla.",
dragToDrawLine:"Serbest \u00e7izgi \u00e7izmek i\u00e7in s\u00fcr\u00fckle.",dragToDrawEllipse:"Bir elips \u00e7izmek i\u00e7in s\u00fcr\u00fckle.",dragToDrawRect:"Bir dikd\u00f6rtgen \u00e7izmek i\u00e7in s\u00fcr\u00fckle.",clkToSetPolygon:"Bir poligon \u00fczerindeki noktalar\u0131 belirlemek i\u00e7in t\u0131kla. Bitirmek i\u00e7in \u00e7ift t\u0131kla.",dragToDrawPolygon:"Serbest poligon \u00e7izmek i\u00e7in s\u00fcr\u00fckle.",clkShapeToResize:"Yeniden boyutland\u0131rmak veya hareket ettirmek i\u00e7in t\u0131kla. D\u00f6nd\u00fcrmek i\u00e7in imleci bir k\u00f6\u015fe yak\u0131n\u0131na getir.",
clkShapeToModify:"\u015eekil noktalar\u0131n\u0131 de\u011fi\u015ftirmek i\u00e7in bir \u015fekle t\u0131kla. Silmek i\u00e7in imle\u00e7 bir nokta \u00fczerindeyken Sil d\u00fc\u011fmesine t\u0131kla.",showShapeInfo:"\u015eekil bilgisi kutusunu g\u00f6ster.",area:"Alan",length:"Uzunluk",nodes:"Devreler",perimeter:"\u00c7evre",location:"Konum",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Layer.RailRouting=ALKMaps.Class(ALKMaps.Layer.Routing,{initialize:function(a,b){ALKMaps.Layer.Routing.prototype.initialize.apply(this,arguments);this.isDraggable=!1},addRoute:function(a){if(void 0===this.routeHandleLookup||null===this.routeHandleLookup)this.routeHandleLookup=[];if(null==this.routeArrowLookup)this.routeArrowLookup=[];if(null===a.functionOptions||null===a.functionOptions.routeId)throw"Route cannot be added. Unique route id is required.";this.getRouteLegPoints(a,!0,!1)},removeRoute:function(a){ALKMaps.Layer.Routing.prototype.removeRoute.apply(this,
arguments)},updateRoute:function(a){ALKMaps.Layer.Routing.prototype.updateRoute.apply(this,arguments)},setRouteHandleVisibility:function(a,b){ALKMaps.Layer.Routing.prototype.setRouteHandleVisibility.apply(this,arguments)},setRouteVisibility:function(a,b){ALKMaps.Layer.Routing.prototype.setRouteVisibility.apply(this,arguments)},setDraggable:function(){},CLASS_NAME:"ALKMaps.Layer.RailRouting"});ALKMaps.Control.ArgParser=ALKMaps.Class(ALKMaps.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(a){var a=a||window.location.href,b=ALKMaps.Util.getParameters(a),c=a.indexOf("#");0<c&&(a="?"+a.substring(c+1,a.length),ALKMaps.Util.extend(b,ALKMaps.Util.getParameters(a)));return b},setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d!=this&&"ALKMaps.Control.ArgParser"==
d.CLASS_NAME){if(d.displayProjection!=this.displayProjection)this.displayProjection=d.displayProjection;break}}if(b==this.map.controls.length){b=this.getParameters();if(b.layers)this.layers=b.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers();if(b.lat&&b.lon){this.center=new ALKMaps.LonLat(parseFloat(b.lon),parseFloat(b.lat));if(b.zoom)this.zoom=parseFloat(b.zoom);this.map.events.register("changebaselayer",this,this.setCenter);this.setCenter()}}},setCenter:function(){this.map.baseLayer&&
(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0,b=this.layers.length;a<b;a++){var c=this.map.layers[a],d=this.layers.charAt(a);"B"==d?this.map.setBaseLayer(c):("T"==d||"F"==d)&&c.setVisibility("T"==
d)}}},CLASS_NAME:"ALKMaps.Control.ArgParser"});ALKMaps.Layer.VLWMS=ALKMaps.Class(ALKMaps.Layer.WMS,{isBaseLayer:!1,singleTile:!1,getURL:function(a){var b=this.map.getProjectionObject(),c=a.clone();"EPSG:4326"!==b.projCode&&(c=a.transform(b,new ALKMaps.Projection("EPSG:4326")));return ALKMaps.Layer.WMS.prototype.getURL.apply(this,[c])},CLASS_NAME:"ALKMaps.Layer.VLWMS"});ALKMaps.Control.WeatherAlertLegend=ALKMaps.Class(ALKMaps.Control,{header:null,body:null,bodyEvents:null,layerId:null,visible:!0,destroy:function(){this.outsideViewport||(this.bodyEvents.un({mousedown:this.eventsHandler}),this.bodyEvents.destroy());ALKMaps.Control.prototype.destroy.apply(this,arguments)},draw:function(){ALKMaps.Control.prototype.draw.apply(this);if(!this.header){this.header=document.createElement("div");this.header.className=this.displayClass+"-header";this.div.appendChild(this.header);
var a=document.createElement("h3");a.className="title";a.innerHTML="NWS Alerts";this.header.appendChild(a)}if(!this.body)this.body=document.createElement("div"),this.body.className=this.displayClass+"-body",this.div.appendChild(this.body),this.drawItems({});if(!this.outsideViewport)this.bodyEvents=new ALKMaps.Events(this,this.body),this.bodyEvents.on({mousedown:this.eventsHandler});this.changeVisibility(!0);return this.div},redrawWithoutGetNewOnes:function(){var a=this.map.getLayer(this.layerId);
a.featuresRemoved&&a.addFeatures(a.featuresRemoved);a.featuresRemoved=[];this.redraw()},redraw:function(){var a=this.map.getLayer(this.layerId);if(null!=a&&null!=a.weatherAlertEvents){for(var b=ALKMaps.Util.extend({},ALKMaps.WeatherAlertColor),c={},d=0;d<a.features.length;d++){var e=a.features[d];if(e.onScreen())e=e.attributes.weatherAlertEvent.AlertEvent,b.hasOwnProperty(e)&&(c[e]=b[e])}if(a.inputElems)for(b=0;b<a.inputElems.length;b++)d=a.inputElems[b],ALKMaps.Event.stopObserving(d,"click",ALKMaps.Function.bindAsEventListener(this.showCheckedFeatures,
d));for(;this.body.hasChildNodes();)this.body.removeChild(this.body.lastChild);this.drawItems(c)}},drawItems:function(a){var b=0,c=this.map.getLayer(this.layerId);c.featuresRemoved=[];c.inputElems=[];for(var d in a)if(ALKMaps.WeatherAlertColor.hasOwnProperty(d)){b++;var e=ALKMaps.Util.hexToRgb(ALKMaps.WeatherAlertColor[d]),f=document.createElement("div");f.style.borderColor=ALKMaps.WeatherAlertColor[d];try{f.style.backgroundColor="rgba("+e.r+","+e.g+","+e.b+",0.2)"}catch(g){f.style.backgroundColor=
"rgb("+e.r+","+e.g+","+e.b+")"}e=document.createElement("input");e.id=ALKMaps.Util.createUniqueID("checkbox");e.name=d;e.type="checkbox";e.value=d;e.checked=!0;e.layer=c;var h=document.createElement("label");h["for"]=e.id;f.appendChild(e);f.appendChild(h);h.innerHTML=d;this.body.appendChild(f);c.inputElems.push(e);ALKMaps.Event.observe(e,"click",ALKMaps.Function.bindAsEventListener(this.showCheckedFeatures,e))}if(0===b)a=document.createElement("div"),a.innerHTML="No alert event to show",this.body.appendChild(a)},
showCheckedFeatures:function(){var a=this.layer,b=[];if(!1===this.checked){for(var c=0;c<a.features.length;c++){var d=a.features[c];d.attributes.weatherAlertEvent.AlertEvent===this.value&&d.onScreen()&&(d.popup&&d.destroyPopup(),a.featuresRemoved.push(d.clone()),b.push(d))}a.removeFeatures(b)}else{for(c=a.featuresRemoved.length-1;0<=c;c--)d=a.featuresRemoved[c],d.attributes.weatherAlertEvent.AlertEvent===this.value&&(b.push(d),a.featuresRemoved.splice(c,1));a.addFeatures(b)}},eventsHandler:function(a){ALKMaps.Event.stop(a)},
changeVisibility:function(a){this.div.style.visibility="hidden";if(!0===this.visible&&!0===a)this.div.style.visibility=""},CLASS_NAME:"ALKMaps.Control.WeatherAlertLegend"});ALKMaps.Layer.WeatherAlerts=ALKMaps.Class(ALKMaps.Layer.Vector,{legendDisplayClass:null,optionDisplayClass:null,externalDivForLegend:null,externalDivForOption:null,alertFilters:null,legendControl:null,optionControl:null,weatherAlertEvents:null,refreshInterval:null,lastUpdated:null,bbox:null,initialize:function(a,b){var c=new ALKMaps.StyleMap({"default":new ALKMaps.Style({fillColor:"${fill}",strokeColor:"${stroke}",strokeWidth:0,fillOpacity:0.2,strokeOpacity:0.2},{context:{fill:function(a){return ALKMaps.WeatherAlertColor[a.attributes.weatherAlertEvent.AlertEvent]},
stroke:function(a){return ALKMaps.WeatherAlertColor[a.attributes.weatherAlertEvent.AlertEvent]}}}),select:new ALKMaps.Style({fillColor:"${fill}",strokeColor:"${stroke}",strokeWidth:0,fillOpacity:0.8,strokeOpacity:0.8},{context:{fill:function(a){return ALKMaps.WeatherAlertColor[a.attributes.weatherAlertEvent.AlertEvent]},stroke:function(a){return ALKMaps.WeatherAlertColor[a.attributes.weatherAlertEvent.AlertEvent]}}})}),b=b||{};b.styleMap=b.styleMap||c;b.strategies=null!=b.strategies?b.strategies:
[new ALKMaps.Strategy.WeatherAlerts({onErrorCallback:b.onErrorCallback,onSuccessCallback:b.onSuccessCallback})];b.protocol=null!=b.protocol?b.protocol:new ALKMaps.Protocol.WeatherAlerts({format:new ALKMaps.Format.WKT});b.alertFilters=null!=b.alertFilters?b.alertFilters:{severity:"All",urgency:"All",certainty:"All",eventNames:null,startTime:null,endTime:null};ALKMaps.Layer.Vector.prototype.initialize.apply(this,[a,b]);this.refreshInterval=6E4*(this.refreshInterval||0.1);this.bbox=b.bbox||this.bbox;
c=!1===b.optionControlVisible?!1:!0;this.optionControl=new ALKMaps.Control.WeatherAlertOption({div:this.externalDivForOption,visible:c});if(null!=this.optionDisplayClass)this.optionControl=new ALKMaps.Control.WeatherAlertOption({displayClass:this.optionDisplayClass,div:this.externalDivForOption,visible:c});this.optionControl.layerId=this.id;c=!1===b.legendControlVisible?!1:!0;this.legendControl=new ALKMaps.Control.WeatherAlertLegend({div:this.externalDivForLegend,visible:c});if(null!=this.legendDisplayClass)this.legendControl=
new ALKMaps.Control.WeatherAlertLegend({displayClass:this.legendDisplayClass,div:this.externalDivForLegend,visible:c});this.legendControl.layerId=this.id;this.events.on({featureunselected:this.featureunselected,scope:this})},destroy:function(){this.events.un({featureunselected:this.featureunselected,scope:this});this.events.destroy()},setVisibility:function(a){this.optionControl.changeVisibility(a);this.legendControl.changeVisibility(a);return ALKMaps.Layer.Vector.prototype.setVisibility.apply(this,
arguments)},featureunselected:function(a){if(null!=a.feature&&null!=a.feature.popup)a.feature.layer.map.removePopup(a.feature.popup),a.feature.popup.destroy(),a.feature.popup=null},setMap:function(a){a.addControl(this.optionControl);a.addControl(this.legendControl);this.optionControl.changeVisibility(this.visibility);this.legendControl.changeVisibility(this.visibility);ALKMaps.Layer.Vector.prototype.setMap.apply(this,arguments)},selectAlertFeatures:function(a,b,c){var d=a.attributes.weatherAlertEvent.ID;
b.unselectAll();var e=b.multiple;b.multiple=!0;for(var f=0;f<this.features.length;f++){var g=this.features[f];g.attributes.weatherAlertEvent.ID===d&&g.getVisibility()&&-1===ALKMaps.Util.indexOf(this.selectedFeatures,g)&&b.select(g)}if(!1!==c){c=null;for(f=0;f<this.weatherAlertEvents.length;f++)this.weatherAlertEvents[f].ID===d&&(c=this.weatherAlertEvents[f]);if(null!=c)d=a.geometry.bounds.getCenterLonLat(),f=new ALKMaps.Size(270,200),g={size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(0,0)},d=
new ALKMaps.Popup.FramedCloud(this.id+"_popup",d,f,'<div style="font-size:11px"><p><strong>title: </strong><a href="'+c.ID+'" target="_blank">'+c.Title+"</a></p><p><strong>summary: </strong>"+c.Summary+"</p><p><strong>event: </strong>"+c.AlertEvent+"</p><p><strong>effective: </strong>"+c.DispEffective+"</p><p><strong>expires: </strong>"+c.DispExpires+"</p><p><strong>urgency: </strong>"+c.Urgency+"</p><p><strong>severity: </strong>"+c.Severity+"</p><p><strong>certainty: </strong>"+c.Certainty+"</p></div>",
g,!0,function(a){this.hide();ALKMaps.Event.stop(a);b.unselectAll()}),d.contentDiv.style.overflow="auto",d.panMapIfOutOfView=!1,d.keepInMap=!0,d.autoSize=!1,a.popup=d,a.layer.map.addPopup(d,!0),d.show()}b.multiple=e},getNewAlerts:function(){var a=!0;null!=this.lastUpdated&&(new Date).getTime()-this.lastUpdated.getTime()<this.refreshInterval&&(a=!1);if(null==this.features||0===this.features.length)a=!0;return a},CLASS_NAME:"ALKMaps.Layer.WeatherAlerts"});ALKMaps.Layer.TrafficIncidents=ALKMaps.Class(ALKMaps.Layer.VirtualTile,{language:null,cacheInterval:10,threshold:5,distance:30,cluster:!0,minZoomLevel:6,wrapDateLine:!0,_requestCounter:0,_featuresDrawn:[],_timeoutId:null,initialize:function(a,b){b=b||{};this.language=b.language||ALKMaps.Lang.getCode();this.distance=b.distance||this.distance;this.threshold=b.threshold||this.threshold;this.onStartCallback=b.onStartCallback||this.onStartCallback;this.onAddedCallback=b.onAddedCallback||this.onAddedCallback;
this.onErrorCallback=b.onErrorCallback||this.onErrorCallback;this.minZoomLevel=b.minZoomLevel||this.minZoomLevel;this.cacheInterval=b.cacheInterval||this.cacheInterval;this.cluster=b.cluster||this.cluster;this.clusterStrategy=new ALKMaps.Strategy.Cluster({distance:this.distance,threshold:this.threshold,autoActivate:!1});var c=new ALKMaps.Style({graphicTitle:"${title}",externalGraphic:"${graphic}",graphicWidth:"${size}",graphicHeight:"${size}"},{context:{title:function(a){return a.cluster?a.cluster.length+
" Locations":a.attributes[0].abbreviation.description||a.attributes[0].abbreviation.shortDesc},graphic:function(a){if(a.cluster)return ALKMaps.IMAGE.GROUP;switch((a.attributes[0].trafficItemTypeDesc||"").toUpperCase()){case "TRAFFIC":case "CONGESTION":a=ALKMaps.IMAGE.TRAFFIC_MAP_TRAFFICJAM;break;case "ACCIDENT":case "DISABLEDVEHICLE":a=ALKMaps.IMAGE.TRAFFIC_MAP_ACCIDENT;break;case "WEATHER":a=ALKMaps.IMAGE.TRAFFIC_MAP_WEATHER;break;case "ROADWORKS":case "CONSTRUCTION":case "ROADCLOSURE":a=ALKMaps.IMAGE.TRAFFIC_MAP_CONSTRUCTION;
break;default:a=ALKMaps.IMAGE.TRAFFIC_MAP_INCIDENT}return a},size:function(a){var b=a.layer.map.getZoom();return a.cluster?(a=a.cluster.length,50>=a?2*b:500>=a?4*b:2E3>=a?6*b:8*b):2*b}}}),c=new ALKMaps.StyleMap({"default":c});this.strategies=b.strategies?b.strategies:[this.clusterStrategy];this.styleMap=b.styleMap?b.styleMap:c;ALKMaps.Layer.VirtualTile.prototype.initialize.apply(this,arguments);if(6>this.minZoomLevel)this.minZoomLevel=6},setMap:function(a){ALKMaps.Layer.VirtualTile.prototype.setMap.apply(this,
arguments);this.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME});null!=this.clusterStrategy&&!0===this.cluster&&this.clusterStrategy.activate()},_successCB:function(a,b,c){!0===b&&c.updateVirtualTile(a.requestId,a);if("function"===typeof c.onAddedCallback)c.onAddedCallback();a=a.trafficIncidentFeatureCollection;a=(new ALKMaps.Format.GeoJSON({externalProjection:new ALKMaps.Projection("EPSG:4326"),internalProjection:this.map.getProjectionObject()})).read(a);for(b=0;b<a.length;b++){var d=
a[b];d.lonlat=new ALKMaps.LonLat(d.geometry.x,d.geometry.y);c._featuresDrawn.push(a[b])}},_failureCB:function(a,b){if("function"===typeof b.onErrorCallback)b.onErrorCallback({response:a})},_drawFromCachedData:function(a){for(var a=this.getCachedTileQkeys(a),b=0;b<a.length;b++){if("function"===typeof this.onStartCallback)this.onStartCallback();++this._requestCounter;this._successCB(this.getCachedVirtualTile(a[b]).data,!1,this);--this._requestCounter}},_drawFromServiceData:function(a){for(var b=this,
a=this.getVirtualBounds(a),c=0;c<a.length;c++){if("function"===typeof b.onStartCallback)b.onStartCallback();var d=a[c],e=d.bounds.toArray();++b._requestCounter;ALKMaps.Services.getTrafficIncidentsBBox({requestId:d.qKey,bbox:e,language:b.language,success:function(a){--b._requestCounter;if(0<a.trafficIncidentFeatureCollection.features.length)b._successCB(a,!0,b);else if("function"===typeof b.onAddedCallback)b.onAddedCallback()},failure:function(a){--b._requestCounter;b._failureCB(a,b)}})}},moveTo:function(a,
b,c){ALKMaps.Layer.VirtualTile.prototype.moveTo.apply(this,arguments);this._requestCounter=0;this._featuresDrawn=[];null!=this._timeoutId&&window.clearTimeout(this._timeoutId);var d=this.map.getZoom();if(d<this.minZoomLevel)this.removeAllFeatures(),this.clusterStrategy.clearCache();else{var e=this.map.getExtent();this.expireVirtualTiles();var f=this.map.getProjectionObject(),g=new ALKMaps.Projection("EPSG:4326"),e=e.transform(f,g),d=ALKMaps.Util.getQkeysFromBounds(e,d,this.minZoomLevel);this._drawFromCachedData(d);
this._drawFromServiceData(d);var h=this;h._timeoutId=window.setInterval(function(){0===h._requestCounter&&(window.clearTimeout(h._timeoutId),h.removeAllFeatures(),h.clusterStrategy.clearCache(),h.addFeatures(h._featuresDrawn))},100)}},destroyFeatures:function(){if(null!=this.features&&0<this.features.length){var a=this.features.slice();null!=this.clusterStrategy&&Array.prototype.push.apply(a,this.clusterStrategy.features);null!=this.clusterStrategy&&this.clusterStrategy.clearCache();ALKMaps.Layer.VirtualTile.prototype.destroyFeatures.apply(this,
arguments)}},onmouseover:function(a){null!=a&&a.layer.drawFeature(a);return!1},onmouseclick:function(a){if(null!=a){var b=new ALKMaps.Size(180,60),c=a.cluster?a.cluster[0].lonlat:a.lonlat,d="";if(a.cluster){var d=a.cluster[0].attributes[0].trafficItemDescription[0],e=null,f=null;if("short_desc"===d.type)e=d.content;if("desc"===d.type)f=d.content;d=(!f?e:f)+" and "+(a.cluster.length-1)+" more"}else{for(var g=a.attributes[0].trafficItemDescription,f=e=null,h=0;h<g.length;h++){d=g[h];if("short_desc"===
d.type)e=d.content;if("desc"===d.type)f=d.content}d=!f?e:f}a.clickPopup=new ALKMaps.Popup.SimplePopup(a.attributes.incidentID+"_click",c,b,'<div style="font-size:12px">'+d+"</div>",null,!0);a.layer.map.addPopup(a.clickPopup,!0)}return!1},CLASS_NAME:"ALKMaps.Layer.TrafficIncidents"});ALKMaps.Layer.Sites=ALKMaps.Class(ALKMaps.Layer.VirtualTile,{minZoomLevel:12,siteType:0,includeSiteGates:!1,_requestCounter:0,_featuresDrawn:[],_timeoutId:null,initialize:function(a,b){b=b||{};this.minZoomLevel=b.minZoomLevel||this.minZoomLevel;this.cacheInterval=b.cacheInterval||this.cacheInterval;var c=new ALKMaps.StyleMap({"default":new ALKMaps.Style({strokeColor:"#b985ea",strokeOpacity:0.48,strokeWidth:3,strokeDashstyle:"solid",fillColor:"#7775b9",fillOpacity:0.1,label:"${siteName}",fontColor:"#696969",
fontSize:"${fontSize}",fontFamily:"Helvetica, Verdana"},{context:{fontSize:function(a){return 14<a.layer.map.getZoom()?"11px":"0px"},siteName:function(a){return!0===a.attributes.publicSite?"":a.attributes.siteName}}})});this.styleMap=b.styleMap?b.styleMap:c;this.siteType=b.siteType?b.siteType:this.siteType;this.includeSiteGates=b.includeSiteGates?b.includeSiteGates:this.includeSiteGates;ALKMaps.Layer.VirtualTile.prototype.initialize.apply(this,arguments);if(6>this.minZoomLevel)this.minZoomLevel=6},
destroy:function(){ALKMaps.Layer.VirtualTile.prototype.destroy.apply(this,arguments)},setMap:function(a){ALKMaps.Layer.VirtualTile.prototype.setMap.apply(this,arguments)},_successCB:function(a,b,c){!0===b&&c.updateVirtualTile(a.Tag,a);if("function"===typeof c.onAddedCallback)c.onAddedCallback();c._addSites(a)},_failureCB:function(a,b){if("function"===typeof b.onErrorCallback)b.onErrorCallback({response:a})},_drawFromCachedData:function(a){for(var a=this.getCachedTileQkeys(a),b=0;b<a.length;b++){if("function"===
typeof this.onStartCallback)this.onStartCallback();++this._requestCounter;this._successCB(this.getCachedVirtualTile(a[b]).data,!1,this);--this._requestCounter}},_drawFromServiceData:function(a){for(var b=this,a=this.getVirtualBounds(a),c=b.siteType,d=b.includeSiteGates,e=0;e<a.length;e++){if("function"===typeof b.onStartCallback)b.onStartCallback();var f=a[e],g=f.bounds.toArray();++b._requestCounter;ALKMaps.Services.getSitesBox({bbox:g,qKey:f.qKey,siteType:c,includeSiteGates:d,success:function(a){--b._requestCounter;
if(0<a.Sites.length)b._successCB(a,!0,b);else if("function"===typeof b.onAddedCallback)b.onAddedCallback()},failure:function(a){--b._requestCounter;b._failureCB(a,b)}})}},moveTo:function(a,b,c){ALKMaps.Layer.VirtualTile.prototype.moveTo.apply(this,arguments);this._requestCounter=0;this._featuresDrawn=[];null!=this._timeoutId&&window.clearTimeout(this._timeoutId);var d=this.map.getZoom();if(d<this.minZoomLevel)this.removeAllFeatures();else{var e=this.map.getExtent();this.expireVirtualTiles();var f=
this.map.getProjectionObject(),g=new ALKMaps.Projection("EPSG:4326"),e=e.transform(f,g),d=ALKMaps.Util.getQkeysFromBounds(e,d,this.minZoomLevel);this._drawFromCachedData(d);this._drawFromServiceData(d);var h=this;h._timeoutId=window.setInterval(function(){0===h._requestCounter&&(window.clearTimeout(h._timeoutId),h.removeAllFeatures(),h.addFeatures(h._featuresDrawn))},100)}},_addSites:function(a){var a=a||{},b=a.Tag;if(null==b||0===b.length)console.log("Site qKey tag does not exist. Site can't be shown here.");
else{a=a.Sites;if(0<a.length)for(var c=this.map.getProjectionObject(),d=new ALKMaps.Projection("EPSG:4326"),e=0;e<a.length;e++){var f=a[e],g=f.PolygonWKT,g=(new ALKMaps.Format.WKT).read(g);g.geometry.transform(d,c);g.attributes.createdOn=f.CreatedOn;g.attributes.modifiedOn=f.ModifiedOn;g.attributes.publicSite=f.PublicSite;g.attributes.siteName=f.SiteName;g.attributes.qKey=b;g.attributes.siteId=f.SiteID;this._featuresDrawn.push(g)}!0===this.includeSiteGates&&this._addSiteGates(a)}},_addSiteGates:function(a){for(var b=
this.map.getProjectionObject(),c=new ALKMaps.Projection("EPSG:4326"),d=0;d<a.length;d++){var e=a[d];if(null!==e.SiteGates&&void 0!==e.SiteGates&&0<e.SiteGates.length)for(var f=0;f<e.SiteGates.length;f++){var g=e.SiteGates[f],h='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><title>Entry Gate</title><circle cx="30" cy="30" r="30" style="fill:#28b24b"/><path d="M29.9,43.5V19.6a1,1,0,0,0-1-1H15.1a1,1,0,0,0-1,1V43.4H11.8v2.9H32.2V43.4H29.9ZM21.5,24.7a2.45,2.45,0,1,1-1.9,1.9A2.48,2.48,0,0,1,21.5,24.7Z" transform="translate(-2 -2)" style="fill:#fff"/><path d="M32.9,26.6l19-8.4-2.2-4.9L32.9,20.7ZM48,15.4l.1,3.3-4.5,2-.1-3.3Zm-8.4,7-4.5,2L35,21.1l4.5-2Z" transform="translate(-2 -2)" style="fill:#fff;opacity:0.75;isolation:isolate"/></svg>';
1==g.GateType?h='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><title>Exit Gate</title><circle cx="30" cy="30" r="30" style="fill:#d31f26"/><path d="M29.9,43.5V19.6a1,1,0,0,0-1-1H15.1a1,1,0,0,0-1,1V43.4H11.8v2.9H32.2V43.4H29.9ZM21.5,24.7a2.45,2.45,0,1,1-1.9,1.9A2.48,2.48,0,0,1,21.5,24.7Z" transform="translate(-2 -2)" style="fill:#fff"/><path d="M32.9,26.6l19-8.4-2.2-4.9L32.9,20.7ZM48,15.4l.1,3.3-4.5,2-.1-3.3Zm-8.4,7-4.5,2L35,21.1l4.5-2Z" transform="translate(-2 -2)" style="fill:#fff;opacity:0.75;isolation:isolate"/></svg>':
2==g.GateType&&(h='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><title>Entry + Exit Gate</title><circle cx="30" cy="30" r="30" style="fill:#00acdf"/><path d="M29.9,43.5V19.6a1,1,0,0,0-1-1H15.1a1,1,0,0,0-1,1V43.4H11.8v2.9H32.2V43.4H29.9ZM21.5,24.7a2.45,2.45,0,1,1-1.9,1.9A2.48,2.48,0,0,1,21.5,24.7Z" transform="translate(-2 -2)" style="fill:#fff"/><path d="M32.9,26.6l19-8.4-2.2-4.9L32.9,20.7ZM48,15.4l.1,3.3-4.5,2-.1-3.3Zm-8.4,7-4.5,2L35,21.1l4.5-2Z" transform="translate(-2 -2)" style="fill:#fff;opacity:0.75;isolation:isolate"/></svg>');
h=ALKMaps.String.format(h);g=(new ALKMaps.Geometry.Point(g.Longitude,g.Latitude)).transform(c,b);this._featuresDrawn.push(new ALKMaps.Feature.Vector(g,{svg:{content:h,size:new ALKMaps.Size(20,20)}},{graphicZIndex:2}))}}},clickHandler:function(a){console.log("Mouse click on feature.",a.feature," lastPixel:",a.lastPixel," lastLonLat",a.lastLonLat);var b=a.feature.clone();b.lonlat=a.lastLonLat;b.popupClass=ALKMaps.Popup.SimplePopup;b.data.popupSize=new ALKMaps.Size(140,20);b.data.popupContentHTML=b.attributes.siteName;
this.map.addPopup(b.createPopup(!0));return!1},CLASS_NAME:"ALKMaps.Layer.Sites"});ALKMaps.Control.LayerSwitcher=ALKMaps.Class(ALKMaps.Control,{layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,
removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);ALKMaps.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):
this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){ALKMaps.Control.prototype.draw.apply(this);this.loadContents();this.outsideViewport||this.minimizeControl();this.redraw();return this.div},onButtonClick:function(a){a=a.buttonElement;if(a===this.minimizeDiv)this.minimizeControl();else if(a===this.maximizeDiv)this.maximizeControl();else if(a._layerSwitcher===this.id&&(a["for"]&&(a=document.getElementById(a["for"])),!a.disabled))"radio"==a.type?(a.checked=!0,this.map.setBaseLayer(this.map.getLayer(a._layer))):
(a.checked=!a.checked,this.updateMap())},clearLayersArray:function(a){this[a+"LayersDiv"].innerHTML="";this[a+"Layers"]=[]},checkRedraw:function(){var a=!1;if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length)a=!0;else for(var b=0,c=this.layerStates.length;b<c;b++){var d=this.layerStates[b],e=this.map.layers[b];if(d.name!=e.name||d.inRange!=e.inRange||d.id!=e.id||d.visibility!=e.visibility){a=!0;break}}return a},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base");
this.clearLayersArray("data");var a=!1,b=!1,c=this.map.layers.length;this.layerStates=Array(c);for(var d=0;d<c;d++){var e=this.map.layers[d];this.layerStates[d]={name:e.name,visibility:e.visibility,inRange:e.inRange,id:e.id}}var f=this.map.layers.slice();this.ascending||f.reverse();d=0;for(c=f.length;d<c;d++){var e=f[d],g=e.isBaseLayer;if(e.displayInLayerSwitcher){g?b=!0:a=!0;var h=g?e==this.map.baseLayer:e.getVisibility(),i=document.createElement("input");i.id=this.id+"_input_"+e.name;i.name=g?this.id+
"_baseLayers":e.name;i.type=g?"radio":"checkbox";i.value=e.name;i.checked=h;i.defaultChecked=h;i.className="olButton";i._layer=e.id;i._layerSwitcher=this.id;if(!g&&!e.inRange)i.disabled=!0;h=document.createElement("label");h["for"]=i.id;ALKMaps.Element.addClass(h,"labelSpan olButton");h._layer=e.id;h._layerSwitcher=this.id;if(!g&&!e.inRange)h.style.color="gray";h.innerHTML=e.name;h.style.verticalAlign=g?"bottom":"baseline";var j=document.createElement("br");(g?this.baseLayers:this.dataLayers).push({layer:e,
inputElem:i,labelSpan:h});e=g?this.baseLayersDiv:this.dataLayersDiv;e.appendChild(i);e.appendChild(h);e.appendChild(j)}}this.dataLbl.style.display=a?"":"none";this.baseLbl.style.display=b?"":"none";return this.div},updateMap:function(){for(var a=0,b=this.baseLayers.length;a<b;a++){var c=this.baseLayers[a];c.inputElem.checked&&this.map.setBaseLayer(c.layer,!1)}a=0;for(b=this.dataLayers.length;a<b;a++)c=this.dataLayers[a],c.layer.setVisibility(c.inputElem.checked)},maximizeControl:function(a){this.div.style.width=
"";this.div.style.height="";this.showControls(!1);null!=a&&ALKMaps.Event.stop(a)},minimizeControl:function(a){this.div.style.width="0px";this.div.style.height="0px";this.showControls(!0);null!=a&&ALKMaps.Event.stop(a)},showControls:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":"";this.layersDiv.style.display=a?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";ALKMaps.Element.addClass(this.layersDiv,
"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=ALKMaps.i18n("Base Layer");ALKMaps.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");ALKMaps.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=ALKMaps.i18n("Overlays");ALKMaps.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");ALKMaps.Element.addClass(this.dataLayersDiv,"dataLayersDiv");
this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv));this.div.appendChild(this.layersDiv);var a=ALKMaps.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=ALKMaps.Util.createAlphaImageDiv("ALKMaps_Control_MaximizeDiv",
null,null,a,"absolute");ALKMaps.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);a=ALKMaps.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=ALKMaps.Util.createAlphaImageDiv("ALKMaps_Control_MinimizeDiv",null,null,a,"absolute");ALKMaps.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display="none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"ALKMaps.Control.LayerSwitcher"});ALKMaps.Lang.nl=ALKMaps.Util.applyDefaults({unhandledRequest:"Het verzoek is niet afgehandeld met de volgende melding: ${statusText}",Permalink:"Permanente verwijzing",Overlays:"Overlays","Base Layer":"Achtergrondkaart",readNotImplemented:"Lezen is niet ge\u00efmplementeerd.",writeNotImplemented:"Schrijven is niet ge\u00efmplementeerd.",noFID:"Een optie die geen FID heeft kan niet bijgewerkt worden.",errorLoadingGML:"Er is een fout opgetreden bij het laden van het GML bestand van ${url}",browserNotSupported:"Uw browser ondersteunt het weergeven van vectoren niet.\nMomenteel ondersteunde weergavemogelijkheden:\n${renderers}",
componentShouldBe:"addFeatures : component moet van het type ${geomType} zijn",getFeatureError:"getFeatureFromEvent is aangeroepen op een laag zonder rederer.\nDit betekent meestal dat u een laag hebt verwijderd, maar niet een handler die ermee geassocieerd was.",minZoomLevelError:"De eigenschap minZoomLevel is alleen bedoeld voor gebruik lagen met die afstammen van FixedZoomLevels-lagen.\nDat deze WFS-laag minZoomLevel controleert, is een overblijfsel uit het verleden.\nWe kunnen deze controle echter niet verwijderen zonder op OL gebaseerde applicaties die hervan afhankelijk zijn stuk te maken.\nDaarom heeft deze functionaliteit de eigenschap 'deprecated' gekregen - de minZoomLevel wordt verwijderd in versie 3.0.\nGebruik in plaats van deze functie de mogelijkheid om min/max voor resolutie in te stellen zoals op de volgende pagina wordt beschreven:\nhttp://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS-transactie: succesvol ${response}",commitFailed:"WFS-transactie: mislukt ${response}",googleWarning:"De Google-Layer kon niet correct geladen worden.<br /><br />\nOm deze melding niet meer te krijgen, moet u een andere achtergrondkaart kiezen in de laagwisselaar in de rechterbovenhoek.<br /><br />\nDit komt waarschijnlijk doordat de bibliotheek ${layerLib} niet correct ingevoegd is.<br /><br />\nOntwikkelaars: <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>klik hier</a> om dit werkend te krijgen.",
getLayerWarning:"De laag ${layerType} kon niet goed geladen worden.<br /><br />\nOm deze melding niet meer te krijgen, moet u een andere achtergrondkaart kiezen in de laagwisselaar in de rechterbovenhoek.<br /><br />\nDit komt waarschijnlijk doordat de bibliotheek ${layerLib} niet correct is ingevoegd.<br /><br />\nOntwikkelaars: <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>klik hier</a> om dit werkend te krijgen.","Scale = 1 : ${scaleDenom}":"Schaal = 1 : ${scaleDenom}",
W:"W",E:"O",N:"N",S:"Z",layerAlreadyAdded:"U hebt geprobeerd om de laag  ${layerName} aan de kaart toe te voegen, maar deze is al toegevoegd",reprojectDeprecated:"U gebruikt de optie 'reproject' op de laag ${layerName}.\nDeze optie is vervallen: deze optie was ontwikkeld om gegevens over commerci\u00eble basiskaarten weer te geven, maar deze functionaliteit wordt nu bereikt door ondersteuning van Spherical Mercator.\nMeer informatie is beschikbaar op http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"Deze methode is verouderd en wordt verwijderd in versie 3.0.\nGebruik ${newMethod}.",boundsAddError:"U moet zowel de x- als de y-waarde doorgeven aan de toevoegfunctie.",lonlatAddError:"U moet zowel de lengte- als de breedtewaarde doorgeven aan de toevoegfunctie.",pixelAddError:"U moet zowel de x- als de y-waarde doorgeven aan de toevoegfunctie.",unsupportedGeometryType:"Dit geometrietype wordt niet ondersteund: ${geomType}",filterEvaluateNotImplemented:"evalueren is niet ge\u00efmplementeerd voor dit filtertype.",
panup:"Schuif op",panleft:"Schuif links",zoomworld:"Zoom wereld",panright:"Schuif rechts",pandown:"Schuif neer",zoomin:"Zoom in",zoomout:"Zoom uit",dragme:"Sleep mij",dragToChangeRoute:"Sleep om route te wijzigen",drawPoints:"Teken punten",clkToSetPoints:"Klik om punten voor een lijn te plaatsen. Dubbelklik om te voltooien.",dragToDrawLine:"Sleep om een vrije lijn te tekenen.",dragToDrawEllipse:"Sleep om een ellips te tekenen.",dragToDrawRect:"Sleep om een rechthoek te tekenen.",clkToSetPolygon:"Klik om punten voor een veelhoek te plaatsen. Dubbelklik om te voltooien.",
dragToDrawPolygon:"Sleep om een vrije veelhoek te tekenen.",clkShapeToResize:"Klik op een vorm voor grootte veranderen of verplaatsen. Houd de cursor bij een hoek om te roteren.",clkShapeToModify:"Klik op een vorm om punten ervan te wijzigen. Met de cursor boven een punt drukt u op de Delete toets om het te verwijderen.",showShapeInfo:"Vorm infovak tonen.",area:"Oppervlakte",length:"Lengte",nodes:"Nodes",perimeter:"Omtrek",location:"Locatie",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",
prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Layer.Traffic=ALKMaps.Class(ALKMaps.Layer.Grid,{reproject:!1,isBaseLayer:!1,singleTile:!1,sphericalMercator:!0,projection:"EPSG:900913",region:null,tilesCached:[],cacheDuration:1,initialize:function(a,b,c){c=c||{};this.singleTile=!0===c.singleTile?!0:this.singleTile;this.isBaseLayer=!1;if(void 0===c.opacity)c.opacity=0.5;var d=[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,6.866455078125E-4,3.4332275390625E-4,
1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6],e=new ALKMaps.LonLat(-180,90);if(c&&c.sphericalMercator||this.sphericalMercator)d=[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,
1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338],e=new ALKMaps.LonLat(2.003750834E7,-2.003750834E7),c=ALKMaps.Util.extend({projection:"EPSG:900913"},c);c=ALKMaps.Util.extend({tileOrigin:e,resolutions:d,singleTile:this.singleTile},c);d=[];if(null!=b&&null!=b.region)this.region=ALKMaps.Util.getRegion(b.region);b=ALKMaps.Util.upperCaseObject(b);d.push(a,"",b,c);ALKMaps.Layer.Grid.prototype.initialize.apply(this,d)},setMap:function(a){ALKMaps.Layer.Grid.prototype.setMap.apply(this,
arguments);if(null==this.region)this.region=a.baseLayer.params.REGION;this.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region,useHyperlink:this.options.attrUseHyperlink})},destroy:function(){this.tilesCached=[];ALKMaps.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new ALKMaps.Layer.Traffic(this.name,this.params,this.getOptions()));return a=ALKMaps.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),
b=a.clone(),c=a.clone();if(!0===this.sphericalMercator)var d=this.map.getProjectionObject(),c=new ALKMaps.Projection("EPSG:4326"),c=a.clone().transform(d,c);var d=-35>c.left&&-35>c.right?"NA":"EU",a={},e;if(!0===this.singleTile){if(-180>c.left)c.left=(c.left%180+180)%180;if(180<c.left)c.left=(c.left%-180-180)%-180;if(-180>c.right)c.right=(c.right%180+180)%180;if(180<c.right)c.right=(c.right%-180-180)%-180;e=this.getImageSize();if("NA"===d){a.IMAGEWIDTH=e.w;a.IMAGEHEIGHT=e.h;e=1E6*c.top;var b=1E6*
c.left,f=1E6*c.bottom,c=1E6*c.right;a.LATITUDE1=0<e?Math.floor(e):Math.ceil(e);a.LONGITUDE1=0<b?Math.floor(b):Math.ceil(b);a.LATITUDE2=0<f?Math.floor(f):Math.ceil(f);a.LONGITUDE2=0<c?Math.floor(c):Math.ceil(c);a.AUTHTOKEN=ALKMaps.Util.getApiKey(!0);e=[];for(c=0;c<ALKMaps.TrafficImgContentServiceURL.length;c++)e.push(ALKMaps.TrafficImgContentServiceURL[c]+"traffic/image")}else a.WIDTH=e.w,a.HEIGHT=e.h,a.PT1=c.left+","+c.top,a.PT2=c.right+","+c.bottom,a.AUTHTOKEN=ALKMaps.Util.getApiKey(!0),e=ALKMaps.TrafficServiceURL}else{c=
this.getTileXYZ(b);ALKMaps.Util.applyDefaults(a,{x:c.x,y:c.y,z:c.z});b=new Date;f=b.getTime();if(1<=this.tilesCached.length)for(var g=this.tilesCached.length-1;0<=g;g--)f-this.tilesCached[g].numericDate>=6E4*this.cacheDuration&&this.tilesCached.splice(g,1);for(var g=!1,h=0;h<this.tilesCached.length-1;h++){var i=this.tilesCached[h],j=i.y,k=i.z,m=i.isoDate;if(i.x===c.x&&j===c.y&&k===c.z){e=m;g=!0;break}}!0===g?a.AUTHTOKEN=ALKMaps.Util.getApiKey(e):(this.tilesCached.push({x:c.x,y:c.y,z:c.z,numericDate:f,
isoDate:b}),a.AUTHTOKEN=ALKMaps.Util.getApiKey(b));if("NA"===d){e=[];for(c=0;c<ALKMaps.TrafficImgContentServiceURL.length;c++)e.push(ALKMaps.TrafficImgContentServiceURL[c]+"traffic/tile")}else e=ALKMaps.TrafficTileServiceURL}if("NA"===d){if(d=this.map.getZoom(),a.PENWIDTH=7<d?d-5:2,a.FEDERALROADCLASSES=ALKMaps.Services.getFrcs(d),this.params)a.HISTTZOFFSET=this.params.HISTTIMEZONE,this.params.HISTDAY&&this.params.HISTTIMEBIN&&null!=this.params.HISTDAY&&!isNaN(this.params.HISTTIMEBIN)&&(a.USEHISTORICAL=
!0)}else a.WIDTH=this.tileSize.h,a.HEIGHT=this.tileSize.w,a.REGION=d,d=this.map.getZoom(),a.STROKEWIDTH=7<d?d-5:2,a.FRCS=ALKMaps.Services.getFrcs(d);return this.getFullRequestString(a,e)},getTileXYZ:function(a){var b=this.getServerZoom(),c=this.getServerResolution(),d=Math.round((a.left-this.maxExtent.left)/(c*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(c*this.tileSize.h));this.wrapDateLine&&(c=Math.pow(2,b),d=(d%c+c)%c);return{x:d,y:a,z:b}},getFullRequestString:function(a,b){return ALKMaps.Layer.Grid.prototype.getFullRequestString.apply(this,
arguments)},updateInfoWarning:function(){var a=this.getServerZoom();this.infoWarning="";if(6>a||16<a)this.infoWarning="Traffic map unavailable";for(var a=this.map.getControlsByClass("ALKMaps.Control.InfoWarning"),b=0;b<a.length;b++)a[b].updateInfoWarning()},CLASS_NAME:"ALKMaps.Layer.Traffic"});ALKMaps.nullHandler=function(a){ALKMaps.Console.userError(ALKMaps.i18n("unhandledRequest",{statusText:a.statusText}))};ALKMaps.loadURL=function(a,b,c,d,e){"string"==typeof b&&(b=ALKMaps.Util.getParameters(b));return ALKMaps.Request.GET({url:a,params:b,success:d?d:ALKMaps.nullHandler,failure:e?e:ALKMaps.nullHandler,scope:c})};
ALKMaps.parseXMLString=function(a){var b=a.indexOf("<");0<b&&(a=a.substring(b));return ALKMaps.Util.Try(function(){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b},function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1);b.overrideMimeType&&b.overrideMimeType("text/xml");b.send(null);return b.responseXML})};
ALKMaps.Ajax={emptyFunction:function(){},getTransport:function(){return ALKMaps.Util.Try(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0};
ALKMaps.Ajax.Responders={responders:[],register:function(a){for(var b=0;b<this.responders.length;b++)if(a==this.responders[b])return;this.responders.push(a)},unregister:function(a){ALKMaps.Util.removeItem(this.reponders,a)},dispatch:function(a,b,c){for(var d,e=0;e<this.responders.length;e++)if(d=this.responders[e],d[a]&&"function"==typeof d[a])try{d[a].apply(d,[b,c])}catch(f){}}};ALKMaps.Ajax.Responders.register({onCreate:function(){ALKMaps.Ajax.activeRequestCount++},onComplete:function(){ALKMaps.Ajax.activeRequestCount--}});
ALKMaps.Ajax.Base=ALKMaps.Class({initialize:function(a){this.options={method:"post",asynchronous:!0,contentType:"application/xml",parameters:""};ALKMaps.Util.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if("string"==typeof this.options.parameters)this.options.parameters=ALKMaps.Util.getParameters(this.options.parameters)}});
ALKMaps.Ajax.Request=ALKMaps.Class(ALKMaps.Ajax.Base,{_complete:!1,initialize:function(a,b){ALKMaps.Ajax.Base.prototype.initialize.apply(this,[b]);ALKMaps.ProxyHost&&ALKMaps.String.startsWith(a,"http")&&(a=ALKMaps.ProxyHost+encodeURIComponent(a));this.transport=ALKMaps.Ajax.getTransport();this.request(a)},request:function(a){this.url=a;this.method=this.options.method;a=ALKMaps.Util.extend({},this.options.parameters);if("get"!=this.method&&"post"!=this.method)a._method=this.method,this.method="post";
this.parameters=a;if(a=ALKMaps.Util.getParameterString(a))"get"==this.method?this.url+=(-1<this.url.indexOf("?")?"&":"?")+a:/Konqueror|Safari|KHTML/.test(navigator.userAgent)&&(a+="&_=");try{var b=new ALKMaps.Ajax.Response(this);if(this.options.onCreate)this.options.onCreate(b);ALKMaps.Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&window.setTimeout(ALKMaps.Function.bind(this.respondToReadyState,
this,1),10);this.transport.onreadystatechange=ALKMaps.Function.bind(this.onStateChange,this);this.setRequestHeaders();this.body="post"==this.method?this.options.postBody||a:null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType)this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;1<a&&!(4==a&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a=
{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",ALKMaps:!0};if("post"==this.method&&(a["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&2005>(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]))a.Connection="close";if("object"==typeof this.options.requestHeaders){var b=this.options.requestHeaders;if("function"==typeof b.push)for(var c=0,d=b.length;c<
d;c+=2)a[b[c]]=b[c+1];else for(c in b)a[c]=b[c]}for(var e in a)this.transport.setRequestHeader(e,a[e])},success:function(){var a=this.getStatus();return!a||200<=a&&300>a},getStatus:function(){try{return this.transport.status||0}catch(a){return 0}},respondToReadyState:function(a){var a=ALKMaps.Ajax.Request.Events[a],b=new ALKMaps.Ajax.Response(this);if("Complete"==a){try{this._complete=!0,(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||ALKMaps.Ajax.emptyFunction)(b)}catch(c){this.dispatchException(c)}b.getHeader("Content-type")}try{(this.options["on"+
a]||ALKMaps.Ajax.emptyFunction)(b),ALKMaps.Ajax.Responders.dispatch("on"+a,this,b)}catch(d){this.dispatchException(d)}if("Complete"==a)this.transport.onreadystatechange=ALKMaps.Ajax.emptyFunction},getHeader:function(a){try{return this.transport.getResponseHeader(a)}catch(b){return null}},dispatchException:function(a){var b=this.options.onException;if(b)b(this,a),ALKMaps.Ajax.Responders.dispatch("onException",this,a);else{for(var b=!1,c=ALKMaps.Ajax.Responders.responders,d=0;d<c.length;d++)if(c[d].onException){b=
!0;break}if(b)ALKMaps.Ajax.Responders.dispatch("onException",this,a);else throw a;}}});ALKMaps.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
ALKMaps.Ajax.Response=ALKMaps.Class({status:0,statusText:"",initialize:function(a){this.request=a;var a=this.transport=a.transport,b=this.readyState=a.readyState;if(2<b&&(!window.attachEvent||window.opera)||4==b)this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=null==a.responseText?"":""+a.responseText;if(4==b)a=a.responseXML,this.responseXML=void 0===a?null:a},getStatus:ALKMaps.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||
""}catch(a){return""}},getHeader:ALKMaps.Ajax.Request.prototype.getHeader,getResponseHeader:function(a){return this.transport.getResponseHeader(a)}});ALKMaps.Ajax.getElementsByTagNameNS=function(a,b,c,d){var e=null;return e=a.getElementsByTagNameNS?a.getElementsByTagNameNS(b,d):a.getElementsByTagName(c+":"+d)};ALKMaps.Ajax.serializeXMLToString=function(a){return(new XMLSerializer).serializeToString(a)};ALKMaps.Filter.Comparison=ALKMaps.Class(ALKMaps.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){ALKMaps.Filter.prototype.initialize.apply(this,[a]);if(this.type===ALKMaps.Filter.Comparison.LIKE&&void 0===a.matchCase)this.matchCase=null},evaluate:function(a){if(a instanceof ALKMaps.Feature.Vector)a=a.attributes;var b=!1,a=a[this.property];switch(this.type){case ALKMaps.Filter.Comparison.EQUAL_TO:b=this.value;b=!this.matchCase&&"string"==
typeof a&&"string"==typeof b?a.toUpperCase()==b.toUpperCase():a==b;break;case ALKMaps.Filter.Comparison.NOT_EQUAL_TO:b=this.value;b=!this.matchCase&&"string"==typeof a&&"string"==typeof b?a.toUpperCase()!=b.toUpperCase():a!=b;break;case ALKMaps.Filter.Comparison.LESS_THAN:b=a<this.value;break;case ALKMaps.Filter.Comparison.GREATER_THAN:b=a>this.value;break;case ALKMaps.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a<=this.value;break;case ALKMaps.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b=a>=this.value;
break;case ALKMaps.Filter.Comparison.BETWEEN:b=a>=this.lowerBoundary&&a<=this.upperBoundary;break;case ALKMaps.Filter.Comparison.LIKE:b=RegExp(this.value,"gi").test(a)}return b},value2regex:function(a,b,c){if("."==a)throw Error("'.' is an unsupported wildCard character for ALKMaps.Filter.Comparison");a=a?a:"*";b=b?b:".";this.value=this.value.replace(RegExp("\\"+(c?c:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+b,"g"),".");this.value=this.value.replace(RegExp("\\"+a,"g"),".*");
this.value=this.value.replace(/\\.\*/g,"\\"+a);return this.value=this.value.replace(/\\\./g,"\\"+b)},regex2value:function(){var a=this.value,a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,c){return c?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,c){return c?a:"!*"}),a=a.replace(/\\\\/g,"\\");return a=a.replace(/\.\*/g,"*")},clone:function(){return ALKMaps.Util.extend(new ALKMaps.Filter.Comparison,this)},CLASS_NAME:"ALKMaps.Filter.Comparison"});ALKMaps.Filter.Comparison.EQUAL_TO="==";
ALKMaps.Filter.Comparison.NOT_EQUAL_TO="!=";ALKMaps.Filter.Comparison.LESS_THAN="<";ALKMaps.Filter.Comparison.GREATER_THAN=">";ALKMaps.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";ALKMaps.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";ALKMaps.Filter.Comparison.BETWEEN="..";ALKMaps.Filter.Comparison.LIKE="~";ALKMaps.Filter.Logical=ALKMaps.Class(ALKMaps.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];ALKMaps.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null;ALKMaps.Filter.prototype.destroy.apply(this)},evaluate:function(a){var b,c;switch(this.type){case ALKMaps.Filter.Logical.AND:for(b=0,c=this.filters.length;b<c;b++)if(!1==this.filters[b].evaluate(a))return!1;return!0;case ALKMaps.Filter.Logical.OR:for(b=0,c=this.filters.length;b<c;b++)if(!0==this.filters[b].evaluate(a))return!0;
return!1;case ALKMaps.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){for(var a=[],b=0,c=this.filters.length;b<c;++b)a.push(this.filters[b].clone());return new ALKMaps.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"ALKMaps.Filter.Logical"});ALKMaps.Filter.Logical.AND="&&";ALKMaps.Filter.Logical.OR="||";ALKMaps.Filter.Logical.NOT="!";ALKMaps.Format.QueryStringFilter=function(){function a(a){a=a.replace(/%/g,"\\%");a=a.replace(/\\\\\.(\*)?/g,function(a,b){return b?a:"\\\\_"});a=a.replace(/\\\\\.\*/g,"\\\\%");a=a.replace(/(\\)?\.(\*)?/g,function(a,b,c){return b||c?a:"_"});a=a.replace(/(\\)?\.\*/g,function(a,b){return b?a:"%"});a=a.replace(/\\\./g,".");return a=a.replace(/(\\)?\\\*/g,function(a,b){return b?a:"*"})}var b={};b[ALKMaps.Filter.Comparison.EQUAL_TO]="eq";b[ALKMaps.Filter.Comparison.NOT_EQUAL_TO]="ne";b[ALKMaps.Filter.Comparison.LESS_THAN]=
"lt";b[ALKMaps.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";b[ALKMaps.Filter.Comparison.GREATER_THAN]="gt";b[ALKMaps.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";b[ALKMaps.Filter.Comparison.LIKE]="ilike";return ALKMaps.Class(ALKMaps.Format,{wildcarded:!1,srsInBBOX:!1,write:function(c,d){var d=d||{},e=c.CLASS_NAME,e=e.substring(e.lastIndexOf(".")+1);switch(e){case "Spatial":switch(c.type){case ALKMaps.Filter.Spatial.BBOX:d.bbox=c.value.toArray();this.srsInBBOX&&c.projection&&d.bbox.push(c.projection.getCode());
break;case ALKMaps.Filter.Spatial.DWITHIN:d.tolerance=c.distance;case ALKMaps.Filter.Spatial.WITHIN:d.lon=c.value.x;d.lat=c.value.y;break;default:ALKMaps.Console.warn("Unknown spatial filter type "+c.type)}break;case "Comparison":e=b[c.type];if(void 0!==e){var f=c.value;c.type==ALKMaps.Filter.Comparison.LIKE&&(f=a(f),this.wildcarded&&(f="%"+f+"%"));d[c.property+"__"+e]=f;d.queryable=d.queryable||[];d.queryable.push(c.property)}else ALKMaps.Console.warn("Unknown comparison filter type "+c.type);break;
case "Logical":if(c.type===ALKMaps.Filter.Logical.AND){e=0;for(f=c.filters.length;e<f;e++)d=this.write(c.filters[e],d)}else ALKMaps.Console.warn("Unsupported logical filter type "+c.type);break;default:ALKMaps.Console.warn("Unknown filter type "+e)}return d},CLASS_NAME:"ALKMaps.Format.QueryStringFilter"})}();ALKMaps.Lang.ru=ALKMaps.Util.applyDefaults({unhandledRequest:"\u041d\u0435\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441 \u0432\u0435\u0440\u043d\u0443\u043b ${statusText}",Permalink:"\u041f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430",Overlays:"\u0421\u043b\u043e\u0438","Base Layer":"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u043b\u043e\u0439",readNotImplemented:"\u0427\u0442\u0435\u043d\u0438\u0435 \u043d\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e.",
writeNotImplemented:"\u0417\u0430\u043f\u0438\u0441\u044c \u043d\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430.",noFID:"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0435\u0442 FID.",errorLoadingGML:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430 GML ${url}",
browserNotSupported:"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u0443\u044e \u0433\u0440\u0430\u0444\u0438\u043a\u0443. \u041d\u0430 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f:\n${renderers}",componentShouldBe:"addFeatures: \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c ${geomType}",
getFeatureError:"getFeatureFromEvent \u0432\u044b\u0437\u0432\u0430\u043d \u0434\u043b\u044f \u0441\u043b\u043e\u044f \u0431\u0435\u0437 \u0440\u0435\u043d\u0434\u0435\u0440\u0435\u0440\u0430. \u041e\u0431\u044b\u0447\u043d\u043e \u044d\u0442\u043e \u0433\u043e\u0432\u043e\u0440\u0438\u0442 \u043e \u0442\u043e\u043c, \u0447\u0442\u043e \u0432\u044b \u0443\u043d\u0438\u0447\u0442\u043e\u0436\u0438\u043b\u0438 \u0441\u043b\u043e\u0439, \u043d\u043e \u043e\u0441\u0442\u0430\u0432\u0438\u043b\u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0439 \u0441 \u043d\u0438\u043c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a.",
minZoomLevelError:"\u0421\u0432\u043e\u0439\u0441\u0442\u0432\u043e minZoomLevel \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0441\u043e \u0441\u043b\u043e\u044f\u043c\u0438, \u044f\u0432\u043b\u044f\u044e\u0449\u0438\u043c\u0438\u0441\u044f \u043f\u043e\u0442\u043e\u043c\u043a\u0430\u043c\u0438 FixedZoomLevels. \u0422\u043e, \u0447\u0442\u043e \u044d\u0442\u043e\u0442 WFS-\u0441\u043b\u043e\u0439 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u043d\u0430 minZoomLevel \u2014 \u0440\u0435\u043b\u0438\u043a\u0442 \u043f\u0440\u043e\u0448\u043b\u043e\u0433\u043e. \u041e\u0434\u043d\u0430\u043a\u043e \u043c\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u043c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0444\u0443\u043d\u043a\u0446\u0438\u044e, \u0442\u0430\u043a \u043a\u0430\u043a, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u043e\u0442 \u043d\u0435\u0451 \u0437\u0430\u0432\u0438\u0441\u044f\u0442 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 ALKMaps \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0435\u0439 \u2014 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 minZoomLevel \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u0430 \u0432 3.0. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432\u043c\u0435\u0441\u0442\u043e \u043d\u0435\u0451 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 \u043c\u0438\u043d/\u043c\u0430\u043a\u0441 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u0443\u044e \u0437\u0434\u0435\u0441\u044c: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"\u0422\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u044f WFS: \u0423\u0421\u041f\u0415\u0428\u041d\u041e ${response}",commitFailed:"\u0422\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u044f WFS: \u041e\u0428\u0418\u0411\u041a\u0410 ${response}",googleWarning:"\u0421\u043b\u043e\u0439 Google \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c.<br><br>\u0427\u0442\u043e\u0431\u044b \u0438\u0437\u0431\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u044d\u0442\u043e\u0433\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u0432\u044b\u0431\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u043b\u043e\u0439 \u0432 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0442\u0435\u043b\u0435 \u0432 \u043f\u0440\u0430\u0432\u043e\u043c \u0432\u0435\u0440\u0445\u043d\u0435\u043c \u0443\u0433\u043b\u0443.<br><br>\u0421\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e, \u043f\u0440\u0438\u0447\u0438\u043d\u0430 \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 Google Maps \u043d\u0435 \u0431\u044b\u043b\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u0438\u043b\u0438 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e API-\u043a\u043b\u044e\u0447\u0430 \u0434\u043b\u044f \u0432\u0430\u0448\u0435\u0433\u043e \u0441\u0430\u0439\u0442\u0430.<br><br>\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c: \u0447\u0442\u043e\u0431\u044b \u0443\u0437\u043d\u0430\u0442\u044c, \u043a\u0430\u043a \u0441\u0434\u0435\u043b\u0430\u0442\u044c, \u0447\u0442\u043e\u0431\u044b \u0432\u0441\u0451 \u0437\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u043e, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>\u0449\u0451\u043b\u043a\u043d\u0438\u0442\u0435 \u0442\u0443\u0442</a>",
getLayerWarning:"\u0421\u043b\u043e\u0439 ${layerType} \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c. <br><br>\u0427\u0442\u043e\u0431\u044b \u0438\u0437\u0431\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u044d\u0442\u043e\u0433\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u0432\u044b\u0431\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u043b\u043e\u0439 \u0432 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0442\u0435\u043b\u0435 \u0432 \u043f\u0440\u0430\u0432\u043e\u043c \u0432\u0435\u0440\u0445\u043d\u0435\u043c \u0443\u0433\u043b\u0443.<br><br>\u0421\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e, \u043f\u0440\u0438\u0447\u0438\u043d\u0430 \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 ${layerLib} \u043d\u0435 \u0431\u044b\u043b\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u0438\u043b\u0438 \u0431\u044b\u043b\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e.<br><br>\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c: \u0447\u0442\u043e\u0431\u044b \u0443\u0437\u043d\u0430\u0442\u044c, \u043a\u0430\u043a \u0441\u0434\u0435\u043b\u0430\u0442\u044c, \u0447\u0442\u043e\u0431\u044b \u0432\u0441\u0451 \u0437\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u043e, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>\u0449\u0451\u043b\u043a\u043d\u0438\u0442\u0435 \u0442\u0443\u0442</a>",
"Scale = 1 : ${scaleDenom}":"\u041c\u0430\u0441\u0448\u0442\u0430\u0431 = 1 : ${scaleDenom}",W:"\u0417",E:"\u0412",N:"\u0421",S:"\u042e",layerAlreadyAdded:"\u0412\u044b \u043f\u043e\u043f\u044b\u0442\u0430\u043b\u0438\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0439 \u00ab${layerName}\u00bb \u043d\u0430 \u043a\u0430\u0440\u0442\u0443, \u043d\u043e \u043e\u043d \u0443\u0436\u0435 \u0431\u044b\u043b \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d",reprojectDeprecated:"\u0412\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0435 \u043e\u043f\u0446\u0438\u044e 'reproject' \u0434\u043b\u044f \u0441\u043b\u043e\u044f ${layerName}. \u042d\u0442\u0430 \u043e\u043f\u0446\u0438\u044f \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0435\u0439: \u0435\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u0430\u0433\u0430\u043b\u043e\u0441\u044c \u0434\u043b\u044f \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438 \u043f\u043e\u043a\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0432\u0435\u0440\u0445 \u043a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u0438\u0445 \u0431\u0430\u0437\u043e\u0432\u044b\u0445 \u043a\u0430\u0440\u0442, \u043d\u043e \u0442\u0435\u043f\u0435\u0440\u044c \u044d\u0442\u043e\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u043d\u0435\u0441\u0451\u0442 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0441\u0444\u0435\u0440\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0440\u043e\u0435\u043a\u0446\u0438\u0438 \u041c\u0435\u0440\u043a\u0430\u0442\u043e\u0440\u0430. \u0411\u043e\u043b\u044c\u0448\u0435 \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043d\u0430 http://trac.openlayers.org/wiki/SphericalMercator.",
methodDeprecated:"\u042d\u0442\u043e\u0442 \u043c\u0435\u0442\u043e\u0434 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u043c \u0438 \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0451\u043d \u0432 \u0432\u0435\u0440\u0441\u0438\u0438 3.0. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c ${newMethod}.",boundsAddError:"\u0424\u0443\u043d\u043a\u0446\u0438\u0438 add \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0431\u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, x \u0438 y.",
lonlatAddError:"\u0424\u0443\u043d\u043a\u0446\u0438\u0438 add \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0431\u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, lon \u0438 lat.",pixelAddError:"\u0424\u0443\u043d\u043a\u0446\u0438\u0438 add \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0431\u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, x \u0438 y.",unsupportedGeometryType:"\u041d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0442\u0438\u043f \u0433\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u0438: ${geomType}",
filterEvaluateNotImplemented:"evaluate \u043d\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430.",panup:"\u041f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0430 \u0432\u0432\u0435\u0440\u0445",panleft:"\u041f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0430\u043b \u0432\u043b\u0435\u0432\u043e",zoomworld:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0438\u0440",
panright:"\u041f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0430 \u0432\u043f\u0440\u0430\u0432\u043e",pandown:"\u041f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0430 \u0432\u043d\u0438\u0437",zoomin:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c",zoomout:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c",dragme:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u044d\u0442\u043e",dragToChangeRoute:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442",
drawPoints:"\u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0442\u043e\u0447\u043a\u0438",clkToSetPoints:"\u0429\u0435\u043b\u043a\u0430\u0439\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0434\u0430\u0442\u044c \u0442\u043e\u0447\u043a\u0438 \u043b\u0438\u043d\u0438\u0438. \u0414\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0449\u0435\u043b\u043a\u043d\u0438\u0442\u0435 \u0434\u0432\u0430\u0436\u0434\u044b.",dragToDrawLine:"\u041f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043b\u0438\u043d\u0438\u044e \u043e\u0442 \u0440\u0443\u043a\u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u0435\u043c.",
dragToDrawEllipse:"\u041f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u044d\u043b\u043b\u0438\u043f\u0441 \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u0435\u043c.",dragToDrawRect:"\u041f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043f\u0440\u044f\u043c\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u0435\u043c.",clkToSetPolygon:"\u0429\u0435\u043b\u043a\u0430\u0439\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0434\u0430\u0442\u044c \u0442\u043e\u0447\u043a\u0438 \u043c\u043d\u043e\u0433\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a\u0430. \u0414\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0449\u0435\u043b\u043a\u043d\u0438\u0442\u0435 \u0434\u0432\u0430\u0436\u0434\u044b.",
dragToDrawPolygon:"\u041f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043c\u043d\u043e\u0433\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a \u043e\u0442 \u0440\u0443\u043a\u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u0435\u043c.",clkShapeToResize:"\u0429\u0435\u043b\u043a\u043d\u0438\u0442\u0435 \u0444\u0438\u0433\u0443\u0440\u0443, \u0447\u0442\u043e\u0431\u044b \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0438\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0435\u0435 \u0440\u0430\u0437\u043c\u0435\u0440. \u0414\u043b\u044f \u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435 \u043a\u0443\u0440\u0441\u043e\u0440 \u0440\u044f\u0434\u043e\u043c \u0441 \u0446\u0435\u043d\u0442\u0440\u043e\u043c \u0444\u0438\u0433\u0443\u0440\u044b.",
clkShapeToModify:"\u0429\u0435\u043b\u043a\u043d\u0438\u0442\u0435 \u0444\u0438\u0433\u0443\u0440\u0443, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0435\u0435 \u0442\u043e\u0447\u043a\u0438. \u0414\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0447\u043a\u0438 \u043d\u0430\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430 \u043d\u0435\u0435 \u043a\u0443\u0440\u0441\u043e\u0440 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043b\u0430\u0432\u0438\u0448\u0443 Delete.",
showShapeInfo:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u044b\u043d\u043e\u0441\u043a\u0443 \u0441\u043e \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f\u043c\u0438 \u043e \u0444\u0438\u0433\u0443\u0440\u0435.",area:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c",length:"\u0414\u043b\u0438\u043d\u0430",nodes:"\u0423\u0437\u043b\u044b",perimeter:"\u041f\u0435\u0440\u0438\u043c\u0435\u0442\u0440",location:"\u041c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435",
dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Control.ZoomPanel=ALKMaps.Class(ALKMaps.Control.Panel,{initialize:function(a){ALKMaps.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new ALKMaps.Control.ZoomIn,new ALKMaps.Control.ZoomToMaxExtent,new ALKMaps.Control.ZoomOut])},CLASS_NAME:"ALKMaps.Control.ZoomPanel"});ALKMaps.Control.Graticule=ALKMaps.Class(ALKMaps.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){a=a||{};a.layerName=a.layerName||ALKMaps.i18n("Graticule");ALKMaps.Control.prototype.initialize.apply(this,[a]);this.labelSymbolizer.stroke=
!1;this.labelSymbolizer.fill=!1;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();ALKMaps.Control.prototype.destroy.apply(this,arguments);if(this.gratLayer)this.gratLayer.destroy(),this.gratLayer=null},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=new ALKMaps.Style({},{rules:[new ALKMaps.Rule({symbolizer:{Point:this.labelSymbolizer,
Line:this.lineSymbolizer}})]});this.gratLayer=new ALKMaps.Layer.Vector(this.layerName,{styleMap:new ALKMaps.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){return ALKMaps.Control.prototype.activate.apply(this,arguments)?(this.map.addLayer(this.gratLayer),this.map.events.register("moveend",this,this.update),this.update(),!0):!1},deactivate:function(){return ALKMaps.Control.prototype.deactivate.apply(this,arguments)?
(this.map.events.unregister("moveend",this,this.update),this.map.removeLayer(this.gratLayer),!0):!1},update:function(){var a=this.map.getExtent();if(a){this.gratLayer.destroyFeatures();var b=new ALKMaps.Projection("EPSG:4326"),c=this.map.getProjectionObject(),d=this.map.getResolution();if(c.proj&&"longlat"==c.proj.projName)this.numPoints=1;var e=this.map.getCenter(),f=new ALKMaps.Pixel(e.lon,e.lat);ALKMaps.Projection.transform(f,c,b);for(var e=this.targetSize*d,e=e*e,g,d=0;d<this.intervals.length;++d){g=
this.intervals[d];var h=g/2,i=f.offset({x:-h,y:-h}),h=f.offset({x:h,y:h});ALKMaps.Projection.transform(i,b,c);ALKMaps.Projection.transform(h,b,c);if((i.x-h.x)*(i.x-h.x)+(i.y-h.y)*(i.y-h.y)<=e)break}f.x=Math.floor(f.x/g)*g;f.y=Math.floor(f.y/g)*g;var d=0,e=[f.clone()],h=f.clone(),j;do h=h.offset({x:0,y:g}),j=ALKMaps.Projection.transform(h.clone(),b,c),e.unshift(h);while(a.containsPixel(j)&&1E3>++d);h=f.clone();do h=h.offset({x:0,y:-g}),j=ALKMaps.Projection.transform(h.clone(),b,c),e.push(h);while(a.containsPixel(j)&&
1E3>++d);d=0;i=[f.clone()];h=f.clone();do h=h.offset({x:-g,y:0}),j=ALKMaps.Projection.transform(h.clone(),b,c),i.unshift(h);while(a.containsPixel(j)&&1E3>++d);h=f.clone();do h=h.offset({x:g,y:0}),j=ALKMaps.Projection.transform(h.clone(),b,c),i.push(h);while(a.containsPixel(j)&&1E3>++d);g=[];for(d=0;d<i.length;++d){j=i[d].x;for(var f=[],k=null,m=Math.min(e[0].y,90),h=Math.max(e[e.length-1].y,-90),l=(m-h)/this.numPoints,m=h,h=0;h<=this.numPoints;++h){var p=new ALKMaps.Geometry.Point(j,m);p.transform(b,
c);f.push(p);m+=l;p.y>=a.bottom&&!k&&(k=p)}this.labelled&&(k=new ALKMaps.Geometry.Point(k.x,a.bottom),j={value:j,label:this.labelled?ALKMaps.Util.getFormattedLonLat(j,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2},this.gratLayer.addFeatures(new ALKMaps.Feature.Vector(k,j)));f=new ALKMaps.Geometry.LineString(f);g.push(new ALKMaps.Feature.Vector(f))}for(h=0;h<e.length;++h)if(m=e[h].y,!(-90>m||90<m)){f=[];d=i[0].x;l=(i[i.length-1].x-d)/this.numPoints;j=d;k=null;for(d=0;d<=this.numPoints;++d)p=
new ALKMaps.Geometry.Point(j,m),p.transform(b,c),f.push(p),j+=l,p.x<a.right&&(k=p);this.labelled&&(k=new ALKMaps.Geometry.Point(a.right,k.y),j={value:m,label:this.labelled?ALKMaps.Util.getFormattedLonLat(m,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2},this.gratLayer.addFeatures(new ALKMaps.Feature.Vector(k,j)));f=new ALKMaps.Geometry.LineString(f);g.push(new ALKMaps.Feature.Vector(f))}this.gratLayer.addFeatures(g)}},CLASS_NAME:"ALKMaps.Control.Graticule"});ALKMaps.Control.Permalink=ALKMaps.Class(ALKMaps.Control,{argParserClass:ALKMaps.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(a,b,c){if(null!==a&&"object"==typeof a&&!ALKMaps.Util.isElement(a)){if(this.base=document.location.href,ALKMaps.Control.prototype.initialize.apply(this,[a]),null!=this.element)this.element=ALKMaps.Util.getElement(this.element)}else ALKMaps.Control.prototype.initialize.apply(this,[c]),this.element=ALKMaps.Util.getElement(a),this.base=
b||document.location.href},destroy:function(){if(this.element&&this.element.parentNode==this.div)this.div.removeChild(this.element),this.element=null;this.map&&this.map.events.unregister("moveend",this,this.updateLink);ALKMaps.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){ALKMaps.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d.CLASS_NAME==this.argParserClass.CLASS_NAME){if(d.displayProjection!=this.displayProjection)this.displayProjection=
d.displayProjection;break}}b==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.element&&!this.anchor)this.element=document.createElement("a"),this.element.innerHTML=ALKMaps.i18n("Permalink"),this.element.href="",this.div.appendChild(this.element);this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this});
this.updateLink();return this.div},updateLink:function(){var a=this.anchor?"#":"?",b=this.base;-1!=b.indexOf(a)&&(b=b.substring(0,b.indexOf(a)));b+=a+ALKMaps.Util.getParameterString(this.createParams());this.anchor&&!this.element?window.location.href=b:this.element.href=b},createParams:function(a,b,c){var a=a||this.map.getCenter(),d=ALKMaps.Util.getParameters(this.base);if(a){d.zoom=b||this.map.getZoom();b=a.lat;a=a.lon;if(this.displayProjection)b=ALKMaps.Projection.transform({x:a,y:b},this.map.getProjectionObject(),
this.displayProjection),a=b.x,b=b.y;d.lat=Math.round(1E5*b)/1E5;d.lon=Math.round(1E5*a)/1E5;c=c||this.map.layers;d.layers="";a=0;for(b=c.length;a<b;a++){var e=c[a];d.layers=e.isBaseLayer?d.layers+(e==this.map.baseLayer?"B":"0"):d.layers+(e.getVisibility()?"T":"F")}}return d},CLASS_NAME:"ALKMaps.Control.Permalink"});ALKMaps.Layer.TrafficCameras=ALKMaps.Class(ALKMaps.Layer.VirtualTile,{cacheInterval:480,threshold:5,distance:30,cluster:!0,minZoomLevel:5,wrapDateLine:!0,_requestCounter:0,_featuresDrawn:[],_timeoutId:null,initialize:function(a,b){b=b||{};this.cacheInterval=b.cacheInterval||this.cacheInterval;this.threshold=b.threshold||this.threshold;this.distance=b.distance||this.distance;this.cluster=b.cluster||this.cluster;this.clusterStrategy=new ALKMaps.Strategy.Cluster({distance:this.distance,threshold:this.threshold,
autoActivate:!1,maxZoomLevel:16});var c=new ALKMaps.Style({strokeColor:"${color}",pointRadius:"${radius}",strokeWidth:1,fillColor:"${color}",fillOpacity:0.3,fontSize:"9px",label:"${label}"},{context:{color:function(a){if(a.cluster){var a=a.cluster.length,b;5>=a?b="#00ff06":10>=a?b="#fe9300":30>=a?b="#027ffb":50>=a?b="#a55fff":100>=a?b="#2448ff":300>=a?b="#fc5800":1E3>=a?b="#02d4cf":1E3<a&&(b="#ce4871");return b}return a.layer.styleMap.styles.temporary.defaultStyle.strokeColor},radius:function(a){if(a.cluster){for(var b=
a.geometry,c=0,g=0;g<a.cluster.length;g++){var h=a.cluster[g].geometry,i=a.layer.map.baseLayer.getResolution(),h=b.distanceTo(h)/i;h>c&&(c=h)}16>c&&(c=16);return c/2}return 8},label:function(a){return a.cluster?a.cluster.length:""}}}),c=new ALKMaps.StyleMap({"default":c});this.strategies=b.strategies?b.strategies:[this.clusterStrategy];this.styleMap=b.styleMap?b.styleMap:c;ALKMaps.Layer.VirtualTile.prototype.initialize.apply(this,arguments)},setMap:function(a){ALKMaps.Layer.VirtualTile.prototype.setMap.apply(this,
arguments);this.attribution=ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region});null!=this.clusterStrategy&&!0===this.cluster&&this.clusterStrategy.activate()},_successCB:function(a,b,c){!0===b&&c.updateVirtualTile(a.requestId,a);if("function"===typeof c.onAddedCallback)c.onAddedCallback();for(var b=new ALKMaps.Projection("EPSG:4326"),d=c.map.getProjectionObject(),e=0;e<a.length;e++){var f=a[e].Coordinates,g=a[e].PublicId,f=(new ALKMaps.Geometry.Point(f[0],f[1])).transform(b,
d),g=new ALKMaps.Feature.Vector(f,{publicId:g},{externalGraphic:ALKMaps.Util.getImageLocation("safety_camera.png"),graphicHeight:16,graphicWidth:16});g.lonlat=new ALKMaps.LonLat(f.x,f.y);c._featuresDrawn.push(g)}},_failureCB:function(a,b){if("function"===typeof b.onErrorCallback)b.onErrorCallback({response:a})},_drawFromCachedData:function(a){for(var a=this.getCachedTileQkeys(a),b=0;b<a.length;b++){if("function"===typeof this.onStartCallback)this.onStartCallback();++this._requestCounter;this._successCB(this.getCachedVirtualTile(a[b]).data,
!1,this);--this._requestCounter}},_drawFromServiceData:function(a){for(var b=this,a=this.getVirtualBounds(a),c=0;c<a.length;c++){if("function"===typeof b.onStartCallback)b.onStartCallback();var d=a[c],e=d.bounds.toArray();++b._requestCounter;ALKMaps.Services.getTrafficCamerasBox({bbox:e,async:!1,success:function(a){--b._requestCounter;if(0<a.length)a.requestId=d.qKey,b._successCB(a,!0,b);else if("function"===typeof b.onAddedCallback)b.onAddedCallback()},failure:function(a){--b._requestCounter;b._failureCB(a,
b)}})}},moveTo:function(a,b,c){ALKMaps.Layer.Vector.prototype.moveTo.apply(this,arguments);this._requestCounter=0;this._featuresDrawn=[];null!=this._timeoutId&&window.clearTimeout(this._timeoutId);var d=this.map.getZoom();if(d<this.minZoomLevel)this.removeAllFeatures(),this.clusterStrategy.clearCache();else{var e=this.map.getExtent();this.expireVirtualTiles();var f=this.map.getProjectionObject(),g=new ALKMaps.Projection("EPSG:4326"),e=e.transform(f,g),d=ALKMaps.Util.getQkeysFromBounds(e,d,this.minZoomLevel);
this._drawFromCachedData(d);this._drawFromServiceData(d);var h=this;h._timeoutId=window.setInterval(function(){0===h._requestCounter&&(window.clearTimeout(h._timeoutId),h.removeAllFeatures(),h.clusterStrategy.clearCache(),h.addFeatures(h._featuresDrawn))},100)}},updateCameraMetadataCache:function(a){var b=null;if(this._featuresDrawn)for(var c=0;c<this._featuresDrawn.length;c++){var d=this._featuresDrawn[c];if(d.attributes.publicId===a.PublicId){d.attributes.metaData=a;b=d;break}}return b},getCameraMetadataFromCache:function(a){var b=
null;if(this._featuresDrawn)for(var c=0;c<this._featuresDrawn.length;c++){var d=this._featuresDrawn[c];if(d.attributes.publicId===a){b=d;break}}return b},getCameraMetadata:function(a){a=a||{};if(null!=a.id){var b=this,c=b.getCameraMetadataFromCache(a.id);null!=c&&null!=c.attributes.metaData?"function"===typeof a.success&&a.success(c):ALKMaps.Services.getTrafficCameraMetadata({id:a.id,success:function(d){c=b.updateCameraMetadataCache(d);"function"===typeof a.success&&a.success(c)},failure:function(b){if("function"===
typeof a.failure)a.failure(b);else{var c="ERROR!";null!=b.responseText&&""!==b.responseText&&(c=JSON.parse(b.responseText)[0],c="Status: "+b.status+"\nStatus Text: "+b.statusText+"\nDescription: "+c.Description+"\n\nTo handle this issue without showing the popup window, add failure callback function to the method's options parameter.");alert(c)}}})}},getUrl:function(a){var a=a||{},b=a.res;return ALKMaps.RestServiceURL+"trafficCam/img?id="+a.id+"&res="+(0===b||"HalfJpeg"===b?0:2===b||"HugeJpeg"===
b?2:1)+"&authToken="+ALKMaps.Util.getApiKey(!0)},destroyFeatures:function(){if(null!=this.features&&0<this.features.length){var a=this.features.slice();null!=this.clusterStrategy&&Array.prototype.push.apply(a,this.clusterStrategy.features);null!=this.clusterStrategy&&this.clusterStrategy.clearCache();ALKMaps.Layer.VirtualTile.prototype.destroyFeatures.apply(this,arguments)}},onmouseover:function(a){if(a.cluster)for(var b=0;b<a.cluster.length&&!(4<=b);b++)a.layer.getCameraMetadata({id:a.cluster[b].attributes.publicId});
else null==a.style.graphicTitle&&null!=a.layer&&a.layer.getCameraMetadata({id:a.attributes.publicId,success:function(b){if(null!=a){if(null!=a.style)a.style.graphicTitle=b.attributes.metaData.Name;null!=a.layer&&a.layer.drawFeature(a,a.style)}}});return!1},onclick:function(a){var b=a.layer;if(a.cluster){for(var c=new ALKMaps.Bounds,d=0;d<a.cluster.length;d++)c.extend(a.cluster[d].lonlat);b.map.zoomToExtent(c)}else b.getCameraMetadata({id:a.attributes.publicId,success:function(c){var d=b.getUrl({id:a.attributes.publicId}),
g=c.attributes.metaData.Orientation,h=new ALKMaps.Size(360,300);null!=g?g="Traffic closest to the camera is travelling "+g.toLowerCase()+".":(g="",h=new ALKMaps.Size(360,290));var i=document.createElement("img");i.src=ALKMaps.Util.getImageLocation("loading.gif");var j=new ALKMaps.Popup.SimplePopup("loadingPopup",a.lonlat,h,"<div>"+c.attributes.metaData.Name+"<br>"+g+"</div><br>"+i.outerHTML,null,!0);b.map.addPopup(j,!0);var k=document.createElement("img");ALKMaps.Event.observe(k,"load",function(){ALKMaps.Event.stopObservingElement(k);
b.map.removePopup(j);j.destroy();m.show()});k.src=d;k.style.width="320px";k.style.height="240px";var m=new ALKMaps.Popup.SimplePopup("cameraPopup",a.lonlat,h,"<div>"+c.attributes.metaData.Name+"<br>"+g+"</div><br>"+k.outerHTML,null,!0);b.map.addPopup(m);m.hide()}});return!1},CLASS_NAME:"ALKMaps.Layer.TrafficCameras"});ALKMaps.Protocol.Script=ALKMaps.Class(ALKMaps.Protocol,{url:null,params:null,callback:null,callbackTemplate:"ALKMaps.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.pendingRequests={};ALKMaps.Protocol.prototype.initialize.apply(this,arguments);if(!this.format)this.format=new ALKMaps.Format.GeoJSON;if(!this.filterToParams&&ALKMaps.Format.QueryStringFilter){var b=new ALKMaps.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});
this.filterToParams=function(a,d){return b.write(a,d)}}},read:function(a){ALKMaps.Protocol.prototype.read.apply(this,arguments);a=ALKMaps.Util.applyDefaults(a,this.options);a.params=ALKMaps.Util.applyDefaults(a.params,this.options.params);if(a.filter&&this.filterToParams)a.params=this.filterToParams(a.filter,a.params);var b=new ALKMaps.Protocol.Response({requestType:"read"}),c=this.createRequest(a.url,a.params,ALKMaps.Function.bind(function(c){b.data=c;this.handleRead(b,a)},this));b.priv=c;return b},
createRequest:function(a,b,c){var c=ALKMaps.Protocol.Script.register(c),d=ALKMaps.String.format(this.callbackTemplate,{id:c}),b=ALKMaps.Util.extend({},b);b[this.callbackKey]=this.callbackPrefix+d;a=ALKMaps.Util.urlAppend(a,ALKMaps.Util.getParameterString(b));b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="ALKMaps_Protocol_Script_"+c;this.pendingRequests[b.id]=b;document.getElementsByTagName("head")[0].appendChild(b);return b},destroyRequest:function(a){ALKMaps.Protocol.Script.unregister(a.id.split("_").pop());
delete this.pendingRequests[a.id];a.parentNode&&a.parentNode.removeChild(a)},handleRead:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){if(b.callback)a.data?(a.features=this.parseFeatures(a.data),a.code=ALKMaps.Protocol.Response.SUCCESS):a.code=ALKMaps.Protocol.Response.FAILURE,this.destroyRequest(a.priv),b.callback.call(b.scope,a)},parseFeatures:function(a){return this.format.read(a)},abort:function(a){if(a)this.destroyRequest(a.priv);else for(var b in this.pendingRequests)this.destroyRequest(this.pendingRequests[b])},
destroy:function(){this.abort();delete this.params;delete this.format;ALKMaps.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"ALKMaps.Protocol.Script"});(function(){var a=ALKMaps.Protocol.Script,b=0;a.registry={};a.register=function(c){var d="c"+ ++b;a.registry[d]=function(){c.apply(this,arguments)};return d};a.unregister=function(b){delete a.registry[b]}})();ALKMaps.Control.MousePosition=ALKMaps.Class(ALKMaps.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate();ALKMaps.Control.prototype.destroy.apply(this,arguments)},activate:function(){return ALKMaps.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset),this.redraw(),
!0):!1},deactivate:function(){return ALKMaps.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.element)this.div.left="",this.div.top="",this.element=this.div;return this.div},redraw:function(a){var b;if(null==a)this.reset();else if(null==this.lastXy||Math.abs(a.xy.x-this.lastXy.x)>
this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity)this.lastXy=a.xy;else if(b=this.map.getLonLatFromPixel(a.xy))if(this.displayProjection&&b.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=a.xy,a=this.formatOutput(b),a!=this.element.innerHTML)this.element.innerHTML=a},reset:function(){if(null!=this.emptyString)this.element.innerHTML=this.emptyString},formatOutput:function(a){var b=parseInt(this.numDigits);return this.prefix+a.lon.toFixed(b)+this.separator+
a.lat.toFixed(b)+this.suffix},CLASS_NAME:"ALKMaps.Control.MousePosition"});ALKMaps.StopLocation=ALKMaps.Class(ALKMaps.Location,{id:null,isViaPoint:!1,sideOfStreetAdherence:null,initialize:function(a){a=a||{};ALKMaps.Location.prototype.initialize.apply(this,arguments);this.id=a.id;this.isViaPoint=a.isViaPoint;this.sideOfStreetAdherence=a.sideOfStreetAdherence},clone:function(){var a=ALKMaps.Util.extend({},this);return new ALKMaps.StopLocation(a)},CLASS_NAME:"ALKMaps.StopLocation"});ALKMaps.StopLocation.fromLonLat=function(a){a=a||{};return new ALKMaps.StopLocation({lonLat:a})};
ALKMaps.StopLocation.fromLonLats=function(a,b){var c=[];if(ALKMaps.Util.isArray(a)&&0<a.length)for(var d=0;d<a.length;d++){var e=ALKMaps.StopLocation.fromLonLat(a[d],b);c.push(e)}return c};
ALKMaps.StopLocation.fromWS_StopLocation=function(a){var b=new ALKMaps.Address({streetAddress:a.StreetAddress,city:a.City,state:a.State,zip:a.Zip,country:a.Country}),c;if(null!=a.Coords){c=a.Coords.Lon;var d=a.Coords.Lat;"number"!==typeof c&&(c=parseFloat(c));"number"!==typeof d&&(d=parseFloat(d));c=new ALKMaps.Lonlat(c,d)}return new ALKMaps.StopLocation({id:a.ID||a.id||a.Id||null,isViaPoint:null!=a.IsViaPoint?a.IsViaPoint:null!=a.isViaPoint?a.isViaPoint:!1,sideOfStreetAdherence:a.SideOfStreetAdherence||
a.sideOfStreetAdherence,address:b,lonLat:c,label:a.Label||a.label||null})};
ALKMaps.StopLocation.parseJson=function(a){var b=[];"string"===typeof a&&(a=JSON.parse(a));if("object"!==typeof a)return b;ALKMaps.Util.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=a[c],e=null;if(d instanceof ALKMaps.WS_StopLocation)e=ALKMaps.StopLocation.fromWS_StopLocation(d);else{e=null;if(null!=d.Address)e=d.Address,e=new ALKMaps.Address({streetAddress:e.StreetAddress,city:e.City,state:e.State,zip:e.Zip,country:e.Country});else if(null!=d.address)e=d.address,e=new ALKMaps.Address({streetAddress:e.streetAddress,
city:e.city,state:e.state,zip:e.zip,country:e.country});var f=null,g=null;if(null!=d.Coords)f=d.Coords.Lon,g=d.Coords.Lat;else if(null!=d.lonLat)f=d.lonLat.lon,g=d.lonLat.lat;"number"!==typeof f&&(f=parseFloat(f));"number"!==typeof g&&(g=parseFloat(g));var h=null;null!=f&&null!=g&&(h=new ALKMaps.LonLat(f,g));e=new ALKMaps.StopLocation({id:d.ID||d.id||d.Id||null,isViaPoint:null!=d.IsViaPoint?d.IsViaPoint:d.isViaPoint,sideOfStreetAdherence:d.SideOfStreetAdherence||d.sideOfStreetAdherence,address:e,
lonLat:h,label:d.Label||d.label||null})}null!==e&&b.push(e)}return b};ALKMaps.Control.NavigationHistory=ALKMaps.Class(ALKMaps.Control,{type:ALKMaps.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,[a]);this.registry=ALKMaps.Util.extend({moveend:this.getState},this.registry);a={trigger:ALKMaps.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+
" "+this.displayClass+"Previous",title:ALKMaps.i18n("prevMapView")};ALKMaps.Util.extend(a,this.previousOptions);this.previous=new ALKMaps.Control.Button(a);a={trigger:ALKMaps.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next",title:ALKMaps.i18n("nextMapView")};ALKMaps.Util.extend(a,this.nextOptions);this.next=new ALKMaps.Control.Button(a);this.clear()},onPreviousChange:function(a){a&&!this.previous.active?this.previous.activate():!a&&this.previous.active&&
this.previous.deactivate()},onNextChange:function(a){a&&!this.next.active?this.next.activate():!a&&this.next.active&&this.next.deactivate()},destroy:function(){ALKMaps.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var a in this)this[a]=null},setMap:function(a){this.map=a;this.next.setMap(a);this.previous.setMap(a)},draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var a=
this.previousStack.shift(),b=this.previousStack.shift();void 0!=b?(this.nextStack.unshift(a),this.previousStack.unshift(b),this.restoring=!0,this.restore(b),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(a);return b},nextTrigger:function(){var a=this.nextStack.shift();if(void 0!=a)this.previousStack.unshift(a),this.restoring=!0,this.restore(a),this.restoring=!1,this.onNextChange(this.nextStack[0],
this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);return a},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(a){var b,c;if(this.map.getProjectionObject()==
a.projection)c=this.map.getZoomForResolution(a.resolution),b=a.center;else{b=a.center.clone();b.transform(a.projection,this.map.getProjectionObject());c=a.units;var d=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;c=this.map.getZoomForResolution((c&&d?ALKMaps.INCHES_PER_UNIT[c]/ALKMaps.INCHES_PER_UNIT[d]:1)*a.resolution)}this.map.setCenter(b,c)},setListeners:function(){this.listeners={};for(var a in this.registry)this.listeners[a]=ALKMaps.Function.bind(function(){if(!this.restoring){this.previousStack.unshift(this.registry[a].apply(this,
arguments));if(1<this.previousStack.length)this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);this.previousStack.length>this.limit+1&&this.previousStack.pop();if(0<this.nextStack.length)this.nextStack=[],this.onNextChange(null,0)}return!0},this)},activate:function(){var a=!1;if(this.map&&ALKMaps.Control.prototype.activate.apply(this)){null==this.listeners&&this.setListeners();for(var b in this.listeners)this.map.events.register(b,this,this.listeners[b]);a=!0;0==this.previousStack.length&&
this.initStack()}return a},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var a=!1;if(this.map&&ALKMaps.Control.prototype.deactivate.apply(this)){for(var b in this.listeners)this.map.events.unregister(b,this,this.listeners[b]);this.clearOnDeactivate&&this.clear();a=!0}return a},CLASS_NAME:"ALKMaps.Control.NavigationHistory"});ALKMaps.Control.Split=ALKMaps.Class(ALKMaps.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.source&&this.setSource(this.options.source)},setSource:function(a){this.active?(this.deactivate(),this.handler&&(this.handler.destroy(),delete this.handler),this.source=a,this.activate()):this.source=a},
activate:function(){var a=ALKMaps.Control.prototype.activate.call(this);if(a)if(this.source){if(this.source.events)this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}else{if(!this.handler)this.handler=new ALKMaps.Handler.Path(this,{done:function(a){this.onSketchComplete({feature:new ALKMaps.Feature.Vector(a)})}},{layerOptions:this.sourceOptions});this.handler.activate()}return a},deactivate:function(){var a=ALKMaps.Control.prototype.deactivate.call(this);
a&&this.source&&this.source.events&&this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});return a},onSketchComplete:function(a){this.feature=null;return!this.considerSplit(a.feature)},afterFeatureModified:function(a){if(a.modified&&"function"===typeof a.feature.geometry.split)this.feature=a.feature,this.considerSplit(a.feature)},removeByGeometry:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c].geometry===b){a.splice(c,1);break}},
isEligible:function(a){return a.geometry?a.state!==ALKMaps.State.DELETE&&"function"===typeof a.geometry.split&&this.feature!==a&&(!this.targetFilter||this.targetFilter.evaluate(a.attributes)):!1},considerSplit:function(a){var b=!1,c=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(a.attributes)){for(var d=this.layer&&this.layer.features||[],e,f,g=[],h=[],i=this.layer===this.source&&this.mutual,j={edge:this.edge,tolerance:this.tolerance,mutual:i},k=[a.geometry],m,l,p,n=0,q=d.length;n<q;++n)if(m=
d[n],this.isEligible(m)){l=[m.geometry];for(var o=0;o<k.length;++o){p=k[o];for(var r=0;r<l.length;++r)if(e=l[r],p.getBounds().intersectsBounds(e.getBounds())&&(e=p.split(e,j)))f=this.events.triggerEvent("beforesplit",{source:a,target:m}),!1!==f&&(i&&(f=e[0],1<f.length&&(f.unshift(o,1),Array.prototype.splice.apply(k,f),o+=f.length-3),e=e[1]),1<e.length&&(e.unshift(r,1),Array.prototype.splice.apply(l,e),r+=e.length-3))}l&&1<l.length&&(this.geomsToFeatures(m,l),this.events.triggerEvent("split",{original:m,
features:l}),Array.prototype.push.apply(g,l),h.push(m),c=!0)}k&&1<k.length&&(this.geomsToFeatures(a,k),this.events.triggerEvent("split",{original:a,features:k}),Array.prototype.push.apply(g,k),h.push(a),b=!0);if(b||c){if(this.deferDelete){d=[];n=0;for(q=h.length;n<q;++n)c=h[n],c.state===ALKMaps.State.INSERT?d.push(c):(c.state=ALKMaps.State.DELETE,this.layer.drawFeature(c));this.layer.destroyFeatures(d,{silent:!0});n=0;for(q=g.length;n<q;++n)g[n].state=ALKMaps.State.INSERT}else this.layer.destroyFeatures(h,
{silent:!0});this.layer.addFeatures(g,{silent:!0});this.events.triggerEvent("aftersplit",{source:a,features:g})}}return b},geomsToFeatures:function(a,b){var c=a.clone();delete c.geometry;for(var d,e=0,f=b.length;e<f;++e)d=c.clone(),d.geometry=b[e],d.state=ALKMaps.State.INSERT,b[e]=d},destroy:function(){this.active&&this.deactivate();ALKMaps.Control.prototype.destroy.call(this)},CLASS_NAME:"ALKMaps.Control.Split"});(function(a){if(a){var b=a.ALKMaps.Control;b.WeatherAlertOption=a.Control.extend({_ddlElements:[{id:"severity",label:"Severity",texts:"All,Extreme,Severe,Moderate,Minor,Unknown".split(","),values:"All,Extreme,Severe,Moderate,Minor,Unknown".split(",")},{id:"urgency",label:"Urgency",texts:"All,Immediate,Expected,Future,Past,Unknown".split(","),values:"All,Immediate,Expected,Future,Past,Unknown".split(",")},{id:"certainty",label:"Certainty",texts:"All,Observed,Likely (>50%),Possible (<=50%),Unlikely (0),Unknown".split(","),
values:"All,Observed,Likely,Possible,Unlikely,Unknown".split(",")}],initialize:function(b){a.Control.prototype.initialize.call(this,b)},_onSelectionChange:function(){var a=this.self,b=this.selectList,e=a.options.layer.getAlertFilters();if("option_selectList_severity"===b.id)e.severity=b.value;if("option_selectList_urgency"===b.id)e.urgency=b.value;if("option_selectList_certainty"===b.id)e.certainty=b.value;a.options.layer.setAlertFilters(e);a.options.layer.redraw()},_getAlerts:function(){null!=this.options.layer&&
this.options.layer.addAlerts()},_addSelectionLists:function(b){for(var d=0;d<this._ddlElements.length;d++){var e=a.DomUtil.create("div","",b),f=a.DomUtil.create("label","",e),g=this._ddlElements[d];f.innerHTML=g.label;e=a.DomUtil.create("select","",e);e.id="option_selectList_"+g.id;for(f=0;f<g.values.length;f++){var h=a.DomUtil.create("option");h.value=g.values[f];h.text=g.texts[f];e.appendChild(h)}a.DomEvent.on(e,"change",this._onSelectionChange,{selectList:e,self:this})}b=a.DomUtil.create("div",
"button",b);a.DomUtil.create("label","",b).innerHTML="&nbsp;";b=a.DomUtil.create("input","olButton",b);b.type="button";b.value="Get Alerts";a.DomEvent.on(b,"click",this._getAlerts,this)},_getSelectedIndex:function(a,b){for(var e=this.options.layer.getAlertFilters()[a],f=0,g=0;g<b.length;g++)b[g]===e&&(f=g);return f},_updateSelectLists:function(){for(var b=0;b<this._ddlElements.length;b++){var d=this._ddlElements[b];a.DomUtil.get("option_selectList_"+d.id).selectedIndex=this._getSelectedIndex(d.id,
d.values)}},onAdd:function(b){this._map=b;var d=a.DomUtil.create("div","alkmaps-controlWeatherAlertOption"),b=a.DomUtil.create("div","alkmaps-controlWeatherAlertOption-header",d);a.DomUtil.create("h3","title",b).innerText="Options";b=a.DomUtil.create("div","alkmaps-controlWeatherAlertOption-body",d);d.style.display="none";a.DomEvent.on(d,"click",function(){});a.DomEvent.disableClickPropagation(d);this._addSelectionLists(b);if(null!=this.options.layer){var e=this;this.options.layer.on("weatherAlertsAdded",
function(){e._updateSelectLists();d.style.display=""})}return d},onRemove:function(){},CLASS_NAME:"ALKMaps.Control.WeatherAlertOption"});b.weatherAlertOption=function(a){return new b.WeatherAlertOption(a)}}})("undefined"===typeof L?null:L);ALKMaps.Strategy.Refresh=ALKMaps.Class(ALKMaps.Strategy,{force:!1,interval:0,timer:null,activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);a&&(!0===this.layer.visibility&&this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this}));return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&this.stop();return a},reset:function(){!0===this.layer.visibility?this.start():this.stop()},start:function(){if(this.interval&&"number"===typeof this.interval&&
0<this.interval)this.timer=window.setInterval(ALKMaps.Function.bind(this.refresh,this),this.interval)},refresh:function(){this.layer&&this.layer.refresh&&"function"==typeof this.layer.refresh&&this.layer.refresh({force:this.force})},stop:function(){if(null!==this.timer)window.clearInterval(this.timer),this.timer=null},CLASS_NAME:"ALKMaps.Strategy.Refresh"});(function(a){if(a&&a.MarkerClusterGroup){var b=a.ALKMaps.Layer;b.TrafficIncidents=a.MarkerClusterGroup.extend({_cacheStrategy:null,_layersDrawn:[],options:{language:"en",minZoom:8,maxZoom:20,maxClusterRadius:30,showCoverageOnHover:!1,disableClusteringAtZoom:14,iconCreateFunction:null,chunkedLoading:!0,chunkProgress:null},_drawLayerGroup:function(b,d){return a.geoJSON(b,{pointToLayer:function(b,c){if(b&&b.properties){var g=d._getIcon(b.properties[0].trafficItemTypeDesc||b.properties[0].abbreviation.description);
return a.marker(c,{icon:g})}},onEachFeature:function(a,b){if(a&&a.properties){var c=d._describeIncident(a.properties[0].trafficItemDescription);null!=c&&("object"===typeof c?b.bindPopup(c.content,c.options):b.bindPopup(c));c=d._describeIncidentTooltip(a.properties[0].abbreviation);null!=c&&b.bindTooltip(c.tooltipText,c.options)}}})},_clearLayerGroup:function(a,b){for(var e=b._layersDrawn.length-1;0<=e;e--)if(null==a||a===b._layersDrawn[e].qKey)b.removeLayer(b._layersDrawn[e].custData),b._layersDrawn.splice(e,
1)},_successCB:function(a,b,e){!0===b&&e._cacheStrategy.updateVirtualTile(a.requestId,a);e.options.successCB&&!1===e.options.successCB(a,e)||(e._clearLayerGroup(a.requestId,e),b=e._drawLayerGroup(a.trafficIncidentFeatureCollection.features,e),e.addLayer(b),e._layersDrawn.push({qKey:a.requestId,custData:b}))},_failureCB:function(a,b){if(b.options.failureCB)return b.options.failureCB(b,a)},_getMapBounds:function(){var a=this._map.getBounds(),b=this._normalizeBounds([a._southWest.lng,a._southWest.lat,
a._northEast.lng,a._northEast.lat]);a._southWest.lng=b[0];a._southWest.lat=b[1];a._northEast.lng=b[2];a._northEast.lat=b[3];return a},_drawFromCachedData:function(a){for(var a=this._cacheStrategy.getCachedTileQkeys(a),b=[],e=0;e<this._layersDrawn.length;e++)b.push(this._layersDrawn[e].qKey);for(e=0;e<a.length;e++)this._successCB(this._cacheStrategy.getCachedVirtualTile(a[e]).data,!1,this)},_drawFromServiceData:function(b){for(var d=this,b=this._cacheStrategy.getVirtualBounds(b),e=0;e<b.length;e++){var f=
b[e],g=f.bounds;a.ALKMaps.Services.getTrafficIncidentsBBox({requestId:f.qKey,bbox:[g._southWest.lng,g._southWest.lat,g._northEast.lng,g._northEast.lat],language:d.options.language,success:function(a){0<a.trafficIncidentFeatureCollection.features.length&&d._successCB(a,!0,d)},failure:function(a){d._failureCB(a,d)}})}},_update:function(){if(this._map){var b=this._map.getZoom();if(b<this.options.minZoom||b>this.options.maxZoom)this._clearLayerGroup(null,this);else{var d=this._getMapBounds();this._cacheStrategy.expireVirtualTiles();
b=a.ALKMaps.Util.getQkeysFromBounds({right:d._northEast.lng,top:d._northEast.lat,left:d._southWest.lng,bottom:d._southWest.lat},b,this._cacheStrategy.options.detailLevel);this._drawFromCachedData(b);this._drawFromServiceData(b)}}},_updateProgressBar:function(){},initialize:function(b){L.Util.setOptions(this,b);if(!this.options.iconCreateFunction)this.options.iconCreateFunction=this._customIconCreateFunction;if(!this.options.chunkProgress)this.options.chunkProgress=this._updateProgressBar;if(null!=
b&&8>b.minZoom)b.minZoom=8,console.log("options.minZoom can't be less than 8. Set 8 for you.");L.MarkerClusterGroup.prototype.initialize.call(this,b);this._cacheStrategy=a.ALKMaps.Util.virtualTile({detailLevel:8,cacheInterval:5});this._layersDrawn=[]},onAdd:function(b){a.MarkerClusterGroup.prototype.onAdd.call(this,b);this._update();b.on("zoomend",this._update,this);b.on("moveend",this._update,this)},onRemove:function(b){b.off("zoomend",this._update,this);b.off("moveend",this._update,this);a.MarkerClusterGroup.prototype.onRemove.call(this,
b)},_normalizeBounds:function(b){b[0]=a.ALKMaps.Util.wrapLongitude(b[0]);b[2]=a.ALKMaps.Util.wrapLongitude(b[2]);return b},_customIconCreateFunction:function(a){var a=a.getChildCount(),b;10>a?(a=[12,12],b=[6,6]):100>a?(a=[16,16],b=[8,8]):(a=[24,24],b=[12,12]);return L.icon({iconUrl:ALKMaps.IMAGE.GROUP,iconSize:a,iconAnchor:b})},_describeIncident:function(a){if(this.options.describeIncidentPopup&&"function"===typeof this.options.describeIncidentPopup)return this.options.describeIncidentPopup(a);for(var b=
null,e=null,f=0;f<a.length;f++){var g=a[f];if("short_desc"===g.type)b=g.content;if("desc"===g.type)e=g.content}return!e?'<div style="font-size:12px">'+b+"</div>":'<div style="font-size:12px">'+e+"</div>"},_describeIncidentTooltip:function(a){return this.options.describeIncidentTooltip?this.options.describeIncidentTooltip(a):{tooltipText:a.description||a.shortDesc,options:{direction:"right",offset:L.point(12,2)}}},_getIcon:function(a){switch((a||"").toUpperCase()){case "TRAFFIC":case "CONGESTION":a=
ALKMaps.IMAGE.TRAFFIC_MAP_TRAFFICJAM;break;case "ACCIDENT":case "DISABLEDVEHICLE":a=ALKMaps.IMAGE.TRAFFIC_MAP_ACCIDENT;break;case "WEATHER":a=ALKMaps.IMAGE.TRAFFIC_MAP_WEATHER;break;case "ROADWORKS":case "CONSTRUCTION":case "ROADCLOSURE":a=ALKMaps.IMAGE.TRAFFIC_MAP_CONSTRUCTION;break;default:a=ALKMaps.IMAGE.TRAFFIC_MAP_INCIDENT}return L.icon({iconUrl:a,iconSize:[26,26],iconAnchor:[13,13],popupAnchor:[0,-16]})},CLASS_NAME:"ALKMaps.Layer.TrafficIncidents"});b.trafficIncidents=function(a){return new b.TrafficIncidents(a)}}})("undefined"===
typeof L?null:L);ALKMaps.Strategy.BBOX=ALKMaps.Class(ALKMaps.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update());return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this});
return a},update:function(a){var b=this.getMapBounds();if(null!==b&&(a&&a.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(b)))this.calculateBounds(b),this.resolution=this.layer.map.getResolution(),this.triggerRead(a)},getMapBounds:function(){if(null===this.layer.map)return null;var a=this.layer.map.getExtent();a&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));return a},
invalidBounds:function(a){a||(a=this.getMapBounds());a=!this.bounds||!this.bounds.containsBounds(a);!a&&this.resFactor&&(a=this.resolution/this.layer.map.getResolution(),a=a>=this.resFactor||a<=1/this.resFactor);return a},calculateBounds:function(a){a||(a=this.getMapBounds());var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio;this.bounds=new ALKMaps.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2)},triggerRead:function(a){this.response&&!(a&&!0===a.noAbort)&&(this.layer.protocol.abort(this.response),
this.layer.events.triggerEvent("loadend"));this.layer.events.triggerEvent("loadstart");this.response=this.layer.protocol.read(ALKMaps.Util.applyDefaults({filter:this.createFilter(),callback:this.merge,scope:this},a))},createFilter:function(){var a=new ALKMaps.Filter.Spatial({type:ALKMaps.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(a=new ALKMaps.Filter.Logical({type:ALKMaps.Filter.Logical.AND,filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();
if((a=a.features)&&0<a.length){var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b))for(var d,e=0,f=a.length;e<f;++e)(d=a[e].geometry)&&d.transform(b,c);this.layer.addFeatures(a)}this.response=null;this.layer.events.triggerEvent("loadend")},CLASS_NAME:"ALKMaps.Strategy.BBOX"});(function(a){if(a){var b=a.ALKMaps.Control;b.SingleSearch=a.Control.extend({POI_ICONS:ALKMaps.POI_ICONS,_doneTypingInterval:700,_doneTypingImmediate:!1,_placeholderText:"Address ...",_minSearchTextLength:3,DEFAULT_SEARCH_OPTION:{region:"NA",maxResults:20},_searchOption:{},_locationRelevance:null,_hideResults:!1,_markerGroup:null,_markerStyle:{iconUrl:null,iconSize:[26,26],iconAnchor:[13,13],popupAnchor:[0,-13]},_markerConfig:{exclusive:!0,centerOnMap:!0,zoomLevel:12},_popupConfig:{show:!0,closeButton:!1},
_displaySystem:"metric",_resultsListElement:null,_deviceLocation:null,_resultTypes:null,_searchCompleted:function(b){this._resultsListElement.innerHTML="";if(0<b.Locations.length){for(var d=0;d<b.Locations.length;d++)this._resultsListElement.appendChild(this._createResultElement(b.Locations[d]));a.ALKMaps.Util.showElement(this._resultsListElement,"hide","show")}else a.ALKMaps.Util.hideElement(this._resultsListElement,"show","hide")},_searchFailed:function(){alert("Search failed.")},_geolocate:function(b){this._deviceLocation=
a.latLng(b.coords.latitude,b.coords.longitude)},_geolocateFailure:function(){this._deviceLocation=null},_getMapViewCenter:function(){var a=null;this._map&&(a=this._map.getCenter());return a},_getCurrentLocation:function(){var a=null!=this._searchOption?this._searchOption.currentLonLat:null;if(null==a)"device"===this._locationRelevance?a=this._deviceLocation:"mapCenter"===this._locationRelevance&&(a=this._getMapViewCenter());return a},_onDoneTyping:function(){var b=this.context,d=a.Util.extend({},
b.DEFAULT_SEARCH_OPTION);a.Util.extend(d,b._searchOption);var e=this.searchBoxInput.value;if(null!=d.query)e=d.query;if(!(null==e||e.length<=b._minSearchTextLength)){e={query:e};if(null!=d.maxResults)e.maxResults=d.maxResults;var f=b._getCurrentLocation.apply(b,[]);if(null!=f)e.currentLonLat=f;if(null!=d.excludedSearchTypes)e.excludedSearchTypes=d.excludedSearchTypes;if(null!=d.poiCategories)e.poiCategories=d.poiCategories;if(null!=d.countries)e.countries=d.countries;if(null!=d.countryType)e.countryType=
d.countryType;if(null!=d.states)e.states=d.states;if(null!=d.region)e.region=d.region;if(!1===d.async)e.async=d.async;f=a.Util.bind(b._searchCompleted,b);if("function"===typeof d.success)f=d.success;b=a.Util.bind(b._searchFailed,b);if("function"===typeof d.failure)b=d.failure;e.success=f;e.failure=b;a.ALKMaps.Services.singleSearch(e)}},_debounce:function(a,b,e){var f;return function(){var g=this,h=arguments,i=e&&!f;clearTimeout(f);f=setTimeout(function(){f=null;e||a.apply(g,h)},b);i&&a.apply(g,h)}},
_onKeyup:function(a){13===a.keyCode&&""!==this._resultsListElement.innerHTML&&this._resultsListElement.children[0].children[0].focus()},_getControlHtmlContent:function(){var b=this._debounce(this._onDoneTyping,this._doneTypingInterval,this._doneTypingImmediate),d=a.DomUtil.create("div");d.id="controlContainer";var e=a.DomUtil.create("div","alkmaps-geo-panel alkmaps-geo-panel-position alkmaps-geo-wide",d);e.style.position="absolute";var f=a.DomUtil.create("div","",e),f=a.DomUtil.create("div","alkmaps-geo-row",
f),f=a.DomUtil.create("input","alkmaps-input-sm alkmaps-geo-input alkmaps-geo-address",f);f.placeholder=this._placeholderText;a.DomEvent.on(f,"input",b,{context:this,searchBoxInput:f});a.DomEvent.on(f,"keyup",this._onKeyup,this);b=a.DomUtil.create("div",null,e);b=a.DomUtil.create("div",null,b);this._resultsListElement=a.DomUtil.create("ul","alkmaps-geo-resultsList hide",b);return d},setSearchOption:function(a,b){"query"!==a&&"maxResults"!==a&&"currentLonLat"!==a&&"excludedSearchTypes"!==a&&"poiCategories"!==
a&&"countries"!==a&&"countryType"!==a&&"states"!==a&&"region"!==a&&"async"!==a&&"success"!==a&&"failure"!==a?alert("'"+a+"' is not a valid key."):this._searchOption[a]=b},setMarkerStyle:function(a,b){"iconUrl"!==a&&"iconSize"!==a&&"iconAnchor"!==a&&"popupAnchor"!==a?alert("'"+a+"' is not a valid key."):this._markerStyle[a]=b},setMarkerConfig:function(a,b){"exclusive"!==a&&"centerOnMap"!==a&&"zoomLevel"!==a?alert("'"+a+"' is not a valid key."):this._markerConfig[a]=b},setPopupConfig:function(a,b){"show"!==
a&&"closeButton"!==a?alert("'"+a+"' is not a valid key."):this._popupConfig[a]=b},_getIconImage:function(a){var b=this._resultTypes[a.ResultType];if("POI"!==b&&"POIType"!==b)return ALKMaps.Util.getImageLocation("cat_poi_address_2d.png");for(var b=null,e=0;e<this.POI_ICONS.length;e++){var f=this.POI_ICONS[e];if(f.ID===a.POITypeID){b=f;break}}return null==b||b.PremiumImage?ALKMaps.Util.getImageLocation("cat_poi_other_2d.png"):ALKMaps.Util.getImageLocation("cat_poi_"+b.BMPName+"_2d.png")},_createResultsIcon:function(b){var d=
a.DomUtil.create("div","results-icon");a.DomUtil.create("img",null,d).src=this._getIconImage(b);return d},_createResultsAddress:function(b,d){var e=a.DomUtil.create("div","results-address");(null!=d?a.DomUtil.create("span","results-"+d+"-text",e):a.DomUtil.create("span","results-text",e)).innerHTML=b;return e},_createResultsCity:function(b){var d=a.DomUtil.create("div","results-city");a.DomUtil.create("span","results-text",d).innerHTML=b;return d},_createResultsLonLat:function(b){var d=a.DomUtil.create("div",
"results-city");a.DomUtil.create("span",null,d).innerHTML=b.Coords.Lat;a.DomUtil.create("span",null,d).innerHTML=", ";a.DomUtil.create("span",null,d).innerHTML=b.Coords.Lon;var e=a.DomUtil.create("span",null,d),f=this._getCurrentLocation();if(null!=f)f=a.ALKMaps.Util.distVincenty({lon:f.lng,lat:f.lat},{lon:b.Coords.Lon,lat:b.Coords.Lat}),e.innerHTML="english"===this._displaySystem?"("+(0.621371*f).toFixed(2)+" mi.)":"("+f.toFixed(2)+" km.)";e=a.DomUtil.create("span","label-position",d);e=a.DomUtil.create("span",
"label label-warning",e);e=a.DomUtil.create("span",null,e);if(null!=this._resultTypes)e.innerHTML=this._resultTypes[b.ResultType];return d},_regionalInformation:function(a){var b=null!==a.Address.City&&""!=a.Address.City?a.Address.City+", ":"",e=null!==a.Address.Zip&&""!==a.Address.Zip?" "+a.Address.Zip:"",f=null!==a.Address.County&&""!==a.Address.County?", "+a.Address.County:"";return 4==a.Region||5==a.Region?b+a.Address.State+e:b+a.Address.Country+e+f},_formatAddressString:function(a,b){var e="";
null!=a.StreetAddress&&""!==a.StreetAddress&&(e+=a.StreetAddress+", ",e+=b?"<br />":"");null!=a.City&&""!==a.City&&(e+=a.City+", ");return e+=a.State+" "+a.Zip},_processResponseItem:function(b){var d=a.latLng(b.Coords.Lat,b.Coords.Lon),e=this._getIconImage(b),f=a.Util.extend({},this._markerStyle);if(null==this._markerStyle.iconUrl||""===this._markerStyle.iconUrl)f.iconUrl=e;f=a.icon(f);this._markerConfig.exclusive&&this._markerGroup.clearLayers();e=this._formatAddressString(b.Address,!0);b=a.marker([b.Coords.Lat,
b.Coords.Lon],{icon:f}).addTo(this._markerGroup);this._popupConfig.show&&b.bindPopup(e,{closeButton:this._popupConfig.closeButton}).openPopup();this._markerConfig.centerOnMap&&this._map.setView(d,this._markerConfig.zoomLevel)},_createResultElement:function(b){var d=a.DomUtil.create("li","results-item"),e=a.DomUtil.create("a","",d);e.href="#";e.setAttribute("tabindex","0");var f=this._createResultsIcon(b);e.appendChild(f);f=this._resultTypes[b.ResultType];if("POI"===f||"POIType"===f){var f=this._createResultsAddress(b.ShortString,
"poi"),g=this._createResultsAddress(b.Address.StreetAddress),h=this._createResultsCity(this._regionalInformation(b));e.appendChild(f);e.appendChild(g);e.appendChild(h)}else f=this._createResultsAddress(b.ShortString),e.appendChild(f);f=this._createResultsLonLat(b);e.appendChild(f);var i=this;a.ALKMaps.Util.addEventHelper(e,"keydown",function(d){40===d.keyCode&&null!=d.target.parentElement.nextElementSibling&&d.target.parentElement.nextElementSibling.children[0].focus();38===d.keyCode&&null!=d.target.parentElement.previousElementSibling&&
d.target.parentElement.previousElementSibling.children[0].focus();13===d.keyCode&&(i._processResponseItem(b),i._hideResults&&a.ALKMaps.Util.hideElement(i._resultsListElement,"show","hide"));27===d.keyCode&&a.ALKMaps.Util.hideElement(i._resultsListElement,"show","hide")});a.ALKMaps.Util.addEventHelper(e,"mousedown",function(){i._processResponseItem(b)});a.ALKMaps.Util.addEventHelper(e,"blur",function(){});a.ALKMaps.Util.addEventHelper(e,"focus",function(){});return d},initialize:function(b){b=b||{};
a.Util.setOptions(this,b);var d=b.searchOption,e;for(e in b.searchOption)this.setSearchOption(e,d[e]);d=b.markerStyle;for(e in d)this.setMarkerStyle(e,d[e]);d=b.markerConfig;for(e in d)this.setMarkerConfig(e,d[e]);b=b.popupConfig;for(e in b)this.setPopupConfig(e,b[e]);(e=navigator.geolocation)&&e.watchPosition(a.Util.bind(this._geolocate,this),a.Util.bind(this._geolocateFailure,this),null);var f=this;try{a.ALKMaps.Services.singleSearchGet({query:"resultTypes",region:"ww",async:!0,success:function(a){f._resultTypes=
a.ResultTypes}})}catch(g){}},onAdd:function(b){this._map=b;var d=this._getControlHtmlContent();this._markerGroup=a.layerGroup().addTo(b);a.DomEvent.on(d,"click",function(){});a.DomEvent.disableClickPropagation(d);return d},onRemove:function(){this._resultTypes=this._markerGroup=this._map=null},CLASS_NAME:"ALKMaps.Control.SingleSearch"});b.singleSearch=function(a){return new b.SingleSearch(a)}}})("undefined"===typeof L?null:L);ALKMaps.Protocol.HTTP=ALKMaps.Class(ALKMaps.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,excludeAuthInfo:!1,initialize:function(a){a=a||{};this.params={};this.headers={};ALKMaps.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&ALKMaps.Format.QueryStringFilter){var b=new ALKMaps.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=
function(a,d){return b.write(a,d)}}},destroy:function(){this.headers=this.params=null;ALKMaps.Protocol.prototype.destroy.apply(this)},read:function(a){ALKMaps.Protocol.prototype.read.apply(this,arguments);a=a||{};a.params=ALKMaps.Util.applyDefaults(a.params,this.options.params);a=ALKMaps.Util.applyDefaults(a,this.options);if(a.filter&&this.filterToParams)a.params=this.filterToParams(a.filter,a.params);var b=void 0!==a.readWithPOST?a.readWithPOST:this.readWithPOST,c=new ALKMaps.Protocol.Response({requestType:"read"});
b?(b=a.headers||{},b["Content-Type"]="application/x-www-form-urlencoded",c.priv=ALKMaps.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:ALKMaps.Util.getParameterString(a.params),headers:b,excludeAuthInfo:this.excludeAuthInfo})):c.priv=ALKMaps.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers,excludeAuthInfo:this.excludeAuthInfo});return c},handleRead:function(a,b){this.handleResponse(a,b)},create:function(a,b){var b=
ALKMaps.Util.applyDefaults(b,this.options),c=new ALKMaps.Protocol.Response({reqFeatures:a,requestType:"create"});c.priv=ALKMaps.Request.POST({url:b.url,callback:this.createCallback(this.handleCreate,c,b),headers:b.headers,data:this.format.write(a)});return c},handleCreate:function(a,b){this.handleResponse(a,b)},update:function(a,b){var b=b||{},c=b.url||a.url||this.options.url+"/"+a.fid,b=ALKMaps.Util.applyDefaults(b,this.options),d=new ALKMaps.Protocol.Response({reqFeatures:a,requestType:"update"});
d.priv=ALKMaps.Request[this.updateWithPOST?"POST":"PUT"]({url:c,callback:this.createCallback(this.handleUpdate,d,b),headers:b.headers,data:this.format.write(a)});return d},handleUpdate:function(a,b){this.handleResponse(a,b)},"delete":function(a,b){var b=b||{},c=b.url||a.url||this.options.url+"/"+a.fid,b=ALKMaps.Util.applyDefaults(b,this.options),d=new ALKMaps.Protocol.Response({reqFeatures:a,requestType:"delete"}),e=this.deleteWithPOST?"POST":"DELETE",c={url:c,callback:this.createCallback(this.handleDelete,
d,b),headers:b.headers};if(this.deleteWithPOST)c.data=this.format.write(a);d.priv=ALKMaps.Request[e](c);return d},handleDelete:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){var c=a.priv;if(b.callback){if(200<=c.status&&300>c.status){if("delete"!=a.requestType)a.features=this.parseFeatures(c);a.code=ALKMaps.Protocol.Response.SUCCESS}else a.code=ALKMaps.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=
a.responseText;return!b||0>=b.length?null:this.format.read(b)},commit:function(a,b){function c(a){for(var b=a.features?a.features.length:0,c=Array(b),e=0;e<b;++e)c[e]=a.features[e].fid;n.insertIds=c;d.apply(this,[a])}function d(a){this.callUserCallback(a,b);p=p&&a.success();f++;if(f>=l&&b.callback)n.code=p?ALKMaps.Protocol.Response.SUCCESS:ALKMaps.Protocol.Response.FAILURE,b.callback.apply(b.scope,[n])}var b=ALKMaps.Util.applyDefaults(b,this.options),e=[],f=0,g={};g[ALKMaps.State.INSERT]=[];g[ALKMaps.State.UPDATE]=
[];g[ALKMaps.State.DELETE]=[];for(var h,i,j=[],k=0,m=a.length;k<m;++k)if(h=a[k],i=g[h.state])i.push(h),j.push(h);var l=(0<g[ALKMaps.State.INSERT].length?1:0)+g[ALKMaps.State.UPDATE].length+g[ALKMaps.State.DELETE].length,p=!0,n=new ALKMaps.Protocol.Response({reqFeatures:j});h=g[ALKMaps.State.INSERT];0<h.length&&e.push(this.create(h,ALKMaps.Util.applyDefaults({callback:c,scope:this},b.create)));h=g[ALKMaps.State.UPDATE];for(k=h.length-1;0<=k;--k)e.push(this.update(h[k],ALKMaps.Util.applyDefaults({callback:d,
scope:this},b.update)));h=g[ALKMaps.State.DELETE];for(k=h.length-1;0<=k;--k)e.push(this["delete"](h[k],ALKMaps.Util.applyDefaults({callback:d,scope:this},b["delete"])));return e},abort:function(a){a&&a.priv.abort()},callUserCallback:function(a,b){var c=b[a.requestType];c&&c.callback&&c.callback.call(c.scope,a)},CLASS_NAME:"ALKMaps.Protocol.HTTP"});ALKMaps.Strategy.Fixed=ALKMaps.Class(ALKMaps.Strategy,{preload:!1,activate:function(){if(ALKMaps.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this});if(!0==this.layer.visibility||this.preload)this.load();else this.layer.events.on({visibilitychanged:this.load,scope:this});return!0}return!1},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this});
return a},load:function(a){var b=this.layer;b.events.triggerEvent("loadstart");b.protocol.read(ALKMaps.Util.applyDefaults({callback:ALKMaps.Function.bind(this.merge,this,b.map.getProjectionObject()),filter:b.filter},a));b.events.un({visibilitychanged:this.load,scope:this})},merge:function(a,b){var c=this.layer;c.destroyFeatures();var d=b.features;if(d&&0<d.length){if(!a.equals(c.projection))for(var e,f=0,g=d.length;f<g;++f)(e=d[f].geometry)&&e.transform(c.projection,a);c.addFeatures(d)}c.events.triggerEvent("loadend")},
CLASS_NAME:"ALKMaps.Strategy.Fixed"});ALKMaps.Strategy.MarkerCluster=ALKMaps.Class(ALKMaps.Strategy,{distance:20,attribute:null,threshold:null,markers:null,clusters:null,clustering:!1,resolution:null,maxZoomLevel:null,displayClass:"olMarkerCluster",activate:function(){var a=ALKMaps.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforemarkersadded:this.cacheMarkers,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=ALKMaps.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforemarkersadded:this.cacheMarkers,
moveend:this.cluster,scope:this}));return a},cacheMarkers:function(a){var b=!0;if(!this.clustering)this.clearCache(),this.markers=a.markers,this.cluster(),b=!1;return b},clearCache:function(){this.markers=null},clusterIEHack:function(){var a=this.layer.map.getExtent(),b=1.2*this.distance*this.resolution,c=new ALKMaps.Bounds(a.left-b,a.bottom-b,a.right+b,a.top+b);this.clusters=null;for(var a=[],d,e,f,b=[],g=0;g<this.markers.length;++g)if(d=this.markers[g],d.lonlat)if(c.containsLonLat(d.lonlat)){e=
!1;for(var h=a.length-1;0<=h;--h)if(f=a[h],this.shouldCluster(f,d)){this.addToCluster(f,d);e=!0;break}e||a.push(this.createCluster(this.markers[g]))}else b.push(d);if(0<a.length){if(1<this.threshold){c=a.slice();a=[];g=0;for(e=c.length;g<e;++g)d=c[g],d.attributes.count<this.threshold?Array.prototype.push.apply(a,d.cluster):a.push(d)}this.clusters=[];0<a.length&&Array.prototype.push.apply(this.clusters,a);0<b.length&&Array.prototype.push.apply(this.clusters,b)}this.layer.clearMarkers();this.clustering=
!0;this.layer.addMarkersForClusterHack(a,b);this.clustering=!1},cluster:function(a){var b=ALKMaps.Util.getBrowserName();this.resolution=this.layer.map.getResolution();if(this.markers&&1500<this.markers.length&&7<this.layer.map.zoom&&("msie"===b||"msie11"===b||"msie12"===b))this.clusterIEHack();else if(this.markers&&(!a||a.zoomChanged)){this.clusters=null;this.resolution=this.layer.map.getResolution();for(var a=[],c,d,e,b=0;b<this.markers.length;++b)if(c=this.markers[b],c.lonlat){d=!1;for(var f=a.length-
1;0<=f;--f)if(e=a[f],this.shouldCluster(e,c)){this.addToCluster(e,c);d=!0;break}d||a.push(this.createCluster(this.markers[b]))}if(0<a.length){if(1<this.threshold){c=a.slice();a=[];b=0;for(e=c.length;b<e;++b)d=c[b],d.attributes.count<this.threshold?Array.prototype.push.apply(a,d.cluster):a.push(d)}this.clusters=a}}if(null!=this.clusters)a=this.splitClusterMarkers(this.clusters),this.layer.clearMarkers(),this.clustering=!0,this.layer.addMarkersForClusterHack(a.viewable,a.notViewable),this.clustering=
!1},clustersExist:function(){var a=!1;if(this.clusters&&0<this.clusters.length&&this.clusters.length==this.layer.markers.length)for(var a=!0,b=0;b<this.clusters.length;++b)if(this.clusters[b]!=this.layer.markers[b]){a=!1;break}return a},shouldCluster:function(a,b){var c=!1,d=this.layer.map;if(null==this.maxZoomLevel||this.maxZoomLevel>=d.getZoom()){c=!0;null!=this.attribute&&(c=(a.cluster[0].attributes[this.attribute]||a.cluster[0].data[this.attribute])===(b.attributes[this.attribute]||b.data[this.attribute]));
var d=a.lonlat,e=b.lonlat,d=Math.sqrt(Math.pow(d.lon-e.lon,2)+Math.pow(d.lat-e.lat,2))/this.resolution,c=c&&d<=this.distance}return c},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1;a.contentHTML=this.buildClusterContent(a.attributes.count)},createCluster:function(a){var b=ALKMaps.Marker2.Anchored.topright(null,a.lonlat,new ALKMaps.Size(40,32),this.buildClusterContent(1),{size:new ALKMaps.Size(0,0),offset:new ALKMaps.Pixel(-18,24)},null,{});b.cluster=[a];b.attributes.count=1;b.backgroundColor=
"";b.opacity=0.9;return b},splitClusterMarkers:function(a){for(var b=this.layer.map.getExtent(),c=1.2*this.distance*this.resolution,b=new ALKMaps.Bounds(b.left-c,b.bottom-c,b.right+c,b.top+c),c=[],d=[],e=0;e<a.length;e++){var f=a[e];b.containsLonLat(f.lonlat)?c.push(f):d.push(f)}return{viewable:c,notViewable:d}},buildClusterContent:function(a){return"<div class="+this.displayClass+">"+a+"</div>"},CLASS_NAME:"ALKMaps.Strategy.MarkerCluster"});ALKMaps.Renderer.SVG=ALKMaps.Class(ALKMaps.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15E3,translationParameters:null,symbolMetrics:null,initialize:function(a){if(this.supported())ALKMaps.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={}},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG",
"1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(){return!0},setExtent:function(a,b){var c=ALKMaps.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=-a.left/d,d=a.top/d;if(b)return this.left=e,this.top=d,this.rendererRoot.setAttributeNS(null,"viewBox","0 0 "+this.size.w+" "+this.size.h),this.translate(this.xOffset,0),!0;(e=this.translate(e-this.left+this.xOffset,d-this.top))||this.setExtent(a,
!0);return c&&e},translate:function(a,b){if(this.inValidRange(a,b,!0)){var c="";if(a||b)c="translate("+a+","+b+")";this.root.setAttributeNS(null,"transform",c);this.translationParameters={x:a,y:b};return!0}return!1},setSize:function(a){ALKMaps.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "ALKMaps.Geometry.Point":c=
b.externalGraphic?"image":this.isComplexSymbol(b.graphicName)||("line"===b.arrows||"end"===b.arrows)&&this.isComplexSymbol(b.arrowGraphicName)?"svg":"circle";break;case "ALKMaps.Geometry.Rectangle":c="rect";break;case "ALKMaps.Geometry.LineString":c="polyline";break;case "ALKMaps.Geometry.LinearRing":c="polygon";break;case "ALKMaps.Geometry.Polygon":case "ALKMaps.Geometry.Curve":c="path"}return c},setStyle:function(a,b,c){var b=b||a._style,c=c||a._options,d=parseFloat(a.getAttributeNS(null,"r")),
e=1,f;if("ALKMaps.Geometry.Point"==a._geometryClass&&d){a.style.visibility="";if(!1===b.graphic)a.style.visibility="hidden";else if(b.externalGraphic){f=this.getPosition(a);if(b.graphicTitle)a.setAttributeNS(null,"title",b.graphicTitle),d=a.getElementsByTagName("title"),0<d.length?d[0].firstChild.textContent=b.graphicTitle:(d=this.nodeFactory(null,"title"),d.textContent=b.graphicTitle,a.appendChild(d));b.graphicWidth&&b.graphicHeight&&a.setAttributeNS(null,"preserveAspectRatio","none");var d=b.graphicWidth||
b.graphicHeight,g=b.graphicHeight||b.graphicWidth,d=d?d:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),i=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",(f.x+(void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*d))).toFixed());a.setAttributeNS(null,"y",(f.y+h).toFixed());a.setAttributeNS(null,"width",d);a.setAttributeNS(null,"height",g);a.setAttributeNS(this.xlinkns,"href",b.externalGraphic);a.setAttributeNS(null,"style","opacity: "+i);a.onclick=ALKMaps.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(b.graphicName)||
("line"===b.arrows||"end"===b.arrows)&&this.isComplexSymbol(b.arrowGraphicName)){d=3*b.pointRadius;e=b.graphicName;if(("line"===b.arrows||"end"===b.arrows)&&this.isComplexSymbol(b.arrowGraphicName))d=3*b.arrowSize,e=b.arrowGraphicName;var g=2*d,j=this.importSymbol(e);f=this.getPosition(a);e=3*this.symbolMetrics[j.id][0]/g;h=a.parentNode;i=a.nextSibling;h&&h.removeChild(a);a.firstChild&&a.removeChild(a.firstChild);a.appendChild(j.firstChild.cloneNode(!0));a.setAttributeNS(null,"viewBox",j.getAttributeNS(null,
"viewBox"));a.setAttributeNS(null,"width",g);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"x",f.x-d);a.setAttributeNS(null,"y",f.y-d);i?h.insertBefore(a,i):h&&h.appendChild(a)}else a.setAttributeNS(null,"r",b.pointRadius);d=b.rotation;if(null!=b.arrows&&null!=b.arrowRotation)d=b.arrowRotation;if((void 0!==d||void 0!==a._rotation)&&f)a._rotation=d,d|=0,"svg"!==a.nodeName?a.setAttributeNS(null,"transform","rotate("+d+" "+f.x+" "+f.y+")"):(f=this.symbolMetrics[j.id],a.firstChild.setAttributeNS(null,
"transform","rotate("+d+" "+f[1]+" "+f[2]+")"))}c.isFilled?("line"===b.arrows||"end"===b.arrows)&&"ALKMaps.Geometry.Point"==a._geometryClass?(a.setAttributeNS(null,"fill",b.arrowFillColor),a.setAttributeNS(null,"fill-opacity",b.arrowFillOpacity)):(a.setAttributeNS(null,"fill",b.fillColor),a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none");c.isStroked?(("line"===b.arrows||"end"===b.arrows)&&"ALKMaps.Geometry.Point"==a._geometryClass?(a.setAttributeNS(null,"stroke",
b.arrowStrokeColor),a.setAttributeNS(null,"stroke-opacity",b.arrowStrokeOpacity),a.setAttributeNS(null,"stroke-width",b.arrowStrokeWidth*e)):(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*e)),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap||"round"),a.setAttributeNS(null,"stroke-linejoin","round"),b.strokeDashstyle&&a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,e))):a.setAttributeNS(null,
"stroke","none");b.pointerEvents&&a.setAttributeNS(null,"pointer-events",b.pointerEvents);null!=b.cursor&&a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeDashstyle;switch(d){case "solid":return"none";case "dot":return[1,4*c].join();case "dash":return[4*c,4*c].join();case "dashdot":return[4*c,4*c,1,4*c].join();case "longdash":return[8*c,4*c].join();case "longdashdot":return[8*c,4*c,1,4*c].join();default:return ALKMaps.String.trim(d).replace(/\s+/g,
",")}},createNode:function(a,b){var c=document.createElementNS(this.xmlns,a);b&&c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==a.nodeName},createRenderRoot:function(){var a=this.nodeFactory(this.container.id+"_svgRoot","svg");a.style.display="block";return a},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,
b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){var d=this.getResolution(),e=(b.x-this.featureDx)/d+this.left,b=this.top-b.y/d;return this.inValidRange(e,b)?(a.setAttributeNS(null,"cx",e),a.setAttributeNS(null,"cy",b),a.setAttributeNS(null,"r",c),a):!1},drawLineString:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);return c.path?
(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawPolygon:function(a,b){for(var c="",d=!0,e=!0,f,g,h=0,i=b.components.length;h<i;h++)c+=" M",f=this.getComponentsString(b.components[h].components," "),(g=f.path)?(c+=" "+g,e=f.complete&&e):d=!1;return d?(a.setAttributeNS(null,"d",c+" z"),a.setAttributeNS(null,"fill-rule","evenodd"),e?a:null):!1},drawRectangle:function(a,b){var c=this.getResolution(),d=(b.x-this.featureDx)/c+this.left,e=this.top-b.y/c;return this.inValidRange(d,e)?(a.setAttributeNS(null,
"x",d),a.setAttributeNS(null,"y",e),a.setAttributeNS(null,"width",b.width/c),a.setAttributeNS(null,"height",b.height/c),a):!1},drawText:function(a,b,c){var d=!!b.labelOutlineWidth;if(d){var e=ALKMaps.Util.extend({},b);e.fontColor=e.labelOutlineColor;e.fontStrokeColor=e.labelOutlineColor;e.fontStrokeWidth=b.labelOutlineWidth;delete e.labelOutlineWidth;this.drawText(a,e,c)}var f=this.getResolution(),e=(c.x-this.featureDx)/f+this.left,g=c.y/f-this.top,d=d?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,
f=this.nodeFactory(a+d,"text");f.setAttributeNS(null,"x",e);f.setAttributeNS(null,"y",-g);b.fontColor&&f.setAttributeNS(null,"fill",b.fontColor);b.fontStrokeColor&&f.setAttributeNS(null,"stroke",b.fontStrokeColor);b.fontStrokeWidth&&f.setAttributeNS(null,"stroke-width",b.fontStrokeWidth);b.fontOpacity&&f.setAttributeNS(null,"opacity",b.fontOpacity);b.fontFamily&&f.setAttributeNS(null,"font-family",b.fontFamily);b.fontSize&&f.setAttributeNS(null,"font-size",b.fontSize);b.fontWeight&&f.setAttributeNS(null,
"font-weight",b.fontWeight);b.fontStyle&&f.setAttributeNS(null,"font-style",b.fontStyle);!0===b.labelSelect?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=a):f.setAttributeNS(null,"pointer-events","none");g=b.labelAlign||ALKMaps.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",ALKMaps.Renderer.SVG.LABEL_ALIGN[g[0]]||"middle");!0===ALKMaps.IS_GECKO&&f.setAttributeNS(null,"dominant-baseline",ALKMaps.Renderer.SVG.LABEL_ALIGN[g[1]]||"central");for(var h=b.label.split("\n"),
i=h.length;f.childNodes.length>i;)f.removeChild(f.lastChild);for(var j=0;j<i;j++){var k=this.nodeFactory(a+d+"_tspan_"+j,"tspan");if(!0===b.labelSelect)k._featureId=a,k._geometry=c,k._geometryClass=c.CLASS_NAME;!1===ALKMaps.IS_GECKO&&k.setAttributeNS(null,"baseline-shift",ALKMaps.Renderer.SVG.LABEL_VSHIFT[g[1]]||"-35%");k.setAttribute("x",e);if(0==j){var m=ALKMaps.Renderer.SVG.LABEL_VFACTOR[g[1]];null==m&&(m=-0.5);k.setAttribute("dy",m*(i-1)+"em")}else k.setAttribute("dy","1em");k.textContent=""===
h[j]?" ":h[j];k.parentNode||f.appendChild(k)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(a,b){for(var c=[],d=!0,e=a.length,f=[],g,h=0;h<e;h++)g=a[h],c.push(g),(g=this.getShortString(g))?f.push(g):(0<h&&this.getShortString(a[h-1])&&f.push(this.clipLine(a[h],a[h-1])),h<e-1&&this.getShortString(a[h+1])&&f.push(this.clipLine(a[h],a[h+1])),d=!1);return{path:f.join(b||","),complete:d}},clipLine:function(a,b){if(b.equals(a))return"";var c=this.getResolution(),d=this.MAX_PIXEL-
this.translationParameters.x,e=this.MAX_PIXEL-this.translationParameters.y,f=(b.x-this.featureDx)/c+this.left,g=this.top-b.y/c,h=(a.x-this.featureDx)/c+this.left,c=this.top-a.y/c,i;if(h<-d||h>d)i=(c-g)/(h-f),h=0>h?-d:d,c=g+(h-f)*i;if(c<-e||c>e)i=(h-f)/(c-g),c=0>c?-e:e,h=f+(c-g)*i;return h+","+c},getShortString:function(a){var b=this.getResolution(),c=(a.x-this.featureDx)/b+this.left,a=this.top-a.y/b;return this.inValidRange(c,a)?c+","+a:!1},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,
"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){if(!this.defs)this.defs=this.createDefs();var b=this.container.id+"-"+a,c=document.getElementById(b);if(null!=c)return c;var d=ALKMaps.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");var a=this.nodeFactory(b,"symbol"),e=this.nodeFactory(null,"polygon");a.appendChild(e);for(var c=new ALKMaps.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),f=[],g,h,i=0;i<d.length;i+=2)g=d[i],h=d[i+1],c.left=Math.min(c.left,
g),c.bottom=Math.min(c.bottom,h),c.right=Math.max(c.right,g),c.top=Math.max(c.top,h),f.push(g,",",h);e.setAttributeNS(null,"points",f.join(" "));d=c.getWidth();e=c.getHeight();a.setAttributeNS(null,"viewBox",[c.left-d,c.bottom-e,3*d,3*e].join(" "));this.symbolMetrics[b]=[Math.max(d,e),c.getCenterLonLat().lon,c.getCenterLonLat().lat];this.defs.appendChild(a);return a},getFeatureIdFromEvent:function(a){var b=ALKMaps.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!b)for(var c=
a.target,b=null,d=0;null==b&&null!=c.parentNode&&c!=this.rendererRoot&&100>=d;)b=c.parentNode._featureId,c=c.parentNode,d++;return b},CLASS_NAME:"ALKMaps.Renderer.SVG"});ALKMaps.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};ALKMaps.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};ALKMaps.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};ALKMaps.Renderer.SVG.preventDefault=function(a){a.preventDefault&&a.preventDefault()};ALKMaps.Lang["cs-CZ"]=ALKMaps.Util.applyDefaults({unhandledRequest:"Nezpracovan\u00e1 n\u00e1vratov\u00e1 hodnota ${statusText}",Permalink:"Trval\u00fd odkaz",Overlays:"P\u0159ekryvn\u00e9 vrstvy","Base Layer":"Podkladov\u00e9 vrstvy",readNotImplemented:"Read nen\u00ed implementov\u00e1no.",writeNotImplemented:"Write nen\u00ed implementov\u00e1no.",noFID:"Nelze aktualizovat prvek, pro kter\u00fd neexistuje FID.",errorLoadingGML:"Chyba p\u0159i na\u010d\u00edt\u00e1n\u00ed souboru GML ${url}",browserNotSupported:"V\u00e1\u0161 prohl\u00ed\u017ee\u010d nepodporuje vykreslov\u00e1n\u00ed vektor\u016f. Moment\u00e1ln\u011b podporovan\u00e9 n\u00e1stroje jsou::\n${renderers}",
componentShouldBe:"addFeatures : komponenta by m\u011bla b\u00fdt ${geomType}",getFeatureError:"getFeatureFromEvent bylo zavol\u00e1no na vrstv\u011b, kter\u00e1 nem\u00e1 vykreslova\u010d. To oby\u010dejn\u011b znamen\u00e1, \u017ee jste odstranil vrstvu, ale ne rutinu s n\u00ed asociovanou.",minZoomLevelError:"Vlastnost minZoomLevel by se m\u011bla pou\u017e\u00edvat pouze s potomky FixedZoomLevels vrstvami. To znamen\u00e1, \u017ee vrstva wfs kontroluje, zda-li minZoomLevel nen\u00ed zbytek z minulosti.Nelze to ov\u0161em vyjmout bez mo\u017enosti, \u017ee bychom rozbili aplikace postaven\u00e9 na OL, kter\u00e9 by na tom mohly z\u00e1viset. Proto tuto vlastnost nedoporu\u010dujeme pou\u017e\u00edvat --  kontrola minZoomLevel bude odstran\u011bna ve verzi 3.0. Pou\u017eijte pros\u00edm rad\u011bji nastaven\u00ed min/max podle p\u0159\u00edkaldu popsan\u00e9ho na: http://trac.openlayers.org/wiki/SettingZoomLevels",
commitSuccess:"WFS Transaction: \u00daSP\u011aCH ${response}",commitFailed:"WFS Transaction: CHYBA ${response}",googleWarning:"Nepoda\u0159ilo se spr\u00e1vn\u011b na\u010d\u00edst vrstvu Google.<br><br>Abyste se zbavili t\u00e9to zpr\u00e1vy, zvolte jinou z\u00e1kladn\u00ed vrstvu v p\u0159ep\u00edna\u010di vrstev.<br><br>To se v\u011bt\u0161inou st\u00e1v\u00e1, pokud nebyl na\u010dten skript, nebo neobsahuje spr\u00e1vn\u00fd kl\u00ed\u010d pro API pro tuto str\u00e1nku.<br><br>V\u00fdvoj\u00e1\u0159i: Pro pomoc, aby tohle fungovalo , <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>klikn\u011bte sem</a>",
getLayerWarning:"The ${layerType} Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the ${layerLib} library script was either not correctly included.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>","Scale = 1 : ${scaleDenom}":"M\u011b\u0159\u00edtko = 1 : ${scaleDenom}",layerAlreadyAdded:"Pokusili jste se p\u0159idat vrstvu: ${layerName} do mapy, ale tato vrstva je ji\u017e v map\u011b p\u0159\u00edtomna.",
reprojectDeprecated:"Pou\u017eil jste volbu 'reproject' ve vrstv\u011b ${layerName}. Tato volba nen\u00ed doporu\u010den\u00e1: byla zde proto, aby bylo mo\u017eno zobrazovat data z okomer\u010dn\u00edch server\u016f, ale tato funkce je nyn\u00ed zaji\u0161t\u011bna pomoc\u00ed podpory Spherical Mercator. V\u00edce informac\u00ed naleznete na http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Tato metoda je zavr\u017een\u00e1 a bude ve verzi 3.0 odstran\u011bna. Pros\u00edm, pou\u017eijte rad\u011bji ${newMethod}.",
boundsAddError:"Pro p\u0159\u00eddavnou funkci mus\u00edte zadat ob\u011b sou\u0159adnice x a y.",lonlatAddError:"Pro p\u0159\u00eddavnou funkci mus\u00edte zadat ob\u011b sou\u0159adnice lon a lat.",pixelAddError:"Pro p\u0159\u00eddavnou funkci mus\u00edte zadat ob\u011b sou\u0159adnice x a y.",unsupportedGeometryType:"Nepodporovan\u00fd typ geometrie: ${geomType}",panup:"Posunout nahoru",panleft:"Posunout doleva",zoomworld:"Sv\u011bt zbl\u00edzka",panright:"Posunout doprava",pandown:"Posunout dol\u016f",
zoomin:"P\u0159ibl\u00ed\u017eit",zoomout:"Odd\u00e1lit",dragme:"St\u00e1hni m\u011b",dragToChangeRoute:"Ta\u017een\u00edm zm\u011bnit trasu",drawPoints:"Nakreslit body",clkToSetPoints:"Kliknut\u00edm nastavit body pro \u010d\u00e1ru. Pro dokon\u010den\u00ed dvakr\u00e1t kliknout.",dragToDrawLine:"Nakreslit ta\u017een\u00edm \u010d\u00e1ru od ruky.",dragToDrawEllipse:"Nakreslit ta\u017een\u00edm elipsu.",dragToDrawRect:"Nakreslit ta\u017een\u00edm obd\u00e9ln\u00edk.",clkToSetPolygon:"Klepnut\u00edm nastavit body pro polygon. Pro dokon\u010den\u00ed dvakr\u00e1t kliknout.",
dragToDrawPolygon:"Nakreslit ta\u017een\u00edm polygon od ruky.",clkShapeToResize:"Klikn\u011bte na tvar, abyste zm\u011bnili jeho velikost nebo ho p\u0159esunuli. Pro ot\u00e1\u010den\u00ed um\u00edst\u011bte kurzor pobl\u00ed\u017e rohu.",clkShapeToModify:"Klikn\u011bte na tvar, abyste \u00fapravili tvar bod\u016f. S kurzorem na bod\u011b stiskn\u011bte kl\u00e1vesu Delete, abyste ho odstranili.",showShapeInfo:"Uk\u00e1zat tvar informa\u010dn\u00edho pol\u00ed\u010dka.",area:"Plocha",length:"D\u00e9lka",
nodes:"Uzly",perimeter:"Obvod",location:"Poloha",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"});ALKMaps.Lang.cs=ALKMaps.Lang["cs-CZ"];ALKMaps.WS_StopLocation=ALKMaps.Class(ALKMaps.WS_Location,{ID:null,IsViaPoint:!1,SideOfStreetAdherence:null,initialize:function(a){a=a||{};ALKMaps.WS_Location.prototype.initialize.apply(this,arguments);this.ID=a.ID||a.id||a.Id;this.IsViaPoint=null!=a.IsViaPoint?a.IsViaPoint:null!=a.isViaPoint?a.isViaPoint:!1;this.SideOfStreetAdherence=a.SideOfStreetAdherence||a.sideOfStreetAdherence},CLASS_NAME:"ALKMaps.WS_StopLocation"});
ALKMaps.WS_StopLocation.fromStopLocation=function(a){a=a||{};return new ALKMaps.WS_StopLocation({ID:a.id,IsViaPoint:null!=a.isViaPoint?a.isViaPoint:!1,SideOfStreetAdherence:a.sideOfStreetAdherence,Address:null!=a.address?ALKMaps.WS_Address.fromAddress(a.address):void 0,Coords:null!=a.lonLat?ALKMaps.WS_Coordinates.fromLonLat(a.lonLat):void 0,Label:a.label})};
ALKMaps.WS_StopLocation.fromStopLocations=function(a,b){var c=[];if(ALKMaps.Util.isArray(a)&&0<a.length)for(var d=0;d<a.length;d++){var e=ALKMaps.WS_StopLocation.fromStopLocation(a[d],b);c.push(e)}return c};ALKMaps.Layer.VectorMarkers=ALKMaps.Class(ALKMaps.Layer.Vector,{initialize:function(a,b){ALKMaps.Layer.Vector.prototype.initialize.apply(this,arguments)},createMarker:function(a,b,c,d){b=b||(null==c?{markerType:"default"}:{markerType:"style"});b.isMarker=!0;var e;e=new ALKMaps.Geometry.Point(a.lon,a.lat);if(null==c&&"custom"!==b.markerType){c=ALKMaps.IMAGE.MARKER;if("blue"===b.markerType)c=ALKMaps.IMAGE.MARKER_BLUE;else if("green"===b.markerType)c=ALKMaps.IMAGE.MARKER_GREEN;else if("gold"===b.markerType)c=
ALKMaps.IMAGE.MARKER_GOLD;c={externalGraphic:c,graphicHeight:25,graphicWidth:21,graphicXOffset:-11,graphicYOffset:-25}}e=new ALKMaps.Feature.Vector(e,b,c);e.lonlat=a;e.popupClass=b.popupClass||ALKMaps.Popup.FramedCloud;(null==d||!0===d)&&this.addMarkers([e]);return e},createMarkers:function(a,b,c){var d=[];if(null!=a&&ALKMaps.Util.isArray(a))d=a;else if(null!=a&&!ALKMaps.Util.isArray(a))d.push(a);else throw new TypeError("Lonlat array is expected.");a=[];if(null!=b&&ALKMaps.Util.isArray(b))a=b;else for(var e=
0;e<d.length;e++)a.push(b);b=[];if(null!=c&&ALKMaps.Util.isArray(c))b=c;else for(e=0;e<d.length;e++)b.push(c);if(d.length!==a.length||d.length!==b.length||a.length!==b.length)throw new TypeError("Todo:");c=[];for(e=0;e<d.length;e++){var f=this.createMarker(d[e],a[e],b[e],!1);c.push(f)}this.addMarkers(c);return c},addMarkers:function(a,b){this.addFeatures(a,b)},removeMarker:function(a,b){this.destroyFeatures([a],b)},clearMarkers:function(a){if(null!=this.features)for(;0<this.features.length;)this.removeMarker(this.features[0],
a)},CLASS_NAME:"ALKMaps.Layer.VectorMarkers"});ALKMaps.Control.PanPanel=ALKMaps.Class(ALKMaps.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(a){ALKMaps.Control.Panel.prototype.initialize.apply(this,[a]);a={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new ALKMaps.Control.Pan(ALKMaps.Control.Pan.NORTH,a),new ALKMaps.Control.Pan(ALKMaps.Control.Pan.SOUTH,a),new ALKMaps.Control.Pan(ALKMaps.Control.Pan.EAST,a),new ALKMaps.Control.Pan(ALKMaps.Control.Pan.WEST,a)])},CLASS_NAME:"ALKMaps.Control.PanPanel"});ALKMaps.Control.Snapping=ALKMaps.Class(ALKMaps.Control,{DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(a){ALKMaps.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.layer&&this.setLayer(this.options.layer);a=ALKMaps.Util.extend({},this.options.defaults);this.defaults=ALKMaps.Util.applyDefaults(a,this.DEFAULTS);this.setTargets(this.options.targets);
0===this.targets.length&&this.layer&&this.addTargetLayer(this.layer);this.geoToleranceCache={}},setLayer:function(a){this.active?(this.deactivate(),this.layer=a,this.activate()):this.layer=a},setTargets:function(a){this.targets=[];if(a&&a.length)for(var b,c=0,d=a.length;c<d;++c)b=a[c],b instanceof ALKMaps.Layer.Vector?this.addTargetLayer(b):this.addTarget(b)},addTargetLayer:function(a){this.addTarget({layer:a})},addTarget:function(a){a=ALKMaps.Util.applyDefaults(a,this.defaults);a.nodeTolerance=a.nodeTolerance||
a.tolerance;a.vertexTolerance=a.vertexTolerance||a.tolerance;a.edgeTolerance=a.edgeTolerance||a.tolerance;this.targets.push(a)},removeTargetLayer:function(a){for(var b,c=this.targets.length-1;0<=c;--c)b=this.targets[c],b.layer===a&&this.removeTarget(b)},removeTarget:function(a){return ALKMaps.Util.removeItem(this.targets,a)},activate:function(){var a=ALKMaps.Control.prototype.activate.call(this);if(a&&this.layer&&this.layer.events)this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,
vertexmodified:this.onVertexModified,scope:this});return a},deactivate:function(){var a=ALKMaps.Control.prototype.deactivate.call(this);a&&this.layer&&this.layer.events&&this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});this.point=this.feature=null;return a},onSketchModified:function(a){this.feature=a.feature;this.considerSnapping(a.vertex,a.vertex)},onVertexModified:function(a){this.feature=a.feature;var b=
this.layer.map.getLonLatFromViewPortPx(a.pixel);this.considerSnapping(a.vertex,new ALKMaps.Geometry.Point(b.lon,b.lat))},considerSnapping:function(a,b){for(var c={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},d=!1,e,f,g=0,h=this.targets.length;g<h;++g)if(f=this.targets[g],e=this.testTarget(f,b))if(this.greedy){c=e;c.target=f;d=!0;break}else if(e.rank<c.rank||e.rank===c.rank&&e.dist<c.dist)c=e,c.target=f,d=!0;if(d)!1!==this.events.triggerEvent("beforesnap",{point:a,x:c.x,
y:c.y,distance:c.dist,layer:c.target.layer,snapType:this.precedence[c.rank]})?(a.x=c.x,a.y=c.y,this.point=a,this.events.triggerEvent("snap",{point:a,snapType:this.precedence[c.rank],layer:c.target.layer,distance:c.dist})):d=!1;if(this.point&&!d)a.x=b.x,a.y=b.y,this.point=null,this.events.triggerEvent("unsnap",{point:a})},testTarget:function(a,b){var c=this.layer.map.getResolution();if("minResolution"in a&&c<a.minResolution||"maxResolution"in a&&c>=a.maxResolution)return null;for(var c={node:this.getGeoTolerance(a.nodeTolerance,
c),vertex:this.getGeoTolerance(a.vertexTolerance,c),edge:this.getGeoTolerance(a.edgeTolerance,c)},d=Math.max(c.node,c.vertex,c.edge),e={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},f=!1,g=a.layer.features,h,i,j,k,m,l,p=this.precedence.length,n=new ALKMaps.LonLat(b.x,b.y),q=0,o=g.length;q<o;++q)if(h=g[q],h!==this.feature&&!h._sketch&&h.state!==ALKMaps.State.DELETE&&(!a.filter||a.filter.evaluate(h))&&h.atPoint(n,d,d))for(var r=0,t=Math.min(e.rank+1,p);r<t;++r)if(i=this.precedence[r],
a[i])if("edge"===i){if(j=h.geometry.distanceTo(b,{details:!0}),m=j.distance,m<=c[i]&&m<e.dist){e={rank:r,dist:m,x:j.x0,y:j.y0};f=!0;break}}else{j=h.geometry.getVertices("node"===i);l=!1;for(var s=0,u=j.length;s<u;++s)if(k=j[s],m=k.distanceTo(b),m<=c[i]&&(r<e.rank||r===e.rank&&m<e.dist))e={rank:r,dist:m,x:k.x,y:k.y},l=f=!0;if(l)break}return f?e:null},getGeoTolerance:function(a,b){if(b!==this.resolution)this.resolution=b,this.geoToleranceCache={};var c=this.geoToleranceCache[a];void 0===c&&(c=a*b,this.geoToleranceCache[a]=
c);return c},destroy:function(){this.active&&this.deactivate();delete this.layer;delete this.targets;ALKMaps.Control.prototype.destroy.call(this)},CLASS_NAME:"ALKMaps.Control.Snapping"});ALKMaps.Lang.sl={panup:"Pomik navzgor",panleft:"Pomik levo",zoomworld:"Pove\u010daj svet",panright:"Pomik desno",pandown:"Pomik navzdol",zoomin:"Pove\u010dava",zoomout:"Pomanj\u0161ava",dragme:"Povleci me",dragToChangeRoute:"Povlecite, \u010de \u017eelite spremeniti smer.",drawPoints:"Izris to\u010dk",clkToSetPoints:"Kliknite, da dolo\u010dite to\u010dke za \u010drto. Dvokliknite, da dokon\u010date.",dragToDrawLine:"Povlecite, \u010de \u017eelite izrisati prostoro\u010dno \u010drto.",dragToDrawEllipse:"Povlecite, \u010de \u017eelite izrisati elipso.",
dragToDrawRect:"Povlecite, \u010de \u017eelite izrisati pravokotnik.",clkToSetPolygon:"Kliknite, da dolo\u010dite to\u010dke za mnogokotnik. Dvokliknite, da dokon\u010date.",dragToDrawPolygon:"Povlecite, \u010de \u017eelite izrisati prostoro\u010dni mnogokotnik.",clkShapeToResize:"Kliknite obliko, da spremenite njeno velikost ali jo premaknete. Za obra\u010danje postavite kazalec poleg kota.",clkShapeToModify:"Kliknite obliko, da spremenite to\u010dke oblike. \u010ce \u017eelite odstraniti to\u010dko, pritisnite tipko Delete (Izbri\u0161i), ko je kazalec na to\u010dki.",
showShapeInfo:"Poka\u017ee okno z informacijami o obliki.",area:"Obmo\u010dje",length:"Dol\u017eina",nodes:"Vozli\u0161\u010da",perimeter:"Okolica",location:"Lokacija",dragPan:"Drag the map to pan",boxZoom:"Draw a box to zoom",prevMapView:"Previous map view",nextMapView:"Next map view"};ALKMaps.Control.CircleMeasure=ALKMaps.Class(ALKMaps.Control.DragFeature,{layer:null,circleLayer:null,center:null,radius:null,centerIcon:null,pivotIcon:null,autoActivate:!0,geometryTypes:["ALKMaps.Geometry.Point"],minRadius:null,maxRadius:null,sketchStyle:null,finishStyle:null,initialize:function(a){a=a||{};this.center=a.center;this.radius=a.radius;this.centerIcon=a.centerIcon;this.pivotIcon=a.pivotIcon;this.minRadius=a.minRadius;this.maxRadius=a.maxRadius;this.sketchStyle=a.sketchStyle||{fillColor:"#080808",
fillOpacity:0.4,strokeColor:"#080808",strokeOpacity:1,strokeWidth:2};this.finishStyle=a.finishStyle||{fillColor:"#FFFFFF",fillOpacity:0.4,strokeColor:"#0000FF",strokeOpacity:1,strokeWidth:2};this.layer=new ALKMaps.Layer.Vector("ALKMaps.Control.CircleMeasure_Top",{displayInLayerSwitcher:!1});this.circleLayer=new ALKMaps.Layer.Vector("ALKMaps.Control.CircleMeasure_Bottom",{displayInLayerSwitcher:!1});ALKMaps.Control.DragFeature.prototype.initialize.apply(this,[this.layer])},drawCenter:function(){var a=
new ALKMaps.Geometry.Point(this.center.lon,this.center.lat),a=new ALKMaps.Feature.Vector(a,null,{externalGraphic:this.centerIcon.url,graphicHeight:this.centerIcon.size.h,graphicWidth:this.centerIcon.size.w,graphicXOffset:this.centerIcon.offset.x,graphicYOffset:this.centerIcon.offset.y,cursor:"move"});a.fid="center";this.layer.addFeatures([a])},drawPivot:function(){var a=new ALKMaps.Geometry.Point(this.center.lon+this.radius,this.center.lat),a=new ALKMaps.Feature.Vector(a,null,{externalGraphic:this.pivotIcon.url,
graphicHeight:this.pivotIcon.size.h,graphicWidth:this.pivotIcon.size.w,graphicXOffset:this.pivotIcon.offset.x,graphicYOffset:this.pivotIcon.offset.y,cursor:"w-resize",graphicTitle:ALKMaps.i18n("dragme")});a.fid="pivot";this.layer.addFeatures([a])},drawCircle:function(a,b){var c=new ALKMaps.Geometry.Point(this.center.lon,this.center.lat),c=new ALKMaps.Geometry.Polygon.createRegularPolygon(c,a||this.radius,100,0),c=new ALKMaps.Feature.Vector(c,null,b||this.finishStyle);c.fid="circle";this.circleLayer.addFeatures([c])},
setMap:function(a){ALKMaps.Control.DragFeature.prototype.setMap.apply(this,arguments);this.centerIcon=this.centerIcon||new ALKMaps.Icon(ALKMaps.IMAGE.PIN_RED,new ALKMaps.Size(32,32),new ALKMaps.Pixel(-10,-22));this.pivotIcon=this.pivotIcon||new ALKMaps.Icon(ALKMaps.IMAGE.PIN_GREEN,new ALKMaps.Size(32,32),new ALKMaps.Pixel(-10,-22));a.addLayers([this.circleLayer,this.layer]);null!=this.center&&null!=this.radius&&(this.drawCircle(),this.drawCenter(),this.drawPivot())},destroy:function(){this.layer.removeAllFeatures();
this.circleLayer.removeAllFeatures();this.circleLayer=null;ALKMaps.Control.DragFeature.prototype.destroy.apply(this,[])},getRadius:function(){return Math.abs(this.radius)},moveFeature:function(a){var b=this.map.getResolution();if("center"===this.feature.fid){this.center=new ALKMaps.LonLat(this.feature.geometry.x,this.feature.geometry.y);for(var c=0;c<this.feature.layer.features.length;c++){var d=this.feature.layer.features[c];d.geometry.move(b*(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y));this.layer.drawFeature(d)}for(c=
0;c<this.circleLayer.features.length;c++)d=this.circleLayer.features[c],d.geometry.move(b*(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y)),"circle"===d.fid&&this.circleLayer.drawFeature(d)}if("pivot"===this.feature.fid){b=this.radius+=b*(a.x-this.lastPixel.x);d=1;0>b&&(d=-1);null!=this.minRadius&&null!=this.maxRadius&&(Math.abs(this.radius)<this.minRadius&&(b=d*this.minRadius),Math.abs(this.radius)>this.maxRadius&&(b=d*this.maxRadius));this.feature.geometry.x=this.center.lon+b;this.feature.geometry.y=
this.center.lat;this.layer.drawFeature(this.feature);for(c=0;c<this.circleLayer.features.length;c++)d=this.circleLayer.features[c],"circle"===d.fid&&(this.circleLayer.removeFeatures([d]),this.drawCircle(b,this.sketchStyle))}this.lastPixel=a},doneDragging:function(a){if(null!=this.minRadius&&null!=this.maxRadius){var b=1;0>this.radius&&(b=-1);if(Math.abs(this.radius)<this.minRadius)this.radius=b*this.minRadius;if(Math.abs(this.radius)>this.maxRadius)this.radius=b*this.maxRadius}if("center"!==this.feature.fid)for(b=
0;b<this.circleLayer.features.length;b++){var c=this.circleLayer.features[b];"circle"===c.fid&&(this.circleLayer.removeFeatures([c]),this.drawCircle())}ALKMaps.Control.DragFeature.prototype.doneDragging.apply(this,arguments)},adjustMapAndCircle:function(a){var b=this.map.getExtent(),c=Math.abs(b.right-b.left),b=Math.abs(b.bottom-b.top),c=Math.min(c,b)/4,b=this.map.getZoom();if(null!=this.minRadius&&null!=this.maxRadius&&(c<this.minRadius||c>this.maxRadius)){if(c<this.minRadius)c=this.minRadius;if(c>
this.maxRadius)c=this.maxRadius;b=2*c;b=this.map.getZoomForExtent(new ALKMaps.Bounds(a.lon-b,a.lat-b,a.lon+b,a.lat+b))}this.map.setCenter(a,b);this.center=a;this.radius=c;this.drawCircle();this.drawCenter();this.drawPivot()},CLASS_NAME:"ALKMaps.Control.CircleMeasure"});ALKMaps.Control.ScaleLine=ALKMaps.Class(ALKMaps.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!0,draw:function(){ALKMaps.Control.prototype.draw.apply(this,arguments);if(!this.eTop)this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top",this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"),
this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible";this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(a){var b=parseInt(Math.log(a)/Math.log(10)),b=Math.pow(10,b),a=parseInt(a/b);return(5<a?5:2<a?2:1)*b},update:function(){var a=this.map.getResolution();if(a){var b=this.map.getUnits(),c=ALKMaps.INCHES_PER_UNIT,d=this.maxWidth*
a*c[b],e=1;!0===this.geodesic&&(e=(this.map.getGeodesicPixelSize().w||1.0E-6)*this.maxWidth/(d/c.km),d*=e);var f,g;1E5<d?(f=this.topOutUnits,g=this.bottomOutUnits):(f=this.topInUnits,g=this.bottomInUnits);var h=d/c[f],i=d/c[g],d=this.getBarLen(h),j=this.getBarLen(i),h=d/c[b]*c[f],i=j/c[b]*c[g],b=h/a/e,a=i/a/e;if("visible"==this.eBottom.style.visibility)this.eBottom.style.width=Math.round(a)+"px",this.eBottom.innerHTML=j+" "+g;if("visible"==this.eTop.style.visibility)this.eTop.style.width=Math.round(b)+
"px",this.eTop.innerHTML=d+" "+f}},CLASS_NAME:"ALKMaps.Control.ScaleLine"});ALKMaps.Popup.SimplePopup=ALKMaps.Class(ALKMaps.Popup,{sizeAdjustment:new ALKMaps.Size(0,0),initialize:function(a,b,c,d,e,f,g){null===a&&(a=ALKMaps.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=b;this.padding=10;this.maxSize={w:300,h:300};this.panMapIfOutOfView=!0;this.contentDisplayClass="popup-content-forJS";null!==c?this.contentSize=c:this.autoSize=!0;if(null!==d)this.contentHTML=d;this.offset=null===e?new ALKMaps.Pixel(0,0):e;this.div=ALKMaps.Util.createDiv(this.id,null,null,
null,null,null);this.groupDiv=ALKMaps.Util.createDiv(this.id+"_GroupDiv",null,null,null,"relative",null);this.groupDiv.className="popup";this.contentContainerDiv=ALKMaps.Util.createDiv(this.div.id+"_contentContainerDiv",null,null,null,"relative");this.contentContainerDiv.className="popup-content-container";this.contentDiv=ALKMaps.Util.createDiv(this.div.id+"_contentDiv",null,null,null,"relative");this.contentDiv.className="popup-content";this.contentContainerDiv.appendChild(this.contentDiv);this.groupDiv.appendChild(this.contentContainerDiv);
this.stemContainerDiv=ALKMaps.Util.createDiv(this.div.id+"_stemContainerDiv",null,null,null,"relative");this.stemContainerDiv.className="popup-stem-container";this.stemDiv=ALKMaps.Util.createDiv(this.div.id+"_stemDiv",null,null,null,"relative");this.stemDiv.className="popup-stem";this.stemContainerDiv.appendChild(this.stemDiv);this.groupDiv.appendChild(this.stemContainerDiv);this.div.appendChild(this.groupDiv);f&&this.addCloseBox(g);this.registerEvents()},destroy:function(){ALKMaps.Popup.prototype.destroy.apply(this,
arguments)},addCloseBox:function(a){this.closeDiv=ALKMaps.Util.createDiv(this.id+"_close",null,{w:18,h:14});this.closeDiv.className="popup-close-button";this.closeDiv.innerHTML="&times";this.groupDiv.appendChild(this.closeDiv);a=a||function(a){this.hide();ALKMaps.Event.stop(a)};ALKMaps.Event.observe(this.closeDiv,"touchend",ALKMaps.Function.bindAsEventListener(a,this));ALKMaps.Event.observe(this.closeDiv,"click",ALKMaps.Function.bindAsEventListener(a,this))},draw:function(a){null==a&&null!==this.lonlat&&
null!==this.map&&(a=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&&this.map.events.register("movestart",this,this.hide);!this.autoSize&&!this.size&&this.setSize(this.contentSize);this.setContentHTML();this.moveTo(a);this.panMapIfOutOfView&&this.panIntoView();return this.div},moveTo:function(a){if(null!==a&&null!==this.div)this.div.style.left=a.x-(this.size.w/2-this.offset.x)+"px",this.div.style.top=a.y-(this.size.h-this.offset.y)+"px"},updateSize:function(){var a="<div class='"+this.contentDisplayClass+
"'>"+this.contentDiv.innerHTML+"</div>",b=this.map?this.map.div:document.body,c=this.getRenderedDimensions(a,null,{containerElement:b}),d=this.getSafeContentSize(c),e=null;d.equals(c)?e=c:(c={w:d.w<c.w?d.w:null,h:d.h<c.h?d.h:null},c.w&&c.h?e=d:(a=this.getRenderedDimensions(a,c,{displayClass:this.contentDisplayClass,containerElement:b}),"hidden"!==ALKMaps.Element.getStyle(this.contentDiv,"overflow")&&a.equals(d)&&(d=ALKMaps.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=this.getSafeContentSize(a)));
this.setSize(e)},getRenderedDimensions:function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";for(var g=c&&c.containerElement?c.containerElement:document.body,h=!1,i=null,j=g;j&&"body"!==j.tagName.toLowerCase();){var k=ALKMaps.Element.getStyle(j,"position");if("absolute"===k){h=!0;break}else if(k&&"static"!==k)break;j=j.parentNode}if(h&&(0===g.clientHeight||0===g.clientWidth))i=document.createElement("div"),i.style.visibility="hidden",i.style.position="absolute",i.style.overflow=
"visible",i.style.width=document.body.clientWidth+"px",i.style.height=document.body.clientHeight+"px",i.appendChild(f);f.style.position="absolute";if(b)if(b.w)d=b.w,f.style.width=d+"px";else if(b.h)e=b.h,f.style.height=e+"px";if(c&&c.displayClass)f.className=c.displayClass;b=document.createElement("div");b.innerHTML=a;b.style.overflow="auto";if(b.childNodes){a=0;for(c=b.childNodes.length;a<c;a++)if(b.childNodes[a].style)b.childNodes[a].style.overflow="auto"}f.appendChild(b);f.className="popup-content-container";
i?g.appendChild(i):g.appendChild(f);d||(d=parseInt(b.scrollWidth),d+=this.sizeAdjustment.w);e||(e=parseInt(b.scrollHeight),e+=this.sizeAdjustment.h);f.removeChild(b);i?(i.removeChild(f),g.removeChild(i)):g.removeChild(f);return new ALKMaps.Size(d,e)},setSize:function(a){ALKMaps.Popup.prototype.setSize.apply(this,arguments);this.size.h+=36;this.lonlat&&this.map&&this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))},CLASS_NAME:"ALKMaps.Popup.SimplePopup"});(function(a){var b="https://developer.trimblemaps.com",c='<img src="'+a.Util.getImageLocation("trimblemaps-logo.png")+'"/>&copy Trimble Inc. | &copy OpenMapTiles &copy OpenStreetMap contributors';a.Copyright=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?'<a href="" ontouchstart="window.open('+
("'"+b+"'")+')">'+c+"</a>":'<a href="'+b+'" target="_blank">'+c+"</a>";a.CopyrightWithoutHyperlink=c})(ALKMaps);(function(a){if(a){var b=a.ALKMaps.Layer;b.Tile=a.TileLayer.extend({projection:a.CRS.EPSG900913.code,region:null,dataset:"Current",style:"transportation",imgsrc:null,attribution:null,attrPosition:"bottomright",attrUseHyperlink:!0,attrVisible:!0,minZoom:0,maxZoom:20,isBaseLayer:!0,tileSize:256,drawergroups:null,language:null,initialize:function(b){b=b||{};this.region=b.region||this.region;this.dataset=b.dataset||this.dataset;this.style=ALKMaps.STYLE.legacyCheck(b.style);this.imgsrc=b.imgsrc;this.attribution=
b.attribution||this.attribution;this.attrPosition=b.attrPosition||this.attrPosition;this.attrUseHyperlink=void 0===b.attrUseHyperlink?this.attrUseHyperlink:b.attrUseHyperlink;this.attrVisible=void 0===b.attrVisible?this.attrVisible:b.attrVisible;this.tileSize=b.tileSize||this.tileSize;this.zoomOffset=512===this.tileSize?-1:0;this.drawergroups=b.drawergroups||ALKMaps.CONTENT.DEFAULT;this.language=b.language||ALKMaps.Lang.getCode();if("satellite"===this.style)this.imgoption="Background";b=null;if(!0===
this.isBaseLayer&&null!=this.attribution)b=this.attribution;var d=this.getUrl();a.TileLayer.prototype.initialize.call(this,d,{attribution:b,minZoom:this.minZoom,maxZoom:this.maxZoom,subdomains:["a","b","c","d"],zoomOffset:this.zoomOffset,tileSize:this.tileSize})},onAdd:function(b){this._map=b;this.addEventListener("loading",this._onLoadStart,this);this.addEventListener("load",this._onLoadEnd,this);this.options.minZoom=b.options.minZoom||this.minZoom;this.options.maxZoom=b.options.maxZoom||this.maxZoom;
a.TileLayer.prototype.onAdd.call(this,this._map);this._map.attributionControl.setPosition(this.attrPosition);!0===this.attrVisible?!0===this.attrUseHyperlink?this._map.attributionControl.setPrefix(ALKMaps.Copyright):this._map.attributionControl.setPrefix('<img src="'+a.ALKMaps.Util.getImageLocation("alkmaps-logo.png")+'"> Copyright &copy; '+a.ALKMaps.Util.getYear()+" ALK Technologies Inc. Portions &copy; OpenStreetMap contributors."):this._map.attributionControl.setPrefix();var d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,
region:this.region,isBaseLayer:this.isBaseLayer});null!=d&&this._map.attributionControl.addAttribution(d);this.setUrl(this.getUrl(),!1);if("satellite"===this.style&&!0===this.isBaseLayer)this.transparentOverlayLayer=d=this.cloneOverlayLayer({imgoption:"Foreground"}),this._map.addLayer(d);b.addEventListener("baselayerchange",this._onBaseLayerChange,this)},onRemove:function(b){if(null!=this.transparentOverlayLayer){var d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,imgOption:this.transparentOverlayLayer.imgoption,
style:this.transparentOverlayLayer.style,isBaseLayer:this.transparentOverlayLayer.isBaseLayer});null!=d&&this._map.attributionControl.removeAttribution(d);this._map.removeLayer(this.transparentOverlayLayer);this.transparentOverlayLayer=null}d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region,isBaseLayer:this.isBaseLayer});null!=d&&this._map.attributionControl.removeAttribution(d);b.removeEventListener("baselayerchange",this._onBaseLayerChange,this);this.removeEventListener("loading",
this._onLoadStart,this);this.removeEventListener("load",this._onLoadEnd,this);a.TileLayer.prototype.onRemove.call(this,b)},setStyle:function(a){if(null!=this.transparentOverlayLayer&&"satellite"!==a)this._map.removeLayer(this.transparentOverlayLayer),this.transparentOverlayLayer=null;if("satellite"!==this.style&&"satellite"===a&&(this.style=a,this.imgoption="Background",this._map)){var b=this.cloneOverlayLayer({imgoption:"Foreground"});b.isBaseLayer=!1;this.transparentOverlayLayer=b;this._map.addLayer(b)}this.style=
ALKMaps.STYLE.legacyCheck(a);this.setUrl(this.getUrl(),!1)},setRegion:function(b){if(this.region!==b){var d=this.region;this.region=b;this.setUrl(this.getUrl(),!1);!0===this.isBaseLayer&&(b=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:d,isBaseLayer:this.isBaseLayer}),d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region,isBaseLayer:this.isBaseLayer}),null!=b&&this._map.attributionControl.removeAttribution(b),null!=d&&this._map.attributionControl.addAttribution(d),
this.transparentOverlayLayer&&this.transparentOverlayLayer.setRegion(this.region))}},setDataset:function(a){this.dataset=a;if(this.transparentOverlayLayer)this.transparentOverlayLayer.dataset=a,this.transparentOverlayLayer.setUrl(this.transparentOverlayLayer.getUrl(),!1);this.setUrl(this.getUrl())},setLanguage:function(a){this.language=a;this.setUrl(this.getUrl(),!1)},clone:function(b){var d={region:this.region,dataset:this.dataset,style:this.style,imgsrc:this.imgsrc,zoomOffset:this.zoomOffset,tileSize:this.tileSize,
drawergroups:this.drawergroups,language:this.language};if(null!=this.attribution)d.attribution=this.attribution;if(null!=b.imgoption)d.imgoption=b.imgoption;return new a.ALKMaps.Layer.Tile(d)},cloneOverlayLayer:function(b){var d=this.clone(b);d.isBaseLayer=!1;if("satellite"===this.style)d.imgoption=b.imgoption,d.options.attribution=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,imgOption:d.imgoption,style:d.style,isBaseLayer:d.isBaseLayer});return d},getUrl:function(){var b=ALKMaps.IsInitMap;
if(ALKMaps.IsInitMap)ALKMaps.IsInitMap=!1;var d=a.ALKMaps.Util.getApiKey(b),e=ALKMaps.Util.getDrawerGroupFlags(this.drawergroups),b={INIT:b,AUTHTOKEN:d,region:this.region,dataset:this.dataset,srs:this.projection,vectorstyle:this.style,width:this.tileSize,drawergroups:e,language:this.language},e="";"satellite"===this.style&&null!=this.imgoption?(b.imgoption=this.imgoption,"Background"===this.imgoption?(b=ALKMaps.Util.getSatelliteProvider(this.imgsrc),d=ALKMaps.Util.getParameterString({authToken:d,
proj:"EPSG:900913",provider:b,width:this.tileSize}),e=a.ALKMaps.ContentServiceURL_SatImg+"SatImageTile?"+d+"&z={z}&x={x}&y={y}"):e=a.ALKMaps.MapTileServiceURL+"maptile?"+ALKMaps.Util.getParameterString(b)+"&z={z}&x={x}&y={y}"):e=a.ALKMaps.MapTileServiceURL+"maptile?"+ALKMaps.Util.getParameterString(b)+"&z={z}&x={x}&y={y}";return e},addContent:function(a){a=ALKMaps.Util.convertToStringArray(a);a=a.concat(this.drawergroups.split(","));ALKMaps.Util.removeDuplicates(a);this.drawergroups=a.join(",");if(this.transparentOverlayLayer)this.transparentOverlayLayer.drawergroups=
this.drawergroups,this.transparentOverlayLayer.setUrl(this.transparentOverlayLayer.getUrl(),!1);this.setUrl(this.getUrl())},setContent:function(a){this.drawergroups="";this.addContent(a)},removeContent:function(a){var b=ALKMaps.Util.convertToStringArray(a),a=this.drawergroups.split(","),a=a.filter(function(a){return-1===b.indexOf(a)});this.drawergroups=a.join(",");if(this.transparentOverlayLayer)this.transparentOverlayLayer.drawergroups=this.drawergroups,this.transparentOverlayLayer.setUrl(this.transparentOverlayLayer.getUrl(),
!1);this.setUrl(this.getUrl())},_onBaseLayerChange:function(a){null!=a&&!0===a.layer.isBaseLayer&&a.layer===this&&null!=this.transparentOverlayLayer&&this.transparentOverlayLayer.setZIndex(a.layer.options.zIndex+1)},_onLoadStart:function(){if(null==this.loading||!1===this.loading)this.loading=!0,a.ALKMaps.Util.showLoading(this._map)},_onLoadEnd:function(){if(!0===this.loading)a.ALKMaps.Util.hideLoading(this._map),this.loading=!1},CLASS_NAME:"ALKMaps.Layer.BaseMap"});b.tile=function(a,d){return new b.Tile(a,
d)};b.BaseMap=b.Tile;b.baseMap=b.tile}})("undefined"===typeof L?null:L);(function(a){if(a){var b=a.ALKMaps.Layer;b.Routing=a.Class.extend({map:null,_routeIds:[],_features:[],_currentStyleId:-1,_routeStyles:[{opacity:0.6,color:"#00ff06",weight:9},{opacity:0.6,color:"#fe9300",weight:9},{opacity:0.6,color:"#027ffb",weight:9},{opacity:0.6,color:"#a55fff",weight:9},{opacity:0.6,color:"#2448ff",weight:9},{opacity:0.6,color:"#fc5800",weight:9},{opacity:0.6,color:"#02d4cf",weight:9},{opacity:0.6,color:"#ce4871",weight:9}],_routeObjs:[],initialize:function(){},onAdd:function(b){this._map=
b;this._el=a.DomUtil.create("div","routing-layer leaflet-zoom-hide");b.getPanes().overlayPane.appendChild(this._el)},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._el)},addRoute:function(b){var b=b||{},d=b.stops,e=b.options||{},f=b.functionOptions||{},g=b.reportOptions||null;if(null==e.dataset&&null!=g&&null!=g.dataVersion)if(!0===/^PCM[0-9]{2}$/.test(g.dataVersion)){if(22<Number(g.dataVersion.substring(3)))e.dataset=g.dataVersion}else e.dataset=g.dataVersion;e.region=e.region||"NA";
e.dataset=e.dataset||"Current";for(var h=null!=f.style&&"object"===typeof f.style?f.style:this._getNextRouteStyle(),i=null!=f.showHandles&&!1===f.showHandles?!1:!0,j=null!=f.frameRoutes&&!1===f.frameRoutes?!1:!0,k="",m=0;m<d.length;m++)0<m&&(k+=";"),k+=d[m].lng+","+d[m].lat;var l=this;a.ALKMaps.Util.showLoading(this._map);a.ALKMaps.Services.getRoutePath({stops:k,options:e,success:function(k){var n=JSON.parse(k.responseText),k={routeFeatures:[]};k.routeId=f.routeId;k.params=b;for(var n=n.geometry.coordinates,
m=[],o=0;o<n.length;o++){for(var r=[],t=0;t<n[o].length;t++)r.push(a.latLng(n[o][t][1],n[o][t][0]));m.push(r)}ALKMaps.String.startsWith(a.version,"0.7.")?n=a.multiPolyline(m,h).addTo(l._map):ALKMaps.String.startsWith(a.version,"1.0.3")?n=a.polyline(m,h).addTo(l._map):(n=a.polyline(m,h).addTo(l._map),console.log("Leaflet version",a.version,"is not fully tested."));l._features.push(n);k.routeFeatures.push(n);n=1;!1===i&&(n=0);for(var s=[],o=0;o<d.length;o++){switch(o){case 0:r=a.icon({iconUrl:a.ALKMaps.Util.getImageLocation("flag_start.png"),
iconSize:[25,25]});break;case d.length-1:r=a.icon({iconUrl:a.ALKMaps.Util.getImageLocation("flag_end.png"),iconSize:[25,25]});break;default:r=a.icon({iconUrl:a.ALKMaps.Util.getImageLocation("flag_waypoint.png"),iconSize:[25,25]})}s.push([d[o].lng,d[o].lat]);r=a.marker([d[o].lat,d[o].lng],{icon:r,opacity:n});r.addTo(l._map);l._features.push(r);k.routeFeatures.push(r)}a.ALKMaps.Util.hideLoading(l._map);!0===j&&(n=a.featureGroup(l._features).getBounds(),l._map.fitBounds(n));l._routeIds.push(f.routeId);
l._routeObjs.push(k);k=function(a){null!=b.success&&"function"===typeof b.success&&b.success({routeId:f.routeId,report:a,stops:s,path:m})};null!=g&&"object"===typeof g?a.ALKMaps.Services.getReports({coords:s,options:e,reportOptions:g,success:k,failure:function(a){if(b.failure&&"function"===typeof b.failure)b.failure(a);else{for(var d="",e=0;e<a.length;e++)d=d+a[e].Description+"\n\n";alert(d)}}}):k(null)},failure:function(a){b.failure&&"function"===typeof b.failure?b.failure(a):alert(a.status+"\n"+
a.statusText+"\n "+a.responseText)}})},removeRoute:function(a){for(var b=0;b<this._routeObjs.length;b++)if(this._routeObjs[b].routeId===a){for(var e=this._routeObjs[b],f=0;f<e.routeFeatures.length;f++){var g=e.routeFeatures[f];this._map.removeLayer(g);g=this._features.indexOf(g);-1<g&&this._features.splice(g,1)}-1<this._routeIds.indexOf(a)&&this._routeIds.splice(this._routeIds.indexOf(a),1);e=this._routeObjs.indexOf(e);-1<e&&this._routeObjs.splice(e,1)}},updateRoute:function(a){for(var b=(a.functionOptions||
{}).routeId,e=0;e<this._routeObjs.length;e++)if(this._routeObjs[e].routeId===b){e=this._routeObjs[e];if(void 0===a.stops)a.stops=e.params.stops;if(void 0===a.options)a.options=e.params.options;if(void 0===a.reportOptions)a.reportOptions=e.params.reportOptions;if(void 0===a.functionOptions)a.functionOptions=e.params.functionOptions;break}this.removeRoute(b);this.addRoute(a)},_getNextRouteStyle:function(){this._currentStyleId++;if(this._currentStyleId>=this._routeStyles.length)this._currentStyleId=
0;return this._routeStyles[this._currentStyleId]},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){this._map=b;this._zoomAnimated=b._zoomAnimated;if(this.getEvents){var e=this.getEvents();b.on(e,this);this.once("remove",function(){b.off(e,this)},this)}this.onAdd(b);b.fire("layeradd",{layer:this})}},CLASS_NAME:"ALKMaps.Layer.Routing"});b.routing=function(a){return new b.Routing(a)}}})("undefined"===typeof L?null:L);(function(a){if(a){var b=a.ALKMaps.Layer;b.Traffic=a.TileLayer.extend({projection:a.CRS.EPSG900913.code,region:"NA",histDay:null,histTimeBin:null,histTimeZone:null,initialize:function(b){b=b||{};this.region=b.region||this.region;this.histDay=b.histDay||this.histDay;this.histTimeBin=b.histTimeBin||this.histTimeBin;this.histTimeZone=b.histTimeZone||this.histTimeZone;this.opacity=b.opacity||0.5;a.setOptions(this,{maxZoom:20})},onAdd:function(b){this._map=b;var d=this._getUrl();a.TileLayer.prototype.initialize.call(this,
d,{subdomains:["a","b","c","d"],opacity:this.opacity});d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region});b.attributionControl.addAttribution(d);a.TileLayer.prototype.onAdd.call(this,b);b.addEventListener("zoomend",this._updateUrl,this);this.addEventListener("loading",this._onLoadStart,this);this.addEventListener("load",this._onLoadEnd,this);a.TileLayer.prototype.onAdd.call(this,b)},onRemove:function(b){var d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,
region:this.region});b.attributionControl.removeAttribution(d);b.removeEventListener("zoomend",this._updateUrl,this);this.removeEventListener("loading",this._onLoadStart,this);this.removeEventListener("load",this._onLoadEnd,this);a.TileLayer.prototype.onRemove.call(this,b)},setRegion:function(b){if(b!==this.region){var d=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region}),e=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:b});null!=d&&this._map.attributionControl.removeAttribution(d);
null!=e&&this._map.attributionControl.addAttribution(e);this.region=b;this._updateUrl()}},clone:function(){return new a.ALKMaps.Layer.Traffic({region:this.region,histDay:this.histDay,histTimeBin:this.histTimeBin,histTimeZone:this.histTimeZone,opacity:this.opacity})},_getUrl:function(){var b=a.ALKMaps.Util.getApiKey(),d=this._map.getZoom(),e=ALKMaps.Services.getFrcs(d);return a.ALKMaps.MapTileServiceURL+"trafficTile?"+ALKMaps.Util.getParameterString({AUTHTOKEN:b,region:this.region,width:this.tileSize,
height:this.tileSize,FRCS:e,histDay:this.histDay,histTimeBin:this.histTimeBin,histTimeZone:this.histTimeZone,strokeWidth:7<d?d-5:2})+"&z={z}&x={x}&y={y}"},_updateUrl:function(){this.setUrl(this._getUrl(),!1)},_onLoadStart:function(){if(null==this.loading||!1===this.loading)this.loading=!0,a.ALKMaps.Util.showLoading(this._map)},_onLoadEnd:function(){if(!0===this.loading)a.ALKMaps.Util.hideLoading(this._map),this.loading=!1},CLASS_NAME:"ALKMaps.Layer.Traffic"});b.traffic=function(a){return new b.Traffic(a)}}})("undefined"===
typeof L?null:L);(function(a){if(a){var b=a.ALKMaps.Layer;b.WeatherRadar=a.TileLayer.extend({projection:a.CRS.EPSG900913.code,opacity:0.5,display:"radar",attribution:null,attrPosition:"bottomright",attrUseHyperlink:!1,attrVisible:!0,minZoom:4,maxZoom:20,tileSize:256,initialize:function(b){b=b||{};this.display=null!=b.display&&"satellite"===b.display?b.display:this.display;this.opacity=b.opacity||this.opacity;this.attribution=b.attribution||this.attribution;this.attrPosition=b.attrPosition||this.attrPosition;this.attrUseHyperlink=
void 0===b.attrUseHyperlink?this.attrUseHyperlink:b.attrUseHyperlink;this.attrVisible=void 0===b.attrVisible?this.attrVisible:b.attrVisible;this.tileSize=b.tileSize||this.tileSize;this.zoomOffset=512===this.tileSize?-1:0;var b=a.ALKMaps.Services.getAttribution({className:this.CLASS_NAME,region:this.region}),d=this.getUrl();a.TileLayer.prototype.initialize.call(this,d,{attribution:b,minZoom:this.minZoom,maxZoom:this.maxZoom,subdomains:["a","b","c","d"],zoomOffset:this.zoomOffset,tileSize:this.tileSize,
opacity:this.opacity})},onAdd:function(b){this._map=b;a.TileLayer.prototype.onAdd.call(this,this._map);this._map.attributionControl.setPosition(this.attrPosition);this.setUrl(this.getUrl(),!1)},onRemove:function(b){a.TileLayer.prototype.onRemove.call(this,b)},getUrl:function(){var b={weatherDisplay:this.display,AUTHTOKEN:a.ALKMaps.Util.getApiKey(),srs:this.projection};return a.ALKMaps.ContentServiceURL_SatImg+"WeatherImageTile?"+ALKMaps.Util.getParameterString(b)+"&z={z}&x={x}&y={y}"},CLASS_NAME:"ALKMaps.Layer.WeatherRadar"});
b.weatherRadar=function(a){return new b.WeatherRadar(a)}}})("undefined"===typeof L?null:L);
